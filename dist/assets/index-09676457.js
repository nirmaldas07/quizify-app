(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var _2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function iy(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ay={exports:{}},lu={},oy={exports:{}},Ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wo=Symbol.for("react.element"),k2=Symbol.for("react.portal"),E2=Symbol.for("react.fragment"),C2=Symbol.for("react.strict_mode"),T2=Symbol.for("react.profiler"),I2=Symbol.for("react.provider"),A2=Symbol.for("react.context"),R2=Symbol.for("react.forward_ref"),P2=Symbol.for("react.suspense"),D2=Symbol.for("react.memo"),M2=Symbol.for("react.lazy"),i0=Symbol.iterator;function L2(t){return t===null||typeof t!="object"?null:(t=i0&&t[i0]||t["@@iterator"],typeof t=="function"?t:null)}var ly={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},cy=Object.assign,uy={};function ga(t,e,n){this.props=t,this.context=e,this.refs=uy,this.updater=n||ly}ga.prototype.isReactComponent={};ga.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ga.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function dy(){}dy.prototype=ga.prototype;function bf(t,e,n){this.props=t,this.context=e,this.refs=uy,this.updater=n||ly}var wf=bf.prototype=new dy;wf.constructor=bf;cy(wf,ga.prototype);wf.isPureReactComponent=!0;var a0=Array.isArray,hy=Object.prototype.hasOwnProperty,Nf={current:null},fy={key:!0,ref:!0,__self:!0,__source:!0};function my(t,e,n){var r,i={},a=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)hy.call(e,r)&&!fy.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];i.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Wo,type:t,key:a,ref:o,props:i,_owner:Nf.current}}function O2(t,e){return{$$typeof:Wo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function jf(t){return typeof t=="object"&&t!==null&&t.$$typeof===Wo}function F2(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var o0=/\/+/g;function od(t,e){return typeof t=="object"&&t!==null&&t.key!=null?F2(""+t.key):e.toString(36)}function Jl(t,e,n,r,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Wo:case k2:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+od(o,0):r,a0(i)?(n="",t!=null&&(n=t.replace(o0,"$&/")+"/"),Jl(i,e,n,"",function(d){return d})):i!=null&&(jf(i)&&(i=O2(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(o0,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",a0(t))for(var l=0;l<t.length;l++){a=t[l];var u=r+od(a,l);o+=Jl(a,e,n,u,i)}else if(u=L2(t),typeof u=="function")for(t=u.call(t),l=0;!(a=t.next()).done;)a=a.value,u=r+od(a,l++),o+=Jl(a,e,n,u,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function bl(t,e,n){if(t==null)return t;var r=[],i=0;return Jl(t,r,"","",function(a){return e.call(n,a,i++)}),r}function V2(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var vn={current:null},Zl={transition:null},z2={ReactCurrentDispatcher:vn,ReactCurrentBatchConfig:Zl,ReactCurrentOwner:Nf};function py(){throw Error("act(...) is not supported in production builds of React.")}Ve.Children={map:bl,forEach:function(t,e,n){bl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return bl(t,function(){e++}),e},toArray:function(t){return bl(t,function(e){return e})||[]},only:function(t){if(!jf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ve.Component=ga;Ve.Fragment=E2;Ve.Profiler=T2;Ve.PureComponent=bf;Ve.StrictMode=C2;Ve.Suspense=P2;Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z2;Ve.act=py;Ve.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=cy({},t.props),i=t.key,a=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=Nf.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)hy.call(e,u)&&!fy.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Wo,type:t.type,key:i,ref:a,props:r,_owner:o}};Ve.createContext=function(t){return t={$$typeof:A2,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:I2,_context:t},t.Consumer=t};Ve.createElement=my;Ve.createFactory=function(t){var e=my.bind(null,t);return e.type=t,e};Ve.createRef=function(){return{current:null}};Ve.forwardRef=function(t){return{$$typeof:R2,render:t}};Ve.isValidElement=jf;Ve.lazy=function(t){return{$$typeof:M2,_payload:{_status:-1,_result:t},_init:V2}};Ve.memo=function(t,e){return{$$typeof:D2,type:t,compare:e===void 0?null:e}};Ve.startTransition=function(t){var e=Zl.transition;Zl.transition={};try{t()}finally{Zl.transition=e}};Ve.unstable_act=py;Ve.useCallback=function(t,e){return vn.current.useCallback(t,e)};Ve.useContext=function(t){return vn.current.useContext(t)};Ve.useDebugValue=function(){};Ve.useDeferredValue=function(t){return vn.current.useDeferredValue(t)};Ve.useEffect=function(t,e){return vn.current.useEffect(t,e)};Ve.useId=function(){return vn.current.useId()};Ve.useImperativeHandle=function(t,e,n){return vn.current.useImperativeHandle(t,e,n)};Ve.useInsertionEffect=function(t,e){return vn.current.useInsertionEffect(t,e)};Ve.useLayoutEffect=function(t,e){return vn.current.useLayoutEffect(t,e)};Ve.useMemo=function(t,e){return vn.current.useMemo(t,e)};Ve.useReducer=function(t,e,n){return vn.current.useReducer(t,e,n)};Ve.useRef=function(t){return vn.current.useRef(t)};Ve.useState=function(t){return vn.current.useState(t)};Ve.useSyncExternalStore=function(t,e,n){return vn.current.useSyncExternalStore(t,e,n)};Ve.useTransition=function(){return vn.current.useTransition()};Ve.version="18.3.1";oy.exports=Ve;var f=oy.exports;const pn=iy(f);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $2=f,B2=Symbol.for("react.element"),U2=Symbol.for("react.fragment"),q2=Object.prototype.hasOwnProperty,Q2=$2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,G2={key:!0,ref:!0,__self:!0,__source:!0};function gy(t,e,n){var r,i={},a=null,o=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)q2.call(e,r)&&!G2.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:B2,type:t,key:a,ref:o,props:i,_owner:Q2.current}}lu.Fragment=U2;lu.jsx=gy;lu.jsxs=gy;ay.exports=lu;var s=ay.exports,Jd={},xy={exports:{}},zn={},yy={exports:{}},vy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e($,O){var V=$.length;$.push(O);e:for(;0<V;){var B=V-1>>>1,M=$[B];if(0<i(M,O))$[B]=O,$[V]=M,V=B;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var O=$[0],V=$.pop();if(V!==O){$[0]=V;e:for(var B=0,M=$.length,z=M>>>1;B<z;){var H=2*(B+1)-1,ne=$[H],q=H+1,ee=$[q];if(0>i(ne,V))q<M&&0>i(ee,ne)?($[B]=ee,$[q]=V,B=q):($[B]=ne,$[H]=V,B=H);else if(q<M&&0>i(ee,V))$[B]=ee,$[q]=V,B=q;else break e}}return O}function i($,O){var V=$.sortIndex-O.sortIndex;return V!==0?V:$.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],d=[],h=1,g=null,x=3,N=!1,w=!1,k=!1,I=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v($){for(var O=n(d);O!==null;){if(O.callback===null)r(d);else if(O.startTime<=$)r(d),O.sortIndex=O.expirationTime,e(u,O);else break;O=n(d)}}function P($){if(k=!1,v($),!w)if(n(u)!==null)w=!0,te(D);else{var O=n(d);O!==null&&K(P,O.startTime-$)}}function D($,O){w=!1,k&&(k=!1,C(m),m=-1),N=!0;var V=x;try{for(v(O),g=n(u);g!==null&&(!(g.expirationTime>O)||$&&!A());){var B=g.callback;if(typeof B=="function"){g.callback=null,x=g.priorityLevel;var M=B(g.expirationTime<=O);O=t.unstable_now(),typeof M=="function"?g.callback=M:g===n(u)&&r(u),v(O)}else r(u);g=n(u)}if(g!==null)var z=!0;else{var H=n(d);H!==null&&K(P,H.startTime-O),z=!1}return z}finally{g=null,x=V,N=!1}}var L=!1,E=null,m=-1,y=5,j=-1;function A(){return!(t.unstable_now()-j<y)}function T(){if(E!==null){var $=t.unstable_now();j=$;var O=!0;try{O=E(!0,$)}finally{O?S():(L=!1,E=null)}}else L=!1}var S;if(typeof _=="function")S=function(){_(T)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,Z=G.port2;G.port1.onmessage=T,S=function(){Z.postMessage(null)}}else S=function(){I(T,0)};function te($){E=$,L||(L=!0,S())}function K($,O){m=I(function(){$(t.unstable_now())},O)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){w||N||(w=!0,te(D))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function($){switch(x){case 1:case 2:case 3:var O=3;break;default:O=x}var V=x;x=O;try{return $()}finally{x=V}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,O){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var V=x;x=$;try{return O()}finally{x=V}},t.unstable_scheduleCallback=function($,O,V){var B=t.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?B+V:B):V=B,$){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=V+M,$={id:h++,callback:O,priorityLevel:$,startTime:V,expirationTime:M,sortIndex:-1},V>B?($.sortIndex=V,e(d,$),n(u)===null&&$===n(d)&&(k?(C(m),m=-1):k=!0,K(P,V-B))):($.sortIndex=M,e(u,$),w||N||(w=!0,te(D))),$},t.unstable_shouldYield=A,t.unstable_wrapCallback=function($){var O=x;return function(){var V=x;x=O;try{return $.apply(this,arguments)}finally{x=V}}}})(vy);yy.exports=vy;var H2=yy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W2=f,Fn=H2;function de(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var by=new Set,wo={};function xi(t,e){na(t,e),na(t+"Capture",e)}function na(t,e){for(wo[t]=e,t=0;t<e.length;t++)by.add(e[t])}var Fr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zd=Object.prototype.hasOwnProperty,Y2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,l0={},c0={};function K2(t){return Zd.call(c0,t)?!0:Zd.call(l0,t)?!1:Y2.test(t)?c0[t]=!0:(l0[t]=!0,!1)}function X2(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function J2(t,e,n,r){if(e===null||typeof e>"u"||X2(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function bn(t,e,n,r,i,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var Zt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Zt[t]=new bn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Zt[e]=new bn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Zt[t]=new bn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Zt[t]=new bn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Zt[t]=new bn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Zt[t]=new bn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Zt[t]=new bn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Zt[t]=new bn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Zt[t]=new bn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Sf=/[\-:]([a-z])/g;function _f(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Sf,_f);Zt[e]=new bn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Sf,_f);Zt[e]=new bn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Sf,_f);Zt[e]=new bn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Zt[t]=new bn(t,1,!1,t.toLowerCase(),null,!1,!1)});Zt.xlinkHref=new bn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Zt[t]=new bn(t,1,!1,t.toLowerCase(),null,!0,!0)});function kf(t,e,n,r){var i=Zt.hasOwnProperty(e)?Zt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(J2(e,n,i,r)&&(n=null),r||i===null?K2(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Hr=W2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wl=Symbol.for("react.element"),Li=Symbol.for("react.portal"),Oi=Symbol.for("react.fragment"),Ef=Symbol.for("react.strict_mode"),eh=Symbol.for("react.profiler"),wy=Symbol.for("react.provider"),Ny=Symbol.for("react.context"),Cf=Symbol.for("react.forward_ref"),th=Symbol.for("react.suspense"),nh=Symbol.for("react.suspense_list"),Tf=Symbol.for("react.memo"),ns=Symbol.for("react.lazy"),jy=Symbol.for("react.offscreen"),u0=Symbol.iterator;function Oa(t){return t===null||typeof t!="object"?null:(t=u0&&t[u0]||t["@@iterator"],typeof t=="function"?t:null)}var _t=Object.assign,ld;function Xa(t){if(ld===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);ld=e&&e[1]||""}return`
`+ld+t}var cd=!1;function ud(t,e){if(!t||cd)return"";cd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),a=r.stack.split(`
`),o=i.length-1,l=a.length-1;1<=o&&0<=l&&i[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==a[l]){var u=`
`+i[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{cd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Xa(t):""}function Z2(t){switch(t.tag){case 5:return Xa(t.type);case 16:return Xa("Lazy");case 13:return Xa("Suspense");case 19:return Xa("SuspenseList");case 0:case 2:case 15:return t=ud(t.type,!1),t;case 11:return t=ud(t.type.render,!1),t;case 1:return t=ud(t.type,!0),t;default:return""}}function rh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Oi:return"Fragment";case Li:return"Portal";case eh:return"Profiler";case Ef:return"StrictMode";case th:return"Suspense";case nh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Ny:return(t.displayName||"Context")+".Consumer";case wy:return(t._context.displayName||"Context")+".Provider";case Cf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Tf:return e=t.displayName||null,e!==null?e:rh(t.type)||"Memo";case ns:e=t._payload,t=t._init;try{return rh(t(e))}catch{}}return null}function e5(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rh(e);case 8:return e===Ef?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ss(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Sy(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function t5(t){var e=Sy(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Nl(t){t._valueTracker||(t._valueTracker=t5(t))}function _y(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Sy(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function bc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function sh(t,e){var n=e.checked;return _t({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function d0(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ss(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ky(t,e){e=e.checked,e!=null&&kf(t,"checked",e,!1)}function ih(t,e){ky(t,e);var n=Ss(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ah(t,e.type,n):e.hasOwnProperty("defaultValue")&&ah(t,e.type,Ss(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function h0(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ah(t,e,n){(e!=="number"||bc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ja=Array.isArray;function Wi(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ss(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function oh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(de(91));return _t({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function f0(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(de(92));if(Ja(n)){if(1<n.length)throw Error(de(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ss(n)}}function Ey(t,e){var n=Ss(e.value),r=Ss(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function m0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Cy(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Cy(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var jl,Ty=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(jl=jl||document.createElement("div"),jl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=jl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function No(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var io={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},n5=["Webkit","ms","Moz","O"];Object.keys(io).forEach(function(t){n5.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),io[e]=io[t]})});function Iy(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||io.hasOwnProperty(t)&&io[t]?(""+e).trim():e+"px"}function Ay(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Iy(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var r5=_t({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ch(t,e){if(e){if(r5[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(de(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(de(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(de(61))}if(e.style!=null&&typeof e.style!="object")throw Error(de(62))}}function uh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dh=null;function If(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var hh=null,Yi=null,Ki=null;function p0(t){if(t=Xo(t)){if(typeof hh!="function")throw Error(de(280));var e=t.stateNode;e&&(e=fu(e),hh(t.stateNode,t.type,e))}}function Ry(t){Yi?Ki?Ki.push(t):Ki=[t]:Yi=t}function Py(){if(Yi){var t=Yi,e=Ki;if(Ki=Yi=null,p0(t),e)for(t=0;t<e.length;t++)p0(e[t])}}function Dy(t,e){return t(e)}function My(){}var dd=!1;function Ly(t,e,n){if(dd)return t(e,n);dd=!0;try{return Dy(t,e,n)}finally{dd=!1,(Yi!==null||Ki!==null)&&(My(),Py())}}function jo(t,e){var n=t.stateNode;if(n===null)return null;var r=fu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(de(231,e,typeof n));return n}var fh=!1;if(Fr)try{var Fa={};Object.defineProperty(Fa,"passive",{get:function(){fh=!0}}),window.addEventListener("test",Fa,Fa),window.removeEventListener("test",Fa,Fa)}catch{fh=!1}function s5(t,e,n,r,i,a,o,l,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var ao=!1,wc=null,Nc=!1,mh=null,i5={onError:function(t){ao=!0,wc=t}};function a5(t,e,n,r,i,a,o,l,u){ao=!1,wc=null,s5.apply(i5,arguments)}function o5(t,e,n,r,i,a,o,l,u){if(a5.apply(this,arguments),ao){if(ao){var d=wc;ao=!1,wc=null}else throw Error(de(198));Nc||(Nc=!0,mh=d)}}function yi(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Oy(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function g0(t){if(yi(t)!==t)throw Error(de(188))}function l5(t){var e=t.alternate;if(!e){if(e=yi(t),e===null)throw Error(de(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return g0(i),t;if(a===r)return g0(i),e;a=a.sibling}throw Error(de(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o)throw Error(de(189))}}if(n.alternate!==r)throw Error(de(190))}if(n.tag!==3)throw Error(de(188));return n.stateNode.current===n?t:e}function Fy(t){return t=l5(t),t!==null?Vy(t):null}function Vy(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Vy(t);if(e!==null)return e;t=t.sibling}return null}var zy=Fn.unstable_scheduleCallback,x0=Fn.unstable_cancelCallback,c5=Fn.unstable_shouldYield,u5=Fn.unstable_requestPaint,Rt=Fn.unstable_now,d5=Fn.unstable_getCurrentPriorityLevel,Af=Fn.unstable_ImmediatePriority,$y=Fn.unstable_UserBlockingPriority,jc=Fn.unstable_NormalPriority,h5=Fn.unstable_LowPriority,By=Fn.unstable_IdlePriority,cu=null,yr=null;function f5(t){if(yr&&typeof yr.onCommitFiberRoot=="function")try{yr.onCommitFiberRoot(cu,t,void 0,(t.current.flags&128)===128)}catch{}}var or=Math.clz32?Math.clz32:g5,m5=Math.log,p5=Math.LN2;function g5(t){return t>>>=0,t===0?32:31-(m5(t)/p5|0)|0}var Sl=64,_l=4194304;function Za(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Sc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,a=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=Za(l):(a&=o,a!==0&&(r=Za(a)))}else o=n&~i,o!==0?r=Za(o):a!==0&&(r=Za(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-or(e),i=1<<n,r|=t[n],e&=~i;return r}function x5(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function y5(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-or(a),l=1<<o,u=i[o];u===-1?(!(l&n)||l&r)&&(i[o]=x5(l,e)):u<=e&&(t.expiredLanes|=l),a&=~l}}function ph(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Uy(){var t=Sl;return Sl<<=1,!(Sl&4194240)&&(Sl=64),t}function hd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Yo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-or(e),t[e]=n}function v5(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-or(n),a=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~a}}function Rf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-or(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var it=0;function qy(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Qy,Pf,Gy,Hy,Wy,gh=!1,kl=[],hs=null,fs=null,ms=null,So=new Map,_o=new Map,is=[],b5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function y0(t,e){switch(t){case"focusin":case"focusout":hs=null;break;case"dragenter":case"dragleave":fs=null;break;case"mouseover":case"mouseout":ms=null;break;case"pointerover":case"pointerout":So.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":_o.delete(e.pointerId)}}function Va(t,e,n,r,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},e!==null&&(e=Xo(e),e!==null&&Pf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function w5(t,e,n,r,i){switch(e){case"focusin":return hs=Va(hs,t,e,n,r,i),!0;case"dragenter":return fs=Va(fs,t,e,n,r,i),!0;case"mouseover":return ms=Va(ms,t,e,n,r,i),!0;case"pointerover":var a=i.pointerId;return So.set(a,Va(So.get(a)||null,t,e,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,_o.set(a,Va(_o.get(a)||null,t,e,n,r,i)),!0}return!1}function Yy(t){var e=Ks(t.target);if(e!==null){var n=yi(e);if(n!==null){if(e=n.tag,e===13){if(e=Oy(n),e!==null){t.blockedOn=e,Wy(t.priority,function(){Gy(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ec(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=xh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);dh=r,n.target.dispatchEvent(r),dh=null}else return e=Xo(n),e!==null&&Pf(e),t.blockedOn=n,!1;e.shift()}return!0}function v0(t,e,n){ec(t)&&n.delete(e)}function N5(){gh=!1,hs!==null&&ec(hs)&&(hs=null),fs!==null&&ec(fs)&&(fs=null),ms!==null&&ec(ms)&&(ms=null),So.forEach(v0),_o.forEach(v0)}function za(t,e){t.blockedOn===e&&(t.blockedOn=null,gh||(gh=!0,Fn.unstable_scheduleCallback(Fn.unstable_NormalPriority,N5)))}function ko(t){function e(i){return za(i,t)}if(0<kl.length){za(kl[0],t);for(var n=1;n<kl.length;n++){var r=kl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(hs!==null&&za(hs,t),fs!==null&&za(fs,t),ms!==null&&za(ms,t),So.forEach(e),_o.forEach(e),n=0;n<is.length;n++)r=is[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<is.length&&(n=is[0],n.blockedOn===null);)Yy(n),n.blockedOn===null&&is.shift()}var Xi=Hr.ReactCurrentBatchConfig,_c=!0;function j5(t,e,n,r){var i=it,a=Xi.transition;Xi.transition=null;try{it=1,Df(t,e,n,r)}finally{it=i,Xi.transition=a}}function S5(t,e,n,r){var i=it,a=Xi.transition;Xi.transition=null;try{it=4,Df(t,e,n,r)}finally{it=i,Xi.transition=a}}function Df(t,e,n,r){if(_c){var i=xh(t,e,n,r);if(i===null)Nd(t,e,r,kc,n),y0(t,r);else if(w5(i,t,e,n,r))r.stopPropagation();else if(y0(t,r),e&4&&-1<b5.indexOf(t)){for(;i!==null;){var a=Xo(i);if(a!==null&&Qy(a),a=xh(t,e,n,r),a===null&&Nd(t,e,r,kc,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else Nd(t,e,r,null,n)}}var kc=null;function xh(t,e,n,r){if(kc=null,t=If(r),t=Ks(t),t!==null)if(e=yi(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Oy(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return kc=t,null}function Ky(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(d5()){case Af:return 1;case $y:return 4;case jc:case h5:return 16;case By:return 536870912;default:return 16}default:return 16}}var os=null,Mf=null,tc=null;function Xy(){if(tc)return tc;var t,e=Mf,n=e.length,r,i="value"in os?os.value:os.textContent,a=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[a-r];r++);return tc=i.slice(t,1<r?1-r:void 0)}function nc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function El(){return!0}function b0(){return!1}function $n(t){function e(n,r,i,a,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?El:b0,this.isPropagationStopped=b0,this}return _t(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=El)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=El)},persist:function(){},isPersistent:El}),e}var xa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lf=$n(xa),Ko=_t({},xa,{view:0,detail:0}),_5=$n(Ko),fd,md,$a,uu=_t({},Ko,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Of,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==$a&&($a&&t.type==="mousemove"?(fd=t.screenX-$a.screenX,md=t.screenY-$a.screenY):md=fd=0,$a=t),fd)},movementY:function(t){return"movementY"in t?t.movementY:md}}),w0=$n(uu),k5=_t({},uu,{dataTransfer:0}),E5=$n(k5),C5=_t({},Ko,{relatedTarget:0}),pd=$n(C5),T5=_t({},xa,{animationName:0,elapsedTime:0,pseudoElement:0}),I5=$n(T5),A5=_t({},xa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),R5=$n(A5),P5=_t({},xa,{data:0}),N0=$n(P5),D5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},M5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},L5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function O5(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=L5[t])?!!e[t]:!1}function Of(){return O5}var F5=_t({},Ko,{key:function(t){if(t.key){var e=D5[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=nc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?M5[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Of,charCode:function(t){return t.type==="keypress"?nc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?nc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),V5=$n(F5),z5=_t({},uu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),j0=$n(z5),$5=_t({},Ko,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Of}),B5=$n($5),U5=_t({},xa,{propertyName:0,elapsedTime:0,pseudoElement:0}),q5=$n(U5),Q5=_t({},uu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),G5=$n(Q5),H5=[9,13,27,32],Ff=Fr&&"CompositionEvent"in window,oo=null;Fr&&"documentMode"in document&&(oo=document.documentMode);var W5=Fr&&"TextEvent"in window&&!oo,Jy=Fr&&(!Ff||oo&&8<oo&&11>=oo),S0=String.fromCharCode(32),_0=!1;function Zy(t,e){switch(t){case"keyup":return H5.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ev(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Fi=!1;function Y5(t,e){switch(t){case"compositionend":return ev(e);case"keypress":return e.which!==32?null:(_0=!0,S0);case"textInput":return t=e.data,t===S0&&_0?null:t;default:return null}}function K5(t,e){if(Fi)return t==="compositionend"||!Ff&&Zy(t,e)?(t=Xy(),tc=Mf=os=null,Fi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Jy&&e.locale!=="ko"?null:e.data;default:return null}}var X5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function k0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!X5[t.type]:e==="textarea"}function tv(t,e,n,r){Ry(r),e=Ec(e,"onChange"),0<e.length&&(n=new Lf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var lo=null,Eo=null;function J5(t){hv(t,0)}function du(t){var e=$i(t);if(_y(e))return t}function Z5(t,e){if(t==="change")return e}var nv=!1;if(Fr){var gd;if(Fr){var xd="oninput"in document;if(!xd){var E0=document.createElement("div");E0.setAttribute("oninput","return;"),xd=typeof E0.oninput=="function"}gd=xd}else gd=!1;nv=gd&&(!document.documentMode||9<document.documentMode)}function C0(){lo&&(lo.detachEvent("onpropertychange",rv),Eo=lo=null)}function rv(t){if(t.propertyName==="value"&&du(Eo)){var e=[];tv(e,Eo,t,If(t)),Ly(J5,e)}}function eN(t,e,n){t==="focusin"?(C0(),lo=e,Eo=n,lo.attachEvent("onpropertychange",rv)):t==="focusout"&&C0()}function tN(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return du(Eo)}function nN(t,e){if(t==="click")return du(e)}function rN(t,e){if(t==="input"||t==="change")return du(e)}function sN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var cr=typeof Object.is=="function"?Object.is:sN;function Co(t,e){if(cr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Zd.call(e,i)||!cr(t[i],e[i]))return!1}return!0}function T0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function I0(t,e){var n=T0(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=T0(n)}}function sv(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?sv(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function iv(){for(var t=window,e=bc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=bc(t.document)}return e}function Vf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function iN(t){var e=iv(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&sv(n.ownerDocument.documentElement,n)){if(r!==null&&Vf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!t.extend&&a>r&&(i=r,r=a,a=i),i=I0(n,a);var o=I0(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var aN=Fr&&"documentMode"in document&&11>=document.documentMode,Vi=null,yh=null,co=null,vh=!1;function A0(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;vh||Vi==null||Vi!==bc(r)||(r=Vi,"selectionStart"in r&&Vf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),co&&Co(co,r)||(co=r,r=Ec(yh,"onSelect"),0<r.length&&(e=new Lf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Vi)))}function Cl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var zi={animationend:Cl("Animation","AnimationEnd"),animationiteration:Cl("Animation","AnimationIteration"),animationstart:Cl("Animation","AnimationStart"),transitionend:Cl("Transition","TransitionEnd")},yd={},av={};Fr&&(av=document.createElement("div").style,"AnimationEvent"in window||(delete zi.animationend.animation,delete zi.animationiteration.animation,delete zi.animationstart.animation),"TransitionEvent"in window||delete zi.transitionend.transition);function hu(t){if(yd[t])return yd[t];if(!zi[t])return t;var e=zi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in av)return yd[t]=e[n];return t}var ov=hu("animationend"),lv=hu("animationiteration"),cv=hu("animationstart"),uv=hu("transitionend"),dv=new Map,R0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ms(t,e){dv.set(t,e),xi(e,[t])}for(var vd=0;vd<R0.length;vd++){var bd=R0[vd],oN=bd.toLowerCase(),lN=bd[0].toUpperCase()+bd.slice(1);Ms(oN,"on"+lN)}Ms(ov,"onAnimationEnd");Ms(lv,"onAnimationIteration");Ms(cv,"onAnimationStart");Ms("dblclick","onDoubleClick");Ms("focusin","onFocus");Ms("focusout","onBlur");Ms(uv,"onTransitionEnd");na("onMouseEnter",["mouseout","mouseover"]);na("onMouseLeave",["mouseout","mouseover"]);na("onPointerEnter",["pointerout","pointerover"]);na("onPointerLeave",["pointerout","pointerover"]);xi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));xi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));xi("onBeforeInput",["compositionend","keypress","textInput","paste"]);xi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));xi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));xi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var eo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cN=new Set("cancel close invalid load scroll toggle".split(" ").concat(eo));function P0(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,o5(r,e,void 0,t),t.currentTarget=null}function hv(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==a&&i.isPropagationStopped())break e;P0(i,l,d),a=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,d=l.currentTarget,l=l.listener,u!==a&&i.isPropagationStopped())break e;P0(i,l,d),a=u}}}if(Nc)throw t=mh,Nc=!1,mh=null,t}function ht(t,e){var n=e[Sh];n===void 0&&(n=e[Sh]=new Set);var r=t+"__bubble";n.has(r)||(fv(e,t,2,!1),n.add(r))}function wd(t,e,n){var r=0;e&&(r|=4),fv(n,t,r,e)}var Tl="_reactListening"+Math.random().toString(36).slice(2);function To(t){if(!t[Tl]){t[Tl]=!0,by.forEach(function(n){n!=="selectionchange"&&(cN.has(n)||wd(n,!1,t),wd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Tl]||(e[Tl]=!0,wd("selectionchange",!1,e))}}function fv(t,e,n,r){switch(Ky(e)){case 1:var i=j5;break;case 4:i=S5;break;default:i=Df}n=i.bind(null,e,n,t),i=void 0,!fh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Nd(t,e,n,r,i){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Ks(l),o===null)return;if(u=o.tag,u===5||u===6){r=a=o;continue e}l=l.parentNode}}r=r.return}Ly(function(){var d=a,h=If(n),g=[];e:{var x=dv.get(t);if(x!==void 0){var N=Lf,w=t;switch(t){case"keypress":if(nc(n)===0)break e;case"keydown":case"keyup":N=V5;break;case"focusin":w="focus",N=pd;break;case"focusout":w="blur",N=pd;break;case"beforeblur":case"afterblur":N=pd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":N=w0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":N=E5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":N=B5;break;case ov:case lv:case cv:N=I5;break;case uv:N=q5;break;case"scroll":N=_5;break;case"wheel":N=G5;break;case"copy":case"cut":case"paste":N=R5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":N=j0}var k=(e&4)!==0,I=!k&&t==="scroll",C=k?x!==null?x+"Capture":null:x;k=[];for(var _=d,v;_!==null;){v=_;var P=v.stateNode;if(v.tag===5&&P!==null&&(v=P,C!==null&&(P=jo(_,C),P!=null&&k.push(Io(_,P,v)))),I)break;_=_.return}0<k.length&&(x=new N(x,w,null,n,h),g.push({event:x,listeners:k}))}}if(!(e&7)){e:{if(x=t==="mouseover"||t==="pointerover",N=t==="mouseout"||t==="pointerout",x&&n!==dh&&(w=n.relatedTarget||n.fromElement)&&(Ks(w)||w[Vr]))break e;if((N||x)&&(x=h.window===h?h:(x=h.ownerDocument)?x.defaultView||x.parentWindow:window,N?(w=n.relatedTarget||n.toElement,N=d,w=w?Ks(w):null,w!==null&&(I=yi(w),w!==I||w.tag!==5&&w.tag!==6)&&(w=null)):(N=null,w=d),N!==w)){if(k=w0,P="onMouseLeave",C="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(k=j0,P="onPointerLeave",C="onPointerEnter",_="pointer"),I=N==null?x:$i(N),v=w==null?x:$i(w),x=new k(P,_+"leave",N,n,h),x.target=I,x.relatedTarget=v,P=null,Ks(h)===d&&(k=new k(C,_+"enter",w,n,h),k.target=v,k.relatedTarget=I,P=k),I=P,N&&w)t:{for(k=N,C=w,_=0,v=k;v;v=_i(v))_++;for(v=0,P=C;P;P=_i(P))v++;for(;0<_-v;)k=_i(k),_--;for(;0<v-_;)C=_i(C),v--;for(;_--;){if(k===C||C!==null&&k===C.alternate)break t;k=_i(k),C=_i(C)}k=null}else k=null;N!==null&&D0(g,x,N,k,!1),w!==null&&I!==null&&D0(g,I,w,k,!0)}}e:{if(x=d?$i(d):window,N=x.nodeName&&x.nodeName.toLowerCase(),N==="select"||N==="input"&&x.type==="file")var D=Z5;else if(k0(x))if(nv)D=rN;else{D=tN;var L=eN}else(N=x.nodeName)&&N.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(D=nN);if(D&&(D=D(t,d))){tv(g,D,n,h);break e}L&&L(t,x,d),t==="focusout"&&(L=x._wrapperState)&&L.controlled&&x.type==="number"&&ah(x,"number",x.value)}switch(L=d?$i(d):window,t){case"focusin":(k0(L)||L.contentEditable==="true")&&(Vi=L,yh=d,co=null);break;case"focusout":co=yh=Vi=null;break;case"mousedown":vh=!0;break;case"contextmenu":case"mouseup":case"dragend":vh=!1,A0(g,n,h);break;case"selectionchange":if(aN)break;case"keydown":case"keyup":A0(g,n,h)}var E;if(Ff)e:{switch(t){case"compositionstart":var m="onCompositionStart";break e;case"compositionend":m="onCompositionEnd";break e;case"compositionupdate":m="onCompositionUpdate";break e}m=void 0}else Fi?Zy(t,n)&&(m="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(m="onCompositionStart");m&&(Jy&&n.locale!=="ko"&&(Fi||m!=="onCompositionStart"?m==="onCompositionEnd"&&Fi&&(E=Xy()):(os=h,Mf="value"in os?os.value:os.textContent,Fi=!0)),L=Ec(d,m),0<L.length&&(m=new N0(m,t,null,n,h),g.push({event:m,listeners:L}),E?m.data=E:(E=ev(n),E!==null&&(m.data=E)))),(E=W5?Y5(t,n):K5(t,n))&&(d=Ec(d,"onBeforeInput"),0<d.length&&(h=new N0("onBeforeInput","beforeinput",null,n,h),g.push({event:h,listeners:d}),h.data=E))}hv(g,e)})}function Io(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ec(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=jo(t,n),a!=null&&r.unshift(Io(t,a,i)),a=jo(t,e),a!=null&&r.push(Io(t,a,i))),t=t.return}return r}function _i(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function D0(t,e,n,r,i){for(var a=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&d!==null&&(l=d,i?(u=jo(n,a),u!=null&&o.unshift(Io(n,u,l))):i||(u=jo(n,a),u!=null&&o.push(Io(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var uN=/\r\n?/g,dN=/\u0000|\uFFFD/g;function M0(t){return(typeof t=="string"?t:""+t).replace(uN,`
`).replace(dN,"")}function Il(t,e,n){if(e=M0(e),M0(t)!==e&&n)throw Error(de(425))}function Cc(){}var bh=null,wh=null;function Nh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var jh=typeof setTimeout=="function"?setTimeout:void 0,hN=typeof clearTimeout=="function"?clearTimeout:void 0,L0=typeof Promise=="function"?Promise:void 0,fN=typeof queueMicrotask=="function"?queueMicrotask:typeof L0<"u"?function(t){return L0.resolve(null).then(t).catch(mN)}:jh;function mN(t){setTimeout(function(){throw t})}function jd(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),ko(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);ko(e)}function ps(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function O0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ya=Math.random().toString(36).slice(2),xr="__reactFiber$"+ya,Ao="__reactProps$"+ya,Vr="__reactContainer$"+ya,Sh="__reactEvents$"+ya,pN="__reactListeners$"+ya,gN="__reactHandles$"+ya;function Ks(t){var e=t[xr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Vr]||n[xr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=O0(t);t!==null;){if(n=t[xr])return n;t=O0(t)}return e}t=n,n=t.parentNode}return null}function Xo(t){return t=t[xr]||t[Vr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function $i(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(de(33))}function fu(t){return t[Ao]||null}var _h=[],Bi=-1;function Ls(t){return{current:t}}function gt(t){0>Bi||(t.current=_h[Bi],_h[Bi]=null,Bi--)}function ut(t,e){Bi++,_h[Bi]=t.current,t.current=e}var _s={},fn=Ls(_s),_n=Ls(!1),oi=_s;function ra(t,e){var n=t.type.contextTypes;if(!n)return _s;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=e[a];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function kn(t){return t=t.childContextTypes,t!=null}function Tc(){gt(_n),gt(fn)}function F0(t,e,n){if(fn.current!==_s)throw Error(de(168));ut(fn,e),ut(_n,n)}function mv(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(de(108,e5(t)||"Unknown",i));return _t({},n,r)}function Ic(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||_s,oi=fn.current,ut(fn,t),ut(_n,_n.current),!0}function V0(t,e,n){var r=t.stateNode;if(!r)throw Error(de(169));n?(t=mv(t,e,oi),r.__reactInternalMemoizedMergedChildContext=t,gt(_n),gt(fn),ut(fn,t)):gt(_n),ut(_n,n)}var Rr=null,mu=!1,Sd=!1;function pv(t){Rr===null?Rr=[t]:Rr.push(t)}function xN(t){mu=!0,pv(t)}function Os(){if(!Sd&&Rr!==null){Sd=!0;var t=0,e=it;try{var n=Rr;for(it=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Rr=null,mu=!1}catch(i){throw Rr!==null&&(Rr=Rr.slice(t+1)),zy(Af,Os),i}finally{it=e,Sd=!1}}return null}var Ui=[],qi=0,Ac=null,Rc=0,Un=[],qn=0,li=null,Pr=1,Dr="";function Hs(t,e){Ui[qi++]=Rc,Ui[qi++]=Ac,Ac=t,Rc=e}function gv(t,e,n){Un[qn++]=Pr,Un[qn++]=Dr,Un[qn++]=li,li=t;var r=Pr;t=Dr;var i=32-or(r)-1;r&=~(1<<i),n+=1;var a=32-or(e)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Pr=1<<32-or(e)+i|n<<i|r,Dr=a+t}else Pr=1<<a|n<<i|r,Dr=t}function zf(t){t.return!==null&&(Hs(t,1),gv(t,1,0))}function $f(t){for(;t===Ac;)Ac=Ui[--qi],Ui[qi]=null,Rc=Ui[--qi],Ui[qi]=null;for(;t===li;)li=Un[--qn],Un[qn]=null,Dr=Un[--qn],Un[qn]=null,Pr=Un[--qn],Un[qn]=null}var Ln=null,Dn=null,vt=!1,ar=null;function xv(t,e){var n=Gn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function z0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ln=t,Dn=ps(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ln=t,Dn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=li!==null?{id:Pr,overflow:Dr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Gn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ln=t,Dn=null,!0):!1;default:return!1}}function kh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Eh(t){if(vt){var e=Dn;if(e){var n=e;if(!z0(t,e)){if(kh(t))throw Error(de(418));e=ps(n.nextSibling);var r=Ln;e&&z0(t,e)?xv(r,n):(t.flags=t.flags&-4097|2,vt=!1,Ln=t)}}else{if(kh(t))throw Error(de(418));t.flags=t.flags&-4097|2,vt=!1,Ln=t}}}function $0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ln=t}function Al(t){if(t!==Ln)return!1;if(!vt)return $0(t),vt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Nh(t.type,t.memoizedProps)),e&&(e=Dn)){if(kh(t))throw yv(),Error(de(418));for(;e;)xv(t,e),e=ps(e.nextSibling)}if($0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(de(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Dn=ps(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Dn=null}}else Dn=Ln?ps(t.stateNode.nextSibling):null;return!0}function yv(){for(var t=Dn;t;)t=ps(t.nextSibling)}function sa(){Dn=Ln=null,vt=!1}function Bf(t){ar===null?ar=[t]:ar.push(t)}var yN=Hr.ReactCurrentBatchConfig;function Ba(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(de(309));var r=n.stateNode}if(!r)throw Error(de(147,t));var i=r,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var l=i.refs;o===null?delete l[a]:l[a]=o},e._stringRef=a,e)}if(typeof t!="string")throw Error(de(284));if(!n._owner)throw Error(de(290,t))}return t}function Rl(t,e){throw t=Object.prototype.toString.call(e),Error(de(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function B0(t){var e=t._init;return e(t._payload)}function vv(t){function e(C,_){if(t){var v=C.deletions;v===null?(C.deletions=[_],C.flags|=16):v.push(_)}}function n(C,_){if(!t)return null;for(;_!==null;)e(C,_),_=_.sibling;return null}function r(C,_){for(C=new Map;_!==null;)_.key!==null?C.set(_.key,_):C.set(_.index,_),_=_.sibling;return C}function i(C,_){return C=vs(C,_),C.index=0,C.sibling=null,C}function a(C,_,v){return C.index=v,t?(v=C.alternate,v!==null?(v=v.index,v<_?(C.flags|=2,_):v):(C.flags|=2,_)):(C.flags|=1048576,_)}function o(C){return t&&C.alternate===null&&(C.flags|=2),C}function l(C,_,v,P){return _===null||_.tag!==6?(_=Ad(v,C.mode,P),_.return=C,_):(_=i(_,v),_.return=C,_)}function u(C,_,v,P){var D=v.type;return D===Oi?h(C,_,v.props.children,P,v.key):_!==null&&(_.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===ns&&B0(D)===_.type)?(P=i(_,v.props),P.ref=Ba(C,_,v),P.return=C,P):(P=cc(v.type,v.key,v.props,null,C.mode,P),P.ref=Ba(C,_,v),P.return=C,P)}function d(C,_,v,P){return _===null||_.tag!==4||_.stateNode.containerInfo!==v.containerInfo||_.stateNode.implementation!==v.implementation?(_=Rd(v,C.mode,P),_.return=C,_):(_=i(_,v.children||[]),_.return=C,_)}function h(C,_,v,P,D){return _===null||_.tag!==7?(_=si(v,C.mode,P,D),_.return=C,_):(_=i(_,v),_.return=C,_)}function g(C,_,v){if(typeof _=="string"&&_!==""||typeof _=="number")return _=Ad(""+_,C.mode,v),_.return=C,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case wl:return v=cc(_.type,_.key,_.props,null,C.mode,v),v.ref=Ba(C,null,_),v.return=C,v;case Li:return _=Rd(_,C.mode,v),_.return=C,_;case ns:var P=_._init;return g(C,P(_._payload),v)}if(Ja(_)||Oa(_))return _=si(_,C.mode,v,null),_.return=C,_;Rl(C,_)}return null}function x(C,_,v,P){var D=_!==null?_.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return D!==null?null:l(C,_,""+v,P);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case wl:return v.key===D?u(C,_,v,P):null;case Li:return v.key===D?d(C,_,v,P):null;case ns:return D=v._init,x(C,_,D(v._payload),P)}if(Ja(v)||Oa(v))return D!==null?null:h(C,_,v,P,null);Rl(C,v)}return null}function N(C,_,v,P,D){if(typeof P=="string"&&P!==""||typeof P=="number")return C=C.get(v)||null,l(_,C,""+P,D);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case wl:return C=C.get(P.key===null?v:P.key)||null,u(_,C,P,D);case Li:return C=C.get(P.key===null?v:P.key)||null,d(_,C,P,D);case ns:var L=P._init;return N(C,_,v,L(P._payload),D)}if(Ja(P)||Oa(P))return C=C.get(v)||null,h(_,C,P,D,null);Rl(_,P)}return null}function w(C,_,v,P){for(var D=null,L=null,E=_,m=_=0,y=null;E!==null&&m<v.length;m++){E.index>m?(y=E,E=null):y=E.sibling;var j=x(C,E,v[m],P);if(j===null){E===null&&(E=y);break}t&&E&&j.alternate===null&&e(C,E),_=a(j,_,m),L===null?D=j:L.sibling=j,L=j,E=y}if(m===v.length)return n(C,E),vt&&Hs(C,m),D;if(E===null){for(;m<v.length;m++)E=g(C,v[m],P),E!==null&&(_=a(E,_,m),L===null?D=E:L.sibling=E,L=E);return vt&&Hs(C,m),D}for(E=r(C,E);m<v.length;m++)y=N(E,C,m,v[m],P),y!==null&&(t&&y.alternate!==null&&E.delete(y.key===null?m:y.key),_=a(y,_,m),L===null?D=y:L.sibling=y,L=y);return t&&E.forEach(function(A){return e(C,A)}),vt&&Hs(C,m),D}function k(C,_,v,P){var D=Oa(v);if(typeof D!="function")throw Error(de(150));if(v=D.call(v),v==null)throw Error(de(151));for(var L=D=null,E=_,m=_=0,y=null,j=v.next();E!==null&&!j.done;m++,j=v.next()){E.index>m?(y=E,E=null):y=E.sibling;var A=x(C,E,j.value,P);if(A===null){E===null&&(E=y);break}t&&E&&A.alternate===null&&e(C,E),_=a(A,_,m),L===null?D=A:L.sibling=A,L=A,E=y}if(j.done)return n(C,E),vt&&Hs(C,m),D;if(E===null){for(;!j.done;m++,j=v.next())j=g(C,j.value,P),j!==null&&(_=a(j,_,m),L===null?D=j:L.sibling=j,L=j);return vt&&Hs(C,m),D}for(E=r(C,E);!j.done;m++,j=v.next())j=N(E,C,m,j.value,P),j!==null&&(t&&j.alternate!==null&&E.delete(j.key===null?m:j.key),_=a(j,_,m),L===null?D=j:L.sibling=j,L=j);return t&&E.forEach(function(T){return e(C,T)}),vt&&Hs(C,m),D}function I(C,_,v,P){if(typeof v=="object"&&v!==null&&v.type===Oi&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case wl:e:{for(var D=v.key,L=_;L!==null;){if(L.key===D){if(D=v.type,D===Oi){if(L.tag===7){n(C,L.sibling),_=i(L,v.props.children),_.return=C,C=_;break e}}else if(L.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===ns&&B0(D)===L.type){n(C,L.sibling),_=i(L,v.props),_.ref=Ba(C,L,v),_.return=C,C=_;break e}n(C,L);break}else e(C,L);L=L.sibling}v.type===Oi?(_=si(v.props.children,C.mode,P,v.key),_.return=C,C=_):(P=cc(v.type,v.key,v.props,null,C.mode,P),P.ref=Ba(C,_,v),P.return=C,C=P)}return o(C);case Li:e:{for(L=v.key;_!==null;){if(_.key===L)if(_.tag===4&&_.stateNode.containerInfo===v.containerInfo&&_.stateNode.implementation===v.implementation){n(C,_.sibling),_=i(_,v.children||[]),_.return=C,C=_;break e}else{n(C,_);break}else e(C,_);_=_.sibling}_=Rd(v,C.mode,P),_.return=C,C=_}return o(C);case ns:return L=v._init,I(C,_,L(v._payload),P)}if(Ja(v))return w(C,_,v,P);if(Oa(v))return k(C,_,v,P);Rl(C,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,_!==null&&_.tag===6?(n(C,_.sibling),_=i(_,v),_.return=C,C=_):(n(C,_),_=Ad(v,C.mode,P),_.return=C,C=_),o(C)):n(C,_)}return I}var ia=vv(!0),bv=vv(!1),Pc=Ls(null),Dc=null,Qi=null,Uf=null;function qf(){Uf=Qi=Dc=null}function Qf(t){var e=Pc.current;gt(Pc),t._currentValue=e}function Ch(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ji(t,e){Dc=t,Uf=Qi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Sn=!0),t.firstContext=null)}function Yn(t){var e=t._currentValue;if(Uf!==t)if(t={context:t,memoizedValue:e,next:null},Qi===null){if(Dc===null)throw Error(de(308));Qi=t,Dc.dependencies={lanes:0,firstContext:t}}else Qi=Qi.next=t;return e}var Xs=null;function Gf(t){Xs===null?Xs=[t]:Xs.push(t)}function wv(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Gf(e)):(n.next=i.next,i.next=n),e.interleaved=n,zr(t,r)}function zr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var rs=!1;function Hf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Nv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Mr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function gs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,We&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,zr(t,n)}return i=r.interleaved,i===null?(e.next=e,Gf(r)):(e.next=i.next,i.next=e),r.interleaved=e,zr(t,n)}function rc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Rf(t,n)}}function U0(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?i=a=e:a=a.next=e}else i=a=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Mc(t,e,n,r){var i=t.updateQueue;rs=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var u=l,d=u.next;u.next=null,o===null?a=d:o.next=d,o=u;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=u))}if(a!==null){var g=i.baseState;o=0,h=d=u=null,l=a;do{var x=l.lane,N=l.eventTime;if((r&x)===x){h!==null&&(h=h.next={eventTime:N,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var w=t,k=l;switch(x=e,N=n,k.tag){case 1:if(w=k.payload,typeof w=="function"){g=w.call(N,g,x);break e}g=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=k.payload,x=typeof w=="function"?w.call(N,g,x):w,x==null)break e;g=_t({},g,x);break e;case 2:rs=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,x=i.effects,x===null?i.effects=[l]:x.push(l))}else N={eventTime:N,lane:x,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=N,u=g):h=h.next=N,o|=x;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;x=l,l=x.next,x.next=null,i.lastBaseUpdate=x,i.shared.pending=null}}while(1);if(h===null&&(u=g),i.baseState=u,i.firstBaseUpdate=d,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);ui|=o,t.lanes=o,t.memoizedState=g}}function q0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(de(191,i));i.call(r)}}}var Jo={},vr=Ls(Jo),Ro=Ls(Jo),Po=Ls(Jo);function Js(t){if(t===Jo)throw Error(de(174));return t}function Wf(t,e){switch(ut(Po,e),ut(Ro,t),ut(vr,Jo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=lh(e,t)}gt(vr),ut(vr,e)}function aa(){gt(vr),gt(Ro),gt(Po)}function jv(t){Js(Po.current);var e=Js(vr.current),n=lh(e,t.type);e!==n&&(ut(Ro,t),ut(vr,n))}function Yf(t){Ro.current===t&&(gt(vr),gt(Ro))}var Nt=Ls(0);function Lc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var _d=[];function Kf(){for(var t=0;t<_d.length;t++)_d[t]._workInProgressVersionPrimary=null;_d.length=0}var sc=Hr.ReactCurrentDispatcher,kd=Hr.ReactCurrentBatchConfig,ci=0,St=null,$t=null,Gt=null,Oc=!1,uo=!1,Do=0,vN=0;function sn(){throw Error(de(321))}function Xf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!cr(t[n],e[n]))return!1;return!0}function Jf(t,e,n,r,i,a){if(ci=a,St=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,sc.current=t===null||t.memoizedState===null?jN:SN,t=n(r,i),uo){a=0;do{if(uo=!1,Do=0,25<=a)throw Error(de(301));a+=1,Gt=$t=null,e.updateQueue=null,sc.current=_N,t=n(r,i)}while(uo)}if(sc.current=Fc,e=$t!==null&&$t.next!==null,ci=0,Gt=$t=St=null,Oc=!1,e)throw Error(de(300));return t}function Zf(){var t=Do!==0;return Do=0,t}function pr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gt===null?St.memoizedState=Gt=t:Gt=Gt.next=t,Gt}function Kn(){if($t===null){var t=St.alternate;t=t!==null?t.memoizedState:null}else t=$t.next;var e=Gt===null?St.memoizedState:Gt.next;if(e!==null)Gt=e,$t=t;else{if(t===null)throw Error(de(310));$t=t,t={memoizedState:$t.memoizedState,baseState:$t.baseState,baseQueue:$t.baseQueue,queue:$t.queue,next:null},Gt===null?St.memoizedState=Gt=t:Gt=Gt.next=t}return Gt}function Mo(t,e){return typeof e=="function"?e(t):e}function Ed(t){var e=Kn(),n=e.queue;if(n===null)throw Error(de(311));n.lastRenderedReducer=t;var r=$t,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var l=o=null,u=null,d=a;do{var h=d.lane;if((ci&h)===h)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var g={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=g,o=r):u=u.next=g,St.lanes|=h,ui|=h}d=d.next}while(d!==null&&d!==a);u===null?o=r:u.next=l,cr(r,e.memoizedState)||(Sn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do a=i.lane,St.lanes|=a,ui|=a,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Cd(t){var e=Kn(),n=e.queue;if(n===null)throw Error(de(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,a=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do a=t(a,o.action),o=o.next;while(o!==i);cr(a,e.memoizedState)||(Sn=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),n.lastRenderedState=a}return[a,r]}function Sv(){}function _v(t,e){var n=St,r=Kn(),i=e(),a=!cr(r.memoizedState,i);if(a&&(r.memoizedState=i,Sn=!0),r=r.queue,em(Cv.bind(null,n,r,t),[t]),r.getSnapshot!==e||a||Gt!==null&&Gt.memoizedState.tag&1){if(n.flags|=2048,Lo(9,Ev.bind(null,n,r,i,e),void 0,null),Ht===null)throw Error(de(349));ci&30||kv(n,e,i)}return i}function kv(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=St.updateQueue,e===null?(e={lastEffect:null,stores:null},St.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Ev(t,e,n,r){e.value=n,e.getSnapshot=r,Tv(e)&&Iv(t)}function Cv(t,e,n){return n(function(){Tv(e)&&Iv(t)})}function Tv(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!cr(t,n)}catch{return!0}}function Iv(t){var e=zr(t,1);e!==null&&lr(e,t,1,-1)}function Q0(t){var e=pr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mo,lastRenderedState:t},e.queue=t,t=t.dispatch=NN.bind(null,St,t),[e.memoizedState,t]}function Lo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=St.updateQueue,e===null?(e={lastEffect:null,stores:null},St.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Av(){return Kn().memoizedState}function ic(t,e,n,r){var i=pr();St.flags|=t,i.memoizedState=Lo(1|e,n,void 0,r===void 0?null:r)}function pu(t,e,n,r){var i=Kn();r=r===void 0?null:r;var a=void 0;if($t!==null){var o=$t.memoizedState;if(a=o.destroy,r!==null&&Xf(r,o.deps)){i.memoizedState=Lo(e,n,a,r);return}}St.flags|=t,i.memoizedState=Lo(1|e,n,a,r)}function G0(t,e){return ic(8390656,8,t,e)}function em(t,e){return pu(2048,8,t,e)}function Rv(t,e){return pu(4,2,t,e)}function Pv(t,e){return pu(4,4,t,e)}function Dv(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Mv(t,e,n){return n=n!=null?n.concat([t]):null,pu(4,4,Dv.bind(null,e,t),n)}function tm(){}function Lv(t,e){var n=Kn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Xf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Ov(t,e){var n=Kn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Xf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Fv(t,e,n){return ci&21?(cr(n,e)||(n=Uy(),St.lanes|=n,ui|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Sn=!0),t.memoizedState=n)}function bN(t,e){var n=it;it=n!==0&&4>n?n:4,t(!0);var r=kd.transition;kd.transition={};try{t(!1),e()}finally{it=n,kd.transition=r}}function Vv(){return Kn().memoizedState}function wN(t,e,n){var r=ys(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},zv(t))$v(e,n);else if(n=wv(t,e,n,r),n!==null){var i=xn();lr(n,t,r,i),Bv(n,e,r)}}function NN(t,e,n){var r=ys(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(zv(t))$v(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,l=a(o,n);if(i.hasEagerState=!0,i.eagerState=l,cr(l,o)){var u=e.interleaved;u===null?(i.next=i,Gf(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}n=wv(t,e,i,r),n!==null&&(i=xn(),lr(n,t,r,i),Bv(n,e,r))}}function zv(t){var e=t.alternate;return t===St||e!==null&&e===St}function $v(t,e){uo=Oc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Bv(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Rf(t,n)}}var Fc={readContext:Yn,useCallback:sn,useContext:sn,useEffect:sn,useImperativeHandle:sn,useInsertionEffect:sn,useLayoutEffect:sn,useMemo:sn,useReducer:sn,useRef:sn,useState:sn,useDebugValue:sn,useDeferredValue:sn,useTransition:sn,useMutableSource:sn,useSyncExternalStore:sn,useId:sn,unstable_isNewReconciler:!1},jN={readContext:Yn,useCallback:function(t,e){return pr().memoizedState=[t,e===void 0?null:e],t},useContext:Yn,useEffect:G0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ic(4194308,4,Dv.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ic(4194308,4,t,e)},useInsertionEffect:function(t,e){return ic(4,2,t,e)},useMemo:function(t,e){var n=pr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=pr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=wN.bind(null,St,t),[r.memoizedState,t]},useRef:function(t){var e=pr();return t={current:t},e.memoizedState=t},useState:Q0,useDebugValue:tm,useDeferredValue:function(t){return pr().memoizedState=t},useTransition:function(){var t=Q0(!1),e=t[0];return t=bN.bind(null,t[1]),pr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=St,i=pr();if(vt){if(n===void 0)throw Error(de(407));n=n()}else{if(n=e(),Ht===null)throw Error(de(349));ci&30||kv(r,e,n)}i.memoizedState=n;var a={value:n,getSnapshot:e};return i.queue=a,G0(Cv.bind(null,r,a,t),[t]),r.flags|=2048,Lo(9,Ev.bind(null,r,a,n,e),void 0,null),n},useId:function(){var t=pr(),e=Ht.identifierPrefix;if(vt){var n=Dr,r=Pr;n=(r&~(1<<32-or(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Do++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=vN++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},SN={readContext:Yn,useCallback:Lv,useContext:Yn,useEffect:em,useImperativeHandle:Mv,useInsertionEffect:Rv,useLayoutEffect:Pv,useMemo:Ov,useReducer:Ed,useRef:Av,useState:function(){return Ed(Mo)},useDebugValue:tm,useDeferredValue:function(t){var e=Kn();return Fv(e,$t.memoizedState,t)},useTransition:function(){var t=Ed(Mo)[0],e=Kn().memoizedState;return[t,e]},useMutableSource:Sv,useSyncExternalStore:_v,useId:Vv,unstable_isNewReconciler:!1},_N={readContext:Yn,useCallback:Lv,useContext:Yn,useEffect:em,useImperativeHandle:Mv,useInsertionEffect:Rv,useLayoutEffect:Pv,useMemo:Ov,useReducer:Cd,useRef:Av,useState:function(){return Cd(Mo)},useDebugValue:tm,useDeferredValue:function(t){var e=Kn();return $t===null?e.memoizedState=t:Fv(e,$t.memoizedState,t)},useTransition:function(){var t=Cd(Mo)[0],e=Kn().memoizedState;return[t,e]},useMutableSource:Sv,useSyncExternalStore:_v,useId:Vv,unstable_isNewReconciler:!1};function rr(t,e){if(t&&t.defaultProps){e=_t({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Th(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:_t({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var gu={isMounted:function(t){return(t=t._reactInternals)?yi(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=xn(),i=ys(t),a=Mr(r,i);a.payload=e,n!=null&&(a.callback=n),e=gs(t,a,i),e!==null&&(lr(e,t,i,r),rc(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=xn(),i=ys(t),a=Mr(r,i);a.tag=1,a.payload=e,n!=null&&(a.callback=n),e=gs(t,a,i),e!==null&&(lr(e,t,i,r),rc(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=xn(),r=ys(t),i=Mr(n,r);i.tag=2,e!=null&&(i.callback=e),e=gs(t,i,r),e!==null&&(lr(e,t,r,n),rc(e,t,r))}};function H0(t,e,n,r,i,a,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,a,o):e.prototype&&e.prototype.isPureReactComponent?!Co(n,r)||!Co(i,a):!0}function Uv(t,e,n){var r=!1,i=_s,a=e.contextType;return typeof a=="object"&&a!==null?a=Yn(a):(i=kn(e)?oi:fn.current,r=e.contextTypes,a=(r=r!=null)?ra(t,i):_s),e=new e(n,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=gu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function W0(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&gu.enqueueReplaceState(e,e.state,null)}function Ih(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Hf(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=Yn(a):(a=kn(e)?oi:fn.current,i.context=ra(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(Th(t,e,a,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&gu.enqueueReplaceState(i,i.state,null),Mc(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function oa(t,e){try{var n="",r=e;do n+=Z2(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function Td(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Ah(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var kN=typeof WeakMap=="function"?WeakMap:Map;function qv(t,e,n){n=Mr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){zc||(zc=!0,$h=r),Ah(t,e)},n}function Qv(t,e,n){n=Mr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Ah(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){Ah(t,e),typeof r!="function"&&(xs===null?xs=new Set([this]):xs.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Y0(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new kN;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=zN.bind(null,t,e,n),e.then(t,t))}function K0(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function X0(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Mr(-1,1),e.tag=2,gs(n,e,1))),n.lanes|=1),t)}var EN=Hr.ReactCurrentOwner,Sn=!1;function gn(t,e,n,r){e.child=t===null?bv(e,null,n,r):ia(e,t.child,n,r)}function J0(t,e,n,r,i){n=n.render;var a=e.ref;return Ji(e,i),r=Jf(t,e,n,r,a,i),n=Zf(),t!==null&&!Sn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,$r(t,e,i)):(vt&&n&&zf(e),e.flags|=1,gn(t,e,r,i),e.child)}function Z0(t,e,n,r,i){if(t===null){var a=n.type;return typeof a=="function"&&!cm(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=a,Gv(t,e,a,r,i)):(t=cc(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:Co,n(o,r)&&t.ref===e.ref)return $r(t,e,i)}return e.flags|=1,t=vs(a,r),t.ref=e.ref,t.return=e,e.child=t}function Gv(t,e,n,r,i){if(t!==null){var a=t.memoizedProps;if(Co(a,r)&&t.ref===e.ref)if(Sn=!1,e.pendingProps=r=a,(t.lanes&i)!==0)t.flags&131072&&(Sn=!0);else return e.lanes=t.lanes,$r(t,e,i)}return Rh(t,e,n,r,i)}function Hv(t,e,n){var r=e.pendingProps,i=r.children,a=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ut(Hi,Pn),Pn|=n;else{if(!(n&1073741824))return t=a!==null?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ut(Hi,Pn),Pn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,ut(Hi,Pn),Pn|=r}else a!==null?(r=a.baseLanes|n,e.memoizedState=null):r=n,ut(Hi,Pn),Pn|=r;return gn(t,e,i,n),e.child}function Wv(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Rh(t,e,n,r,i){var a=kn(n)?oi:fn.current;return a=ra(e,a),Ji(e,i),n=Jf(t,e,n,r,a,i),r=Zf(),t!==null&&!Sn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,$r(t,e,i)):(vt&&r&&zf(e),e.flags|=1,gn(t,e,n,i),e.child)}function eg(t,e,n,r,i){if(kn(n)){var a=!0;Ic(e)}else a=!1;if(Ji(e,i),e.stateNode===null)ac(t,e),Uv(e,n,r),Ih(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Yn(d):(d=kn(n)?oi:fn.current,d=ra(e,d));var h=n.getDerivedStateFromProps,g=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";g||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==d)&&W0(e,o,r,d),rs=!1;var x=e.memoizedState;o.state=x,Mc(e,r,o,i),u=e.memoizedState,l!==r||x!==u||_n.current||rs?(typeof h=="function"&&(Th(e,n,h,r),u=e.memoizedState),(l=rs||H0(e,n,l,r,x,u,d))?(g||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Nv(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:rr(e.type,l),o.props=d,g=e.pendingProps,x=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=Yn(u):(u=kn(n)?oi:fn.current,u=ra(e,u));var N=n.getDerivedStateFromProps;(h=typeof N=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==g||x!==u)&&W0(e,o,r,u),rs=!1,x=e.memoizedState,o.state=x,Mc(e,r,o,i);var w=e.memoizedState;l!==g||x!==w||_n.current||rs?(typeof N=="function"&&(Th(e,n,N,r),w=e.memoizedState),(d=rs||H0(e,n,d,r,x,w,u)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,w,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,w,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&x===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&x===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=w),o.props=r,o.state=w,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&x===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&x===t.memoizedState||(e.flags|=1024),r=!1)}return Ph(t,e,n,r,a,i)}function Ph(t,e,n,r,i,a){Wv(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&V0(e,n,!1),$r(t,e,a);r=e.stateNode,EN.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ia(e,t.child,null,a),e.child=ia(e,null,l,a)):gn(t,e,l,a),e.memoizedState=r.state,i&&V0(e,n,!0),e.child}function Yv(t){var e=t.stateNode;e.pendingContext?F0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&F0(t,e.context,!1),Wf(t,e.containerInfo)}function tg(t,e,n,r,i){return sa(),Bf(i),e.flags|=256,gn(t,e,n,r),e.child}var Dh={dehydrated:null,treeContext:null,retryLane:0};function Mh(t){return{baseLanes:t,cachePool:null,transitions:null}}function Kv(t,e,n){var r=e.pendingProps,i=Nt.current,a=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ut(Nt,i&1),t===null)return Eh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,a?(r=e.mode,a=e.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=vu(o,r,0,null),t=si(t,r,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Mh(n),e.memoizedState=Dh,t):nm(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return CN(t,e,o,r,l,i,n);if(a){a=r.fallback,o=e.mode,i=t.child,l=i.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=vs(i,u),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?a=vs(l,a):(a=si(a,o,n,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,o=t.child.memoizedState,o=o===null?Mh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=t.childLanes&~n,e.memoizedState=Dh,r}return a=t.child,t=a.sibling,r=vs(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function nm(t,e){return e=vu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Pl(t,e,n,r){return r!==null&&Bf(r),ia(e,t.child,null,n),t=nm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function CN(t,e,n,r,i,a,o){if(n)return e.flags&256?(e.flags&=-257,r=Td(Error(de(422))),Pl(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=r.fallback,i=e.mode,r=vu({mode:"visible",children:r.children},i,0,null),a=si(a,i,o,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&ia(e,t.child,null,o),e.child.memoizedState=Mh(o),e.memoizedState=Dh,a);if(!(e.mode&1))return Pl(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,a=Error(de(419)),r=Td(a,r,void 0),Pl(t,e,o,r)}if(l=(o&t.childLanes)!==0,Sn||l){if(r=Ht,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,zr(t,i),lr(r,t,i,-1))}return lm(),r=Td(Error(de(421))),Pl(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=$N.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,Dn=ps(i.nextSibling),Ln=e,vt=!0,ar=null,t!==null&&(Un[qn++]=Pr,Un[qn++]=Dr,Un[qn++]=li,Pr=t.id,Dr=t.overflow,li=e),e=nm(e,r.children),e.flags|=4096,e)}function ng(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Ch(t.return,e,n)}function Id(t,e,n,r,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Xv(t,e,n){var r=e.pendingProps,i=r.revealOrder,a=r.tail;if(gn(t,e,r.children,n),r=Nt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ng(t,n,e);else if(t.tag===19)ng(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ut(Nt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Lc(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Id(e,!1,i,n,a);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Lc(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Id(e,!0,n,null,a);break;case"together":Id(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ac(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function $r(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ui|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(de(153));if(e.child!==null){for(t=e.child,n=vs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=vs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function TN(t,e,n){switch(e.tag){case 3:Yv(e),sa();break;case 5:jv(e);break;case 1:kn(e.type)&&Ic(e);break;case 4:Wf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ut(Pc,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ut(Nt,Nt.current&1),e.flags|=128,null):n&e.child.childLanes?Kv(t,e,n):(ut(Nt,Nt.current&1),t=$r(t,e,n),t!==null?t.sibling:null);ut(Nt,Nt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Xv(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ut(Nt,Nt.current),r)break;return null;case 22:case 23:return e.lanes=0,Hv(t,e,n)}return $r(t,e,n)}var Jv,Lh,Zv,e1;Jv=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Lh=function(){};Zv=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Js(vr.current);var a=null;switch(n){case"input":i=sh(t,i),r=sh(t,r),a=[];break;case"select":i=_t({},i,{value:void 0}),r=_t({},r,{value:void 0}),a=[];break;case"textarea":i=oh(t,i),r=oh(t,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Cc)}ch(n,r);var o;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(wo.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in r){var u=r[d];if(l=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(a||(a=[]),a.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(a=a||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(a=a||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(wo.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&ht("scroll",t),a||l===u||(a=[])):(a=a||[]).push(d,u))}n&&(a=a||[]).push("style",n);var d=a;(e.updateQueue=d)&&(e.flags|=4)}};e1=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ua(t,e){if(!vt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function an(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function IN(t,e,n){var r=e.pendingProps;switch($f(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return an(e),null;case 1:return kn(e.type)&&Tc(),an(e),null;case 3:return r=e.stateNode,aa(),gt(_n),gt(fn),Kf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Al(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ar!==null&&(qh(ar),ar=null))),Lh(t,e),an(e),null;case 5:Yf(e);var i=Js(Po.current);if(n=e.type,t!==null&&e.stateNode!=null)Zv(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(de(166));return an(e),null}if(t=Js(vr.current),Al(e)){r=e.stateNode,n=e.type;var a=e.memoizedProps;switch(r[xr]=e,r[Ao]=a,t=(e.mode&1)!==0,n){case"dialog":ht("cancel",r),ht("close",r);break;case"iframe":case"object":case"embed":ht("load",r);break;case"video":case"audio":for(i=0;i<eo.length;i++)ht(eo[i],r);break;case"source":ht("error",r);break;case"img":case"image":case"link":ht("error",r),ht("load",r);break;case"details":ht("toggle",r);break;case"input":d0(r,a),ht("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},ht("invalid",r);break;case"textarea":f0(r,a),ht("invalid",r)}ch(n,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?r.textContent!==l&&(a.suppressHydrationWarning!==!0&&Il(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&Il(r.textContent,l,t),i=["children",""+l]):wo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&ht("scroll",r)}switch(n){case"input":Nl(r),h0(r,a,!0);break;case"textarea":Nl(r),m0(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=Cc)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Cy(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[xr]=e,t[Ao]=r,Jv(t,e,!1,!1),e.stateNode=t;e:{switch(o=uh(n,r),n){case"dialog":ht("cancel",t),ht("close",t),i=r;break;case"iframe":case"object":case"embed":ht("load",t),i=r;break;case"video":case"audio":for(i=0;i<eo.length;i++)ht(eo[i],t);i=r;break;case"source":ht("error",t),i=r;break;case"img":case"image":case"link":ht("error",t),ht("load",t),i=r;break;case"details":ht("toggle",t),i=r;break;case"input":d0(t,r),i=sh(t,r),ht("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=_t({},r,{value:void 0}),ht("invalid",t);break;case"textarea":f0(t,r),i=oh(t,r),ht("invalid",t);break;default:i=r}ch(n,i),l=i;for(a in l)if(l.hasOwnProperty(a)){var u=l[a];a==="style"?Ay(t,u):a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Ty(t,u)):a==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&No(t,u):typeof u=="number"&&No(t,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(wo.hasOwnProperty(a)?u!=null&&a==="onScroll"&&ht("scroll",t):u!=null&&kf(t,a,u,o))}switch(n){case"input":Nl(t),h0(t,r,!1);break;case"textarea":Nl(t),m0(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ss(r.value));break;case"select":t.multiple=!!r.multiple,a=r.value,a!=null?Wi(t,!!r.multiple,a,!1):r.defaultValue!=null&&Wi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Cc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return an(e),null;case 6:if(t&&e.stateNode!=null)e1(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(de(166));if(n=Js(Po.current),Js(vr.current),Al(e)){if(r=e.stateNode,n=e.memoizedProps,r[xr]=e,(a=r.nodeValue!==n)&&(t=Ln,t!==null))switch(t.tag){case 3:Il(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Il(r.nodeValue,n,(t.mode&1)!==0)}a&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[xr]=e,e.stateNode=r}return an(e),null;case 13:if(gt(Nt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(vt&&Dn!==null&&e.mode&1&&!(e.flags&128))yv(),sa(),e.flags|=98560,a=!1;else if(a=Al(e),r!==null&&r.dehydrated!==null){if(t===null){if(!a)throw Error(de(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(de(317));a[xr]=e}else sa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;an(e),a=!1}else ar!==null&&(qh(ar),ar=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Nt.current&1?Bt===0&&(Bt=3):lm())),e.updateQueue!==null&&(e.flags|=4),an(e),null);case 4:return aa(),Lh(t,e),t===null&&To(e.stateNode.containerInfo),an(e),null;case 10:return Qf(e.type._context),an(e),null;case 17:return kn(e.type)&&Tc(),an(e),null;case 19:if(gt(Nt),a=e.memoizedState,a===null)return an(e),null;if(r=(e.flags&128)!==0,o=a.rendering,o===null)if(r)Ua(a,!1);else{if(Bt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Lc(t),o!==null){for(e.flags|=128,Ua(a,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)a=n,t=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,t=o.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ut(Nt,Nt.current&1|2),e.child}t=t.sibling}a.tail!==null&&Rt()>la&&(e.flags|=128,r=!0,Ua(a,!1),e.lanes=4194304)}else{if(!r)if(t=Lc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ua(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!vt)return an(e),null}else 2*Rt()-a.renderingStartTime>la&&n!==1073741824&&(e.flags|=128,r=!0,Ua(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(n=a.last,n!==null?n.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Rt(),e.sibling=null,n=Nt.current,ut(Nt,r?n&1|2:n&1),e):(an(e),null);case 22:case 23:return om(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Pn&1073741824&&(an(e),e.subtreeFlags&6&&(e.flags|=8192)):an(e),null;case 24:return null;case 25:return null}throw Error(de(156,e.tag))}function AN(t,e){switch($f(e),e.tag){case 1:return kn(e.type)&&Tc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return aa(),gt(_n),gt(fn),Kf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Yf(e),null;case 13:if(gt(Nt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(de(340));sa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return gt(Nt),null;case 4:return aa(),null;case 10:return Qf(e.type._context),null;case 22:case 23:return om(),null;case 24:return null;default:return null}}var Dl=!1,dn=!1,RN=typeof WeakSet=="function"?WeakSet:Set,we=null;function Gi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ct(t,e,r)}else n.current=null}function Oh(t,e,n){try{n()}catch(r){Ct(t,e,r)}}var rg=!1;function PN(t,e){if(bh=_c,t=iv(),Vf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,d=0,h=0,g=t,x=null;t:for(;;){for(var N;g!==n||i!==0&&g.nodeType!==3||(l=o+i),g!==a||r!==0&&g.nodeType!==3||(u=o+r),g.nodeType===3&&(o+=g.nodeValue.length),(N=g.firstChild)!==null;)x=g,g=N;for(;;){if(g===t)break t;if(x===n&&++d===i&&(l=o),x===a&&++h===r&&(u=o),(N=g.nextSibling)!==null)break;g=x,x=g.parentNode}g=N}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(wh={focusedElem:t,selectionRange:n},_c=!1,we=e;we!==null;)if(e=we,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,we=t;else for(;we!==null;){e=we;try{var w=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var k=w.memoizedProps,I=w.memoizedState,C=e.stateNode,_=C.getSnapshotBeforeUpdate(e.elementType===e.type?k:rr(e.type,k),I);C.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(de(163))}}catch(P){Ct(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,we=t;break}we=e.return}return w=rg,rg=!1,w}function ho(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&Oh(e,n,a)}i=i.next}while(i!==r)}}function xu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Fh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function t1(t){var e=t.alternate;e!==null&&(t.alternate=null,t1(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[xr],delete e[Ao],delete e[Sh],delete e[pN],delete e[gN])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function n1(t){return t.tag===5||t.tag===3||t.tag===4}function sg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||n1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Vh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Cc));else if(r!==4&&(t=t.child,t!==null))for(Vh(t,e,n),t=t.sibling;t!==null;)Vh(t,e,n),t=t.sibling}function zh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(zh(t,e,n),t=t.sibling;t!==null;)zh(t,e,n),t=t.sibling}var Yt=null,sr=!1;function Xr(t,e,n){for(n=n.child;n!==null;)r1(t,e,n),n=n.sibling}function r1(t,e,n){if(yr&&typeof yr.onCommitFiberUnmount=="function")try{yr.onCommitFiberUnmount(cu,n)}catch{}switch(n.tag){case 5:dn||Gi(n,e);case 6:var r=Yt,i=sr;Yt=null,Xr(t,e,n),Yt=r,sr=i,Yt!==null&&(sr?(t=Yt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Yt.removeChild(n.stateNode));break;case 18:Yt!==null&&(sr?(t=Yt,n=n.stateNode,t.nodeType===8?jd(t.parentNode,n):t.nodeType===1&&jd(t,n),ko(t)):jd(Yt,n.stateNode));break;case 4:r=Yt,i=sr,Yt=n.stateNode.containerInfo,sr=!0,Xr(t,e,n),Yt=r,sr=i;break;case 0:case 11:case 14:case 15:if(!dn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Oh(n,e,o),i=i.next}while(i!==r)}Xr(t,e,n);break;case 1:if(!dn&&(Gi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ct(n,e,l)}Xr(t,e,n);break;case 21:Xr(t,e,n);break;case 22:n.mode&1?(dn=(r=dn)||n.memoizedState!==null,Xr(t,e,n),dn=r):Xr(t,e,n);break;default:Xr(t,e,n)}}function ig(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new RN),e.forEach(function(r){var i=BN.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function tr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Yt=l.stateNode,sr=!1;break e;case 3:Yt=l.stateNode.containerInfo,sr=!0;break e;case 4:Yt=l.stateNode.containerInfo,sr=!0;break e}l=l.return}if(Yt===null)throw Error(de(160));r1(a,o,i),Yt=null,sr=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(d){Ct(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)s1(e,t),e=e.sibling}function s1(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(tr(e,t),fr(t),r&4){try{ho(3,t,t.return),xu(3,t)}catch(k){Ct(t,t.return,k)}try{ho(5,t,t.return)}catch(k){Ct(t,t.return,k)}}break;case 1:tr(e,t),fr(t),r&512&&n!==null&&Gi(n,n.return);break;case 5:if(tr(e,t),fr(t),r&512&&n!==null&&Gi(n,n.return),t.flags&32){var i=t.stateNode;try{No(i,"")}catch(k){Ct(t,t.return,k)}}if(r&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,o=n!==null?n.memoizedProps:a,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&ky(i,a),uh(l,o);var d=uh(l,a);for(o=0;o<u.length;o+=2){var h=u[o],g=u[o+1];h==="style"?Ay(i,g):h==="dangerouslySetInnerHTML"?Ty(i,g):h==="children"?No(i,g):kf(i,h,g,d)}switch(l){case"input":ih(i,a);break;case"textarea":Ey(i,a);break;case"select":var x=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var N=a.value;N!=null?Wi(i,!!a.multiple,N,!1):x!==!!a.multiple&&(a.defaultValue!=null?Wi(i,!!a.multiple,a.defaultValue,!0):Wi(i,!!a.multiple,a.multiple?[]:"",!1))}i[Ao]=a}catch(k){Ct(t,t.return,k)}}break;case 6:if(tr(e,t),fr(t),r&4){if(t.stateNode===null)throw Error(de(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(k){Ct(t,t.return,k)}}break;case 3:if(tr(e,t),fr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ko(e.containerInfo)}catch(k){Ct(t,t.return,k)}break;case 4:tr(e,t),fr(t);break;case 13:tr(e,t),fr(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(im=Rt())),r&4&&ig(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(dn=(d=dn)||h,tr(e,t),dn=d):tr(e,t),fr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(we=t,h=t.child;h!==null;){for(g=we=h;we!==null;){switch(x=we,N=x.child,x.tag){case 0:case 11:case 14:case 15:ho(4,x,x.return);break;case 1:Gi(x,x.return);var w=x.stateNode;if(typeof w.componentWillUnmount=="function"){r=x,n=x.return;try{e=r,w.props=e.memoizedProps,w.state=e.memoizedState,w.componentWillUnmount()}catch(k){Ct(r,n,k)}}break;case 5:Gi(x,x.return);break;case 22:if(x.memoizedState!==null){og(g);continue}}N!==null?(N.return=x,we=N):og(g)}h=h.sibling}e:for(h=null,g=t;;){if(g.tag===5){if(h===null){h=g;try{i=g.stateNode,d?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=g.stateNode,u=g.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Iy("display",o))}catch(k){Ct(t,t.return,k)}}}else if(g.tag===6){if(h===null)try{g.stateNode.nodeValue=d?"":g.memoizedProps}catch(k){Ct(t,t.return,k)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;h===g&&(h=null),g=g.return}h===g&&(h=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:tr(e,t),fr(t),r&4&&ig(t);break;case 21:break;default:tr(e,t),fr(t)}}function fr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(n1(n)){var r=n;break e}n=n.return}throw Error(de(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(No(i,""),r.flags&=-33);var a=sg(t);zh(t,a,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=sg(t);Vh(t,l,o);break;default:throw Error(de(161))}}catch(u){Ct(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function DN(t,e,n){we=t,i1(t)}function i1(t,e,n){for(var r=(t.mode&1)!==0;we!==null;){var i=we,a=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Dl;if(!o){var l=i.alternate,u=l!==null&&l.memoizedState!==null||dn;l=Dl;var d=dn;if(Dl=o,(dn=u)&&!d)for(we=i;we!==null;)o=we,u=o.child,o.tag===22&&o.memoizedState!==null?lg(i):u!==null?(u.return=o,we=u):lg(i);for(;a!==null;)we=a,i1(a),a=a.sibling;we=i,Dl=l,dn=d}ag(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,we=a):ag(t)}}function ag(t){for(;we!==null;){var e=we;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:dn||xu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!dn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:rr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&q0(e,a,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}q0(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var g=h.dehydrated;g!==null&&ko(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(de(163))}dn||e.flags&512&&Fh(e)}catch(x){Ct(e,e.return,x)}}if(e===t){we=null;break}if(n=e.sibling,n!==null){n.return=e.return,we=n;break}we=e.return}}function og(t){for(;we!==null;){var e=we;if(e===t){we=null;break}var n=e.sibling;if(n!==null){n.return=e.return,we=n;break}we=e.return}}function lg(t){for(;we!==null;){var e=we;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{xu(4,e)}catch(u){Ct(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(u){Ct(e,i,u)}}var a=e.return;try{Fh(e)}catch(u){Ct(e,a,u)}break;case 5:var o=e.return;try{Fh(e)}catch(u){Ct(e,o,u)}}}catch(u){Ct(e,e.return,u)}if(e===t){we=null;break}var l=e.sibling;if(l!==null){l.return=e.return,we=l;break}we=e.return}}var MN=Math.ceil,Vc=Hr.ReactCurrentDispatcher,rm=Hr.ReactCurrentOwner,Hn=Hr.ReactCurrentBatchConfig,We=0,Ht=null,Mt=null,Jt=0,Pn=0,Hi=Ls(0),Bt=0,Oo=null,ui=0,yu=0,sm=0,fo=null,Nn=null,im=0,la=1/0,Ar=null,zc=!1,$h=null,xs=null,Ml=!1,ls=null,$c=0,mo=0,Bh=null,oc=-1,lc=0;function xn(){return We&6?Rt():oc!==-1?oc:oc=Rt()}function ys(t){return t.mode&1?We&2&&Jt!==0?Jt&-Jt:yN.transition!==null?(lc===0&&(lc=Uy()),lc):(t=it,t!==0||(t=window.event,t=t===void 0?16:Ky(t.type)),t):1}function lr(t,e,n,r){if(50<mo)throw mo=0,Bh=null,Error(de(185));Yo(t,n,r),(!(We&2)||t!==Ht)&&(t===Ht&&(!(We&2)&&(yu|=n),Bt===4&&as(t,Jt)),En(t,r),n===1&&We===0&&!(e.mode&1)&&(la=Rt()+500,mu&&Os()))}function En(t,e){var n=t.callbackNode;y5(t,e);var r=Sc(t,t===Ht?Jt:0);if(r===0)n!==null&&x0(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&x0(n),e===1)t.tag===0?xN(cg.bind(null,t)):pv(cg.bind(null,t)),fN(function(){!(We&6)&&Os()}),n=null;else{switch(qy(r)){case 1:n=Af;break;case 4:n=$y;break;case 16:n=jc;break;case 536870912:n=By;break;default:n=jc}n=f1(n,a1.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function a1(t,e){if(oc=-1,lc=0,We&6)throw Error(de(327));var n=t.callbackNode;if(Zi()&&t.callbackNode!==n)return null;var r=Sc(t,t===Ht?Jt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Bc(t,r);else{e=r;var i=We;We|=2;var a=l1();(Ht!==t||Jt!==e)&&(Ar=null,la=Rt()+500,ri(t,e));do try{FN();break}catch(l){o1(t,l)}while(1);qf(),Vc.current=a,We=i,Mt!==null?e=0:(Ht=null,Jt=0,e=Bt)}if(e!==0){if(e===2&&(i=ph(t),i!==0&&(r=i,e=Uh(t,i))),e===1)throw n=Oo,ri(t,0),as(t,r),En(t,Rt()),n;if(e===6)as(t,r);else{if(i=t.current.alternate,!(r&30)&&!LN(i)&&(e=Bc(t,r),e===2&&(a=ph(t),a!==0&&(r=a,e=Uh(t,a))),e===1))throw n=Oo,ri(t,0),as(t,r),En(t,Rt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(de(345));case 2:Ws(t,Nn,Ar);break;case 3:if(as(t,r),(r&130023424)===r&&(e=im+500-Rt(),10<e)){if(Sc(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){xn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=jh(Ws.bind(null,t,Nn,Ar),e);break}Ws(t,Nn,Ar);break;case 4:if(as(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-or(r);a=1<<o,o=e[o],o>i&&(i=o),r&=~a}if(r=i,r=Rt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*MN(r/1960))-r,10<r){t.timeoutHandle=jh(Ws.bind(null,t,Nn,Ar),r);break}Ws(t,Nn,Ar);break;case 5:Ws(t,Nn,Ar);break;default:throw Error(de(329))}}}return En(t,Rt()),t.callbackNode===n?a1.bind(null,t):null}function Uh(t,e){var n=fo;return t.current.memoizedState.isDehydrated&&(ri(t,e).flags|=256),t=Bc(t,e),t!==2&&(e=Nn,Nn=n,e!==null&&qh(e)),t}function qh(t){Nn===null?Nn=t:Nn.push.apply(Nn,t)}function LN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!cr(a(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function as(t,e){for(e&=~sm,e&=~yu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-or(e),r=1<<n;t[n]=-1,e&=~r}}function cg(t){if(We&6)throw Error(de(327));Zi();var e=Sc(t,0);if(!(e&1))return En(t,Rt()),null;var n=Bc(t,e);if(t.tag!==0&&n===2){var r=ph(t);r!==0&&(e=r,n=Uh(t,r))}if(n===1)throw n=Oo,ri(t,0),as(t,e),En(t,Rt()),n;if(n===6)throw Error(de(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ws(t,Nn,Ar),En(t,Rt()),null}function am(t,e){var n=We;We|=1;try{return t(e)}finally{We=n,We===0&&(la=Rt()+500,mu&&Os())}}function di(t){ls!==null&&ls.tag===0&&!(We&6)&&Zi();var e=We;We|=1;var n=Hn.transition,r=it;try{if(Hn.transition=null,it=1,t)return t()}finally{it=r,Hn.transition=n,We=e,!(We&6)&&Os()}}function om(){Pn=Hi.current,gt(Hi)}function ri(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,hN(n)),Mt!==null)for(n=Mt.return;n!==null;){var r=n;switch($f(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Tc();break;case 3:aa(),gt(_n),gt(fn),Kf();break;case 5:Yf(r);break;case 4:aa();break;case 13:gt(Nt);break;case 19:gt(Nt);break;case 10:Qf(r.type._context);break;case 22:case 23:om()}n=n.return}if(Ht=t,Mt=t=vs(t.current,null),Jt=Pn=e,Bt=0,Oo=null,sm=yu=ui=0,Nn=fo=null,Xs!==null){for(e=0;e<Xs.length;e++)if(n=Xs[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var o=a.next;a.next=i,r.next=o}n.pending=r}Xs=null}return t}function o1(t,e){do{var n=Mt;try{if(qf(),sc.current=Fc,Oc){for(var r=St.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Oc=!1}if(ci=0,Gt=$t=St=null,uo=!1,Do=0,rm.current=null,n===null||n.return===null){Bt=1,Oo=e,Mt=null;break}e:{var a=t,o=n.return,l=n,u=e;if(e=Jt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,h=l,g=h.tag;if(!(h.mode&1)&&(g===0||g===11||g===15)){var x=h.alternate;x?(h.updateQueue=x.updateQueue,h.memoizedState=x.memoizedState,h.lanes=x.lanes):(h.updateQueue=null,h.memoizedState=null)}var N=K0(o);if(N!==null){N.flags&=-257,X0(N,o,l,a,e),N.mode&1&&Y0(a,d,e),e=N,u=d;var w=e.updateQueue;if(w===null){var k=new Set;k.add(u),e.updateQueue=k}else w.add(u);break e}else{if(!(e&1)){Y0(a,d,e),lm();break e}u=Error(de(426))}}else if(vt&&l.mode&1){var I=K0(o);if(I!==null){!(I.flags&65536)&&(I.flags|=256),X0(I,o,l,a,e),Bf(oa(u,l));break e}}a=u=oa(u,l),Bt!==4&&(Bt=2),fo===null?fo=[a]:fo.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var C=qv(a,u,e);U0(a,C);break e;case 1:l=u;var _=a.type,v=a.stateNode;if(!(a.flags&128)&&(typeof _.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(xs===null||!xs.has(v)))){a.flags|=65536,e&=-e,a.lanes|=e;var P=Qv(a,l,e);U0(a,P);break e}}a=a.return}while(a!==null)}u1(n)}catch(D){e=D,Mt===n&&n!==null&&(Mt=n=n.return);continue}break}while(1)}function l1(){var t=Vc.current;return Vc.current=Fc,t===null?Fc:t}function lm(){(Bt===0||Bt===3||Bt===2)&&(Bt=4),Ht===null||!(ui&268435455)&&!(yu&268435455)||as(Ht,Jt)}function Bc(t,e){var n=We;We|=2;var r=l1();(Ht!==t||Jt!==e)&&(Ar=null,ri(t,e));do try{ON();break}catch(i){o1(t,i)}while(1);if(qf(),We=n,Vc.current=r,Mt!==null)throw Error(de(261));return Ht=null,Jt=0,Bt}function ON(){for(;Mt!==null;)c1(Mt)}function FN(){for(;Mt!==null&&!c5();)c1(Mt)}function c1(t){var e=h1(t.alternate,t,Pn);t.memoizedProps=t.pendingProps,e===null?u1(t):Mt=e,rm.current=null}function u1(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=AN(n,e),n!==null){n.flags&=32767,Mt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Bt=6,Mt=null;return}}else if(n=IN(n,e,Pn),n!==null){Mt=n;return}if(e=e.sibling,e!==null){Mt=e;return}Mt=e=t}while(e!==null);Bt===0&&(Bt=5)}function Ws(t,e,n){var r=it,i=Hn.transition;try{Hn.transition=null,it=1,VN(t,e,n,r)}finally{Hn.transition=i,it=r}return null}function VN(t,e,n,r){do Zi();while(ls!==null);if(We&6)throw Error(de(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(de(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(v5(t,a),t===Ht&&(Mt=Ht=null,Jt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ml||(Ml=!0,f1(jc,function(){return Zi(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Hn.transition,Hn.transition=null;var o=it;it=1;var l=We;We|=4,rm.current=null,PN(t,n),s1(n,t),iN(wh),_c=!!bh,wh=bh=null,t.current=n,DN(n),u5(),We=l,it=o,Hn.transition=a}else t.current=n;if(Ml&&(Ml=!1,ls=t,$c=i),a=t.pendingLanes,a===0&&(xs=null),f5(n.stateNode),En(t,Rt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(zc)throw zc=!1,t=$h,$h=null,t;return $c&1&&t.tag!==0&&Zi(),a=t.pendingLanes,a&1?t===Bh?mo++:(mo=0,Bh=t):mo=0,Os(),null}function Zi(){if(ls!==null){var t=qy($c),e=Hn.transition,n=it;try{if(Hn.transition=null,it=16>t?16:t,ls===null)var r=!1;else{if(t=ls,ls=null,$c=0,We&6)throw Error(de(331));var i=We;for(We|=4,we=t.current;we!==null;){var a=we,o=a.child;if(we.flags&16){var l=a.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(we=d;we!==null;){var h=we;switch(h.tag){case 0:case 11:case 15:ho(8,h,a)}var g=h.child;if(g!==null)g.return=h,we=g;else for(;we!==null;){h=we;var x=h.sibling,N=h.return;if(t1(h),h===d){we=null;break}if(x!==null){x.return=N,we=x;break}we=N}}}var w=a.alternate;if(w!==null){var k=w.child;if(k!==null){w.child=null;do{var I=k.sibling;k.sibling=null,k=I}while(k!==null)}}we=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,we=o;else e:for(;we!==null;){if(a=we,a.flags&2048)switch(a.tag){case 0:case 11:case 15:ho(9,a,a.return)}var C=a.sibling;if(C!==null){C.return=a.return,we=C;break e}we=a.return}}var _=t.current;for(we=_;we!==null;){o=we;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,we=v;else e:for(o=_;we!==null;){if(l=we,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:xu(9,l)}}catch(D){Ct(l,l.return,D)}if(l===o){we=null;break e}var P=l.sibling;if(P!==null){P.return=l.return,we=P;break e}we=l.return}}if(We=i,Os(),yr&&typeof yr.onPostCommitFiberRoot=="function")try{yr.onPostCommitFiberRoot(cu,t)}catch{}r=!0}return r}finally{it=n,Hn.transition=e}}return!1}function ug(t,e,n){e=oa(n,e),e=qv(t,e,1),t=gs(t,e,1),e=xn(),t!==null&&(Yo(t,1,e),En(t,e))}function Ct(t,e,n){if(t.tag===3)ug(t,t,n);else for(;e!==null;){if(e.tag===3){ug(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(xs===null||!xs.has(r))){t=oa(n,t),t=Qv(e,t,1),e=gs(e,t,1),t=xn(),e!==null&&(Yo(e,1,t),En(e,t));break}}e=e.return}}function zN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=xn(),t.pingedLanes|=t.suspendedLanes&n,Ht===t&&(Jt&n)===n&&(Bt===4||Bt===3&&(Jt&130023424)===Jt&&500>Rt()-im?ri(t,0):sm|=n),En(t,e)}function d1(t,e){e===0&&(t.mode&1?(e=_l,_l<<=1,!(_l&130023424)&&(_l=4194304)):e=1);var n=xn();t=zr(t,e),t!==null&&(Yo(t,e,n),En(t,n))}function $N(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),d1(t,n)}function BN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(de(314))}r!==null&&r.delete(e),d1(t,n)}var h1;h1=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||_n.current)Sn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Sn=!1,TN(t,e,n);Sn=!!(t.flags&131072)}else Sn=!1,vt&&e.flags&1048576&&gv(e,Rc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ac(t,e),t=e.pendingProps;var i=ra(e,fn.current);Ji(e,n),i=Jf(null,e,r,t,i,n);var a=Zf();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,kn(r)?(a=!0,Ic(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Hf(e),i.updater=gu,e.stateNode=i,i._reactInternals=e,Ih(e,r,t,n),e=Ph(null,e,r,!0,a,n)):(e.tag=0,vt&&a&&zf(e),gn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ac(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=qN(r),t=rr(r,t),i){case 0:e=Rh(null,e,r,t,n);break e;case 1:e=eg(null,e,r,t,n);break e;case 11:e=J0(null,e,r,t,n);break e;case 14:e=Z0(null,e,r,rr(r.type,t),n);break e}throw Error(de(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:rr(r,i),Rh(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:rr(r,i),eg(t,e,r,i,n);case 3:e:{if(Yv(e),t===null)throw Error(de(387));r=e.pendingProps,a=e.memoizedState,i=a.element,Nv(t,e),Mc(e,r,null,n);var o=e.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=oa(Error(de(423)),e),e=tg(t,e,r,n,i);break e}else if(r!==i){i=oa(Error(de(424)),e),e=tg(t,e,r,n,i);break e}else for(Dn=ps(e.stateNode.containerInfo.firstChild),Ln=e,vt=!0,ar=null,n=bv(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(sa(),r===i){e=$r(t,e,n);break e}gn(t,e,r,n)}e=e.child}return e;case 5:return jv(e),t===null&&Eh(e),r=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,o=i.children,Nh(r,i)?o=null:a!==null&&Nh(r,a)&&(e.flags|=32),Wv(t,e),gn(t,e,o,n),e.child;case 6:return t===null&&Eh(e),null;case 13:return Kv(t,e,n);case 4:return Wf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ia(e,null,r,n):gn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:rr(r,i),J0(t,e,r,i,n);case 7:return gn(t,e,e.pendingProps,n),e.child;case 8:return gn(t,e,e.pendingProps.children,n),e.child;case 12:return gn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,a=e.memoizedProps,o=i.value,ut(Pc,r._currentValue),r._currentValue=o,a!==null)if(cr(a.value,o)){if(a.children===i.children&&!_n.current){e=$r(t,e,n);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(a.tag===1){u=Mr(-1,n&-n),u.tag=2;var d=a.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?u.next=u:(u.next=h.next,h.next=u),d.pending=u}}a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),Ch(a.return,n,e),l.lanes|=n;break}u=u.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(de(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Ch(o,n,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}gn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ji(e,n),i=Yn(i),r=r(i),e.flags|=1,gn(t,e,r,n),e.child;case 14:return r=e.type,i=rr(r,e.pendingProps),i=rr(r.type,i),Z0(t,e,r,i,n);case 15:return Gv(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:rr(r,i),ac(t,e),e.tag=1,kn(r)?(t=!0,Ic(e)):t=!1,Ji(e,n),Uv(e,r,i),Ih(e,r,i,n),Ph(null,e,r,!0,t,n);case 19:return Xv(t,e,n);case 22:return Hv(t,e,n)}throw Error(de(156,e.tag))};function f1(t,e){return zy(t,e)}function UN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gn(t,e,n,r){return new UN(t,e,n,r)}function cm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function qN(t){if(typeof t=="function")return cm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Cf)return 11;if(t===Tf)return 14}return 2}function vs(t,e){var n=t.alternate;return n===null?(n=Gn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function cc(t,e,n,r,i,a){var o=2;if(r=t,typeof t=="function")cm(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Oi:return si(n.children,i,a,e);case Ef:o=8,i|=8;break;case eh:return t=Gn(12,n,e,i|2),t.elementType=eh,t.lanes=a,t;case th:return t=Gn(13,n,e,i),t.elementType=th,t.lanes=a,t;case nh:return t=Gn(19,n,e,i),t.elementType=nh,t.lanes=a,t;case jy:return vu(n,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case wy:o=10;break e;case Ny:o=9;break e;case Cf:o=11;break e;case Tf:o=14;break e;case ns:o=16,r=null;break e}throw Error(de(130,t==null?t:typeof t,""))}return e=Gn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=a,e}function si(t,e,n,r){return t=Gn(7,t,r,e),t.lanes=n,t}function vu(t,e,n,r){return t=Gn(22,t,r,e),t.elementType=jy,t.lanes=n,t.stateNode={isHidden:!1},t}function Ad(t,e,n){return t=Gn(6,t,null,e),t.lanes=n,t}function Rd(t,e,n){return e=Gn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function QN(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hd(0),this.expirationTimes=hd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hd(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function um(t,e,n,r,i,a,o,l,u){return t=new QN(t,e,n,l,u),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Gn(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hf(a),t}function GN(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Li,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function m1(t){if(!t)return _s;t=t._reactInternals;e:{if(yi(t)!==t||t.tag!==1)throw Error(de(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(kn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(de(171))}if(t.tag===1){var n=t.type;if(kn(n))return mv(t,n,e)}return e}function p1(t,e,n,r,i,a,o,l,u){return t=um(n,r,!0,t,i,a,o,l,u),t.context=m1(null),n=t.current,r=xn(),i=ys(n),a=Mr(r,i),a.callback=e??null,gs(n,a,i),t.current.lanes=i,Yo(t,i,r),En(t,r),t}function bu(t,e,n,r){var i=e.current,a=xn(),o=ys(i);return n=m1(n),e.context===null?e.context=n:e.pendingContext=n,e=Mr(a,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=gs(i,e,o),t!==null&&(lr(t,i,o,a),rc(t,i,o)),o}function Uc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function dg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function dm(t,e){dg(t,e),(t=t.alternate)&&dg(t,e)}function HN(){return null}var g1=typeof reportError=="function"?reportError:function(t){console.error(t)};function hm(t){this._internalRoot=t}wu.prototype.render=hm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(de(409));bu(t,e,null,null)};wu.prototype.unmount=hm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;di(function(){bu(null,t,null,null)}),e[Vr]=null}};function wu(t){this._internalRoot=t}wu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Hy();t={blockedOn:null,target:t,priority:e};for(var n=0;n<is.length&&e!==0&&e<is[n].priority;n++);is.splice(n,0,t),n===0&&Yy(t)}};function fm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Nu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function hg(){}function WN(t,e,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var d=Uc(o);a.call(d)}}var o=p1(e,r,t,0,null,!1,!1,"",hg);return t._reactRootContainer=o,t[Vr]=o.current,To(t.nodeType===8?t.parentNode:t),di(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var d=Uc(u);l.call(d)}}var u=um(t,0,!1,null,null,!1,!1,"",hg);return t._reactRootContainer=u,t[Vr]=u.current,To(t.nodeType===8?t.parentNode:t),di(function(){bu(e,u,n,r)}),u}function ju(t,e,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var l=i;i=function(){var u=Uc(o);l.call(u)}}bu(e,o,t,i)}else o=WN(n,e,t,i,r);return Uc(o)}Qy=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Za(e.pendingLanes);n!==0&&(Rf(e,n|1),En(e,Rt()),!(We&6)&&(la=Rt()+500,Os()))}break;case 13:di(function(){var r=zr(t,1);if(r!==null){var i=xn();lr(r,t,1,i)}}),dm(t,1)}};Pf=function(t){if(t.tag===13){var e=zr(t,134217728);if(e!==null){var n=xn();lr(e,t,134217728,n)}dm(t,134217728)}};Gy=function(t){if(t.tag===13){var e=ys(t),n=zr(t,e);if(n!==null){var r=xn();lr(n,t,e,r)}dm(t,e)}};Hy=function(){return it};Wy=function(t,e){var n=it;try{return it=t,e()}finally{it=n}};hh=function(t,e,n){switch(e){case"input":if(ih(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=fu(r);if(!i)throw Error(de(90));_y(r),ih(r,i)}}}break;case"textarea":Ey(t,n);break;case"select":e=n.value,e!=null&&Wi(t,!!n.multiple,e,!1)}};Dy=am;My=di;var YN={usingClientEntryPoint:!1,Events:[Xo,$i,fu,Ry,Py,am]},qa={findFiberByHostInstance:Ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},KN={bundleType:qa.bundleType,version:qa.version,rendererPackageName:qa.rendererPackageName,rendererConfig:qa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Hr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Fy(t),t===null?null:t.stateNode},findFiberByHostInstance:qa.findFiberByHostInstance||HN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ll=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ll.isDisabled&&Ll.supportsFiber)try{cu=Ll.inject(KN),yr=Ll}catch{}}zn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YN;zn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fm(e))throw Error(de(200));return GN(t,e,null,n)};zn.createRoot=function(t,e){if(!fm(t))throw Error(de(299));var n=!1,r="",i=g1;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=um(t,1,!1,null,null,n,!1,r,i),t[Vr]=e.current,To(t.nodeType===8?t.parentNode:t),new hm(e)};zn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(de(188)):(t=Object.keys(t).join(","),Error(de(268,t)));return t=Fy(e),t=t===null?null:t.stateNode,t};zn.flushSync=function(t){return di(t)};zn.hydrate=function(t,e,n){if(!Nu(e))throw Error(de(200));return ju(null,t,e,!0,n)};zn.hydrateRoot=function(t,e,n){if(!fm(t))throw Error(de(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",o=g1;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=p1(e,null,t,1,n??null,i,!1,a,o),t[Vr]=e.current,To(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new wu(e)};zn.render=function(t,e,n){if(!Nu(e))throw Error(de(200));return ju(null,t,e,!1,n)};zn.unmountComponentAtNode=function(t){if(!Nu(t))throw Error(de(40));return t._reactRootContainer?(di(function(){ju(null,null,t,!1,function(){t._reactRootContainer=null,t[Vr]=null})}),!0):!1};zn.unstable_batchedUpdates=am;zn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Nu(n))throw Error(de(200));if(t==null||t._reactInternals===void 0)throw Error(de(38));return ju(t,e,n,!1,r)};zn.version="18.3.1-next-f1338f8080-20240426";function x1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(x1)}catch(t){console.error(t)}}x1(),xy.exports=zn;var XN=xy.exports,fg=XN;Jd.createRoot=fg.createRoot,Jd.hydrateRoot=fg.hydrateRoot;const JN="modulepreload",ZN=function(t){return"/"+t},mg={},mm=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(a=>{if(a=ZN(a),a in mg)return;mg[a]=!0;const o=a.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!r)for(let h=i.length-1;h>=0;h--){const g=i[h];if(g.href===a&&(!o||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${l}`))return;const d=document.createElement("link");if(d.rel=o?"stylesheet":JN,o||(d.as="script",d.crossOrigin=""),d.href=a,document.head.appendChild(d),o)return new Promise((h,g)=>{d.addEventListener("load",h),d.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>e()).catch(a=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a})};var pg="popstate";function ej(t={}){function e(r,i){let{pathname:a,search:o,hash:l}=r.location;return Qh("",{pathname:a,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Fo(i)}return nj(e,n,null,t)}function bt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Xn(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function tj(){return Math.random().toString(36).substring(2,10)}function gg(t,e){return{usr:t.state,key:t.key,idx:e}}function Qh(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?va(e):e,state:n,key:e&&e.key||r||tj()}}function Fo({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function va(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function nj(t,e,n,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,l="POP",u=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function g(){l="POP";let I=h(),C=I==null?null:I-d;d=I,u&&u({action:l,location:k.location,delta:C})}function x(I,C){l="PUSH";let _=Qh(k.location,I,C);n&&n(_,I),d=h()+1;let v=gg(_,d),P=k.createHref(_);try{o.pushState(v,"",P)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;i.location.assign(P)}a&&u&&u({action:l,location:k.location,delta:1})}function N(I,C){l="REPLACE";let _=Qh(k.location,I,C);n&&n(_,I),d=h();let v=gg(_,d),P=k.createHref(_);o.replaceState(v,"",P),a&&u&&u({action:l,location:k.location,delta:0})}function w(I){return rj(I)}let k={get action(){return l},get location(){return t(i,o)},listen(I){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(pg,g),u=I,()=>{i.removeEventListener(pg,g),u=null}},createHref(I){return e(i,I)},createURL:w,encodeLocation(I){let C=w(I);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:x,replace:N,go(I){return o.go(I)}};return k}function rj(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),bt(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Fo(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function y1(t,e,n="/"){return sj(t,e,n,!1)}function sj(t,e,n,r){let i=typeof e=="string"?va(e):e,a=Br(i.pathname||"/",n);if(a==null)return null;let o=v1(t);ij(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let d=gj(a);l=mj(o[u],d,r)}return l}function v1(t,e=[],n=[],r="",i=!1){let a=(o,l,u=i,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&u)return;bt(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let g=Lr([r,h.relativePath]),x=n.concat(h);o.children&&o.children.length>0&&(bt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),v1(o.children,e,x,g,u)),!(o.path==null&&!o.index)&&e.push({path:g,score:hj(g,o.index),routesMeta:x})};return t.forEach((o,l)=>{var u;if(o.path===""||!((u=o.path)!=null&&u.includes("?")))a(o,l);else for(let d of b1(o.path))a(o,l,!0,d)}),e}function b1(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=b1(r.join("/")),l=[];return l.push(...o.map(u=>u===""?a:[a,u].join("/"))),i&&l.push(...o),l.map(u=>t.startsWith("/")&&u===""?"/":u)}function ij(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:fj(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var aj=/^:[\w-]+$/,oj=3,lj=2,cj=1,uj=10,dj=-2,xg=t=>t==="*";function hj(t,e){let n=t.split("/"),r=n.length;return n.some(xg)&&(r+=dj),e&&(r+=lj),n.filter(i=>!xg(i)).reduce((i,a)=>i+(aj.test(a)?oj:a===""?cj:uj),r)}function fj(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function mj(t,e,n=!1){let{routesMeta:r}=t,i={},a="/",o=[];for(let l=0;l<r.length;++l){let u=r[l],d=l===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",g=qc({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),x=u.route;if(!g&&d&&n&&!r[r.length-1].route.index&&(g=qc({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!g)return null;Object.assign(i,g.params),o.push({params:i,pathname:Lr([a,g.pathname]),pathnameBase:bj(Lr([a,g.pathnameBase])),route:x}),g.pathnameBase!=="/"&&(a=Lr([a,g.pathnameBase]))}return o}function qc(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=pj(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:g},x)=>{if(h==="*"){let w=l[x]||"";o=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const N=l[x];return g&&!N?d[h]=void 0:d[h]=(N||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:t}}function pj(t,e=!1,n=!0){Xn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(r.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function gj(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Xn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Br(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function xj(t,e="/"){let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?va(t):t;return{pathname:n?n.startsWith("/")?n:yj(n,e):e,search:wj(r),hash:Nj(i)}}function yj(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Pd(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function vj(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function pm(t){let e=vj(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function gm(t,e,n,r=!1){let i;typeof t=="string"?i=va(t):(i={...t},bt(!i.pathname||!i.pathname.includes("?"),Pd("?","pathname","search",i)),bt(!i.pathname||!i.pathname.includes("#"),Pd("#","pathname","hash",i)),bt(!i.search||!i.search.includes("#"),Pd("#","search","hash",i)));let a=t===""||i.pathname==="",o=a?"/":i.pathname,l;if(o==null)l=n;else{let g=e.length-1;if(!r&&o.startsWith("..")){let x=o.split("/");for(;x[0]==="..";)x.shift(),g-=1;i.pathname=x.join("/")}l=g>=0?e[g]:"/"}let u=xj(i,l),d=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var Lr=t=>t.join("/").replace(/\/\/+/g,"/"),bj=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),wj=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Nj=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function jj(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var w1=["POST","PUT","PATCH","DELETE"];new Set(w1);var Sj=["GET",...w1];new Set(Sj);var ba=f.createContext(null);ba.displayName="DataRouter";var Su=f.createContext(null);Su.displayName="DataRouterState";f.createContext(!1);var N1=f.createContext({isTransitioning:!1});N1.displayName="ViewTransition";var _j=f.createContext(new Map);_j.displayName="Fetchers";var kj=f.createContext(null);kj.displayName="Await";var dr=f.createContext(null);dr.displayName="Navigation";var Zo=f.createContext(null);Zo.displayName="Location";var Jn=f.createContext({outlet:null,matches:[],isDataRoute:!1});Jn.displayName="Route";var xm=f.createContext(null);xm.displayName="RouteError";function Ej(t,{relative:e}={}){bt(wa(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=f.useContext(dr),{hash:i,pathname:a,search:o}=el(t,{relative:e}),l=a;return n!=="/"&&(l=a==="/"?n:Lr([n,a])),r.createHref({pathname:l,search:o,hash:i})}function wa(){return f.useContext(Zo)!=null}function Pt(){return bt(wa(),"useLocation() may be used only in the context of a <Router> component."),f.useContext(Zo).location}var j1="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function S1(t){f.useContext(dr).static||f.useLayoutEffect(t)}function Ye(){let{isDataRoute:t}=f.useContext(Jn);return t?Uj():Cj()}function Cj(){bt(wa(),"useNavigate() may be used only in the context of a <Router> component.");let t=f.useContext(ba),{basename:e,navigator:n}=f.useContext(dr),{matches:r}=f.useContext(Jn),{pathname:i}=Pt(),a=JSON.stringify(pm(r)),o=f.useRef(!1);return S1(()=>{o.current=!0}),f.useCallback((u,d={})=>{if(Xn(o.current,j1),!o.current)return;if(typeof u=="number"){n.go(u);return}let h=gm(u,JSON.parse(a),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Lr([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,a,i,t])}var Tj=f.createContext(null);function Ij(t){let e=f.useContext(Jn).outlet;return e&&f.createElement(Tj.Provider,{value:t},e)}function Aj(){let{matches:t}=f.useContext(Jn),e=t[t.length-1];return e?e.params:{}}function el(t,{relative:e}={}){let{matches:n}=f.useContext(Jn),{pathname:r}=Pt(),i=JSON.stringify(pm(n));return f.useMemo(()=>gm(t,JSON.parse(i),r,e==="path"),[t,i,r,e])}function Rj(t,e){return _1(t,e)}function _1(t,e,n,r,i){var _;bt(wa(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=f.useContext(dr),{matches:o}=f.useContext(Jn),l=o[o.length-1],u=l?l.params:{},d=l?l.pathname:"/",h=l?l.pathnameBase:"/",g=l&&l.route;{let v=g&&g.path||"";k1(d,!g||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let x=Pt(),N;if(e){let v=typeof e=="string"?va(e):e;bt(h==="/"||((_=v.pathname)==null?void 0:_.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${v.pathname}" was given in the \`location\` prop.`),N=v}else N=x;let w=N.pathname||"/",k=w;if(h!=="/"){let v=h.replace(/^\//,"").split("/");k="/"+w.replace(/^\//,"").split("/").slice(v.length).join("/")}let I=y1(t,{pathname:k});Xn(g||I!=null,`No routes matched location "${N.pathname}${N.search}${N.hash}" `),Xn(I==null||I[I.length-1].route.element!==void 0||I[I.length-1].route.Component!==void 0||I[I.length-1].route.lazy!==void 0,`Matched leaf route at location "${N.pathname}${N.search}${N.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let C=Oj(I&&I.map(v=>Object.assign({},v,{params:Object.assign({},u,v.params),pathname:Lr([h,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?h:Lr([h,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),o,n,r,i);return e&&C?f.createElement(Zo.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...N},navigationType:"POP"}},C):C}function Pj(){let t=Bj(),e=jj(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=f.createElement(f.Fragment,null,f.createElement("p",null," Hey developer "),f.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",f.createElement("code",{style:a},"ErrorBoundary")," or"," ",f.createElement("code",{style:a},"errorElement")," prop on your route.")),f.createElement(f.Fragment,null,f.createElement("h2",null,"Unexpected Application Error!"),f.createElement("h3",{style:{fontStyle:"italic"}},e),n?f.createElement("pre",{style:i},n):null,o)}var Dj=f.createElement(Pj,null),Mj=class extends f.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.unstable_onError?this.props.unstable_onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?f.createElement(Jn.Provider,{value:this.props.routeContext},f.createElement(xm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Lj({routeContext:t,match:e,children:n}){let r=f.useContext(ba);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),f.createElement(Jn.Provider,{value:t},n)}function Oj(t,e=[],n=null,r=null,i=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,o=n==null?void 0:n.errors;if(o!=null){let d=a.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);bt(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,d+1))}let l=!1,u=-1;if(n)for(let d=0;d<a.length;d++){let h=a[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:g,errors:x}=n,N=h.route.loader&&!g.hasOwnProperty(h.route.id)&&(!x||x[h.route.id]===void 0);if(h.route.lazy||N){l=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((d,h,g)=>{let x,N=!1,w=null,k=null;n&&(x=o&&h.route.id?o[h.route.id]:void 0,w=h.route.errorElement||Dj,l&&(u<0&&g===0?(k1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),N=!0,k=null):u===g&&(N=!0,k=h.route.hydrateFallbackElement||null)));let I=e.concat(a.slice(0,g+1)),C=()=>{let _;return x?_=w:N?_=k:h.route.Component?_=f.createElement(h.route.Component,null):h.route.element?_=h.route.element:_=d,f.createElement(Lj,{match:h,routeContext:{outlet:d,matches:I,isDataRoute:n!=null},children:_})};return n&&(h.route.ErrorBoundary||h.route.errorElement||g===0)?f.createElement(Mj,{location:n.location,revalidation:n.revalidation,component:w,error:x,children:C(),routeContext:{outlet:null,matches:I,isDataRoute:!0},unstable_onError:r}):C()},null)}function ym(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Fj(t){let e=f.useContext(ba);return bt(e,ym(t)),e}function Vj(t){let e=f.useContext(Su);return bt(e,ym(t)),e}function zj(t){let e=f.useContext(Jn);return bt(e,ym(t)),e}function vm(t){let e=zj(t),n=e.matches[e.matches.length-1];return bt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function $j(){return vm("useRouteId")}function Bj(){var r;let t=f.useContext(xm),e=Vj("useRouteError"),n=vm("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function Uj(){let{router:t}=Fj("useNavigate"),e=vm("useNavigate"),n=f.useRef(!1);return S1(()=>{n.current=!0}),f.useCallback(async(i,a={})=>{Xn(n.current,j1),n.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...a}))},[t,e])}var yg={};function k1(t,e,n){!e&&!yg[t]&&(yg[t]=!0,Xn(!1,n))}f.memo(qj);function qj({routes:t,future:e,state:n,unstable_onError:r}){return _1(t,void 0,n,r,e)}function E1({to:t,replace:e,state:n,relative:r}){bt(wa(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=f.useContext(dr);Xn(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=f.useContext(Jn),{pathname:o}=Pt(),l=Ye(),u=gm(t,pm(a),o,r==="path"),d=JSON.stringify(u);return f.useEffect(()=>{l(JSON.parse(d),{replace:e,state:n,relative:r})},[l,d,r,e,n]),null}function Qj(t){return Ij(t.context)}function et(t){bt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Gj({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:i,static:a=!1}){bt(!wa(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),l=f.useMemo(()=>({basename:o,navigator:i,static:a,future:{}}),[o,i,a]);typeof n=="string"&&(n=va(n));let{pathname:u="/",search:d="",hash:h="",state:g=null,key:x="default"}=n,N=f.useMemo(()=>{let w=Br(u,o);return w==null?null:{location:{pathname:w,search:d,hash:h,state:g,key:x},navigationType:r}},[o,u,d,h,g,x,r]);return Xn(N!=null,`<Router basename="${o}"> is not able to match the URL "${u}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),N==null?null:f.createElement(dr.Provider,{value:l},f.createElement(Zo.Provider,{children:e,value:N}))}function Hj({children:t,location:e}){return Rj(Gh(t),e)}function Gh(t,e=[]){let n=[];return f.Children.forEach(t,(r,i)=>{if(!f.isValidElement(r))return;let a=[...e,i];if(r.type===f.Fragment){n.push.apply(n,Gh(r.props.children,a));return}bt(r.type===et,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),bt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Gh(r.props.children,a)),n.push(o)}),n}var uc="get",dc="application/x-www-form-urlencoded";function _u(t){return t!=null&&typeof t.tagName=="string"}function Wj(t){return _u(t)&&t.tagName.toLowerCase()==="button"}function Yj(t){return _u(t)&&t.tagName.toLowerCase()==="form"}function Kj(t){return _u(t)&&t.tagName.toLowerCase()==="input"}function Xj(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Jj(t,e){return t.button===0&&(!e||e==="_self")&&!Xj(t)}function Hh(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function Zj(t,e){let n=Hh(t);return e&&e.forEach((r,i)=>{n.has(i)||e.getAll(i).forEach(a=>{n.append(i,a)})}),n}var Ol=null;function eS(){if(Ol===null)try{new FormData(document.createElement("form"),0),Ol=!1}catch{Ol=!0}return Ol}var tS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Dd(t){return t!=null&&!tS.has(t)?(Xn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${dc}"`),null):t}function nS(t,e){let n,r,i,a,o;if(Yj(t)){let l=t.getAttribute("action");r=l?Br(l,e):null,n=t.getAttribute("method")||uc,i=Dd(t.getAttribute("enctype"))||dc,a=new FormData(t)}else if(Wj(t)||Kj(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||l.getAttribute("action");if(r=u?Br(u,e):null,n=t.getAttribute("formmethod")||l.getAttribute("method")||uc,i=Dd(t.getAttribute("formenctype"))||Dd(l.getAttribute("enctype"))||dc,a=new FormData(l,t),!eS()){let{name:d,type:h,value:g}=t;if(h==="image"){let x=d?`${d}.`:"";a.append(`${x}x`,"0"),a.append(`${x}y`,"0")}else d&&a.append(d,g)}}else{if(_u(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=uc,r=null,i=dc,o=t}return a&&i==="text/plain"&&(o=a,a=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function bm(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function rS(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&Br(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function sS(t,e){if(t.id in e)return e[t.id];try{let n=await mm(()=>import(t.module),[]);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function iS(t){return t!=null&&typeof t.page=="string"}function aS(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function oS(t,e,n){let r=await Promise.all(t.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await sS(a,n);return o.links?o.links():[]}return[]}));return dS(r.flat(1).filter(aS).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function vg(t,e,n,r,i,a){let o=(u,d)=>n[d]?u.route.id!==n[d].route.id:!0,l=(u,d)=>{var h;return n[d].pathname!==u.pathname||((h=n[d].route.path)==null?void 0:h.endsWith("*"))&&n[d].params["*"]!==u.params["*"]};return a==="assets"?e.filter((u,d)=>o(u,d)||l(u,d)):a==="data"?e.filter((u,d)=>{var g;let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,d)||l(u,d))return!0;if(u.route.shouldRevalidate){let x=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((g=n[0])==null?void 0:g.params)||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function lS(t,e,{includeHydrateFallback:n}={}){return cS(t.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function cS(t){return[...new Set(t)]}function uS(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function dS(t,e){let n=new Set,r=new Set(e);return t.reduce((i,a)=>{if(e&&!iS(a)&&a.as==="script"&&a.href&&r.has(a.href))return i;let l=JSON.stringify(uS(a));return n.has(l)||(n.add(l),i.push({key:l,link:a})),i},[])}function C1(){let t=f.useContext(ba);return bm(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function hS(){let t=f.useContext(Su);return bm(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var wm=f.createContext(void 0);wm.displayName="FrameworkContext";function T1(){let t=f.useContext(wm);return bm(t,"You must render this element inside a <HydratedRouter> element"),t}function fS(t,e){let n=f.useContext(wm),[r,i]=f.useState(!1),[a,o]=f.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:g}=e,x=f.useRef(null);f.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let k=C=>{C.forEach(_=>{o(_.isIntersecting)})},I=new IntersectionObserver(k,{threshold:.5});return x.current&&I.observe(x.current),()=>{I.disconnect()}}},[t]),f.useEffect(()=>{if(r){let k=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(k)}}},[r]);let N=()=>{i(!0)},w=()=>{i(!1),o(!1)};return n?t!=="intent"?[a,x,{}]:[a,x,{onFocus:Qa(l,N),onBlur:Qa(u,w),onMouseEnter:Qa(d,N),onMouseLeave:Qa(h,w),onTouchStart:Qa(g,N)}]:[!1,x,{}]}function Qa(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function mS({page:t,...e}){let{router:n}=C1(),r=f.useMemo(()=>y1(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?f.createElement(gS,{page:t,matches:r,...e}):null}function pS(t){let{manifest:e,routeModules:n}=T1(),[r,i]=f.useState([]);return f.useEffect(()=>{let a=!1;return oS(t,e,n).then(o=>{a||i(o)}),()=>{a=!0}},[t,e,n]),r}function gS({page:t,matches:e,...n}){let r=Pt(),{manifest:i,routeModules:a}=T1(),{basename:o}=C1(),{loaderData:l,matches:u}=hS(),d=f.useMemo(()=>vg(t,e,u,i,r,"data"),[t,e,u,i,r]),h=f.useMemo(()=>vg(t,e,u,i,r,"assets"),[t,e,u,i,r]),g=f.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let w=new Set,k=!1;if(e.forEach(C=>{var v;let _=i.routes[C.route.id];!_||!_.hasLoader||(!d.some(P=>P.route.id===C.route.id)&&C.route.id in l&&((v=a[C.route.id])!=null&&v.shouldRevalidate)||_.hasClientLoader?k=!0:w.add(C.route.id))}),w.size===0)return[];let I=rS(t,o,"data");return k&&w.size>0&&I.searchParams.set("_routes",e.filter(C=>w.has(C.route.id)).map(C=>C.route.id).join(",")),[I.pathname+I.search]},[o,l,r,i,d,e,t,a]),x=f.useMemo(()=>lS(h,i),[h,i]),N=pS(h);return f.createElement(f.Fragment,null,g.map(w=>f.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...n})),x.map(w=>f.createElement("link",{key:w,rel:"modulepreload",href:w,...n})),N.map(({key:w,link:k})=>f.createElement("link",{key:w,nonce:n.nonce,...k})))}function xS(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var I1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{I1&&(window.__reactRouterVersion="7.9.1")}catch{}function yS({basename:t,children:e,window:n}){let r=f.useRef();r.current==null&&(r.current=ej({window:n,v5Compat:!0}));let i=r.current,[a,o]=f.useState({action:i.action,location:i.location}),l=f.useCallback(u=>{f.startTransition(()=>o(u))},[o]);return f.useLayoutEffect(()=>i.listen(l),[i,l]),f.createElement(Gj,{basename:t,children:e,location:a.location,navigationType:a.action,navigator:i})}var A1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,R1=f.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:i,reloadDocument:a,replace:o,state:l,target:u,to:d,preventScrollReset:h,viewTransition:g,...x},N){let{basename:w}=f.useContext(dr),k=typeof d=="string"&&A1.test(d),I,C=!1;if(typeof d=="string"&&k&&(I=d,I1))try{let y=new URL(window.location.href),j=d.startsWith("//")?new URL(y.protocol+d):new URL(d),A=Br(j.pathname,w);j.origin===y.origin&&A!=null?d=A+j.search+j.hash:C=!0}catch{Xn(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=Ej(d,{relative:i}),[v,P,D]=fS(r,x),L=NS(d,{replace:o,state:l,target:u,preventScrollReset:h,relative:i,viewTransition:g});function E(y){e&&e(y),y.defaultPrevented||L(y)}let m=f.createElement("a",{...x,...D,href:I||_,onClick:C||a?e:E,ref:xS(N,P),target:u,"data-discover":!k&&n==="render"?"true":void 0});return v&&!k?f.createElement(f.Fragment,null,m,f.createElement(mS,{page:_})):m});R1.displayName="Link";var vS=f.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:i=!1,style:a,to:o,viewTransition:l,children:u,...d},h){let g=el(o,{relative:d.relative}),x=Pt(),N=f.useContext(Su),{navigator:w,basename:k}=f.useContext(dr),I=N!=null&&ES(g)&&l===!0,C=w.encodeLocation?w.encodeLocation(g).pathname:g.pathname,_=x.pathname,v=N&&N.navigation&&N.navigation.location?N.navigation.location.pathname:null;n||(_=_.toLowerCase(),v=v?v.toLowerCase():null,C=C.toLowerCase()),v&&k&&(v=Br(v,k)||v);const P=C!=="/"&&C.endsWith("/")?C.length-1:C.length;let D=_===C||!i&&_.startsWith(C)&&_.charAt(P)==="/",L=v!=null&&(v===C||!i&&v.startsWith(C)&&v.charAt(C.length)==="/"),E={isActive:D,isPending:L,isTransitioning:I},m=D?e:void 0,y;typeof r=="function"?y=r(E):y=[r,D?"active":null,L?"pending":null,I?"transitioning":null].filter(Boolean).join(" ");let j=typeof a=="function"?a(E):a;return f.createElement(R1,{...d,"aria-current":m,className:y,ref:h,style:j,to:o,viewTransition:l},typeof u=="function"?u(E):u)});vS.displayName="NavLink";var bS=f.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:i,state:a,method:o=uc,action:l,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:g,...x},N)=>{let w=_S(),k=kS(l,{relative:d}),I=o.toLowerCase()==="get"?"get":"post",C=typeof l=="string"&&A1.test(l),_=v=>{if(u&&u(v),v.defaultPrevented)return;v.preventDefault();let P=v.nativeEvent.submitter,D=(P==null?void 0:P.getAttribute("formmethod"))||o;w(P||v.currentTarget,{fetcherKey:e,method:D,navigate:n,replace:i,state:a,relative:d,preventScrollReset:h,viewTransition:g})};return f.createElement("form",{ref:N,method:I,action:k,onSubmit:r?u:_,...x,"data-discover":!C&&t==="render"?"true":void 0})});bS.displayName="Form";function wS(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function P1(t){let e=f.useContext(ba);return bt(e,wS(t)),e}function NS(t,{target:e,replace:n,state:r,preventScrollReset:i,relative:a,viewTransition:o}={}){let l=Ye(),u=Pt(),d=el(t,{relative:a});return f.useCallback(h=>{if(Jj(h,e)){h.preventDefault();let g=n!==void 0?n:Fo(u)===Fo(d);l(t,{replace:g,state:r,preventScrollReset:i,relative:a,viewTransition:o})}},[u,l,d,n,r,e,t,i,a,o])}function D1(t){Xn(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=f.useRef(Hh(t)),n=f.useRef(!1),r=Pt(),i=f.useMemo(()=>Zj(r.search,n.current?null:e.current),[r.search]),a=Ye(),o=f.useCallback((l,u)=>{const d=Hh(typeof l=="function"?l(new URLSearchParams(i)):l);n.current=!0,a("?"+d,u)},[a,i]);return[i,o]}var jS=0,SS=()=>`__${String(++jS)}__`;function _S(){let{router:t}=P1("useSubmit"),{basename:e}=f.useContext(dr),n=$j();return f.useCallback(async(r,i={})=>{let{action:a,method:o,encType:l,formData:u,body:d}=nS(r,e);if(i.navigate===!1){let h=i.fetcherKey||SS();await t.fetch(h,n,i.action||a,{preventScrollReset:i.preventScrollReset,formData:u,body:d,formMethod:i.method||o,formEncType:i.encType||l,flushSync:i.flushSync})}else await t.navigate(i.action||a,{preventScrollReset:i.preventScrollReset,formData:u,body:d,formMethod:i.method||o,formEncType:i.encType||l,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,n])}function kS(t,{relative:e}={}){let{basename:n}=f.useContext(dr),r=f.useContext(Jn);bt(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...el(t||".",{relative:e})},o=Pt();if(t==null){a.search=o.search;let l=new URLSearchParams(a.search),u=l.getAll("index");if(u.some(h=>h==="")){l.delete("index"),u.filter(g=>g).forEach(g=>l.append("index",g));let h=l.toString();a.search=h?`?${h}`:""}}return(!t||t===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:Lr([n,a.pathname])),Fo(a)}function ES(t,{relative:e}={}){let n=f.useContext(N1);bt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=P1("useViewTransitionState"),i=el(t,{relative:e});if(!n.isTransitioning)return!1;let a=Br(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Br(n.nextLocation.pathname,r)||n.nextLocation.pathname;return qc(i.pathname,o)!=null||qc(i.pathname,a)!=null}const CS=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},TS=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[n++];e[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[n++],o=t[n++],l=t[n++],u=((i&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const a=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},L1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const a=t[i],o=i+1<t.length,l=o?t[i+1]:0,u=i+2<t.length,d=u?t[i+2]:0,h=a>>2,g=(a&3)<<4|l>>4;let x=(l&15)<<2|d>>6,N=d&63;u||(N=64,o||(x=64)),r.push(n[h],n[g],n[x],n[N])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(M1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):TS(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const a=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const d=i<t.length?n[t.charAt(i)]:64;++i;const g=i<t.length?n[t.charAt(i)]:64;if(++i,a==null||l==null||d==null||g==null)throw new IS;const x=a<<2|l>>4;if(r.push(x),d!==64){const N=l<<4&240|d>>2;if(r.push(N),g!==64){const w=d<<6&192|g;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class IS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const AS=function(t){const e=M1(t);return L1.encodeByteArray(e,!0)},Qc=function(t){return AS(t).replace(/\./g,"")},RS=function(t){try{return L1.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DS=()=>PS().__FIREBASE_DEFAULTS__,MS=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},LS=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&RS(t[1]);return e&&JSON.parse(e)},Nm=()=>{try{return CS()||DS()||MS()||LS()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},OS=t=>{var e,n;return(n=(e=Nm())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},FS=t=>{const e=OS(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},O1=()=>{var t;return(t=Nm())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jm(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function zS(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $S(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[Qc(JSON.stringify(n)),Qc(JSON.stringify(o)),l].join(".")}const po={};function BS(){const t={prod:[],emulator:[]};for(const e of Object.keys(po))po[e]?t.emulator.push(e):t.prod.push(e);return t}function US(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let bg=!1;function qS(t,e){if(typeof window>"u"||typeof document>"u"||!jm(window.location.host)||po[t]===e||po[t]||bg)return;po[t]=e;function n(x){return`__firebase__banner__${x}`}const r="__firebase__banner",a=BS().prod.length>0;function o(){const x=document.getElementById(r);x&&x.remove()}function l(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function u(x,N){x.setAttribute("width","24"),x.setAttribute("id",N),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function d(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{bg=!0,o()},x}function h(x,N){x.setAttribute("id",N),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function g(){const x=US(r),N=n("text"),w=document.getElementById(N)||document.createElement("span"),k=n("learnmore"),I=document.getElementById(k)||document.createElement("a"),C=n("preprendIcon"),_=document.getElementById(C)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const v=x.element;l(v),h(I,k);const P=d();u(_,C),v.append(_,w,I,P),document.body.appendChild(v)}a?(w.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",N)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QS(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function GS(){var t;const e=(t=Nm())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function HS(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function WS(){return!GS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function F1(){try{return typeof indexedDB=="object"}catch{return!1}}function V1(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var a;e(((a=i.error)===null||a===void 0?void 0:a.message)||"")}}catch(n){e(n)}})}function YS(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KS="FirebaseError";class Fs extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=KS,Object.setPrototypeOf(this,Fs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ku.prototype.create)}}class ku{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?XS(a,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Fs(i,l,r)}}function XS(t,e){return t.replace(JS,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const JS=/\{\$([^}]+)}/g;function ca(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const a=t[i],o=e[i];if(wg(a)&&wg(o)){if(!ca(a,o))return!1}else if(a!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function wg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZS=1e3,e_=2,t_=4*60*60*1e3,n_=.5;function Ng(t,e=ZS,n=e_){const r=e*Math.pow(n,t),i=Math.round(n_*r*(Math.random()-.5)*2);return Math.min(t_,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vn(t){return t&&t._delegate?t._delegate:t}class Ur{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ys="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new VS;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(i_(e))try{this.getOrInitializeService({instanceIdentifier:Ys})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(e=Ys){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ys){return this.instances.has(e)}getOptions(e=Ys){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[a,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(a);r===l&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),a=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;a.add(e),this.onInitCallbacks.set(i,a);const o=this.instances.get(i);return o&&e(o,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:s_(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ys){return this.component?this.component.multipleInstances?e:Ys:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function s_(t){return t===Ys?void 0:t}function i_(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new r_(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Qe||(Qe={}));const o_={debug:Qe.DEBUG,verbose:Qe.VERBOSE,info:Qe.INFO,warn:Qe.WARN,error:Qe.ERROR,silent:Qe.SILENT},l_=Qe.INFO,c_={[Qe.DEBUG]:"log",[Qe.VERBOSE]:"log",[Qe.INFO]:"info",[Qe.WARN]:"warn",[Qe.ERROR]:"error"},u_=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=c_[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Sm{constructor(e){this.name=e,this._logLevel=l_,this._logHandler=u_,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Qe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?o_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Qe.DEBUG,...e),this._logHandler(this,Qe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Qe.VERBOSE,...e),this._logHandler(this,Qe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Qe.INFO,...e),this._logHandler(this,Qe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Qe.WARN,...e),this._logHandler(this,Qe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Qe.ERROR,...e),this._logHandler(this,Qe.ERROR,...e)}}const d_=(t,e)=>e.some(n=>t instanceof n);let jg,Sg;function h_(){return jg||(jg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function f_(){return Sg||(Sg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const z1=new WeakMap,Wh=new WeakMap,$1=new WeakMap,Md=new WeakMap,_m=new WeakMap;function m_(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{n(bs(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&z1.set(n,t)}).catch(()=>{}),_m.set(e,t),e}function p_(t){if(Wh.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});Wh.set(t,e)}let Yh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Wh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||$1.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return bs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function g_(t){Yh=t(Yh)}function x_(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Ld(this),e,...n);return $1.set(r,e.sort?e.sort():[e]),bs(r)}:f_().includes(t)?function(...e){return t.apply(Ld(this),e),bs(z1.get(this))}:function(...e){return bs(t.apply(Ld(this),e))}}function y_(t){return typeof t=="function"?x_(t):(t instanceof IDBTransaction&&p_(t),d_(t,h_())?new Proxy(t,Yh):t)}function bs(t){if(t instanceof IDBRequest)return m_(t);if(Md.has(t))return Md.get(t);const e=y_(t);return e!==t&&(Md.set(t,e),_m.set(e,t)),e}const Ld=t=>_m.get(t);function B1(t,e,{blocked:n,upgrade:r,blocking:i,terminated:a}={}){const o=indexedDB.open(t,e),l=bs(o);return r&&o.addEventListener("upgradeneeded",u=>{r(bs(o.result),u.oldVersion,u.newVersion,bs(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const v_=["get","getKey","getAll","getAllKeys","count"],b_=["put","add","delete","clear"],Od=new Map;function _g(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Od.get(e))return Od.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=b_.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||v_.includes(n)))return;const a=async function(o,...l){const u=this.transaction(o,i?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),i&&u.done]))[0]};return Od.set(e,a),a}g_(t=>({...t,get:(e,n,r)=>_g(e,n)||t.get(e,n,r),has:(e,n)=>!!_g(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(N_(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function N_(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Kh="@firebase/app",kg="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qr=new Sm("@firebase/app"),j_="@firebase/app-compat",S_="@firebase/analytics-compat",__="@firebase/analytics",k_="@firebase/app-check-compat",E_="@firebase/app-check",C_="@firebase/auth",T_="@firebase/auth-compat",I_="@firebase/database",A_="@firebase/data-connect",R_="@firebase/database-compat",P_="@firebase/functions",D_="@firebase/functions-compat",M_="@firebase/installations",L_="@firebase/installations-compat",O_="@firebase/messaging",F_="@firebase/messaging-compat",V_="@firebase/performance",z_="@firebase/performance-compat",$_="@firebase/remote-config",B_="@firebase/remote-config-compat",U_="@firebase/storage",q_="@firebase/storage-compat",Q_="@firebase/firestore",G_="@firebase/ai",H_="@firebase/firestore-compat",W_="firebase",Y_="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xh="[DEFAULT]",K_={[Kh]:"fire-core",[j_]:"fire-core-compat",[__]:"fire-analytics",[S_]:"fire-analytics-compat",[E_]:"fire-app-check",[k_]:"fire-app-check-compat",[C_]:"fire-auth",[T_]:"fire-auth-compat",[I_]:"fire-rtdb",[A_]:"fire-data-connect",[R_]:"fire-rtdb-compat",[P_]:"fire-fn",[D_]:"fire-fn-compat",[M_]:"fire-iid",[L_]:"fire-iid-compat",[O_]:"fire-fcm",[F_]:"fire-fcm-compat",[V_]:"fire-perf",[z_]:"fire-perf-compat",[$_]:"fire-rc",[B_]:"fire-rc-compat",[U_]:"fire-gcs",[q_]:"fire-gcs-compat",[Q_]:"fire-fst",[H_]:"fire-fst-compat",[G_]:"fire-vertex","fire-js":"fire-js",[W_]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gc=new Map,X_=new Map,Jh=new Map;function Eg(t,e){try{t.container.addComponent(e)}catch(n){qr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ks(t){const e=t.name;if(Jh.has(e))return qr.debug(`There were multiple attempts to register component ${e}.`),!1;Jh.set(e,t);for(const n of Gc.values())Eg(n,t);for(const n of X_.values())Eg(n,t);return!0}function tl(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function J_(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z_={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ws=new ku("app","Firebase",Z_);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ur("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ws.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tk=Y_;function U1(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Xh,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw ws.create("bad-app-name",{appName:String(i)});if(n||(n=O1()),!n)throw ws.create("no-options");const a=Gc.get(i);if(a){if(ca(n,a.options)&&ca(r,a.config))return a;throw ws.create("duplicate-app",{appName:i})}const o=new a_(i);for(const u of Jh.values())o.addComponent(u);const l=new ek(n,r,o);return Gc.set(i,l),l}function q1(t=Xh){const e=Gc.get(t);if(!e&&t===Xh&&O1())return U1();if(!e)throw ws.create("no-app",{appName:t});return e}function br(t,e,n){var r;let i=(r=K_[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const a=i.match(/\s|\//),o=e.match(/\s|\//);if(a||o){const l=[`Unable to register library "${i}" with version "${e}":`];a&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),qr.warn(l.join(" "));return}ks(new Ur(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nk="firebase-heartbeat-database",rk=1,Vo="firebase-heartbeat-store";let Fd=null;function Q1(){return Fd||(Fd=B1(nk,rk,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Vo)}catch(n){console.warn(n)}}}}).catch(t=>{throw ws.create("idb-open",{originalErrorMessage:t.message})})),Fd}async function sk(t){try{const n=(await Q1()).transaction(Vo),r=await n.objectStore(Vo).get(G1(t));return await n.done,r}catch(e){if(e instanceof Fs)qr.warn(e.message);else{const n=ws.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});qr.warn(n.message)}}}async function Cg(t,e){try{const r=(await Q1()).transaction(Vo,"readwrite");await r.objectStore(Vo).put(e,G1(t)),await r.done}catch(n){if(n instanceof Fs)qr.warn(n.message);else{const r=ws.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});qr.warn(r.message)}}}function G1(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ik=1024,ak=30;class ok{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new ck(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=Tg();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(o=>o.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:i}),this._heartbeatsCache.heartbeats.length>ak){const o=uk(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){qr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Tg(),{heartbeatsToSend:r,unsentEntries:i}=lk(this._heartbeatsCache.heartbeats),a=Qc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(n){return qr.warn(n),""}}}function Tg(){return new Date().toISOString().substring(0,10)}function lk(t,e=ik){const n=[];let r=t.slice();for(const i of t){const a=n.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),Ig(n)>e){a.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Ig(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class ck{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return F1()?V1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await sk(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Cg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Cg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Ig(t){return Qc(JSON.stringify({version:2,heartbeats:t})).length}function uk(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dk(t){ks(new Ur("platform-logger",e=>new w_(e),"PRIVATE")),ks(new Ur("heartbeat",e=>new ok(e),"PRIVATE")),br(Kh,kg,t),br(Kh,kg,"esm2017"),br("fire-js","")}dk("");var hk="firebase",fk="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */br(hk,fk,"app");var Ag=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ns,H1;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,m){function y(){}y.prototype=m.prototype,E.D=m.prototype,E.prototype=new y,E.prototype.constructor=E,E.C=function(j,A,T){for(var S=Array(arguments.length-2),G=2;G<arguments.length;G++)S[G-2]=arguments[G];return m.prototype[A].apply(j,S)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,m,y){y||(y=0);var j=Array(16);if(typeof m=="string")for(var A=0;16>A;++A)j[A]=m.charCodeAt(y++)|m.charCodeAt(y++)<<8|m.charCodeAt(y++)<<16|m.charCodeAt(y++)<<24;else for(A=0;16>A;++A)j[A]=m[y++]|m[y++]<<8|m[y++]<<16|m[y++]<<24;m=E.g[0],y=E.g[1],A=E.g[2];var T=E.g[3],S=m+(T^y&(A^T))+j[0]+3614090360&4294967295;m=y+(S<<7&4294967295|S>>>25),S=T+(A^m&(y^A))+j[1]+3905402710&4294967295,T=m+(S<<12&4294967295|S>>>20),S=A+(y^T&(m^y))+j[2]+606105819&4294967295,A=T+(S<<17&4294967295|S>>>15),S=y+(m^A&(T^m))+j[3]+3250441966&4294967295,y=A+(S<<22&4294967295|S>>>10),S=m+(T^y&(A^T))+j[4]+4118548399&4294967295,m=y+(S<<7&4294967295|S>>>25),S=T+(A^m&(y^A))+j[5]+1200080426&4294967295,T=m+(S<<12&4294967295|S>>>20),S=A+(y^T&(m^y))+j[6]+2821735955&4294967295,A=T+(S<<17&4294967295|S>>>15),S=y+(m^A&(T^m))+j[7]+4249261313&4294967295,y=A+(S<<22&4294967295|S>>>10),S=m+(T^y&(A^T))+j[8]+1770035416&4294967295,m=y+(S<<7&4294967295|S>>>25),S=T+(A^m&(y^A))+j[9]+2336552879&4294967295,T=m+(S<<12&4294967295|S>>>20),S=A+(y^T&(m^y))+j[10]+4294925233&4294967295,A=T+(S<<17&4294967295|S>>>15),S=y+(m^A&(T^m))+j[11]+2304563134&4294967295,y=A+(S<<22&4294967295|S>>>10),S=m+(T^y&(A^T))+j[12]+1804603682&4294967295,m=y+(S<<7&4294967295|S>>>25),S=T+(A^m&(y^A))+j[13]+4254626195&4294967295,T=m+(S<<12&4294967295|S>>>20),S=A+(y^T&(m^y))+j[14]+2792965006&4294967295,A=T+(S<<17&4294967295|S>>>15),S=y+(m^A&(T^m))+j[15]+1236535329&4294967295,y=A+(S<<22&4294967295|S>>>10),S=m+(A^T&(y^A))+j[1]+4129170786&4294967295,m=y+(S<<5&4294967295|S>>>27),S=T+(y^A&(m^y))+j[6]+3225465664&4294967295,T=m+(S<<9&4294967295|S>>>23),S=A+(m^y&(T^m))+j[11]+643717713&4294967295,A=T+(S<<14&4294967295|S>>>18),S=y+(T^m&(A^T))+j[0]+3921069994&4294967295,y=A+(S<<20&4294967295|S>>>12),S=m+(A^T&(y^A))+j[5]+3593408605&4294967295,m=y+(S<<5&4294967295|S>>>27),S=T+(y^A&(m^y))+j[10]+38016083&4294967295,T=m+(S<<9&4294967295|S>>>23),S=A+(m^y&(T^m))+j[15]+3634488961&4294967295,A=T+(S<<14&4294967295|S>>>18),S=y+(T^m&(A^T))+j[4]+3889429448&4294967295,y=A+(S<<20&4294967295|S>>>12),S=m+(A^T&(y^A))+j[9]+568446438&4294967295,m=y+(S<<5&4294967295|S>>>27),S=T+(y^A&(m^y))+j[14]+3275163606&4294967295,T=m+(S<<9&4294967295|S>>>23),S=A+(m^y&(T^m))+j[3]+4107603335&4294967295,A=T+(S<<14&4294967295|S>>>18),S=y+(T^m&(A^T))+j[8]+1163531501&4294967295,y=A+(S<<20&4294967295|S>>>12),S=m+(A^T&(y^A))+j[13]+2850285829&4294967295,m=y+(S<<5&4294967295|S>>>27),S=T+(y^A&(m^y))+j[2]+4243563512&4294967295,T=m+(S<<9&4294967295|S>>>23),S=A+(m^y&(T^m))+j[7]+1735328473&4294967295,A=T+(S<<14&4294967295|S>>>18),S=y+(T^m&(A^T))+j[12]+2368359562&4294967295,y=A+(S<<20&4294967295|S>>>12),S=m+(y^A^T)+j[5]+4294588738&4294967295,m=y+(S<<4&4294967295|S>>>28),S=T+(m^y^A)+j[8]+2272392833&4294967295,T=m+(S<<11&4294967295|S>>>21),S=A+(T^m^y)+j[11]+1839030562&4294967295,A=T+(S<<16&4294967295|S>>>16),S=y+(A^T^m)+j[14]+4259657740&4294967295,y=A+(S<<23&4294967295|S>>>9),S=m+(y^A^T)+j[1]+2763975236&4294967295,m=y+(S<<4&4294967295|S>>>28),S=T+(m^y^A)+j[4]+1272893353&4294967295,T=m+(S<<11&4294967295|S>>>21),S=A+(T^m^y)+j[7]+4139469664&4294967295,A=T+(S<<16&4294967295|S>>>16),S=y+(A^T^m)+j[10]+3200236656&4294967295,y=A+(S<<23&4294967295|S>>>9),S=m+(y^A^T)+j[13]+681279174&4294967295,m=y+(S<<4&4294967295|S>>>28),S=T+(m^y^A)+j[0]+3936430074&4294967295,T=m+(S<<11&4294967295|S>>>21),S=A+(T^m^y)+j[3]+3572445317&4294967295,A=T+(S<<16&4294967295|S>>>16),S=y+(A^T^m)+j[6]+76029189&4294967295,y=A+(S<<23&4294967295|S>>>9),S=m+(y^A^T)+j[9]+3654602809&4294967295,m=y+(S<<4&4294967295|S>>>28),S=T+(m^y^A)+j[12]+3873151461&4294967295,T=m+(S<<11&4294967295|S>>>21),S=A+(T^m^y)+j[15]+530742520&4294967295,A=T+(S<<16&4294967295|S>>>16),S=y+(A^T^m)+j[2]+3299628645&4294967295,y=A+(S<<23&4294967295|S>>>9),S=m+(A^(y|~T))+j[0]+4096336452&4294967295,m=y+(S<<6&4294967295|S>>>26),S=T+(y^(m|~A))+j[7]+1126891415&4294967295,T=m+(S<<10&4294967295|S>>>22),S=A+(m^(T|~y))+j[14]+2878612391&4294967295,A=T+(S<<15&4294967295|S>>>17),S=y+(T^(A|~m))+j[5]+4237533241&4294967295,y=A+(S<<21&4294967295|S>>>11),S=m+(A^(y|~T))+j[12]+1700485571&4294967295,m=y+(S<<6&4294967295|S>>>26),S=T+(y^(m|~A))+j[3]+2399980690&4294967295,T=m+(S<<10&4294967295|S>>>22),S=A+(m^(T|~y))+j[10]+4293915773&4294967295,A=T+(S<<15&4294967295|S>>>17),S=y+(T^(A|~m))+j[1]+2240044497&4294967295,y=A+(S<<21&4294967295|S>>>11),S=m+(A^(y|~T))+j[8]+1873313359&4294967295,m=y+(S<<6&4294967295|S>>>26),S=T+(y^(m|~A))+j[15]+4264355552&4294967295,T=m+(S<<10&4294967295|S>>>22),S=A+(m^(T|~y))+j[6]+2734768916&4294967295,A=T+(S<<15&4294967295|S>>>17),S=y+(T^(A|~m))+j[13]+1309151649&4294967295,y=A+(S<<21&4294967295|S>>>11),S=m+(A^(y|~T))+j[4]+4149444226&4294967295,m=y+(S<<6&4294967295|S>>>26),S=T+(y^(m|~A))+j[11]+3174756917&4294967295,T=m+(S<<10&4294967295|S>>>22),S=A+(m^(T|~y))+j[2]+718787259&4294967295,A=T+(S<<15&4294967295|S>>>17),S=y+(T^(A|~m))+j[9]+3951481745&4294967295,E.g[0]=E.g[0]+m&4294967295,E.g[1]=E.g[1]+(A+(S<<21&4294967295|S>>>11))&4294967295,E.g[2]=E.g[2]+A&4294967295,E.g[3]=E.g[3]+T&4294967295}r.prototype.u=function(E,m){m===void 0&&(m=E.length);for(var y=m-this.blockSize,j=this.B,A=this.h,T=0;T<m;){if(A==0)for(;T<=y;)i(this,E,T),T+=this.blockSize;if(typeof E=="string"){for(;T<m;)if(j[A++]=E.charCodeAt(T++),A==this.blockSize){i(this,j),A=0;break}}else for(;T<m;)if(j[A++]=E[T++],A==this.blockSize){i(this,j),A=0;break}}this.h=A,this.o+=m},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var m=1;m<E.length-8;++m)E[m]=0;var y=8*this.o;for(m=E.length-8;m<E.length;++m)E[m]=y&255,y/=256;for(this.u(E),E=Array(16),m=y=0;4>m;++m)for(var j=0;32>j;j+=8)E[y++]=this.g[m]>>>j&255;return E};function a(E,m){var y=l;return Object.prototype.hasOwnProperty.call(y,E)?y[E]:y[E]=m(E)}function o(E,m){this.h=m;for(var y=[],j=!0,A=E.length-1;0<=A;A--){var T=E[A]|0;j&&T==m||(y[A]=T,j=!1)}this.g=y}var l={};function u(E){return-128<=E&&128>E?a(E,function(m){return new o([m|0],0>m?-1:0)}):new o([E|0],0>E?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return g;if(0>E)return I(d(-E));for(var m=[],y=1,j=0;E>=y;j++)m[j]=E/y|0,y*=4294967296;return new o(m,0)}function h(E,m){if(E.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(E.charAt(0)=="-")return I(h(E.substring(1),m));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var y=d(Math.pow(m,8)),j=g,A=0;A<E.length;A+=8){var T=Math.min(8,E.length-A),S=parseInt(E.substring(A,A+T),m);8>T?(T=d(Math.pow(m,T)),j=j.j(T).add(d(S))):(j=j.j(y),j=j.add(d(S)))}return j}var g=u(0),x=u(1),N=u(16777216);t=o.prototype,t.m=function(){if(k(this))return-I(this).m();for(var E=0,m=1,y=0;y<this.g.length;y++){var j=this.i(y);E+=(0<=j?j:4294967296+j)*m,m*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(w(this))return"0";if(k(this))return"-"+I(this).toString(E);for(var m=d(Math.pow(E,6)),y=this,j="";;){var A=P(y,m).g;y=C(y,A.j(m));var T=((0<y.g.length?y.g[0]:y.h)>>>0).toString(E);if(y=A,w(y))return T+j;for(;6>T.length;)T="0"+T;j=T+j}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function w(E){if(E.h!=0)return!1;for(var m=0;m<E.g.length;m++)if(E.g[m]!=0)return!1;return!0}function k(E){return E.h==-1}t.l=function(E){return E=C(this,E),k(E)?-1:w(E)?0:1};function I(E){for(var m=E.g.length,y=[],j=0;j<m;j++)y[j]=~E.g[j];return new o(y,~E.h).add(x)}t.abs=function(){return k(this)?I(this):this},t.add=function(E){for(var m=Math.max(this.g.length,E.g.length),y=[],j=0,A=0;A<=m;A++){var T=j+(this.i(A)&65535)+(E.i(A)&65535),S=(T>>>16)+(this.i(A)>>>16)+(E.i(A)>>>16);j=S>>>16,T&=65535,S&=65535,y[A]=S<<16|T}return new o(y,y[y.length-1]&-2147483648?-1:0)};function C(E,m){return E.add(I(m))}t.j=function(E){if(w(this)||w(E))return g;if(k(this))return k(E)?I(this).j(I(E)):I(I(this).j(E));if(k(E))return I(this.j(I(E)));if(0>this.l(N)&&0>E.l(N))return d(this.m()*E.m());for(var m=this.g.length+E.g.length,y=[],j=0;j<2*m;j++)y[j]=0;for(j=0;j<this.g.length;j++)for(var A=0;A<E.g.length;A++){var T=this.i(j)>>>16,S=this.i(j)&65535,G=E.i(A)>>>16,Z=E.i(A)&65535;y[2*j+2*A]+=S*Z,_(y,2*j+2*A),y[2*j+2*A+1]+=T*Z,_(y,2*j+2*A+1),y[2*j+2*A+1]+=S*G,_(y,2*j+2*A+1),y[2*j+2*A+2]+=T*G,_(y,2*j+2*A+2)}for(j=0;j<m;j++)y[j]=y[2*j+1]<<16|y[2*j];for(j=m;j<2*m;j++)y[j]=0;return new o(y,0)};function _(E,m){for(;(E[m]&65535)!=E[m];)E[m+1]+=E[m]>>>16,E[m]&=65535,m++}function v(E,m){this.g=E,this.h=m}function P(E,m){if(w(m))throw Error("division by zero");if(w(E))return new v(g,g);if(k(E))return m=P(I(E),m),new v(I(m.g),I(m.h));if(k(m))return m=P(E,I(m)),new v(I(m.g),m.h);if(30<E.g.length){if(k(E)||k(m))throw Error("slowDivide_ only works with positive integers.");for(var y=x,j=m;0>=j.l(E);)y=D(y),j=D(j);var A=L(y,1),T=L(j,1);for(j=L(j,2),y=L(y,2);!w(j);){var S=T.add(j);0>=S.l(E)&&(A=A.add(y),T=S),j=L(j,1),y=L(y,1)}return m=C(E,A.j(m)),new v(A,m)}for(A=g;0<=E.l(m);){for(y=Math.max(1,Math.floor(E.m()/m.m())),j=Math.ceil(Math.log(y)/Math.LN2),j=48>=j?1:Math.pow(2,j-48),T=d(y),S=T.j(m);k(S)||0<S.l(E);)y-=j,T=d(y),S=T.j(m);w(T)&&(T=x),A=A.add(T),E=C(E,S)}return new v(A,E)}t.A=function(E){return P(this,E).h},t.and=function(E){for(var m=Math.max(this.g.length,E.g.length),y=[],j=0;j<m;j++)y[j]=this.i(j)&E.i(j);return new o(y,this.h&E.h)},t.or=function(E){for(var m=Math.max(this.g.length,E.g.length),y=[],j=0;j<m;j++)y[j]=this.i(j)|E.i(j);return new o(y,this.h|E.h)},t.xor=function(E){for(var m=Math.max(this.g.length,E.g.length),y=[],j=0;j<m;j++)y[j]=this.i(j)^E.i(j);return new o(y,this.h^E.h)};function D(E){for(var m=E.g.length+1,y=[],j=0;j<m;j++)y[j]=E.i(j)<<1|E.i(j-1)>>>31;return new o(y,E.h)}function L(E,m){var y=m>>5;m%=32;for(var j=E.g.length-y,A=[],T=0;T<j;T++)A[T]=0<m?E.i(T+y)>>>m|E.i(T+y+1)<<32-m:E.i(T+y);return new o(A,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,H1=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Ns=o}).apply(typeof Ag<"u"?Ag:typeof self<"u"?self:typeof window<"u"?window:{});var Fl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var W1,to,Y1,hc,Zh,K1,X1,J1;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,p,b){return c==Array.prototype||c==Object.prototype||(c[p]=b.value),c};function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Fl=="object"&&Fl];for(var p=0;p<c.length;++p){var b=c[p];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}var r=n(this);function i(c,p){if(p)e:{var b=r;c=c.split(".");for(var R=0;R<c.length-1;R++){var U=c[R];if(!(U in b))break e;b=b[U]}c=c[c.length-1],R=b[c],p=p(R),p!=R&&p!=null&&e(b,c,{configurable:!0,writable:!0,value:p})}}function a(c,p){c instanceof String&&(c+="");var b=0,R=!1,U={next:function(){if(!R&&b<c.length){var Y=b++;return{value:p(Y,c[Y]),done:!1}}return R=!0,{done:!0,value:void 0}}};return U[Symbol.iterator]=function(){return U},U}i("Array.prototype.values",function(c){return c||function(){return a(this,function(p,b){return b})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(c){var p=typeof c;return p=p!="object"?p:c?Array.isArray(c)?"array":p:"null",p=="array"||p=="object"&&typeof c.length=="number"}function d(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function h(c,p,b){return c.call.apply(c.bind,arguments)}function g(c,p,b){if(!c)throw Error();if(2<arguments.length){var R=Array.prototype.slice.call(arguments,2);return function(){var U=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(U,R),c.apply(p,U)}}return function(){return c.apply(p,arguments)}}function x(c,p,b){return x=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:g,x.apply(null,arguments)}function N(c,p){var b=Array.prototype.slice.call(arguments,1);return function(){var R=b.slice();return R.push.apply(R,arguments),c.apply(this,R)}}function w(c,p){function b(){}b.prototype=p.prototype,c.aa=p.prototype,c.prototype=new b,c.prototype.constructor=c,c.Qb=function(R,U,Y){for(var fe=Array(arguments.length-2),lt=2;lt<arguments.length;lt++)fe[lt-2]=arguments[lt];return p.prototype[U].apply(R,fe)}}function k(c){const p=c.length;if(0<p){const b=Array(p);for(let R=0;R<p;R++)b[R]=c[R];return b}return[]}function I(c,p){for(let b=1;b<arguments.length;b++){const R=arguments[b];if(u(R)){const U=c.length||0,Y=R.length||0;c.length=U+Y;for(let fe=0;fe<Y;fe++)c[U+fe]=R[fe]}else c.push(R)}}class C{constructor(p,b){this.i=p,this.j=b,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function _(c){return/^[\s\xa0]*$/.test(c)}function v(){var c=l.navigator;return c&&(c=c.userAgent)?c:""}function P(c){return P[" "](c),c}P[" "]=function(){};var D=v().indexOf("Gecko")!=-1&&!(v().toLowerCase().indexOf("webkit")!=-1&&v().indexOf("Edge")==-1)&&!(v().indexOf("Trident")!=-1||v().indexOf("MSIE")!=-1)&&v().indexOf("Edge")==-1;function L(c,p,b){for(const R in c)p.call(b,c[R],R,c)}function E(c,p){for(const b in c)p.call(void 0,c[b],b,c)}function m(c){const p={};for(const b in c)p[b]=c[b];return p}const y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j(c,p){let b,R;for(let U=1;U<arguments.length;U++){R=arguments[U];for(b in R)c[b]=R[b];for(let Y=0;Y<y.length;Y++)b=y[Y],Object.prototype.hasOwnProperty.call(R,b)&&(c[b]=R[b])}}function A(c){var p=1;c=c.split(":");const b=[];for(;0<p&&c.length;)b.push(c.shift()),p--;return c.length&&b.push(c.join(":")),b}function T(c){l.setTimeout(()=>{throw c},0)}function S(){var c=O;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class G{constructor(){this.h=this.g=null}add(p,b){const R=Z.get();R.set(p,b),this.h?this.h.next=R:this.g=R,this.h=R}}var Z=new C(()=>new te,c=>c.reset());class te{constructor(){this.next=this.g=this.h=null}set(p,b){this.h=p,this.g=b,this.next=null}reset(){this.next=this.g=this.h=null}}let K,$=!1,O=new G,V=()=>{const c=l.Promise.resolve(void 0);K=()=>{c.then(B)}};var B=()=>{for(var c;c=S();){try{c.h.call(c.g)}catch(b){T(b)}var p=Z;p.j(c),100>p.h&&(p.h++,c.next=p.g,p.g=c)}$=!1};function M(){this.s=this.s,this.C=this.C}M.prototype.s=!1,M.prototype.ma=function(){this.s||(this.s=!0,this.N())},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var H=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const b=()=>{};l.addEventListener("test",b,p),l.removeEventListener("test",b,p)}catch{}return c}();function ne(c,p){if(z.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var b=this.type=c.type,R=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget){if(D){e:{try{P(p.nodeName);var U=!0;break e}catch{}U=!1}U||(p=null)}}else b=="mouseover"?p=c.fromElement:b=="mouseout"&&(p=c.toElement);this.relatedTarget=p,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:q[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&ne.aa.h.call(this)}}w(ne,z);var q={2:"touch",3:"pen",4:"mouse"};ne.prototype.h=function(){ne.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var ee="closure_listenable_"+(1e6*Math.random()|0),X=0;function Q(c,p,b,R,U){this.listener=c,this.proxy=null,this.src=p,this.type=b,this.capture=!!R,this.ha=U,this.key=++X,this.da=this.fa=!1}function oe(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function ue(c){this.src=c,this.g={},this.h=0}ue.prototype.add=function(c,p,b,R,U){var Y=c.toString();c=this.g[Y],c||(c=this.g[Y]=[],this.h++);var fe=ce(c,p,R,U);return-1<fe?(p=c[fe],b||(p.fa=!1)):(p=new Q(p,this.src,Y,!!R,U),p.fa=b,c.push(p)),p};function ae(c,p){var b=p.type;if(b in c.g){var R=c.g[b],U=Array.prototype.indexOf.call(R,p,void 0),Y;(Y=0<=U)&&Array.prototype.splice.call(R,U,1),Y&&(oe(p),c.g[b].length==0&&(delete c.g[b],c.h--))}}function ce(c,p,b,R){for(var U=0;U<c.length;++U){var Y=c[U];if(!Y.da&&Y.listener==p&&Y.capture==!!b&&Y.ha==R)return U}return-1}var J="closure_lm_"+(1e6*Math.random()|0),W={};function F(c,p,b,R,U){if(R&&R.once)return pe(c,p,b,R,U);if(Array.isArray(p)){for(var Y=0;Y<p.length;Y++)F(c,p[Y],b,R,U);return null}return b=Te(b),c&&c[ee]?c.K(p,b,d(R)?!!R.capture:!!R,U):re(c,p,b,!1,R,U)}function re(c,p,b,R,U,Y){if(!p)throw Error("Invalid event type");var fe=d(U)?!!U.capture:!!U,lt=Be(c);if(lt||(c[J]=lt=new ue(c)),b=lt.add(p,b,R,fe,Y),b.proxy)return b;if(R=le(),b.proxy=R,R.src=c,R.listener=b,c.addEventListener)H||(U=fe),U===void 0&&(U=!1),c.addEventListener(p.toString(),R,U);else if(c.attachEvent)c.attachEvent(De(p.toString()),R);else if(c.addListener&&c.removeListener)c.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return b}function le(){function c(b){return p.call(c.src,c.listener,b)}const p=xt;return c}function pe(c,p,b,R,U){if(Array.isArray(p)){for(var Y=0;Y<p.length;Y++)pe(c,p[Y],b,R,U);return null}return b=Te(b),c&&c[ee]?c.L(p,b,d(R)?!!R.capture:!!R,U):re(c,p,b,!0,R,U)}function Ne(c,p,b,R,U){if(Array.isArray(p))for(var Y=0;Y<p.length;Y++)Ne(c,p[Y],b,R,U);else R=d(R)?!!R.capture:!!R,b=Te(b),c&&c[ee]?(c=c.i,p=String(p).toString(),p in c.g&&(Y=c.g[p],b=ce(Y,b,R,U),-1<b&&(oe(Y[b]),Array.prototype.splice.call(Y,b,1),Y.length==0&&(delete c.g[p],c.h--)))):c&&(c=Be(c))&&(p=c.g[p.toString()],c=-1,p&&(c=ce(p,b,R,U)),(b=-1<c?p[c]:null)&&Pe(b))}function Pe(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[ee])ae(p.i,c);else{var b=c.type,R=c.proxy;p.removeEventListener?p.removeEventListener(b,R,c.capture):p.detachEvent?p.detachEvent(De(b),R):p.addListener&&p.removeListener&&p.removeListener(R),(b=Be(p))?(ae(b,c),b.h==0&&(b.src=null,p[J]=null)):oe(c)}}}function De(c){return c in W?W[c]:W[c]="on"+c}function xt(c,p){if(c.da)c=!0;else{p=new ne(p,this);var b=c.listener,R=c.ha||c.src;c.fa&&Pe(c),c=b.call(R,p)}return c}function Be(c){return c=c[J],c instanceof ue?c:null}var ge="__closure_events_fn_"+(1e9*Math.random()>>>0);function Te(c){return typeof c=="function"?c:(c[ge]||(c[ge]=function(p){return c.handleEvent(p)}),c[ge])}function Ie(){M.call(this),this.i=new ue(this),this.M=this,this.F=null}w(Ie,M),Ie.prototype[ee]=!0,Ie.prototype.removeEventListener=function(c,p,b,R){Ne(this,c,p,b,R)};function Me(c,p){var b,R=c.F;if(R)for(b=[];R;R=R.F)b.push(R);if(c=c.M,R=p.type||p,typeof p=="string")p=new z(p,c);else if(p instanceof z)p.target=p.target||c;else{var U=p;p=new z(R,c),j(p,U)}if(U=!0,b)for(var Y=b.length-1;0<=Y;Y--){var fe=p.g=b[Y];U=Oe(fe,R,!0,p)&&U}if(fe=p.g=c,U=Oe(fe,R,!0,p)&&U,U=Oe(fe,R,!1,p)&&U,b)for(Y=0;Y<b.length;Y++)fe=p.g=b[Y],U=Oe(fe,R,!1,p)&&U}Ie.prototype.N=function(){if(Ie.aa.N.call(this),this.i){var c=this.i,p;for(p in c.g){for(var b=c.g[p],R=0;R<b.length;R++)oe(b[R]);delete c.g[p],c.h--}}this.F=null},Ie.prototype.K=function(c,p,b,R){return this.i.add(String(c),p,!1,b,R)},Ie.prototype.L=function(c,p,b,R){return this.i.add(String(c),p,!0,b,R)};function Oe(c,p,b,R){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();for(var U=!0,Y=0;Y<p.length;++Y){var fe=p[Y];if(fe&&!fe.da&&fe.capture==b){var lt=fe.listener,Wt=fe.ha||fe.src;fe.fa&&ae(c.i,fe),U=lt.call(Wt,R)!==!1&&U}}return U&&!R.defaultPrevented}function yt(c,p,b){if(typeof c=="function")b&&(c=x(c,b));else if(c&&typeof c.handleEvent=="function")c=x(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:l.setTimeout(c,p||0)}function Vt(c){c.g=yt(()=>{c.g=null,c.i&&(c.i=!1,Vt(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class wt extends M{constructor(p,b){super(),this.m=p,this.l=b,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Vt(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ge(c){M.call(this),this.h=c,this.g={}}w(Ge,M);var ot=[];function qt(c){L(c.g,function(p,b){this.g.hasOwnProperty(b)&&Pe(p)},c),c.g={}}Ge.prototype.N=function(){Ge.aa.N.call(this),qt(this)},Ge.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Cn=l.JSON.stringify,tn=l.JSON.parse,mn=class{stringify(c){return l.JSON.stringify(c,void 0)}parse(c){return l.JSON.parse(c,void 0)}};function Tn(){}Tn.prototype.h=null;function hr(c){return c.h||(c.h=c.i())}function me(){}var Se={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ue(){z.call(this,"d")}w(Ue,z);function Fe(){z.call(this,"c")}w(Fe,z);var nt={},ze=null;function rt(){return ze=ze||new Ie}nt.La="serverreachability";function Ze(c){z.call(this,nt.La,c)}w(Ze,z);function ve(c){const p=rt();Me(p,new Ze(p))}nt.STAT_EVENT="statevent";function Ee(c,p){z.call(this,nt.STAT_EVENT,c),this.stat=p}w(Ee,z);function ke(c){const p=rt();Me(p,new Ee(p,c))}nt.Ma="timingevent";function at(c,p){z.call(this,nt.Ma,c),this.size=p}w(at,z);function st(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){c()},p)}function he(){this.g=!0}he.prototype.xa=function(){this.g=!1};function je(c,p,b,R,U,Y){c.info(function(){if(c.g)if(Y)for(var fe="",lt=Y.split("&"),Wt=0;Wt<lt.length;Wt++){var Je=lt[Wt].split("=");if(1<Je.length){var nn=Je[0];Je=Je[1];var rn=nn.split("_");fe=2<=rn.length&&rn[1]=="type"?fe+(nn+"="+Je+"&"):fe+(nn+"=redacted&")}}else fe=null;else fe=Y;return"XMLHTTP REQ ("+R+") [attempt "+U+"]: "+p+`
`+b+`
`+fe})}function Ke(c,p,b,R,U,Y,fe){c.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+U+"]: "+p+`
`+b+`
`+Y+" "+fe})}function He(c,p,b,R){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+zt(c,b)+(R?" "+R:"")})}function Xe(c,p){c.info(function(){return"TIMEOUT: "+p})}he.prototype.info=function(){};function zt(c,p){if(!c.g)return p;if(!p)return null;try{var b=JSON.parse(p);if(b){for(c=0;c<b.length;c++)if(Array.isArray(b[c])){var R=b[c];if(!(2>R.length)){var U=R[1];if(Array.isArray(U)&&!(1>U.length)){var Y=U[0];if(Y!="noop"&&Y!="stop"&&Y!="close")for(var fe=1;fe<U.length;fe++)U[fe]=""}}}}return Cn(b)}catch{return p}}var It={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},In={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Zn;function Er(){}w(Er,Tn),Er.prototype.g=function(){return new XMLHttpRequest},Er.prototype.i=function(){return{}},Zn=new Er;function Bn(c,p,b,R){this.j=c,this.i=p,this.l=b,this.R=R||1,this.U=new Ge(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new wp}function wp(){this.i=null,this.g="",this.h=!1}var Np={},Ku={};function Xu(c,p,b){c.L=1,c.v=dl(Cr(p)),c.m=b,c.P=!0,jp(c,null)}function jp(c,p){c.F=Date.now(),ll(c),c.A=Cr(c.v);var b=c.A,R=c.R;Array.isArray(R)||(R=[String(R)]),Op(b.i,"t",R),c.C=0,b=c.j.J,c.h=new wp,c.g=t0(c.j,b?p:null,!c.m),0<c.O&&(c.M=new wt(x(c.Y,c,c.g),c.O)),p=c.U,b=c.g,R=c.ca;var U="readystatechange";Array.isArray(U)||(U&&(ot[0]=U.toString()),U=ot);for(var Y=0;Y<U.length;Y++){var fe=F(b,U[Y],R||p.handleEvent,!1,p.h||p);if(!fe)break;p.g[fe.key]=fe}p=c.H?m(c.H):{},c.m?(c.u||(c.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,p)):(c.u="GET",c.g.ea(c.A,c.u,null,p)),ve(),je(c.i,c.u,c.A,c.l,c.R,c.m)}Bn.prototype.ca=function(c){c=c.target;const p=this.M;p&&Tr(c)==3?p.j():this.Y(c)},Bn.prototype.Y=function(c){try{if(c==this.g)e:{const rn=Tr(this.g);var p=this.g.Ba();const Si=this.g.Z();if(!(3>rn)&&(rn!=3||this.g&&(this.h.h||this.g.oa()||qp(this.g)))){this.J||rn!=4||p==7||(p==8||0>=Si?ve(3):ve(2)),Ju(this);var b=this.g.Z();this.X=b;t:if(Sp(this)){var R=qp(this.g);c="";var U=R.length,Y=Tr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Bs(this),Ta(this);var fe="";break t}this.h.i=new l.TextDecoder}for(p=0;p<U;p++)this.h.h=!0,c+=this.h.i.decode(R[p],{stream:!(Y&&p==U-1)});R.length=0,this.h.g+=c,this.C=0,fe=this.h.g}else fe=this.g.oa();if(this.o=b==200,Ke(this.i,this.u,this.A,this.l,this.R,rn,b),this.o){if(this.T&&!this.K){t:{if(this.g){var lt,Wt=this.g;if((lt=Wt.g?Wt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(lt)){var Je=lt;break t}}Je=null}if(b=Je)He(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Zu(this,b);else{this.o=!1,this.s=3,ke(12),Bs(this),Ta(this);break e}}if(this.P){b=!0;let er;for(;!this.J&&this.C<fe.length;)if(er=a2(this,fe),er==Ku){rn==4&&(this.s=4,ke(14),b=!1),He(this.i,this.l,null,"[Incomplete Response]");break}else if(er==Np){this.s=4,ke(15),He(this.i,this.l,fe,"[Invalid Chunk]"),b=!1;break}else He(this.i,this.l,er,null),Zu(this,er);if(Sp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),rn!=4||fe.length!=0||this.h.h||(this.s=1,ke(16),b=!1),this.o=this.o&&b,!b)He(this.i,this.l,fe,"[Invalid Chunked Response]"),Bs(this),Ta(this);else if(0<fe.length&&!this.W){this.W=!0;var nn=this.j;nn.g==this&&nn.ba&&!nn.M&&(nn.j.info("Great, no buffering proxy detected. Bytes received: "+fe.length),id(nn),nn.M=!0,ke(11))}}else He(this.i,this.l,fe,null),Zu(this,fe);rn==4&&Bs(this),this.o&&!this.J&&(rn==4?Xp(this.j,this):(this.o=!1,ll(this)))}else j2(this.g),b==400&&0<fe.indexOf("Unknown SID")?(this.s=3,ke(12)):(this.s=0,ke(13)),Bs(this),Ta(this)}}}catch{}finally{}};function Sp(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function a2(c,p){var b=c.C,R=p.indexOf(`
`,b);return R==-1?Ku:(b=Number(p.substring(b,R)),isNaN(b)?Np:(R+=1,R+b>p.length?Ku:(p=p.slice(R,R+b),c.C=R+b,p)))}Bn.prototype.cancel=function(){this.J=!0,Bs(this)};function ll(c){c.S=Date.now()+c.I,_p(c,c.I)}function _p(c,p){if(c.B!=null)throw Error("WatchDog timer not null");c.B=st(x(c.ba,c),p)}function Ju(c){c.B&&(l.clearTimeout(c.B),c.B=null)}Bn.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(Xe(this.i,this.A),this.L!=2&&(ve(),ke(17)),Bs(this),this.s=2,Ta(this)):_p(this,this.S-c)};function Ta(c){c.j.G==0||c.J||Xp(c.j,c)}function Bs(c){Ju(c);var p=c.M;p&&typeof p.ma=="function"&&p.ma(),c.M=null,qt(c.U),c.g&&(p=c.g,c.g=null,p.abort(),p.ma())}function Zu(c,p){try{var b=c.j;if(b.G!=0&&(b.g==c||ed(b.h,c))){if(!c.K&&ed(b.h,c)&&b.G==3){try{var R=b.Da.g.parse(p)}catch{R=null}if(Array.isArray(R)&&R.length==3){var U=R;if(U[0]==0){e:if(!b.u){if(b.g)if(b.g.F+3e3<c.F)xl(b),pl(b);else break e;sd(b),ke(18)}}else b.za=U[1],0<b.za-b.T&&37500>U[2]&&b.F&&b.v==0&&!b.C&&(b.C=st(x(b.Za,b),6e3));if(1>=Cp(b.h)&&b.ca){try{b.ca()}catch{}b.ca=void 0}}else qs(b,11)}else if((c.K||b.g==c)&&xl(b),!_(p))for(U=b.Da.g.parse(p),p=0;p<U.length;p++){let Je=U[p];if(b.T=Je[0],Je=Je[1],b.G==2)if(Je[0]=="c"){b.K=Je[1],b.ia=Je[2];const nn=Je[3];nn!=null&&(b.la=nn,b.j.info("VER="+b.la));const rn=Je[4];rn!=null&&(b.Aa=rn,b.j.info("SVER="+b.Aa));const Si=Je[5];Si!=null&&typeof Si=="number"&&0<Si&&(R=1.5*Si,b.L=R,b.j.info("backChannelRequestTimeoutMs_="+R)),R=b;const er=c.g;if(er){const vl=er.g?er.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(vl){var Y=R.h;Y.g||vl.indexOf("spdy")==-1&&vl.indexOf("quic")==-1&&vl.indexOf("h2")==-1||(Y.j=Y.l,Y.g=new Set,Y.h&&(td(Y,Y.h),Y.h=null))}if(R.D){const ad=er.g?er.g.getResponseHeader("X-HTTP-Session-Id"):null;ad&&(R.ya=ad,dt(R.I,R.D,ad))}}b.G=3,b.l&&b.l.ua(),b.ba&&(b.R=Date.now()-c.F,b.j.info("Handshake RTT: "+b.R+"ms")),R=b;var fe=c;if(R.qa=e0(R,R.J?R.ia:null,R.W),fe.K){Tp(R.h,fe);var lt=fe,Wt=R.L;Wt&&(lt.I=Wt),lt.B&&(Ju(lt),ll(lt)),R.g=fe}else Yp(R);0<b.i.length&&gl(b)}else Je[0]!="stop"&&Je[0]!="close"||qs(b,7);else b.G==3&&(Je[0]=="stop"||Je[0]=="close"?Je[0]=="stop"?qs(b,7):rd(b):Je[0]!="noop"&&b.l&&b.l.ta(Je),b.v=0)}}ve(4)}catch{}}var o2=class{constructor(c,p){this.g=c,this.map=p}};function kp(c){this.l=c||10,l.PerformanceNavigationTiming?(c=l.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ep(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Cp(c){return c.h?1:c.g?c.g.size:0}function ed(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function td(c,p){c.g?c.g.add(p):c.h=p}function Tp(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}kp.prototype.cancel=function(){if(this.i=Ip(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Ip(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const b of c.g.values())p=p.concat(b.D);return p}return k(c.i)}function l2(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(u(c)){for(var p=[],b=c.length,R=0;R<b;R++)p.push(c[R]);return p}p=[],b=0;for(R in c)p[b++]=c[R];return p}function c2(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(u(c)||typeof c=="string"){var p=[];c=c.length;for(var b=0;b<c;b++)p.push(b);return p}p=[],b=0;for(const R in c)p[b++]=R;return p}}}function Ap(c,p){if(c.forEach&&typeof c.forEach=="function")c.forEach(p,void 0);else if(u(c)||typeof c=="string")Array.prototype.forEach.call(c,p,void 0);else for(var b=c2(c),R=l2(c),U=R.length,Y=0;Y<U;Y++)p.call(void 0,R[Y],b&&b[Y],c)}var Rp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function u2(c,p){if(c){c=c.split("&");for(var b=0;b<c.length;b++){var R=c[b].indexOf("="),U=null;if(0<=R){var Y=c[b].substring(0,R);U=c[b].substring(R+1)}else Y=c[b];p(Y,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function Us(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Us){this.h=c.h,cl(this,c.j),this.o=c.o,this.g=c.g,ul(this,c.s),this.l=c.l;var p=c.i,b=new Ra;b.i=p.i,p.g&&(b.g=new Map(p.g),b.h=p.h),Pp(this,b),this.m=c.m}else c&&(p=String(c).match(Rp))?(this.h=!1,cl(this,p[1]||"",!0),this.o=Ia(p[2]||""),this.g=Ia(p[3]||"",!0),ul(this,p[4]),this.l=Ia(p[5]||"",!0),Pp(this,p[6]||"",!0),this.m=Ia(p[7]||"")):(this.h=!1,this.i=new Ra(null,this.h))}Us.prototype.toString=function(){var c=[],p=this.j;p&&c.push(Aa(p,Dp,!0),":");var b=this.g;return(b||p=="file")&&(c.push("//"),(p=this.o)&&c.push(Aa(p,Dp,!0),"@"),c.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.s,b!=null&&c.push(":",String(b))),(b=this.l)&&(this.g&&b.charAt(0)!="/"&&c.push("/"),c.push(Aa(b,b.charAt(0)=="/"?f2:h2,!0))),(b=this.i.toString())&&c.push("?",b),(b=this.m)&&c.push("#",Aa(b,p2)),c.join("")};function Cr(c){return new Us(c)}function cl(c,p,b){c.j=b?Ia(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function ul(c,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);c.s=p}else c.s=null}function Pp(c,p,b){p instanceof Ra?(c.i=p,g2(c.i,c.h)):(b||(p=Aa(p,m2)),c.i=new Ra(p,c.h))}function dt(c,p,b){c.i.set(p,b)}function dl(c){return dt(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Ia(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Aa(c,p,b){return typeof c=="string"?(c=encodeURI(c).replace(p,d2),b&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function d2(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Dp=/[#\/\?@]/g,h2=/[#\?:]/g,f2=/[#\?]/g,m2=/[#\?@]/g,p2=/#/g;function Ra(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function Yr(c){c.g||(c.g=new Map,c.h=0,c.i&&u2(c.i,function(p,b){c.add(decodeURIComponent(p.replace(/\+/g," ")),b)}))}t=Ra.prototype,t.add=function(c,p){Yr(this),this.i=null,c=Ni(this,c);var b=this.g.get(c);return b||this.g.set(c,b=[]),b.push(p),this.h+=1,this};function Mp(c,p){Yr(c),p=Ni(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function Lp(c,p){return Yr(c),p=Ni(c,p),c.g.has(p)}t.forEach=function(c,p){Yr(this),this.g.forEach(function(b,R){b.forEach(function(U){c.call(p,U,R,this)},this)},this)},t.na=function(){Yr(this);const c=Array.from(this.g.values()),p=Array.from(this.g.keys()),b=[];for(let R=0;R<p.length;R++){const U=c[R];for(let Y=0;Y<U.length;Y++)b.push(p[R])}return b},t.V=function(c){Yr(this);let p=[];if(typeof c=="string")Lp(this,c)&&(p=p.concat(this.g.get(Ni(this,c))));else{c=Array.from(this.g.values());for(let b=0;b<c.length;b++)p=p.concat(c[b])}return p},t.set=function(c,p){return Yr(this),this.i=null,c=Ni(this,c),Lp(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},t.get=function(c,p){return c?(c=this.V(c),0<c.length?String(c[0]):p):p};function Op(c,p,b){Mp(c,p),0<b.length&&(c.i=null,c.g.set(Ni(c,p),k(b)),c.h+=b.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(var b=0;b<p.length;b++){var R=p[b];const Y=encodeURIComponent(String(R)),fe=this.V(R);for(R=0;R<fe.length;R++){var U=Y;fe[R]!==""&&(U+="="+encodeURIComponent(String(fe[R]))),c.push(U)}}return this.i=c.join("&")};function Ni(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function g2(c,p){p&&!c.j&&(Yr(c),c.i=null,c.g.forEach(function(b,R){var U=R.toLowerCase();R!=U&&(Mp(this,R),Op(this,U,b))},c)),c.j=p}function x2(c,p){const b=new he;if(l.Image){const R=new Image;R.onload=N(Kr,b,"TestLoadImage: loaded",!0,p,R),R.onerror=N(Kr,b,"TestLoadImage: error",!1,p,R),R.onabort=N(Kr,b,"TestLoadImage: abort",!1,p,R),R.ontimeout=N(Kr,b,"TestLoadImage: timeout",!1,p,R),l.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=c}else p(!1)}function y2(c,p){const b=new he,R=new AbortController,U=setTimeout(()=>{R.abort(),Kr(b,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:R.signal}).then(Y=>{clearTimeout(U),Y.ok?Kr(b,"TestPingServer: ok",!0,p):Kr(b,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(U),Kr(b,"TestPingServer: error",!1,p)})}function Kr(c,p,b,R,U){try{U&&(U.onload=null,U.onerror=null,U.onabort=null,U.ontimeout=null),R(b)}catch{}}function v2(){this.g=new mn}function b2(c,p,b){const R=b||"";try{Ap(c,function(U,Y){let fe=U;d(U)&&(fe=Cn(U)),p.push(R+Y+"="+encodeURIComponent(fe))})}catch(U){throw p.push(R+"type="+encodeURIComponent("_badmap")),U}}function hl(c){this.l=c.Ub||null,this.j=c.eb||!1}w(hl,Tn),hl.prototype.g=function(){return new fl(this.l,this.j)},hl.prototype.i=function(c){return function(){return c}}({});function fl(c,p){Ie.call(this),this.D=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(fl,Ie),t=fl.prototype,t.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=p,this.readyState=1,Da(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(p.body=c),(this.D||l).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Pa(this)),this.readyState=0},t.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Da(this)),this.g&&(this.readyState=3,Da(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Fp(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function Fp(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}t.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?Pa(this):Da(this),this.readyState==3&&Fp(this)}},t.Ra=function(c){this.g&&(this.response=this.responseText=c,Pa(this))},t.Qa=function(c){this.g&&(this.response=c,Pa(this))},t.ga=function(){this.g&&Pa(this)};function Pa(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Da(c)}t.setRequestHeader=function(c,p){this.u.append(c,p)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var b=p.next();!b.done;)b=b.value,c.push(b[0]+": "+b[1]),b=p.next();return c.join(`\r
`)};function Da(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(fl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Vp(c){let p="";return L(c,function(b,R){p+=R,p+=":",p+=b,p+=`\r
`}),p}function nd(c,p,b){e:{for(R in b){var R=!1;break e}R=!0}R||(b=Vp(b),typeof c=="string"?b!=null&&encodeURIComponent(String(b)):dt(c,p,b))}function Et(c){Ie.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(Et,Ie);var w2=/^https?$/i,N2=["POST","PUT"];t=Et.prototype,t.Ha=function(c){this.J=c},t.ea=function(c,p,b,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Zn.g(),this.v=this.o?hr(this.o):hr(Zn),this.g.onreadystatechange=x(this.Ea,this);try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(Y){zp(this,Y);return}if(c=b||"",b=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var U in R)b.set(U,R[U]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const Y of R.keys())b.set(Y,R.get(Y));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(b.keys()).find(Y=>Y.toLowerCase()=="content-type"),U=l.FormData&&c instanceof l.FormData,!(0<=Array.prototype.indexOf.call(N2,p,void 0))||R||U||b.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Y,fe]of b)this.g.setRequestHeader(Y,fe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Up(this),this.u=!0,this.g.send(c),this.u=!1}catch(Y){zp(this,Y)}};function zp(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.m=5,$p(c),ml(c)}function $p(c){c.A||(c.A=!0,Me(c,"complete"),Me(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,Me(this,"complete"),Me(this,"abort"),ml(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ml(this,!0)),Et.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Bp(this):this.bb())},t.bb=function(){Bp(this)};function Bp(c){if(c.h&&typeof o<"u"&&(!c.v[1]||Tr(c)!=4||c.Z()!=2)){if(c.u&&Tr(c)==4)yt(c.Ea,0,c);else if(Me(c,"readystatechange"),Tr(c)==4){c.h=!1;try{const fe=c.Z();e:switch(fe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var b;if(!(b=p)){var R;if(R=fe===0){var U=String(c.D).match(Rp)[1]||null;!U&&l.self&&l.self.location&&(U=l.self.location.protocol.slice(0,-1)),R=!w2.test(U?U.toLowerCase():"")}b=R}if(b)Me(c,"complete"),Me(c,"success");else{c.m=6;try{var Y=2<Tr(c)?c.g.statusText:""}catch{Y=""}c.l=Y+" ["+c.Z()+"]",$p(c)}}finally{ml(c)}}}}function ml(c,p){if(c.g){Up(c);const b=c.g,R=c.v[0]?()=>{}:null;c.g=null,c.v=null,p||Me(c,"ready");try{b.onreadystatechange=R}catch{}}}function Up(c){c.I&&(l.clearTimeout(c.I),c.I=null)}t.isActive=function(){return!!this.g};function Tr(c){return c.g?c.g.readyState:0}t.Z=function(){try{return 2<Tr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),tn(p)}};function qp(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function j2(c){const p={};c=(c.g&&2<=Tr(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<c.length;R++){if(_(c[R]))continue;var b=A(c[R]);const U=b[0];if(b=b[1],typeof b!="string")continue;b=b.trim();const Y=p[U]||[];p[U]=Y,Y.push(b)}E(p,function(R){return R.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ma(c,p,b){return b&&b.internalChannelParams&&b.internalChannelParams[c]||p}function Qp(c){this.Aa=0,this.i=[],this.j=new he,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ma("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ma("baseRetryDelayMs",5e3,c),this.cb=Ma("retryDelaySeedMs",1e4,c),this.Wa=Ma("forwardChannelMaxRetries",2,c),this.wa=Ma("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new kp(c&&c.concurrentRequestLimit),this.Da=new v2,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Qp.prototype,t.la=8,t.G=1,t.connect=function(c,p,b,R){ke(0),this.W=c,this.H=p||{},b&&R!==void 0&&(this.H.OSID=b,this.H.OAID=R),this.F=this.X,this.I=e0(this,null,this.W),gl(this)};function rd(c){if(Gp(c),c.G==3){var p=c.U++,b=Cr(c.I);if(dt(b,"SID",c.K),dt(b,"RID",p),dt(b,"TYPE","terminate"),La(c,b),p=new Bn(c,c.j,p),p.L=2,p.v=dl(Cr(b)),b=!1,l.navigator&&l.navigator.sendBeacon)try{b=l.navigator.sendBeacon(p.v.toString(),"")}catch{}!b&&l.Image&&(new Image().src=p.v,b=!0),b||(p.g=t0(p.j,null),p.g.ea(p.v)),p.F=Date.now(),ll(p)}Zp(c)}function pl(c){c.g&&(id(c),c.g.cancel(),c.g=null)}function Gp(c){pl(c),c.u&&(l.clearTimeout(c.u),c.u=null),xl(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&l.clearTimeout(c.s),c.s=null)}function gl(c){if(!Ep(c.h)&&!c.s){c.s=!0;var p=c.Ga;K||V(),$||(K(),$=!0),O.add(p,c),c.B=0}}function S2(c,p){return Cp(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=p.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=st(x(c.Ga,c,p),Jp(c,c.B)),c.B++,!0)}t.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const U=new Bn(this,this.j,c);let Y=this.o;if(this.S&&(Y?(Y=m(Y),j(Y,this.S)):Y=this.S),this.m!==null||this.O||(U.H=Y,Y=null),this.P)e:{for(var p=0,b=0;b<this.i.length;b++){t:{var R=this.i[b];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(p+=R,4096<p){p=b;break e}if(p===4096||b===this.i.length-1){p=b+1;break e}}p=1e3}else p=1e3;p=Wp(this,U,p),b=Cr(this.I),dt(b,"RID",c),dt(b,"CVER",22),this.D&&dt(b,"X-HTTP-Session-Id",this.D),La(this,b),Y&&(this.O?p="headers="+encodeURIComponent(String(Vp(Y)))+"&"+p:this.m&&nd(b,this.m,Y)),td(this.h,U),this.Ua&&dt(b,"TYPE","init"),this.P?(dt(b,"$req",p),dt(b,"SID","null"),U.T=!0,Xu(U,b,null)):Xu(U,b,p),this.G=2}}else this.G==3&&(c?Hp(this,c):this.i.length==0||Ep(this.h)||Hp(this))};function Hp(c,p){var b;p?b=p.l:b=c.U++;const R=Cr(c.I);dt(R,"SID",c.K),dt(R,"RID",b),dt(R,"AID",c.T),La(c,R),c.m&&c.o&&nd(R,c.m,c.o),b=new Bn(c,c.j,b,c.B+1),c.m===null&&(b.H=c.o),p&&(c.i=p.D.concat(c.i)),p=Wp(c,b,1e3),b.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),td(c.h,b),Xu(b,R,p)}function La(c,p){c.H&&L(c.H,function(b,R){dt(p,R,b)}),c.l&&Ap({},function(b,R){dt(p,R,b)})}function Wp(c,p,b){b=Math.min(c.i.length,b);var R=c.l?x(c.l.Na,c.l,c):null;e:{var U=c.i;let Y=-1;for(;;){const fe=["count="+b];Y==-1?0<b?(Y=U[0].g,fe.push("ofs="+Y)):Y=0:fe.push("ofs="+Y);let lt=!0;for(let Wt=0;Wt<b;Wt++){let Je=U[Wt].g;const nn=U[Wt].map;if(Je-=Y,0>Je)Y=Math.max(0,U[Wt].g-100),lt=!1;else try{b2(nn,fe,"req"+Je+"_")}catch{R&&R(nn)}}if(lt){R=fe.join("&");break e}}}return c=c.i.splice(0,b),p.D=c,R}function Yp(c){if(!c.g&&!c.u){c.Y=1;var p=c.Fa;K||V(),$||(K(),$=!0),O.add(p,c),c.v=0}}function sd(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=st(x(c.Fa,c),Jp(c,c.v)),c.v++,!0)}t.Fa=function(){if(this.u=null,Kp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=st(x(this.ab,this),c)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ke(10),pl(this),Kp(this))};function id(c){c.A!=null&&(l.clearTimeout(c.A),c.A=null)}function Kp(c){c.g=new Bn(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var p=Cr(c.qa);dt(p,"RID","rpc"),dt(p,"SID",c.K),dt(p,"AID",c.T),dt(p,"CI",c.F?"0":"1"),!c.F&&c.ja&&dt(p,"TO",c.ja),dt(p,"TYPE","xmlhttp"),La(c,p),c.m&&c.o&&nd(p,c.m,c.o),c.L&&(c.g.I=c.L);var b=c.g;c=c.ia,b.L=1,b.v=dl(Cr(p)),b.m=null,b.P=!0,jp(b,c)}t.Za=function(){this.C!=null&&(this.C=null,pl(this),sd(this),ke(19))};function xl(c){c.C!=null&&(l.clearTimeout(c.C),c.C=null)}function Xp(c,p){var b=null;if(c.g==p){xl(c),id(c),c.g=null;var R=2}else if(ed(c.h,p))b=p.D,Tp(c.h,p),R=1;else return;if(c.G!=0){if(p.o)if(R==1){b=p.m?p.m.length:0,p=Date.now()-p.F;var U=c.B;R=rt(),Me(R,new at(R,b)),gl(c)}else Yp(c);else if(U=p.s,U==3||U==0&&0<p.X||!(R==1&&S2(c,p)||R==2&&sd(c)))switch(b&&0<b.length&&(p=c.h,p.i=p.i.concat(b)),U){case 1:qs(c,5);break;case 4:qs(c,10);break;case 3:qs(c,6);break;default:qs(c,2)}}}function Jp(c,p){let b=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(b*=2),b*p}function qs(c,p){if(c.j.info("Error code "+p),p==2){var b=x(c.fb,c),R=c.Xa;const U=!R;R=new Us(R||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||cl(R,"https"),dl(R),U?x2(R.toString(),b):y2(R.toString(),b)}else ke(2);c.G=0,c.l&&c.l.sa(p),Zp(c),Gp(c)}t.fb=function(c){c?(this.j.info("Successfully pinged google.com"),ke(2)):(this.j.info("Failed to ping google.com"),ke(1))};function Zp(c){if(c.G=0,c.ka=[],c.l){const p=Ip(c.h);(p.length!=0||c.i.length!=0)&&(I(c.ka,p),I(c.ka,c.i),c.h.i.length=0,k(c.i),c.i.length=0),c.l.ra()}}function e0(c,p,b){var R=b instanceof Us?Cr(b):new Us(b);if(R.g!="")p&&(R.g=p+"."+R.g),ul(R,R.s);else{var U=l.location;R=U.protocol,p=p?p+"."+U.hostname:U.hostname,U=+U.port;var Y=new Us(null);R&&cl(Y,R),p&&(Y.g=p),U&&ul(Y,U),b&&(Y.l=b),R=Y}return b=c.D,p=c.ya,b&&p&&dt(R,b,p),dt(R,"VER",c.la),La(c,R),R}function t0(c,p,b){if(p&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Ca&&!c.pa?new Et(new hl({eb:b})):new Et(c.pa),p.Ha(c.J),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function n0(){}t=n0.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function yl(){}yl.prototype.g=function(c,p){return new An(c,p)};function An(c,p){Ie.call(this),this.g=new Qp(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(c?c["X-WebChannel-Client-Profile"]=p.va:c={"X-WebChannel-Client-Profile":p.va}),this.g.S=c,(c=p&&p.Sb)&&!_(c)&&(this.g.m=c),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!_(p)&&(this.g.D=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new ji(this)}w(An,Ie),An.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},An.prototype.close=function(){rd(this.g)},An.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var b={};b.__data__=c,c=b}else this.u&&(b={},b.__data__=Cn(c),c=b);p.i.push(new o2(p.Ya++,c)),p.G==3&&gl(p)},An.prototype.N=function(){this.g.l=null,delete this.j,rd(this.g),delete this.g,An.aa.N.call(this)};function r0(c){Ue.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const b in p){c=b;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}w(r0,Ue);function s0(){Fe.call(this),this.status=1}w(s0,Fe);function ji(c){this.g=c}w(ji,n0),ji.prototype.ua=function(){Me(this.g,"a")},ji.prototype.ta=function(c){Me(this.g,new r0(c))},ji.prototype.sa=function(c){Me(this.g,new s0)},ji.prototype.ra=function(){Me(this.g,"b")},yl.prototype.createWebChannel=yl.prototype.g,An.prototype.send=An.prototype.o,An.prototype.open=An.prototype.m,An.prototype.close=An.prototype.close,J1=function(){return new yl},X1=function(){return rt()},K1=nt,Zh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},It.NO_ERROR=0,It.TIMEOUT=8,It.HTTP_ERROR=6,hc=It,In.COMPLETE="complete",Y1=In,me.EventType=Se,Se.OPEN="a",Se.CLOSE="b",Se.ERROR="c",Se.MESSAGE="d",Ie.prototype.listen=Ie.prototype.K,to=me,Et.prototype.listenOnce=Et.prototype.L,Et.prototype.getLastError=Et.prototype.Ka,Et.prototype.getLastErrorCode=Et.prototype.Ba,Et.prototype.getStatus=Et.prototype.Z,Et.prototype.getResponseJson=Et.prototype.Oa,Et.prototype.getResponseText=Et.prototype.oa,Et.prototype.send=Et.prototype.ea,Et.prototype.setWithCredentials=Et.prototype.Ha,W1=Et}).apply(typeof Fl<"u"?Fl:typeof self<"u"?self:typeof window<"u"?window:{});const Rg="@firebase/firestore",Pg="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}cn.UNAUTHENTICATED=new cn(null),cn.GOOGLE_CREDENTIALS=new cn("google-credentials-uid"),cn.FIRST_PARTY=new cn("first-party-uid"),cn.MOCK_USER=new cn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Na="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hi=new Sm("@firebase/firestore");function Ai(){return hi.logLevel}function be(t,...e){if(hi.logLevel<=Qe.DEBUG){const n=e.map(km);hi.debug(`Firestore (${Na}): ${t}`,...n)}}function Qr(t,...e){if(hi.logLevel<=Qe.ERROR){const n=e.map(km);hi.error(`Firestore (${Na}): ${t}`,...n)}}function Es(t,...e){if(hi.logLevel<=Qe.WARN){const n=e.map(km);hi.warn(`Firestore (${Na}): ${t}`,...n)}}function km(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ce(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,Z1(t,r,n)}function Z1(t,e,n){let r=`FIRESTORE (${Na}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Qr(r),new Error(r)}function tt(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||Z1(e,i,r)}function Re(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class xe extends Fs{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class mk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(cn.UNAUTHENTICATED))}shutdown(){}}class pk{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class gk{constructor(e){this.t=e,this.currentUser=cn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){tt(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let a=new Or;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Or,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const u=a;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},l=u=>{be("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(be("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Or)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(be("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(tt(typeof r.accessToken=="string",31837,{l:r}),new eb(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return tt(e===null||typeof e=="string",2055,{h:e}),new cn(e)}}class xk{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=cn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class yk{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new xk(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(cn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Dg{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class vk{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,J_(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){tt(this.o===void 0,3512);const r=a=>{a.error!=null&&be("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,be("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const i=a=>{be("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):be("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Dg(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(tt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Dg(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bk(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tb(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Em{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=bk(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<n&&(r+=e.charAt(i[a]%62))}return r}}function Le(t,e){return t<e?-1:t>e?1:0}function ef(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),i=e.codePointAt(n);if(r!==i){if(r<128&&i<128)return Le(r,i);{const a=tb(),o=wk(a.encode(Mg(t,n)),a.encode(Mg(e,n)));return o!==0?o:Le(r,i)}}n+=r>65535?2:1}return Le(t.length,e.length)}function Mg(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function wk(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return Le(t[n],e[n]);return Le(t.length,e.length)}function ua(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lg="__name__";class gr{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ce(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Ce(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return gr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof gr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const a=gr.compareSegments(e.get(i),n.get(i));if(a!==0)return a}return Le(e.length,n.length)}static compareSegments(e,n){const r=gr.isNumericId(e),i=gr.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?gr.extractNumericId(e).compare(gr.extractNumericId(n)):ef(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ns.fromString(e.substring(4,e.length-2))}}class ct extends gr{construct(e,n,r){return new ct(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new xe(se.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new ct(n)}static emptyPath(){return new ct([])}}const Nk=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Xt extends gr{construct(e,n,r){return new Xt(e,n,r)}static isValidIdentifier(e){return Nk.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Xt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Lg}static keyField(){return new Xt([Lg])}static fromServerFormat(e){const n=[];let r="",i=0;const a=()=>{if(r.length===0)throw new xe(se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new xe(se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new xe(se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(a(),i++)}if(a(),o)throw new xe(se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Xt(n)}static emptyPath(){return new Xt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e){this.path=e}static fromPath(e){return new _e(ct.fromString(e))}static fromName(e){return new _e(ct.fromString(e).popFirst(5))}static empty(){return new _e(ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ct.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new _e(new ct(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nb(t,e,n){if(!n)throw new xe(se.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function jk(t,e,n,r){if(e===!0&&r===!0)throw new xe(se.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Og(t){if(!_e.isDocumentKey(t))throw new xe(se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Fg(t){if(_e.isDocumentKey(t))throw new xe(se.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function rb(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Eu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ce(12329,{type:typeof t})}function Wn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new xe(se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Eu(t);throw new xe(se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Sk(t,e){if(e<=0)throw new xe(se.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ot(t,e){const n={typeString:t};return e&&(n.value=e),n}function nl(t,e){if(!rb(t))throw new xe(se.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){n=`Expected '${r}' field to equal '${a.value}'`;break}}if(n)throw new xe(se.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vg=-62135596800,zg=1e6;class pt{static now(){return pt.fromMillis(Date.now())}static fromDate(e){return pt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*zg);return new pt(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new xe(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new xe(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Vg)throw new xe(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new xe(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/zg}_compareTo(e){return this.seconds===e.seconds?Le(this.nanoseconds,e.nanoseconds):Le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:pt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(nl(e,pt._jsonSchema))return new pt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Vg;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}pt._jsonSchemaVersion="firestore/timestamp/1.0",pt._jsonSchema={type:Ot("string",pt._jsonSchemaVersion),seconds:Ot("number"),nanoseconds:Ot("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{static fromTimestamp(e){return new Ae(e)}static min(){return new Ae(new pt(0,0))}static max(){return new Ae(new pt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zo=-1;function _k(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ae.fromTimestamp(r===1e9?new pt(n+1,0):new pt(n,r));return new Cs(i,_e.empty(),e)}function kk(t){return new Cs(t.readTime,t.key,zo)}class Cs{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Cs(Ae.min(),_e.empty(),zo)}static max(){return new Cs(Ae.max(),_e.empty(),zo)}}function Ek(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=_e.comparator(t.documentKey,e.documentKey),n!==0?n:Le(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ck="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Tk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ja(t){if(t.code!==se.FAILED_PRECONDITION||t.message!==Ck)throw t;be("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ce(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ie((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(n,a).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ie?n:ie.resolve(n)}catch(n){return ie.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ie.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ie.reject(n)}static resolve(e){return new ie((n,r)=>{n(e)})}static reject(e){return new ie((n,r)=>{r(e)})}static waitFor(e){return new ie((n,r)=>{let i=0,a=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++a,o&&a===i&&n()},u=>r(u))}),o=!0,a===i&&n()})}static or(e){let n=ie.resolve(!1);for(const r of e)n=n.next(i=>i?ie.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,a)=>{r.push(n.call(this,i,a))}),this.waitFor(r)}static mapArray(e,n){return new ie((r,i)=>{const a=e.length,o=new Array(a);let l=0;for(let u=0;u<a;u++){const d=u;n(e[d]).next(h=>{o[d]=h,++l,l===a&&r(o)},h=>i(h))}})}static doWhile(e,n){return new ie((r,i)=>{const a=()=>{e()===!0?n().next(()=>{a()},i):r()};a()})}}function Ik(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Sa(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this._e(r),this.ae=r=>n.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}Cu.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cm=-1;function Tu(t){return t==null}function Hc(t){return t===0&&1/t==-1/0}function Ak(t){return typeof t=="number"&&Number.isInteger(t)&&!Hc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sb="";function Rk(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=$g(e)),e=Pk(t.get(n),e);return $g(e)}function Pk(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const a=t.charAt(i);switch(a){case"\0":n+="";break;case sb:n+="";break;default:n+=a}}return n}function $g(t){return t+sb+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bg(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Vs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ib(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e,n){this.comparator=e,this.root=n||Kt.EMPTY}insert(e,n){return new kt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Kt.BLACK,null,null))}remove(e){return new kt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Kt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vl(this.root,e,this.comparator,!0)}}class Vl{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=n?r(e.key,n):1,n&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Kt{constructor(e,n,r,i,a){this.key=e,this.value=n,this.color=r??Kt.RED,this.left=i??Kt.EMPTY,this.right=a??Kt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,a){return new Kt(e??this.key,n??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,n,r),null):a===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Kt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Kt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Kt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Kt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ce(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ce(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ce(27949);return e+(this.isRed()?0:1)}}Kt.EMPTY=null,Kt.RED=!0,Kt.BLACK=!1;Kt.EMPTY=new class{constructor(){this.size=0}get key(){throw Ce(57766)}get value(){throw Ce(16141)}get color(){throw Ce(16727)}get left(){throw Ce(29726)}get right(){throw Ce(36894)}copy(e,n,r,i,a){return this}insert(e,n,r){return new Kt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.comparator=e,this.data=new kt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Ug(this.data.getIterator())}getIteratorFrom(e){return new Ug(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ut)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,a=r.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ut(this.comparator);return n.data=e,n}}class Ug{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this.fields=e,e.sort(Xt.comparator)}static empty(){return new Mn([])}unionWith(e){let n=new Ut(Xt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Mn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ua(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new ab("Invalid base64 string: "+a):a}}(e);return new en(n)}static fromUint8Array(e){const n=function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a}(e);return new en(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}en.EMPTY_BYTE_STRING=new en("");const Dk=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ts(t){if(tt(!!t,39018),typeof t=="string"){let e=0;const n=Dk.exec(t);if(tt(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:At(t.seconds),nanos:At(t.nanos)}}function At(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Is(t){return typeof t=="string"?en.fromBase64String(t):en.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ob="server_timestamp",lb="__type__",cb="__previous_value__",ub="__local_write_time__";function Tm(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[lb])===null||n===void 0?void 0:n.stringValue)===ob}function Iu(t){const e=t.mapValue.fields[cb];return Tm(e)?Iu(e):e}function $o(t){const e=Ts(t.mapValue.fields[ub].timestampValue);return new pt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(e,n,r,i,a,o,l,u,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=h}}const Wc="(default)";class Bo{constructor(e,n){this.projectId=e,this.database=n||Wc}static empty(){return new Bo("","")}get isDefaultDatabase(){return this.database===Wc}isEqual(e){return e instanceof Bo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const db="__type__",hb="__max__",zl={mapValue:{fields:{__type__:{stringValue:hb}}}},fb="__vector__",Yc="value";function As(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Tm(t)?4:Ok(t)?9007199254740991:Lk(t)?10:11:Ce(28295,{value:t})}function kr(t,e){if(t===e)return!0;const n=As(t);if(n!==As(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return $o(t).isEqual($o(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=Ts(i.timestampValue),l=Ts(a.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,a){return Is(i.bytesValue).isEqual(Is(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,a){return At(i.geoPointValue.latitude)===At(a.geoPointValue.latitude)&&At(i.geoPointValue.longitude)===At(a.geoPointValue.longitude)}(t,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return At(i.integerValue)===At(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=At(i.doubleValue),l=At(a.doubleValue);return o===l?Hc(o)===Hc(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return ua(t.arrayValue.values||[],e.arrayValue.values||[],kr);case 10:case 11:return function(i,a){const o=i.mapValue.fields||{},l=a.mapValue.fields||{};if(Bg(o)!==Bg(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!kr(o[u],l[u])))return!1;return!0}(t,e);default:return Ce(52216,{left:t})}}function Uo(t,e){return(t.values||[]).find(n=>kr(n,e))!==void 0}function da(t,e){if(t===e)return 0;const n=As(t),r=As(e);if(n!==r)return Le(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Le(t.booleanValue,e.booleanValue);case 2:return function(a,o){const l=At(a.integerValue||a.doubleValue),u=At(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return qg(t.timestampValue,e.timestampValue);case 4:return qg($o(t),$o(e));case 5:return ef(t.stringValue,e.stringValue);case 6:return function(a,o){const l=Is(a),u=Is(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(a,o){const l=a.split("/"),u=o.split("/");for(let d=0;d<l.length&&d<u.length;d++){const h=Le(l[d],u[d]);if(h!==0)return h}return Le(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,o){const l=Le(At(a.latitude),At(o.latitude));return l!==0?l:Le(At(a.longitude),At(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Qg(t.arrayValue,e.arrayValue);case 10:return function(a,o){var l,u,d,h;const g=a.fields||{},x=o.fields||{},N=(l=g[Yc])===null||l===void 0?void 0:l.arrayValue,w=(u=x[Yc])===null||u===void 0?void 0:u.arrayValue,k=Le(((d=N==null?void 0:N.values)===null||d===void 0?void 0:d.length)||0,((h=w==null?void 0:w.values)===null||h===void 0?void 0:h.length)||0);return k!==0?k:Qg(N,w)}(t.mapValue,e.mapValue);case 11:return function(a,o){if(a===zl.mapValue&&o===zl.mapValue)return 0;if(a===zl.mapValue)return 1;if(o===zl.mapValue)return-1;const l=a.fields||{},u=Object.keys(l),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let g=0;g<u.length&&g<h.length;++g){const x=ef(u[g],h[g]);if(x!==0)return x;const N=da(l[u[g]],d[h[g]]);if(N!==0)return N}return Le(u.length,h.length)}(t.mapValue,e.mapValue);default:throw Ce(23264,{le:n})}}function qg(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Le(t,e);const n=Ts(t),r=Ts(e),i=Le(n.seconds,r.seconds);return i!==0?i:Le(n.nanos,r.nanos)}function Qg(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const a=da(n[i],r[i]);if(a)return a}return Le(n.length,r.length)}function ha(t){return tf(t)}function tf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ts(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Is(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return _e.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const a of n.values||[])i?i=!1:r+=",",r+=tf(a);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",a=!0;for(const o of r)a?a=!1:i+=",",i+=`${o}:${tf(n.fields[o])}`;return i+"}"}(t.mapValue):Ce(61005,{value:t})}function fc(t){switch(As(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Iu(t);return e?16+fc(e):16;case 5:return 2*t.stringValue.length;case 6:return Is(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,a)=>i+fc(a),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return Vs(r.fields,(a,o)=>{i+=a.length+fc(o)}),i}(t.mapValue);default:throw Ce(13486,{value:t})}}function Gg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function nf(t){return!!t&&"integerValue"in t}function Im(t){return!!t&&"arrayValue"in t}function Hg(t){return!!t&&"nullValue"in t}function Wg(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function mc(t){return!!t&&"mapValue"in t}function Lk(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[db])===null||n===void 0?void 0:n.stringValue)===fb}function go(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Vs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=go(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=go(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Ok(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===hb}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this.value=e}static empty(){return new jn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!mc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=go(n)}setAll(e){let n=Xt.emptyPath(),r={},i=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=l.popLast()}o?r[l.lastSegment()]=go(o):i.push(l.lastSegment())});const a=this.getFieldsMap(n);this.applyChanges(a,r,i)}delete(e){const n=this.field(e.popLast());mc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return kr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];mc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Vs(n,(i,a)=>e[i]=a);for(const i of r)delete e[i]}clone(){return new jn(go(this.value))}}function mb(t){const e=[];return Vs(t.fields,(n,r)=>{const i=new Xt([n]);if(mc(r)){const a=mb(r.mapValue).fields;if(a.length===0)e.push(i);else for(const o of a)e.push(i.child(o))}else e.push(i)}),new Mn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e,n,r,i,a,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=a,this.data=o,this.documentState=l}static newInvalidDocument(e){return new hn(e,0,Ae.min(),Ae.min(),Ae.min(),jn.empty(),0)}static newFoundDocument(e,n,r,i){return new hn(e,1,n,Ae.min(),r,i,0)}static newNoDocument(e,n){return new hn(e,2,n,Ae.min(),Ae.min(),jn.empty(),0)}static newUnknownDocument(e,n){return new hn(e,3,n,Ae.min(),Ae.min(),jn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ae.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=jn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=jn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ae.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof hn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new hn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(e,n){this.position=e,this.inclusive=n}}function Yg(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const a=e[i],o=t.position[i];if(a.field.isKeyField()?r=_e.comparator(_e.fromName(o.referenceValue),n.key):r=da(o,n.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function Kg(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!kr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,n="asc"){this.field=e,this.dir=n}}function Fk(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pb{}class Lt extends pb{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new zk(e,n,r):n==="array-contains"?new Uk(e,r):n==="in"?new qk(e,r):n==="not-in"?new Qk(e,r):n==="array-contains-any"?new Gk(e,r):new Lt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new $k(e,r):new Bk(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(da(n,this.value)):n!==null&&As(this.value)===As(n)&&this.matchesComparison(da(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ce(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ur extends pb{constructor(e,n){super(),this.filters=e,this.op=n,this.he=null}static create(e,n){return new ur(e,n)}matches(e){return gb(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function gb(t){return t.op==="and"}function xb(t){return Vk(t)&&gb(t)}function Vk(t){for(const e of t.filters)if(e instanceof ur)return!1;return!0}function rf(t){if(t instanceof Lt)return t.field.canonicalString()+t.op.toString()+ha(t.value);if(xb(t))return t.filters.map(e=>rf(e)).join(",");{const e=t.filters.map(n=>rf(n)).join(",");return`${t.op}(${e})`}}function yb(t,e){return t instanceof Lt?function(r,i){return i instanceof Lt&&r.op===i.op&&r.field.isEqual(i.field)&&kr(r.value,i.value)}(t,e):t instanceof ur?function(r,i){return i instanceof ur&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((a,o,l)=>a&&yb(o,i.filters[l]),!0):!1}(t,e):void Ce(19439)}function vb(t){return t instanceof Lt?function(n){return`${n.field.canonicalString()} ${n.op} ${ha(n.value)}`}(t):t instanceof ur?function(n){return n.op.toString()+" {"+n.getFilters().map(vb).join(" ,")+"}"}(t):"Filter"}class zk extends Lt{constructor(e,n,r){super(e,n,r),this.key=_e.fromName(r.referenceValue)}matches(e){const n=_e.comparator(e.key,this.key);return this.matchesComparison(n)}}class $k extends Lt{constructor(e,n){super(e,"in",n),this.keys=bb("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Bk extends Lt{constructor(e,n){super(e,"not-in",n),this.keys=bb("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function bb(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>_e.fromName(r.referenceValue))}class Uk extends Lt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Im(n)&&Uo(n.arrayValue,this.value)}}class qk extends Lt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Uo(this.value.arrayValue,n)}}class Qk extends Lt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Uo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Uo(this.value.arrayValue,n)}}class Gk extends Lt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Im(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Uo(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(e,n=null,r=[],i=[],a=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=l,this.Pe=null}}function Xg(t,e=null,n=[],r=[],i=null,a=null,o=null){return new Hk(t,e,n,r,i,a,o)}function Am(t){const e=Re(t);if(e.Pe===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>rf(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(a){return a.field.canonicalString()+a.dir}(r)).join(","),Tu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ha(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ha(r)).join(",")),e.Pe=n}return e.Pe}function Rm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Fk(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!yb(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Kg(t.startAt,e.startAt)&&Kg(t.endAt,e.endAt)}function sf(t){return _e.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e,n=null,r=[],i=[],a=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=l,this.endAt=u,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function Wk(t,e,n,r,i,a,o,l){return new rl(t,e,n,r,i,a,o,l)}function Au(t){return new rl(t)}function Jg(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function wb(t){return t.collectionGroup!==null}function xo(t){const e=Re(t);if(e.Te===null){e.Te=[];const n=new Set;for(const a of e.explicitOrderBy)e.Te.push(a),n.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Ut(Xt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(a=>{n.has(a.canonicalString())||a.isKeyField()||e.Te.push(new Xc(a,r))}),n.has(Xt.keyField().canonicalString())||e.Te.push(new Xc(Xt.keyField(),r))}return e.Te}function wr(t){const e=Re(t);return e.Ie||(e.Ie=Yk(e,xo(t))),e.Ie}function Yk(t,e){if(t.limitType==="F")return Xg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new Xc(i.field,a)});const n=t.endAt?new Kc(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Kc(t.startAt.position,t.startAt.inclusive):null;return Xg(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function af(t,e){const n=t.filters.concat([e]);return new rl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Jc(t,e,n){return new rl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ru(t,e){return Rm(wr(t),wr(e))&&t.limitType===e.limitType}function Nb(t){return`${Am(wr(t))}|lt:${t.limitType}`}function Ri(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>vb(i)).join(", ")}]`),Tu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>ha(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>ha(i)).join(",")),`Target(${r})`}(wr(t))}; limitType=${t.limitType})`}function Pu(t,e){return e.isFoundDocument()&&function(r,i){const a=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):_e.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)}(t,e)&&function(r,i){for(const a of xo(r))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const a of r.filters)if(!a.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,l,u){const d=Yg(o,l,u);return o.inclusive?d<=0:d<0}(r.startAt,xo(r),i)||r.endAt&&!function(o,l,u){const d=Yg(o,l,u);return o.inclusive?d>=0:d>0}(r.endAt,xo(r),i))}(t,e)}function Kk(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function jb(t){return(e,n)=>{let r=!1;for(const i of xo(t)){const a=Xk(i,e,n);if(a!==0)return a;r=r||i.field.isKeyField()}return 0}}function Xk(t,e,n){const r=t.field.isKeyField()?_e.comparator(e.key,n.key):function(a,o,l){const u=o.data.field(a),d=l.data.field(a);return u!==null&&d!==null?da(u,d):Ce(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ce(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,a]of r)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Vs(this.inner,(n,r)=>{for(const[i,a]of r)e(i,a)})}isEmpty(){return ib(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jk=new kt(_e.comparator);function Gr(){return Jk}const Sb=new kt(_e.comparator);function no(...t){let e=Sb;for(const n of t)e=e.insert(n.key,n);return e}function _b(t){let e=Sb;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Zs(){return yo()}function kb(){return yo()}function yo(){return new vi(t=>t.toString(),(t,e)=>t.isEqual(e))}const Zk=new kt(_e.comparator),eE=new Ut(_e.comparator);function $e(...t){let e=eE;for(const n of t)e=e.add(n);return e}const tE=new Ut(Le);function nE(){return tE}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Hc(e)?"-0":e}}function Eb(t){return{integerValue:""+t}}function Cb(t,e){return Ak(e)?Eb(e):Pm(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(){this._=void 0}}function rE(t,e,n){return t instanceof qo?function(i,a){const o={fields:{[lb]:{stringValue:ob},[ub]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Tm(a)&&(a=Iu(a)),a&&(o.fields[cb]=a),{mapValue:o}}(n,e):t instanceof fa?Ib(t,e):t instanceof Qo?Ab(t,e):function(i,a){const o=Tb(i,a),l=Zg(o)+Zg(i.Ee);return nf(o)&&nf(i.Ee)?Eb(l):Pm(i.serializer,l)}(t,e)}function sE(t,e,n){return t instanceof fa?Ib(t,e):t instanceof Qo?Ab(t,e):n}function Tb(t,e){return t instanceof Go?function(r){return nf(r)||function(a){return!!a&&"doubleValue"in a}(r)}(e)?e:{integerValue:0}:null}class qo extends Du{}class fa extends Du{constructor(e){super(),this.elements=e}}function Ib(t,e){const n=Rb(e);for(const r of t.elements)n.some(i=>kr(i,r))||n.push(r);return{arrayValue:{values:n}}}class Qo extends Du{constructor(e){super(),this.elements=e}}function Ab(t,e){let n=Rb(e);for(const r of t.elements)n=n.filter(i=>!kr(i,r));return{arrayValue:{values:n}}}class Go extends Du{constructor(e,n){super(),this.serializer=e,this.Ee=n}}function Zg(t){return At(t.integerValue||t.doubleValue)}function Rb(t){return Im(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(e,n){this.field=e,this.transform=n}}function iE(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof fa&&i instanceof fa||r instanceof Qo&&i instanceof Qo?ua(r.elements,i.elements,kr):r instanceof Go&&i instanceof Go?kr(r.Ee,i.Ee):r instanceof qo&&i instanceof qo}(t.transform,e.transform)}class aE{constructor(e,n){this.version=e,this.transformResults=n}}class Nr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Nr}static exists(e){return new Nr(void 0,e)}static updateTime(e){return new Nr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function pc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Mu{}function Pb(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Mb(t.key,Nr.none()):new sl(t.key,t.data,Nr.none());{const n=t.data,r=jn.empty();let i=new Ut(Xt.comparator);for(let a of e.fields)if(!i.has(a)){let o=n.field(a);o===null&&a.length>1&&(a=a.popLast(),o=n.field(a)),o===null?r.delete(a):r.set(a,o),i=i.add(a)}return new zs(t.key,r,new Mn(i.toArray()),Nr.none())}}function oE(t,e,n){t instanceof sl?function(i,a,o){const l=i.value.clone(),u=tx(i.fieldTransforms,a,o.transformResults);l.setAll(u),a.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof zs?function(i,a,o){if(!pc(i.precondition,a))return void a.convertToUnknownDocument(o.version);const l=tx(i.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(Db(i)),u.setAll(l),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function vo(t,e,n,r){return t instanceof sl?function(a,o,l,u){if(!pc(a.precondition,o))return l;const d=a.value.clone(),h=nx(a.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof zs?function(a,o,l,u){if(!pc(a.precondition,o))return l;const d=nx(a.fieldTransforms,u,o),h=o.data;return h.setAll(Db(a)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(a,o,l){return pc(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function lE(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),a=Tb(r.transform,i||null);a!=null&&(n===null&&(n=jn.empty()),n.set(r.field,a))}return n||null}function ex(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ua(r,i,(a,o)=>iE(a,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class sl extends Mu{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class zs extends Mu{constructor(e,n,r,i,a=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Db(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function tx(t,e,n){const r=new Map;tt(t.length===n.length,32656,{Ae:n.length,Re:t.length});for(let i=0;i<n.length;i++){const a=t[i],o=a.transform,l=e.data.field(a.field);r.set(a.field,sE(o,l,n[i]))}return r}function nx(t,e,n){const r=new Map;for(const i of t){const a=i.transform,o=n.data.field(i.field);r.set(i.field,rE(a,o,e))}return r}class Mb extends Mu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class cE extends Mu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&oE(a,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=vo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=vo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=kb();return this.mutations.forEach(i=>{const a=e.get(i.key),o=a.overlayedDocument;let l=this.applyToLocalView(o,a.mutatedFields);l=n.has(i.key)?null:l;const u=Pb(o,l);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Ae.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),$e())}isEqual(e){return this.batchId===e.batchId&&ua(this.mutations,e.mutations,(n,r)=>ex(n,r))&&ua(this.baseMutations,e.baseMutations,(n,r)=>ex(n,r))}}class Mm{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){tt(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let i=function(){return Zk}();const a=e.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new Mm(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dE{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hE{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dt,qe;function fE(t){switch(t){case se.OK:return Ce(64938);case se.CANCELLED:case se.UNKNOWN:case se.DEADLINE_EXCEEDED:case se.RESOURCE_EXHAUSTED:case se.INTERNAL:case se.UNAVAILABLE:case se.UNAUTHENTICATED:return!1;case se.INVALID_ARGUMENT:case se.NOT_FOUND:case se.ALREADY_EXISTS:case se.PERMISSION_DENIED:case se.FAILED_PRECONDITION:case se.ABORTED:case se.OUT_OF_RANGE:case se.UNIMPLEMENTED:case se.DATA_LOSS:return!0;default:return Ce(15467,{code:t})}}function Lb(t){if(t===void 0)return Qr("GRPC error has no .code"),se.UNKNOWN;switch(t){case Dt.OK:return se.OK;case Dt.CANCELLED:return se.CANCELLED;case Dt.UNKNOWN:return se.UNKNOWN;case Dt.DEADLINE_EXCEEDED:return se.DEADLINE_EXCEEDED;case Dt.RESOURCE_EXHAUSTED:return se.RESOURCE_EXHAUSTED;case Dt.INTERNAL:return se.INTERNAL;case Dt.UNAVAILABLE:return se.UNAVAILABLE;case Dt.UNAUTHENTICATED:return se.UNAUTHENTICATED;case Dt.INVALID_ARGUMENT:return se.INVALID_ARGUMENT;case Dt.NOT_FOUND:return se.NOT_FOUND;case Dt.ALREADY_EXISTS:return se.ALREADY_EXISTS;case Dt.PERMISSION_DENIED:return se.PERMISSION_DENIED;case Dt.FAILED_PRECONDITION:return se.FAILED_PRECONDITION;case Dt.ABORTED:return se.ABORTED;case Dt.OUT_OF_RANGE:return se.OUT_OF_RANGE;case Dt.UNIMPLEMENTED:return se.UNIMPLEMENTED;case Dt.DATA_LOSS:return se.DATA_LOSS;default:return Ce(39323,{code:t})}}(qe=Dt||(Dt={}))[qe.OK=0]="OK",qe[qe.CANCELLED=1]="CANCELLED",qe[qe.UNKNOWN=2]="UNKNOWN",qe[qe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",qe[qe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",qe[qe.NOT_FOUND=5]="NOT_FOUND",qe[qe.ALREADY_EXISTS=6]="ALREADY_EXISTS",qe[qe.PERMISSION_DENIED=7]="PERMISSION_DENIED",qe[qe.UNAUTHENTICATED=16]="UNAUTHENTICATED",qe[qe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",qe[qe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",qe[qe.ABORTED=10]="ABORTED",qe[qe.OUT_OF_RANGE=11]="OUT_OF_RANGE",qe[qe.UNIMPLEMENTED=12]="UNIMPLEMENTED",qe[qe.INTERNAL=13]="INTERNAL",qe[qe.UNAVAILABLE=14]="UNAVAILABLE",qe[qe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mE=new Ns([4294967295,4294967295],0);function rx(t){const e=tb().encode(t),n=new H1;return n.update(e),new Uint8Array(n.digest())}function sx(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Ns([n,r],0),new Ns([i,a],0)]}class Lm{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ro(`Invalid padding: ${n}`);if(r<0)throw new ro(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ro(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ro(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*e.length-n,this.ge=Ns.fromNumber(this.fe)}pe(e,n,r){let i=e.add(n.multiply(Ns.fromNumber(r)));return i.compare(mE)===1&&(i=new Ns([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const n=rx(e),[r,i]=sx(n);for(let a=0;a<this.hashCount;a++){const o=this.pe(r,i,a);if(!this.ye(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new Lm(a,i,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.fe===0)return;const n=rx(e),[r,i]=sx(n);for(let a=0;a<this.hashCount;a++){const o=this.pe(r,i,a);this.we(o)}}we(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ro extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,n,r,i,a){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,il.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Lu(Ae.min(),i,new kt(Le),Gr(),$e())}}class il{constructor(e,n,r,i,a){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new il(r,n,$e(),$e(),$e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(e,n,r,i){this.Se=e,this.removedTargetIds=n,this.key=r,this.be=i}}class Ob{constructor(e,n){this.targetId=e,this.De=n}}class Fb{constructor(e,n,r=en.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class ix{constructor(){this.ve=0,this.Ce=ax(),this.Fe=en.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=$e(),n=$e(),r=$e();return this.Ce.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Ce(38017,{changeType:a})}}),new il(this.Fe,this.Me,e,n,r)}ke(){this.xe=!1,this.Ce=ax()}qe(e,n){this.xe=!0,this.Ce=this.Ce.insert(e,n)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,tt(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class pE{constructor(e){this.We=e,this.Ge=new Map,this.ze=Gr(),this.je=$l(),this.Je=$l(),this.He=new kt(Le)}Ye(e){for(const n of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(n,e.be):this.Xe(n,e.key,e.be);for(const n of e.removedTargetIds)this.Xe(n,e.key,e.be)}et(e){this.forEachTarget(e,n=>{const r=this.tt(n);switch(e.state){case 0:this.nt(n)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(e.resumeToken));break;default:Ce(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ge.forEach((r,i)=>{this.nt(i)&&n(i)})}it(e){const n=e.targetId,r=e.De.count,i=this.st(n);if(i){const a=i.target;if(sf(a))if(r===0){const o=new _e(a.path);this.Xe(n,o,hn.newNoDocument(o,Ae.min()))}else tt(r===1,20013,{expectedCount:r});else{const o=this.ot(n);if(o!==r){const l=this._t(e),u=l?this.ut(l,e,o):1;if(u!==0){this.rt(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,d)}}}}}_t(e){const n=e.De.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:a=0}=n;let o,l;try{o=Is(r).toUint8Array()}catch(u){if(u instanceof ab)return Es("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Lm(o,i,a)}catch(u){return Es(u instanceof ro?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.fe===0?null:l}ut(e,n,r){return n.De.count===r-this.ht(e,n.targetId)?0:2}ht(e,n){const r=this.We.getRemoteKeysForTarget(n);let i=0;return r.forEach(a=>{const o=this.We.lt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(l)||(this.Xe(n,a,null),i++)}),i}Pt(e){const n=new Map;this.Ge.forEach((a,o)=>{const l=this.st(o);if(l){if(a.current&&sf(l.target)){const u=new _e(l.target.path);this.Tt(u).has(o)||this.It(o,u)||this.Xe(o,u,hn.newNoDocument(u,e))}a.Ne&&(n.set(o,a.Le()),a.ke())}});let r=$e();this.Je.forEach((a,o)=>{let l=!0;o.forEachWhile(u=>{const d=this.st(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(a))}),this.ze.forEach((a,o)=>o.setReadTime(e));const i=new Lu(e,n,this.He,this.ze,r);return this.ze=Gr(),this.je=$l(),this.Je=$l(),this.He=new kt(Le),i}Ze(e,n){if(!this.nt(e))return;const r=this.It(e,n.key)?2:0;this.tt(e).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(e)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(e))}Xe(e,n,r){if(!this.nt(e))return;const i=this.tt(e);this.It(e,n)?i.qe(n,1):i.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(e)),this.Je=this.Je.insert(n,this.dt(n).add(e)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const n=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let n=this.Ge.get(e);return n||(n=new ix,this.Ge.set(e,n)),n}dt(e){let n=this.Je.get(e);return n||(n=new Ut(Le),this.Je=this.Je.insert(e,n)),n}Tt(e){let n=this.je.get(e);return n||(n=new Ut(Le),this.je=this.je.insert(e,n)),n}nt(e){const n=this.st(e)!==null;return n||be("WatchChangeAggregator","Detected inactive target",e),n}st(e){const n=this.Ge.get(e);return n&&n.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new ix),this.We.getRemoteKeysForTarget(e).forEach(n=>{this.Xe(e,n,null)})}It(e,n){return this.We.getRemoteKeysForTarget(e).has(n)}}function $l(){return new kt(_e.comparator)}function ax(){return new kt(_e.comparator)}const gE=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),xE=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),yE=(()=>({and:"AND",or:"OR"}))();class vE{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function of(t,e){return t.useProto3Json||Tu(e)?e:{value:e}}function Zc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Vb(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function bE(t,e){return Zc(t,e.toTimestamp())}function jr(t){return tt(!!t,49232),Ae.fromTimestamp(function(n){const r=Ts(n);return new pt(r.seconds,r.nanos)}(t))}function Om(t,e){return lf(t,e).canonicalString()}function lf(t,e){const n=function(i){return new ct(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function zb(t){const e=ct.fromString(t);return tt(Qb(e),10190,{key:e.toString()}),e}function cf(t,e){return Om(t.databaseId,e.path)}function Vd(t,e){const n=zb(e);if(n.get(1)!==t.databaseId.projectId)throw new xe(se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new xe(se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new _e(Bb(n))}function $b(t,e){return Om(t.databaseId,e)}function wE(t){const e=zb(t);return e.length===4?ct.emptyPath():Bb(e)}function uf(t){return new ct(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Bb(t){return tt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function ox(t,e,n){return{name:cf(t,e),fields:n.value.mapValue.fields}}function NE(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Ce(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(d,h){return d.useProto3Json?(tt(h===void 0||typeof h=="string",58123),en.fromBase64String(h||"")):(tt(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),en.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const h=d.code===void 0?se.UNKNOWN:Lb(d.code);return new xe(h,d.message||"")}(o);n=new Fb(r,i,a,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Vd(t,r.document.name),a=jr(r.document.updateTime),o=r.document.createTime?jr(r.document.createTime):Ae.min(),l=new jn({mapValue:{fields:r.document.fields}}),u=hn.newFoundDocument(i,a,o,l),d=r.targetIds||[],h=r.removedTargetIds||[];n=new gc(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Vd(t,r.document),a=r.readTime?jr(r.readTime):Ae.min(),o=hn.newNoDocument(i,a),l=r.removedTargetIds||[];n=new gc([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Vd(t,r.document),a=r.removedTargetIds||[];n=new gc([],a,i,null)}else{if(!("filter"in e))return Ce(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:a}=r,o=new hE(i,a),l=r.targetId;n=new Ob(l,o)}}return n}function jE(t,e){let n;if(e instanceof sl)n={update:ox(t,e.key,e.value)};else if(e instanceof Mb)n={delete:cf(t,e.key)};else if(e instanceof zs)n={update:ox(t,e.key,e.data),updateMask:RE(e.fieldMask)};else{if(!(e instanceof cE))return Ce(16599,{Rt:e.type});n={verify:cf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(a,o){const l=o.transform;if(l instanceof qo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof fa)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Qo)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Go)return{fieldPath:o.field.canonicalString(),increment:l.Ee};throw Ce(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:bE(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Ce(27497)}(t,e.precondition)),n}function SE(t,e){return t&&t.length>0?(tt(e!==void 0,14353),t.map(n=>function(i,a){let o=i.updateTime?jr(i.updateTime):jr(a);return o.isEqual(Ae.min())&&(o=jr(a)),new aE(o,i.transformResults||[])}(n,e))):[]}function _E(t,e){return{documents:[$b(t,e.path)]}}function kE(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=$b(t,i);const a=function(d){if(d.length!==0)return qb(ur.create(d,"and"))}(e.filters);a&&(n.structuredQuery.where=a);const o=function(d){if(d.length!==0)return d.map(h=>function(x){return{field:Pi(x.field),direction:TE(x.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=of(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{Vt:n,parent:i}}function EE(t){let e=wE(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){tt(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let a=[];n.where&&(a=function(g){const x=Ub(g);return x instanceof ur&&xb(x)?x.getFilters():[x]}(n.where));let o=[];n.orderBy&&(o=function(g){return g.map(x=>function(w){return new Xc(Di(w.field),function(I){switch(I){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(x))}(n.orderBy));let l=null;n.limit&&(l=function(g){let x;return x=typeof g=="object"?g.value:g,Tu(x)?null:x}(n.limit));let u=null;n.startAt&&(u=function(g){const x=!!g.before,N=g.values||[];return new Kc(N,x)}(n.startAt));let d=null;return n.endAt&&(d=function(g){const x=!g.before,N=g.values||[];return new Kc(N,x)}(n.endAt)),Wk(e,i,o,a,l,"F",u,d)}function CE(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ce(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Ub(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Di(n.unaryFilter.field);return Lt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Di(n.unaryFilter.field);return Lt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Di(n.unaryFilter.field);return Lt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Di(n.unaryFilter.field);return Lt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ce(61313);default:return Ce(60726)}}(t):t.fieldFilter!==void 0?function(n){return Lt.create(Di(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ce(58110);default:return Ce(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return ur.create(n.compositeFilter.filters.map(r=>Ub(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ce(1026)}}(n.compositeFilter.op))}(t):Ce(30097,{filter:t})}function TE(t){return gE[t]}function IE(t){return xE[t]}function AE(t){return yE[t]}function Pi(t){return{fieldPath:t.canonicalString()}}function Di(t){return Xt.fromServerFormat(t.fieldPath)}function qb(t){return t instanceof Lt?function(n){if(n.op==="=="){if(Wg(n.value))return{unaryFilter:{field:Pi(n.field),op:"IS_NAN"}};if(Hg(n.value))return{unaryFilter:{field:Pi(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Wg(n.value))return{unaryFilter:{field:Pi(n.field),op:"IS_NOT_NAN"}};if(Hg(n.value))return{unaryFilter:{field:Pi(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Pi(n.field),op:IE(n.op),value:n.value}}}(t):t instanceof ur?function(n){const r=n.getFilters().map(i=>qb(i));return r.length===1?r[0]:{compositeFilter:{op:AE(n.op),filters:r}}}(t):Ce(54877,{filter:t})}function RE(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Qb(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e,n,r,i,a=Ae.min(),o=Ae.min(),l=en.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new cs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new cs(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new cs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new cs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(e){this.gt=e}}function DE(t){const e=EE({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Jc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(){this.Dn=new LE}addToCollectionParentIndex(e,n){return this.Dn.add(n),ie.resolve()}getCollectionParents(e,n){return ie.resolve(this.Dn.getEntries(n))}addFieldIndex(e,n){return ie.resolve()}deleteFieldIndex(e,n){return ie.resolve()}deleteAllFieldIndexes(e){return ie.resolve()}createTargetIndexes(e,n){return ie.resolve()}getDocumentsMatchingTarget(e,n){return ie.resolve(null)}getIndexType(e,n){return ie.resolve(0)}getFieldIndexes(e,n){return ie.resolve([])}getNextCollectionGroupToUpdate(e){return ie.resolve(null)}getMinOffset(e,n){return ie.resolve(Cs.min())}getMinOffsetFromCollectionGroup(e,n){return ie.resolve(Cs.min())}updateCollectionGroup(e,n,r){return ie.resolve()}updateIndexEntries(e,n){return ie.resolve()}}class LE{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ut(ct.comparator),a=!i.has(r);return this.index[n]=i.add(r),a}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ut(ct.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Gb=41943040;class wn{static withCacheSize(e){return new wn(e,wn.DEFAULT_COLLECTION_PERCENTILE,wn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wn.DEFAULT_COLLECTION_PERCENTILE=10,wn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wn.DEFAULT=new wn(Gb,wn.DEFAULT_COLLECTION_PERCENTILE,wn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wn.DISABLED=new wn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new ma(0)}static ur(){return new ma(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cx="LruGarbageCollector",OE=1048576;function ux([t,e],[n,r]){const i=Le(t,n);return i===0?Le(e,r):i}class FE{constructor(e){this.Tr=e,this.buffer=new Ut(ux),this.Ir=0}dr(){return++this.Ir}Er(e){const n=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();ux(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class VE{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){be(cx,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Sa(n)?be(cx,"Ignoring IndexedDB error during garbage collection: ",n):await ja(n)}await this.Rr(3e5)})}}class zE{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.mr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return ie.resolve(Cu.ue);const r=new FE(n);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(be("LruGarbageCollector","Garbage collection skipped; disabled"),ie.resolve(lx)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(be("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),lx):this.pr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,n){let r,i,a,o,l,u,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(be("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,o=Date.now(),this.nthSequenceNumber(e,i))).next(g=>(r=g,l=Date.now(),this.removeTargets(e,r,n))).next(g=>(a=g,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(g=>(d=Date.now(),Ai()<=Qe.DEBUG&&be("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(l-o)+`ms
	Removed ${a} targets in `+(u-l)+`ms
	Removed ${g} documents in `+(d-u)+`ms
Total Duration: ${d-h}ms`),ie.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:g})))}}function $E(t,e){return new zE(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(){this.changes=new vi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,hn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?ie.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UE{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&vo(r.mutation,i,Mn.empty(),pt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,$e()).next(()=>r))}getLocalViewOfDocuments(e,n,r=$e()){const i=Zs();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(a=>{let o=no();return a.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Zs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,$e()))}populateOverlays(e,n,r){const i=[];return r.forEach(a=>{n.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,i){let a=Gr();const o=yo(),l=function(){return yo()}();return n.forEach((u,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof zs)?a=a.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),vo(h.mutation,d,h.mutation.getFieldMask(),pt.now())):o.set(d.key,Mn.empty())}),this.recalculateAndSaveOverlays(e,a).next(u=>(u.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>{var g;return l.set(d,new UE(h,(g=o.get(d))!==null&&g!==void 0?g:null))}),l))}recalculateAndSaveOverlays(e,n){const r=yo();let i=new kt((o,l)=>o-l),a=$e();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let h=r.get(u)||Mn.empty();h=l.applyToLocalView(d,h),r.set(u,h);const g=(i.get(l.batchId)||$e()).add(u);i=i.insert(l.batchId,g)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),d=u.key,h=u.value,g=kb();h.forEach(x=>{if(!a.has(x)){const N=Pb(n.get(x),r.get(x));N!==null&&g.set(x,N),a=a.add(x)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,g))}return ie.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return _e.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):wb(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-a.size):ie.resolve(Zs());let l=zo,u=a;return o.next(d=>ie.forEach(d,(h,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),a.get(h)?ie.resolve():this.remoteDocumentCache.getEntry(e,h).next(x=>{u=u.insert(h,x)}))).next(()=>this.populateOverlays(e,d,a)).next(()=>this.computeViews(e,u,d,$e())).next(h=>({batchId:l,changes:_b(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new _e(n)).next(r=>{let i=no();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const a=n.collectionGroup;let o=no();return this.indexManager.getCollectionParents(e,a).next(l=>ie.forEach(l,u=>{const d=function(g,x){return new rl(x,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(h=>{h.forEach((g,x)=>{o=o.insert(g,x)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,a,i))).next(o=>{a.forEach((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,hn.newInvalidDocument(h)))});let l=no();return o.forEach((u,d)=>{const h=a.get(u);h!==void 0&&vo(h.mutation,d,Mn.empty(),pt.now()),Pu(n,d)&&(l=l.insert(u,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,n){return ie.resolve(this.Br.get(n))}saveBundleMetadata(e,n){return this.Br.set(n.id,function(i){return{id:i.id,version:i.version,createTime:jr(i.createTime)}}(n)),ie.resolve()}getNamedQuery(e,n){return ie.resolve(this.Lr.get(n))}saveNamedQuery(e,n){return this.Lr.set(n.name,function(i){return{name:i.name,query:DE(i.bundledQuery),readTime:jr(i.readTime)}}(n)),ie.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GE{constructor(){this.overlays=new kt(_e.comparator),this.kr=new Map}getOverlay(e,n){return ie.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Zs();return ie.forEach(n,i=>this.getOverlay(e,i).next(a=>{a!==null&&r.set(i,a)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,a)=>{this.wt(e,n,a)}),ie.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.kr.get(r);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.kr.delete(r)),ie.resolve()}getOverlaysForCollection(e,n,r){const i=Zs(),a=n.length+1,o=new _e(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===a&&u.largestBatchId>r&&i.set(u.getKey(),u)}return ie.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let a=new kt((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=a.get(d.largestBatchId);h===null&&(h=Zs(),a=a.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const l=Zs(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,h)=>l.set(d,h)),!(l.size()>=i)););return ie.resolve(l)}wt(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new dE(n,r));let a=this.kr.get(n);a===void 0&&(a=$e(),this.kr.set(n,a)),this.kr.set(n,a.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(){this.sessionToken=en.EMPTY_BYTE_STRING}getSessionToken(e){return ie.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ie.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm{constructor(){this.qr=new Ut(Qt.Qr),this.$r=new Ut(Qt.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,n){const r=new Qt(e,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new Qt(e,n))}Gr(e,n){e.forEach(r=>this.removeReference(r,n))}zr(e){const n=new _e(new ct([])),r=new Qt(n,e),i=new Qt(n,e+1),a=[];return this.$r.forEachInRange([r,i],o=>{this.Wr(o),a.push(o.key)}),a}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const n=new _e(new ct([])),r=new Qt(n,e),i=new Qt(n,e+1);let a=$e();return this.$r.forEachInRange([r,i],o=>{a=a.add(o.key)}),a}containsKey(e){const n=new Qt(e,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Qt{constructor(e,n){this.key=e,this.Hr=n}static Qr(e,n){return _e.comparator(e.key,n.key)||Le(e.Hr,n.Hr)}static Ur(e,n){return Le(e.Hr,n.Hr)||_e.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WE{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new Ut(Qt.Qr)}checkEmpty(e){return ie.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const a=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new uE(a,n,r,i);this.mutationQueue.push(o);for(const l of i)this.Yr=this.Yr.add(new Qt(l.key,a)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ie.resolve(o)}lookupMutationBatch(e,n){return ie.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.Xr(r),a=i<0?0:i;return ie.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(this.mutationQueue.length===0?Cm:this.er-1)}getAllMutationBatches(e){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Qt(n,0),i=new Qt(n,Number.POSITIVE_INFINITY),a=[];return this.Yr.forEachInRange([r,i],o=>{const l=this.Zr(o.Hr);a.push(l)}),ie.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ut(Le);return n.forEach(i=>{const a=new Qt(i,0),o=new Qt(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([a,o],l=>{r=r.add(l.Hr)})}),ie.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let a=r;_e.isDocumentKey(a)||(a=a.child(""));const o=new Qt(new _e(a),0);let l=new Ut(Le);return this.Yr.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(l=l.add(u.Hr)),!0)},o),ie.resolve(this.ei(l))}ei(e){const n=[];return e.forEach(r=>{const i=this.Zr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){tt(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return ie.forEach(n.mutations,i=>{const a=new Qt(i.key,n.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,n){const r=new Qt(n,0),i=this.Yr.firstAfterOrEqual(r);return ie.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ie.resolve()}ti(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(e){this.ni=e,this.docs=function(){return new kt(_e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),a=i?i.size:0,o=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return ie.resolve(r?r.document.mutableCopy():hn.newInvalidDocument(n))}getEntries(e,n){let r=Gr();return n.forEach(i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():hn.newInvalidDocument(i))}),ie.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let a=Gr();const o=n.path,l=new _e(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Ek(kk(h),r)<=0||(i.has(h.key)||Pu(n,h))&&(a=a.insert(h.key,h.mutableCopy()))}return ie.resolve(a)}getAllFromCollectionGroup(e,n,r,i){Ce(9500)}ri(e,n){return ie.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new KE(this)}getSize(e){return ie.resolve(this.size)}}class KE extends BE{constructor(e){super(),this.Or=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)}),ie.waitFor(n)}getFromCache(e,n){return this.Or.getEntry(e,n)}getAllFromCache(e,n){return this.Or.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XE{constructor(e){this.persistence=e,this.ii=new vi(n=>Am(n),Rm),this.lastRemoteSnapshotVersion=Ae.min(),this.highestTargetId=0,this.si=0,this.oi=new Fm,this.targetCount=0,this._i=ma.ar()}forEachTarget(e,n){return this.ii.forEach((r,i)=>n(i)),ie.resolve()}getLastRemoteSnapshotVersion(e){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ie.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),ie.resolve()}hr(e){this.ii.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this._i=new ma(n),this.highestTargetId=n),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,n){return this.hr(n),this.targetCount+=1,ie.resolve()}updateTargetData(e,n){return this.hr(n),ie.resolve()}removeTargetData(e,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,ie.resolve()}removeTargets(e,n,r){let i=0;const a=[];return this.ii.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.ii.delete(o),a.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),ie.waitFor(a).next(()=>i)}getTargetCount(e){return ie.resolve(this.targetCount)}getTargetData(e,n){const r=this.ii.get(n)||null;return ie.resolve(r)}addMatchingKeys(e,n,r){return this.oi.Kr(n,r),ie.resolve()}removeMatchingKeys(e,n,r){this.oi.Gr(n,r);const i=this.persistence.referenceDelegate,a=[];return i&&n.forEach(o=>{a.push(i.markPotentiallyOrphaned(e,o))}),ie.waitFor(a)}removeMatchingKeysForTargetId(e,n){return this.oi.zr(n),ie.resolve()}getMatchingKeysForTargetId(e,n){const r=this.oi.Jr(n);return ie.resolve(r)}containsKey(e,n){return ie.resolve(this.oi.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hb{constructor(e,n){this.ai={},this.overlays={},this.ui=new Cu(0),this.ci=!1,this.ci=!0,this.li=new HE,this.referenceDelegate=e(this),this.hi=new XE(this),this.indexManager=new ME,this.remoteDocumentCache=function(i){return new YE(i)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new PE(n),this.Ti=new QE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new GE,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ai[e.toKey()];return r||(r=new WE(n,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,n,r){be("MemoryPersistence","Starting transaction:",e);const i=new JE(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(a=>this.referenceDelegate.di(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ei(e,n){return ie.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,n)))}}class JE extends Tk{constructor(e){super(),this.currentSequenceNumber=e}}class Vm{constructor(e){this.persistence=e,this.Ai=new Fm,this.Ri=null}static Vi(e){return new Vm(e)}get mi(){if(this.Ri)return this.Ri;throw Ce(60996)}addReference(e,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),ie.resolve()}removeReference(e,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),ie.resolve()}markPotentiallyOrphaned(e,n){return this.mi.add(n.toString()),ie.resolve()}removeTarget(e,n){this.Ai.zr(n.targetId).forEach(i=>this.mi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(a=>this.mi.add(a.toString()))}).next(()=>r.removeTargetData(e,n))}Ii(){this.Ri=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.mi,r=>{const i=_e.fromPath(r);return this.fi(e,i).next(a=>{a||n.removeEntry(i,Ae.min())})}).next(()=>(this.Ri=null,n.apply(e)))}updateLimboDocument(e,n){return this.fi(e,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(e){return 0}fi(e,n){return ie.or([()=>ie.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class eu{constructor(e,n){this.persistence=e,this.gi=new vi(r=>Rk(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=$E(this,n)}static Vi(e,n){return new eu(e,n)}Ii(){}di(e){return ie.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}mr(e){const n=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}yr(e){let n=0;return this.gr(e,r=>{n++}).next(()=>n)}gr(e,n){return ie.forEach(this.gi,(r,i)=>this.Sr(e,r,i).next(a=>a?ie.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ri(e,o=>this.Sr(e,o,n).next(l=>{l||(r++,a.removeEntry(o,Ae.min()))})).next(()=>a.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.gi.set(n,e.currentSequenceNumber),ie.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),ie.resolve()}removeReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),ie.resolve()}updateLimboDocument(e,n){return this.gi.set(n,e.currentSequenceNumber),ie.resolve()}Pi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=fc(e.data.value)),n}Sr(e,n,r){return ie.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.gi.get(n);return ie.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Is=r,this.ds=i}static Es(e,n){let r=$e(),i=$e();for(const a of n.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new zm(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return WS()?8:Ik(QS())>0?6:4}()}initialize(e,n){this.gs=e,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(e,n,r,i){const a={result:null};return this.ps(e,n).next(o=>{a.result=o}).next(()=>{if(!a.result)return this.ys(e,n,i,r).next(o=>{a.result=o})}).next(()=>{if(a.result)return;const o=new ZE;return this.ws(e,n,o).next(l=>{if(a.result=l,this.Rs)return this.Ss(e,n,o,l.size)})}).next(()=>a.result)}Ss(e,n,r,i){return r.documentReadCount<this.Vs?(Ai()<=Qe.DEBUG&&be("QueryEngine","SDK will not create cache indexes for query:",Ri(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ie.resolve()):(Ai()<=Qe.DEBUG&&be("QueryEngine","Query:",Ri(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(Ai()<=Qe.DEBUG&&be("QueryEngine","The SDK decides to create cache indexes for query:",Ri(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,wr(n))):ie.resolve())}ps(e,n){if(Jg(n))return ie.resolve(null);let r=wr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Jc(n,null,"F"),r=wr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const o=$e(...a);return this.gs.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.bs(n,l);return this.Ds(n,d,o,u.readTime)?this.ps(e,Jc(n,null,"F")):this.vs(e,d,n,u)}))})))}ys(e,n,r,i){return Jg(n)||i.isEqual(Ae.min())?ie.resolve(null):this.gs.getDocuments(e,r).next(a=>{const o=this.bs(n,a);return this.Ds(n,o,r,i)?ie.resolve(null):(Ai()<=Qe.DEBUG&&be("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ri(n)),this.vs(e,o,n,_k(i,zo)).next(l=>l))})}bs(e,n){let r=new Ut(jb(e));return n.forEach((i,a)=>{Pu(e,a)&&(r=r.add(a))}),r}Ds(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const a=e.limitType==="F"?n.last():n.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}ws(e,n,r){return Ai()<=Qe.DEBUG&&be("QueryEngine","Using full collection scan to execute query:",Ri(n)),this.gs.getDocumentsMatchingQuery(e,n,Cs.min(),r)}vs(e,n,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next(a=>(n.forEach(o=>{a=a.insert(o.key,o)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $m="LocalStore",tC=3e8;class nC{constructor(e,n,r,i){this.persistence=e,this.Cs=n,this.serializer=i,this.Fs=new kt(Le),this.Ms=new vi(a=>Am(a),Rm),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new qE(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Fs))}}function rC(t,e,n,r){return new nC(t,e,n,r)}async function Wb(t,e){const n=Re(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(a=>(i=a,n.Ns(e),n.mutationQueue.getAllMutationBatches(r))).next(a=>{const o=[],l=[];let u=$e();for(const d of i){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of a){l.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return n.localDocuments.getDocuments(r,u).next(d=>({Bs:d,removedBatchIds:o,addedBatchIds:l}))})})}function sC(t,e){const n=Re(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),a=n.Os.newChangeBuffer({trackRemovals:!0});return function(l,u,d,h){const g=d.batch,x=g.keys();let N=ie.resolve();return x.forEach(w=>{N=N.next(()=>h.getEntry(u,w)).next(k=>{const I=d.docVersions.get(w);tt(I!==null,48541),k.version.compareTo(I)<0&&(g.applyToRemoteDocument(k,d),k.isValidDocument()&&(k.setReadTime(d.commitVersion),h.addEntry(k)))})}),N.next(()=>l.mutationQueue.removeMutationBatch(u,g))}(n,r,e,a).next(()=>a.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=$e();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(u=u.add(l.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function Yb(t){const e=Re(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.hi.getLastRemoteSnapshotVersion(n))}function iC(t,e){const n=Re(t),r=e.snapshotVersion;let i=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const o=n.Os.newChangeBuffer({trackRemovals:!0});i=n.Fs;const l=[];e.targetChanges.forEach((h,g)=>{const x=i.get(g);if(!x)return;l.push(n.hi.removeMatchingKeys(a,h.removedDocuments,g).next(()=>n.hi.addMatchingKeys(a,h.addedDocuments,g)));let N=x.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(g)!==null?N=N.withResumeToken(en.EMPTY_BYTE_STRING,Ae.min()).withLastLimboFreeSnapshotVersion(Ae.min()):h.resumeToken.approximateByteSize()>0&&(N=N.withResumeToken(h.resumeToken,r)),i=i.insert(g,N),function(k,I,C){return k.resumeToken.approximateByteSize()===0||I.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=tC?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(x,N,h)&&l.push(n.hi.updateTargetData(a,N))});let u=Gr(),d=$e();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(a,h))}),l.push(aC(a,o,e.documentUpdates).next(h=>{u=h.Ls,d=h.ks})),!r.isEqual(Ae.min())){const h=n.hi.getLastRemoteSnapshotVersion(a).next(g=>n.hi.setTargetsMetadata(a,a.currentSequenceNumber,r));l.push(h)}return ie.waitFor(l).next(()=>o.apply(a)).next(()=>n.localDocuments.getLocalViewOfDocuments(a,u,d)).next(()=>u)}).then(a=>(n.Fs=i,a))}function aC(t,e,n){let r=$e(),i=$e();return n.forEach(a=>r=r.add(a)),e.getEntries(t,r).next(a=>{let o=Gr();return n.forEach((l,u)=>{const d=a.get(l);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(l)),u.isNoDocument()&&u.version.isEqual(Ae.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):be($m,"Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",u.version)}),{Ls:o,ks:i}})}function oC(t,e){const n=Re(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Cm),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function lC(t,e){const n=Re(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.hi.getTargetData(r,e).next(a=>a?(i=a,ie.resolve(i)):n.hi.allocateTargetId(r).next(o=>(i=new cs(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(e,r.targetId)),r})}async function df(t,e,n){const r=Re(t),i=r.Fs.get(e),a=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",a,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Sa(o))throw o;be($m,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)}function dx(t,e,n){const r=Re(t);let i=Ae.min(),a=$e();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,h){const g=Re(u),x=g.Ms.get(h);return x!==void 0?ie.resolve(g.Fs.get(x)):g.hi.getTargetData(d,h)}(r,o,wr(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,l.targetId).next(u=>{a=u})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?i:Ae.min(),n?a:$e())).next(l=>(cC(r,Kk(e),l),{documents:l,qs:a})))}function cC(t,e,n){let r=t.xs.get(e)||Ae.min();n.forEach((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),t.xs.set(e,r)}class hx{constructor(){this.activeTargetIds=nE()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class uC{constructor(){this.Fo=new hx,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,n,r){this.Mo[e]=n}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new hx,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fx="ConnectivityMonitor";class mx{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){be(fx,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){be(fx,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bl=null;function hf(){return Bl===null?Bl=function(){return 268435456+Math.round(2147483648*Math.random())}():Bl++,"0x"+Bl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zd="RestConnection",hC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class fC{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===Wc?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,n,r,i,a){const o=hf(),l=this.Go(e,n.toUriEncodedString());be(zd,`Sending RPC '${e}' ${o}:`,l,r);const u={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(u,i,a);const{host:d}=new URL(l),h=jm(d);return this.jo(e,l,u,r,h).then(g=>(be(zd,`Received RPC '${e}' ${o}: `,g),g),g=>{throw Es(zd,`RPC '${e}' ${o} failed with error: `,g,"url: ",l,"request:",r),g})}Jo(e,n,r,i,a,o){return this.Wo(e,n,r,i,a)}zo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Na}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,a)=>e[a]=i),r&&r.headers.forEach((i,a)=>e[a]=i)}Go(e,n){const r=hC[e];return`${this.$o}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const on="WebChannelConnection";class pC extends fC{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,n,r,i,a){const o=hf();return new Promise((l,u)=>{const d=new W1;d.setWithCredentials(!0),d.listenOnce(Y1.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case hc.NO_ERROR:const g=d.getResponseJson();be(on,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),l(g);break;case hc.TIMEOUT:be(on,`RPC '${e}' ${o} timed out`),u(new xe(se.DEADLINE_EXCEEDED,"Request time out"));break;case hc.HTTP_ERROR:const x=d.getStatus();if(be(on,`RPC '${e}' ${o} failed with status:`,x,"response text:",d.getResponseText()),x>0){let N=d.getResponseJson();Array.isArray(N)&&(N=N[0]);const w=N==null?void 0:N.error;if(w&&w.status&&w.message){const k=function(C){const _=C.toLowerCase().replace(/_/g,"-");return Object.values(se).indexOf(_)>=0?_:se.UNKNOWN}(w.status);u(new xe(k,w.message))}else u(new xe(se.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new xe(se.UNAVAILABLE,"Connection failed."));break;default:Ce(9055,{c_:e,streamId:o,l_:d.getLastErrorCode(),h_:d.getLastError()})}}finally{be(on,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(i);be(on,`RPC '${e}' ${o} sending request:`,i),d.send(n,"POST",h,r,15)})}P_(e,n,r){const i=hf(),a=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=J1(),l=X1(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.zo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const h=a.join("");be(on,`Creating RPC '${e}' stream ${i}: ${h}`,u);const g=o.createWebChannel(h,u);this.T_(g);let x=!1,N=!1;const w=new mC({Ho:I=>{N?be(on,`Not sending because RPC '${e}' stream ${i} is closed:`,I):(x||(be(on,`Opening RPC '${e}' stream ${i} transport.`),g.open(),x=!0),be(on,`RPC '${e}' stream ${i} sending:`,I),g.send(I))},Yo:()=>g.close()}),k=(I,C,_)=>{I.listen(C,v=>{try{_(v)}catch(P){setTimeout(()=>{throw P},0)}})};return k(g,to.EventType.OPEN,()=>{N||(be(on,`RPC '${e}' stream ${i} transport opened.`),w.s_())}),k(g,to.EventType.CLOSE,()=>{N||(N=!0,be(on,`RPC '${e}' stream ${i} transport closed`),w.__(),this.I_(g))}),k(g,to.EventType.ERROR,I=>{N||(N=!0,Es(on,`RPC '${e}' stream ${i} transport errored. Name:`,I.name,"Message:",I.message),w.__(new xe(se.UNAVAILABLE,"The operation could not be completed")))}),k(g,to.EventType.MESSAGE,I=>{var C;if(!N){const _=I.data[0];tt(!!_,16349);const v=_,P=(v==null?void 0:v.error)||((C=v[0])===null||C===void 0?void 0:C.error);if(P){be(on,`RPC '${e}' stream ${i} received error:`,P);const D=P.status;let L=function(y){const j=Dt[y];if(j!==void 0)return Lb(j)}(D),E=P.message;L===void 0&&(L=se.INTERNAL,E="Unknown error status: "+D+" with message "+P.message),N=!0,w.__(new xe(L,E)),g.close()}else be(on,`RPC '${e}' stream ${i} received:`,_),w.a_(_)}}),k(l,K1.STAT_EVENT,I=>{I.stat===Zh.PROXY?be(on,`RPC '${e}' stream ${i} detected buffering proxy`):I.stat===Zh.NOPROXY&&be(on,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.o_()},0),w}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(n=>n===e)}}function $d(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ou(t){return new vE(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb{constructor(e,n,r=1e3,i=1.5,a=6e4){this.Fi=e,this.timerId=n,this.d_=r,this.E_=i,this.A_=a,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,n-r);i>0&&be("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const px="PersistentStream";class Xb{constructor(e,n,r,i,a,o,l,u){this.Fi=e,this.w_=r,this.S_=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Kb(e,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():n&&n.code===se.RESOURCE_EXHAUSTED?(Qr(n.toString()),Qr("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(n)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===n&&this.W_(r,i)},r=>{e(()=>{const i=new xe(se.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(e,n){const r=this.K_(this.b_);this.stream=this.z_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return be(px,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return n=>{this.Fi.enqueueAndForget(()=>this.b_===e?n():(be(px,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class gC extends Xb{constructor(e,n,r,i,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=a}z_(e,n){return this.connection.P_("Listen",e,n)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const n=NE(this.serializer,e),r=function(a){if(!("targetChange"in a))return Ae.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?Ae.min():o.readTime?jr(o.readTime):Ae.min()}(e);return this.listener.J_(n,r)}H_(e){const n={};n.database=uf(this.serializer),n.addTarget=function(a,o){let l;const u=o.target;if(l=sf(u)?{documents:_E(a,u)}:{query:kE(a,u).Vt},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=Vb(a,o.resumeToken);const d=of(a,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(Ae.min())>0){l.readTime=Zc(a,o.snapshotVersion.toTimestamp());const d=of(a,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=CE(this.serializer,e);r&&(n.labels=r),this.k_(n)}Y_(e){const n={};n.database=uf(this.serializer),n.removeTarget=e,this.k_(n)}}class xC extends Xb{constructor(e,n,r,i,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=a}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,n){return this.connection.P_("Write",e,n)}j_(e){return tt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,tt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){tt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const n=SE(e.writeResults,e.commitTime),r=jr(e.commitTime);return this.listener.ta(r,n)}na(){const e={};e.database=uf(this.serializer),this.k_(e)}X_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>jE(this.serializer,r))};this.k_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{}class vC extends yC{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new xe(se.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Wo(e,lf(n,r),i,a,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new xe(se.UNKNOWN,a.toString())})}Jo(e,n,r,i,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Jo(e,lf(n,r),i,o,l,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new xe(se.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class bC{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Qr(n),this._a=!1):be("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fi="RemoteStore";class wC{constructor(e,n,r,i,a){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=a,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{bi(this)&&(be(fi,"Restarting streams for network reachability change."),await async function(u){const d=Re(u);d.Ia.add(4),await al(d),d.Aa.set("Unknown"),d.Ia.delete(4),await Fu(d)}(this))})}),this.Aa=new bC(r,i)}}async function Fu(t){if(bi(t))for(const e of t.da)await e(!0)}async function al(t){for(const e of t.da)await e(!1)}function Jb(t,e){const n=Re(t);n.Ta.has(e.targetId)||(n.Ta.set(e.targetId,e),Qm(n)?qm(n):_a(n).x_()&&Um(n,e))}function Bm(t,e){const n=Re(t),r=_a(n);n.Ta.delete(e),r.x_()&&Zb(n,e),n.Ta.size===0&&(r.x_()?r.B_():bi(n)&&n.Aa.set("Unknown"))}function Um(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ae.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}_a(t).H_(e)}function Zb(t,e){t.Ra.$e(e),_a(t).Y_(e)}function qm(t){t.Ra=new pE({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),_a(t).start(),t.Aa.aa()}function Qm(t){return bi(t)&&!_a(t).M_()&&t.Ta.size>0}function bi(t){return Re(t).Ia.size===0}function ew(t){t.Ra=void 0}async function NC(t){t.Aa.set("Online")}async function jC(t){t.Ta.forEach((e,n)=>{Um(t,e)})}async function SC(t,e){ew(t),Qm(t)?(t.Aa.la(e),qm(t)):t.Aa.set("Unknown")}async function _C(t,e,n){if(t.Aa.set("Online"),e instanceof Fb&&e.state===2&&e.cause)try{await async function(i,a){const o=a.cause;for(const l of a.targetIds)i.Ta.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.Ta.delete(l),i.Ra.removeTarget(l))}(t,e)}catch(r){be(fi,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await tu(t,r)}else if(e instanceof gc?t.Ra.Ye(e):e instanceof Ob?t.Ra.it(e):t.Ra.et(e),!n.isEqual(Ae.min()))try{const r=await Yb(t.localStore);n.compareTo(r)>=0&&await function(a,o){const l=a.Ra.Pt(o);return l.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=a.Ta.get(d);h&&a.Ta.set(d,h.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,d)=>{const h=a.Ta.get(u);if(!h)return;a.Ta.set(u,h.withResumeToken(en.EMPTY_BYTE_STRING,h.snapshotVersion)),Zb(a,u);const g=new cs(h.target,u,d,h.sequenceNumber);Um(a,g)}),a.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){be(fi,"Failed to raise snapshot:",r),await tu(t,r)}}async function tu(t,e,n){if(!Sa(e))throw e;t.Ia.add(1),await al(t),t.Aa.set("Offline"),n||(n=()=>Yb(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{be(fi,"Retrying IndexedDB access"),await n(),t.Ia.delete(1),await Fu(t)})}function tw(t,e){return e().catch(n=>tu(t,n,e))}async function Vu(t){const e=Re(t),n=Rs(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Cm;for(;kC(e);)try{const i=await oC(e.localStore,r);if(i===null){e.Pa.length===0&&n.B_();break}r=i.batchId,EC(e,i)}catch(i){await tu(e,i)}nw(e)&&rw(e)}function kC(t){return bi(t)&&t.Pa.length<10}function EC(t,e){t.Pa.push(e);const n=Rs(t);n.x_()&&n.Z_&&n.X_(e.mutations)}function nw(t){return bi(t)&&!Rs(t).M_()&&t.Pa.length>0}function rw(t){Rs(t).start()}async function CC(t){Rs(t).na()}async function TC(t){const e=Rs(t);for(const n of t.Pa)e.X_(n.mutations)}async function IC(t,e,n){const r=t.Pa.shift(),i=Mm.from(r,e,n);await tw(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Vu(t)}async function AC(t,e){e&&Rs(t).Z_&&await async function(r,i){if(function(o){return fE(o)&&o!==se.ABORTED}(i.code)){const a=r.Pa.shift();Rs(r).N_(),await tw(r,()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i)),await Vu(r)}}(t,e),nw(t)&&rw(t)}async function gx(t,e){const n=Re(t);n.asyncQueue.verifyOperationInProgress(),be(fi,"RemoteStore received new credentials");const r=bi(n);n.Ia.add(3),await al(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ia.delete(3),await Fu(n)}async function RC(t,e){const n=Re(t);e?(n.Ia.delete(2),await Fu(n)):e||(n.Ia.add(2),await al(n),n.Aa.set("Unknown"))}function _a(t){return t.Va||(t.Va=function(n,r,i){const a=Re(n);return a.ia(),new gC(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Zo:NC.bind(null,t),e_:jC.bind(null,t),n_:SC.bind(null,t),J_:_C.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),Qm(t)?qm(t):t.Aa.set("Unknown")):(await t.Va.stop(),ew(t))})),t.Va}function Rs(t){return t.ma||(t.ma=function(n,r,i){const a=Re(n);return a.ia(),new xC(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:CC.bind(null,t),n_:AC.bind(null,t),ea:TC.bind(null,t),ta:IC.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await Vu(t)):(await t.ma.stop(),t.Pa.length>0&&(be(fi,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(e,n,r,i,a){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Or,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,a){const o=Date.now()+r,l=new Gm(e,n,o,i,a);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new xe(se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Hm(t,e){if(Qr("AsyncQueue",`${e}: ${t}`),Sa(t))return new xe(se.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{static emptySet(e){return new ea(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||_e.comparator(n.key,r.key):(n,r)=>_e.comparator(n.key,r.key),this.keyedMap=no(),this.sortedSet=new kt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ea)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ea;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xx{constructor(){this.fa=new kt(_e.comparator)}track(e){const n=e.doc.key,r=this.fa.get(n);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(n,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(n):e.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):Ce(63341,{At:e,ga:r}):this.fa=this.fa.insert(n,e)}pa(){const e=[];return this.fa.inorderTraversal((n,r)=>{e.push(r)}),e}}class pa{constructor(e,n,r,i,a,o,l,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,a){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new pa(e,n,ea.emptySet(n),o,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ru(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class DC{constructor(){this.queries=yx(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){const i=Re(n),a=i.queries;i.queries=yx(),a.forEach((o,l)=>{for(const u of l.wa)u.onError(r)})})(this,new xe(se.ABORTED,"Firestore shutting down"))}}function yx(){return new vi(t=>Nb(t),Ru)}async function Wm(t,e){const n=Re(t);let r=3;const i=e.query;let a=n.queries.get(i);a?!a.Sa()&&e.ba()&&(r=2):(a=new PC,r=e.ba()?0:1);try{switch(r){case 0:a.ya=await n.onListen(i,!0);break;case 1:a.ya=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const l=Hm(o,`Initialization of query '${Ri(e.query)}' failed`);return void e.onError(l)}n.queries.set(i,a),a.wa.push(e),e.va(n.onlineState),a.ya&&e.Ca(a.ya)&&Km(n)}async function Ym(t,e){const n=Re(t),r=e.query;let i=3;const a=n.queries.get(r);if(a){const o=a.wa.indexOf(e);o>=0&&(a.wa.splice(o,1),a.wa.length===0?i=e.ba()?0:1:!a.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function MC(t,e){const n=Re(t);let r=!1;for(const i of e){const a=i.query,o=n.queries.get(a);if(o){for(const l of o.wa)l.Ca(i)&&(r=!0);o.ya=i}}r&&Km(n)}function LC(t,e,n){const r=Re(t),i=r.queries.get(e);if(i)for(const a of i.wa)a.onError(n);r.queries.delete(e)}function Km(t){t.Da.forEach(e=>{e.next()})}var ff,vx;(vx=ff||(ff={})).Fa="default",vx.Cache="cache";class Xm{constructor(e,n,r){this.query=e,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new pa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),n=!0):this.Ba(e,this.onlineState)&&(this.La(e),n=!0),this.Oa=e,n}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),n=!0),n}Ba(e,n){if(!e.fromCache||!this.ba())return!0;const r=n!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const n=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(e){e=pa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==ff.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(e){this.key=e}}class iw{constructor(e){this.key=e}}class OC{constructor(e,n){this.query=e,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=$e(),this.mutatedKeys=$e(),this.Xa=jb(e),this.eu=new ea(this.Xa)}get tu(){return this.Ha}nu(e,n){const r=n?n.ru:new xx,i=n?n.eu:this.eu;let a=n?n.mutatedKeys:this.mutatedKeys,o=i,l=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,g)=>{const x=i.get(h),N=Pu(this.query,g)?g:null,w=!!x&&this.mutatedKeys.has(x.key),k=!!N&&(N.hasLocalMutations||this.mutatedKeys.has(N.key)&&N.hasCommittedMutations);let I=!1;x&&N?x.data.isEqual(N.data)?w!==k&&(r.track({type:3,doc:N}),I=!0):this.iu(x,N)||(r.track({type:2,doc:N}),I=!0,(u&&this.Xa(N,u)>0||d&&this.Xa(N,d)<0)&&(l=!0)):!x&&N?(r.track({type:0,doc:N}),I=!0):x&&!N&&(r.track({type:1,doc:x}),I=!0,(u||d)&&(l=!0)),I&&(N?(o=o.add(N),a=k?a.add(h):a.delete(h)):(o=o.delete(h),a=a.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),a=a.delete(h.key),r.track({type:1,doc:h})}return{eu:o,ru:r,Ds:l,mutatedKeys:a}}iu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const a=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const o=e.ru.pa();o.sort((h,g)=>function(N,w){const k=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ce(20277,{At:I})}};return k(N)-k(w)}(h.type,g.type)||this.Xa(h.doc,g.doc)),this.su(r),i=i!=null&&i;const l=n&&!i?this.ou():[],u=this.Za.size===0&&this.current&&!i?1:0,d=u!==this.Ya;return this.Ya=u,o.length!==0||d?{snapshot:new pa(this.query,e.eu,a,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:l}:{_u:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new xx,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=$e(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const n=[];return e.forEach(r=>{this.Za.has(r)||n.push(new iw(r))}),this.Za.forEach(r=>{e.has(r)||n.push(new sw(r))}),n}uu(e){this.Ha=e.qs,this.Za=$e();const n=this.nu(e.documents);return this.applyChanges(n,!0)}cu(){return pa.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Jm="SyncEngine";class FC{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class VC{constructor(e){this.key=e,this.lu=!1}}class zC{constructor(e,n,r,i,a,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new vi(l=>Nb(l),Ru),this.Tu=new Map,this.Iu=new Set,this.du=new kt(_e.comparator),this.Eu=new Map,this.Au=new Fm,this.Ru={},this.Vu=new Map,this.mu=ma.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function $C(t,e,n=!0){const r=dw(t);let i;const a=r.Pu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.cu()):i=await aw(r,e,n,!0),i}async function BC(t,e){const n=dw(t);await aw(n,e,!0,!1)}async function aw(t,e,n,r){const i=await lC(t.localStore,wr(e)),a=i.targetId,o=t.sharedClientState.addLocalQueryTarget(a,n);let l;return r&&(l=await UC(t,e,a,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&Jb(t.remoteStore,i),l}async function UC(t,e,n,r,i){t.gu=(g,x,N)=>async function(k,I,C,_){let v=I.view.nu(C);v.Ds&&(v=await dx(k.localStore,I.query,!1).then(({documents:E})=>I.view.nu(E,v)));const P=_&&_.targetChanges.get(I.targetId),D=_&&_.targetMismatches.get(I.targetId)!=null,L=I.view.applyChanges(v,k.isPrimaryClient,P,D);return wx(k,I.targetId,L._u),L.snapshot}(t,g,x,N);const a=await dx(t.localStore,e,!0),o=new OC(e,a.qs),l=o.nu(a.documents),u=il.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),d=o.applyChanges(l,t.isPrimaryClient,u);wx(t,n,d._u);const h=new FC(e,n,o);return t.Pu.set(e,h),t.Tu.has(n)?t.Tu.get(n).push(e):t.Tu.set(n,[e]),d.snapshot}async function qC(t,e,n){const r=Re(t),i=r.Pu.get(e),a=r.Tu.get(i.targetId);if(a.length>1)return r.Tu.set(i.targetId,a.filter(o=>!Ru(o,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await df(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Bm(r.remoteStore,i.targetId),mf(r,i.targetId)}).catch(ja)):(mf(r,i.targetId),await df(r.localStore,i.targetId,!0))}async function QC(t,e){const n=Re(t),r=n.Pu.get(e),i=n.Tu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Bm(n.remoteStore,r.targetId))}async function GC(t,e,n){const r=ZC(t);try{const i=await function(o,l){const u=Re(o),d=pt.now(),h=l.reduce((N,w)=>N.add(w.key),$e());let g,x;return u.persistence.runTransaction("Locally write mutations","readwrite",N=>{let w=Gr(),k=$e();return u.Os.getEntries(N,h).next(I=>{w=I,w.forEach((C,_)=>{_.isValidDocument()||(k=k.add(C))})}).next(()=>u.localDocuments.getOverlayedDocuments(N,w)).next(I=>{g=I;const C=[];for(const _ of l){const v=lE(_,g.get(_.key).overlayedDocument);v!=null&&C.push(new zs(_.key,v,mb(v.value.mapValue),Nr.exists(!0)))}return u.mutationQueue.addMutationBatch(N,d,C,l)}).next(I=>{x=I;const C=I.applyToLocalDocumentSet(g,k);return u.documentOverlayCache.saveOverlays(N,I.batchId,C)})}).then(()=>({batchId:x.batchId,changes:_b(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,l,u){let d=o.Ru[o.currentUser.toKey()];d||(d=new kt(Le)),d=d.insert(l,u),o.Ru[o.currentUser.toKey()]=d}(r,i.batchId,n),await ol(r,i.changes),await Vu(r.remoteStore)}catch(i){const a=Hm(i,"Failed to persist write");n.reject(a)}}async function ow(t,e){const n=Re(t);try{const r=await iC(n.localStore,e);e.targetChanges.forEach((i,a)=>{const o=n.Eu.get(a);o&&(tt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.lu=!0:i.modifiedDocuments.size>0?tt(o.lu,14607):i.removedDocuments.size>0&&(tt(o.lu,42227),o.lu=!1))}),await ol(n,r,e)}catch(r){await ja(r)}}function bx(t,e,n){const r=Re(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Pu.forEach((a,o)=>{const l=o.view.va(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const u=Re(o);u.onlineState=l;let d=!1;u.queries.forEach((h,g)=>{for(const x of g.wa)x.va(l)&&(d=!0)}),d&&Km(u)}(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function HC(t,e,n){const r=Re(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Eu.get(e),a=i&&i.key;if(a){let o=new kt(_e.comparator);o=o.insert(a,hn.newNoDocument(a,Ae.min()));const l=$e().add(a),u=new Lu(Ae.min(),new Map,new kt(Le),o,l);await ow(r,u),r.du=r.du.remove(a),r.Eu.delete(e),Zm(r)}else await df(r.localStore,e,!1).then(()=>mf(r,e,n)).catch(ja)}async function WC(t,e){const n=Re(t),r=e.batch.batchId;try{const i=await sC(n.localStore,e);cw(n,r,null),lw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ol(n,i)}catch(i){await ja(i)}}async function YC(t,e,n){const r=Re(t);try{const i=await function(o,l){const u=Re(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return u.mutationQueue.lookupMutationBatch(d,l).next(g=>(tt(g!==null,37113),h=g.keys(),u.mutationQueue.removeMutationBatch(d,g))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>u.localDocuments.getDocuments(d,h))})}(r.localStore,e);cw(r,e,n),lw(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ol(r,i)}catch(i){await ja(i)}}function lw(t,e){(t.Vu.get(e)||[]).forEach(n=>{n.resolve()}),t.Vu.delete(e)}function cw(t,e,n){const r=Re(t);let i=r.Ru[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(n?a.reject(n):a.resolve(),i=i.remove(e)),r.Ru[r.currentUser.toKey()]=i}}function mf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Tu.get(e))t.Pu.delete(r),n&&t.hu.pu(r,n);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(r=>{t.Au.containsKey(r)||uw(t,r)})}function uw(t,e){t.Iu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Bm(t.remoteStore,n),t.du=t.du.remove(e),t.Eu.delete(n),Zm(t))}function wx(t,e,n){for(const r of n)r instanceof sw?(t.Au.addReference(r.key,e),KC(t,r)):r instanceof iw?(be(Jm,"Document no longer in limbo: "+r.key),t.Au.removeReference(r.key,e),t.Au.containsKey(r.key)||uw(t,r.key)):Ce(19791,{yu:r})}function KC(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Iu.has(r)||(be(Jm,"New document in limbo: "+n),t.Iu.add(r),Zm(t))}function Zm(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const n=new _e(ct.fromString(e)),r=t.mu.next();t.Eu.set(r,new VC(n)),t.du=t.du.insert(n,r),Jb(t.remoteStore,new cs(wr(Au(n.path)),r,"TargetPurposeLimboResolution",Cu.ue))}}async function ol(t,e,n){const r=Re(t),i=[],a=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((l,u)=>{o.push(r.gu(u,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const g=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(u.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(d){i.push(d);const g=zm.Es(u.targetId,d);a.push(g)}}))}),await Promise.all(o),r.hu.J_(i),await async function(u,d){const h=Re(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>ie.forEach(d,x=>ie.forEach(x.Is,N=>h.persistence.referenceDelegate.addReference(g,x.targetId,N)).next(()=>ie.forEach(x.ds,N=>h.persistence.referenceDelegate.removeReference(g,x.targetId,N)))))}catch(g){if(!Sa(g))throw g;be($m,"Failed to update sequence numbers: "+g)}for(const g of d){const x=g.targetId;if(!g.fromCache){const N=h.Fs.get(x),w=N.snapshotVersion,k=N.withLastLimboFreeSnapshotVersion(w);h.Fs=h.Fs.insert(x,k)}}}(r.localStore,a))}async function XC(t,e){const n=Re(t);if(!n.currentUser.isEqual(e)){be(Jm,"User change. New user:",e.toKey());const r=await Wb(n.localStore,e);n.currentUser=e,function(a,o){a.Vu.forEach(l=>{l.forEach(u=>{u.reject(new xe(se.CANCELLED,o))})}),a.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ol(n,r.Bs)}}function JC(t,e){const n=Re(t),r=n.Eu.get(e);if(r&&r.lu)return $e().add(r.key);{let i=$e();const a=n.Tu.get(e);if(!a)return i;for(const o of a){const l=n.Pu.get(o);i=i.unionWith(l.view.tu)}return i}}function dw(t){const e=Re(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ow.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=JC.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=HC.bind(null,e),e.hu.J_=MC.bind(null,e.eventManager),e.hu.pu=LC.bind(null,e.eventManager),e}function ZC(t){const e=Re(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=WC.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=YC.bind(null,e),e}class nu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ou(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,n){return null}Fu(e,n){return null}vu(e){return rC(this.persistence,new eC,e.initialUser,this.serializer)}Du(e){return new Hb(Vm.Vi,this.serializer)}bu(e){return new uC}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}nu.provider={build:()=>new nu};class eT extends nu{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,n){tt(this.persistence.referenceDelegate instanceof eu,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new VE(r,e.asyncQueue,n)}Du(e){const n=this.cacheSizeBytes!==void 0?wn.withCacheSize(this.cacheSizeBytes):wn.DEFAULT;return new Hb(r=>eu.Vi(r,n),this.serializer)}}class pf{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>bx(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=XC.bind(null,this.syncEngine),await RC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new DC}()}createDatastore(e){const n=Ou(e.databaseInfo.databaseId),r=function(a){return new pC(a)}(e.databaseInfo);return function(a,o,l,u){return new vC(a,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,a,o,l){return new wC(r,i,a,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>bx(this.syncEngine,n,0),function(){return mx.C()?new mx:new dC}())}createSyncEngine(e,n){return function(i,a,o,l,u,d,h){const g=new zC(i,a,o,l,u,d);return h&&(g.fu=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const a=Re(i);be(fi,"RemoteStore shutting down."),a.Ia.add(5),await al(a),a.Ea.shutdown(),a.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}pf.provider={build:()=>new pf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Qr("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ps="FirestoreClient";class tT{constructor(e,n,r,i,a){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=cn.UNAUTHENTICATED,this.clientId=Em.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,async o=>{be(Ps,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(be(Ps,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Or;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Hm(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Bd(t,e){t.asyncQueue.verifyOperationInProgress(),be(Ps,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Wb(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>{Es("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{be("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{Es("Terminating Firestore due to IndexedDb database deletion failed",i)})}),t._offlineComponents=e}async function Nx(t,e){t.asyncQueue.verifyOperationInProgress();const n=await nT(t);be(Ps,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>gx(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>gx(e.remoteStore,i)),t._onlineComponents=e}async function nT(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){be(Ps,"Using user provided OfflineComponentProvider");try{await Bd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===se.FAILED_PRECONDITION||i.code===se.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Es("Error using user provided cache. Falling back to memory cache: "+n),await Bd(t,new nu)}}else be(Ps,"Using default OfflineComponentProvider"),await Bd(t,new eT(void 0));return t._offlineComponents}async function hw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(be(Ps,"Using user provided OnlineComponentProvider"),await Nx(t,t._uninitializedComponentsProvider._online)):(be(Ps,"Using default OnlineComponentProvider"),await Nx(t,new pf))),t._onlineComponents}function rT(t){return hw(t).then(e=>e.syncEngine)}async function ru(t){const e=await hw(t),n=e.eventManager;return n.onListen=$C.bind(null,e.syncEngine),n.onUnlisten=qC.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=BC.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=QC.bind(null,e.syncEngine),n}function sT(t,e,n={}){const r=new Or;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,l,u,d){const h=new ep({next:x=>{h.Ou(),o.enqueueAndForget(()=>Ym(a,g));const N=x.docs.has(l);!N&&x.fromCache?d.reject(new xe(se.UNAVAILABLE,"Failed to get document because the client is offline.")):N&&x.fromCache&&u&&u.source==="server"?d.reject(new xe(se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(x)},error:x=>d.reject(x)}),g=new Xm(Au(l.path),h,{includeMetadataChanges:!0,ka:!0});return Wm(a,g)}(await ru(t),t.asyncQueue,e,n,r)),r.promise}function iT(t,e,n={}){const r=new Or;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,l,u,d){const h=new ep({next:x=>{h.Ou(),o.enqueueAndForget(()=>Ym(a,g)),x.fromCache&&u.source==="server"?d.reject(new xe(se.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(x)},error:x=>d.reject(x)}),g=new Xm(l,h,{includeMetadataChanges:!0,ka:!0});return Wm(a,g)}(await ru(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jx=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mw="firestore.googleapis.com",Sx=!0;class _x{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new xe(se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=mw,this.ssl=Sx}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:Sx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Gb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<OE)throw new xe(se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}jk("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new xe(se.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new xe(se.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new xe(se.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class zu{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _x({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new xe(se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new xe(se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _x(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new mk;switch(r.type){case"firstParty":return new yk(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new xe(se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=jx.get(n);r&&(be("ComponentProvider","Removing Datastore"),jx.delete(n),r.terminate())}(this),Promise.resolve()}}function aT(t,e,n,r={}){var i;t=Wn(t,zu);const a=jm(e),o=t._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),u=`${e}:${n}`;a&&(zS(`https://${u}`),qS("Firestore",!0)),o.host!==mw&&o.host!==u&&Es("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=Object.assign(Object.assign({},o),{host:u,ssl:a,emulatorOptions:r});if(!ca(d,l)&&(t._setSettings(d),r.mockUserToken)){let h,g;if(typeof r.mockUserToken=="string")h=r.mockUserToken,g=cn.MOCK_USER;else{h=$S(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const x=r.mockUserToken.sub||r.mockUserToken.user_id;if(!x)throw new xe(se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new cn(x)}t._authCredentials=new pk(new eb(h,g))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new $s(this.firestore,e,this._query)}}class Tt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new js(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tt(this.firestore,e,this._key)}toJSON(){return{type:Tt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(nl(n,Tt._jsonSchema))return new Tt(e,r||null,new _e(ct.fromString(n.referencePath)))}}Tt._jsonSchemaVersion="firestore/documentReference/1.0",Tt._jsonSchema={type:Ot("string",Tt._jsonSchemaVersion),referencePath:Ot("string")};class js extends $s{constructor(e,n,r){super(e,n,Au(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tt(this.firestore,null,new _e(e))}withConverter(e){return new js(this.firestore,e,this._path)}}function ki(t,e,...n){if(t=Vn(t),nb("collection","path",e),t instanceof zu){const r=ct.fromString(e,...n);return Fg(r),new js(t,null,r)}{if(!(t instanceof Tt||t instanceof js))throw new xe(se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ct.fromString(e,...n));return Fg(r),new js(t.firestore,null,r)}}function mr(t,e,...n){if(t=Vn(t),arguments.length===1&&(e=Em.newId()),nb("doc","path",e),t instanceof zu){const r=ct.fromString(e,...n);return Og(r),new Tt(t,null,new _e(r))}{if(!(t instanceof Tt||t instanceof js))throw new xe(se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ct.fromString(e,...n));return Og(r),new Tt(t.firestore,t instanceof js?t.converter:null,new _e(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kx="AsyncQueue";class Ex{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Kb(this,"async_queue_retry"),this.oc=()=>{const r=$d();r&&be(kx,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const n=$d();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const n=$d();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const n=new Or;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Sa(e))throw e;be(kx,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const n=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,Qr("INTERNAL UNHANDLED ERROR: ",Cx(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(e,n,r){this.ac(),this.sc.indexOf(e)>-1&&(n=0);const i=Gm.createAndSchedule(this,e,n,r,a=>this.lc(a));return this.ec.push(i),i}ac(){this.tc&&Ce(47125,{hc:Cx(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const n of this.ec)if(n.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ec)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const n=this.ec.indexOf(e);this.ec.splice(n,1)}}function Cx(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tx(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const a of r)if(a in i&&typeof i[a]=="function")return!0;return!1}(t,["next","error","complete"])}class mi extends zu{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Ex,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Ex(e),this._firestoreClient=void 0,await e}}}function oT(t,e){const n=typeof t=="object"?t:q1(),r=typeof t=="string"?t:e||Wc,i=tl(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const a=FS("firestore");a&&aT(i,...a)}return i}function $u(t){if(t._terminated)throw new xe(se.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||lT(t),t._firestoreClient}function lT(t){var e,n,r;const i=t._freezeSettings(),a=function(l,u,d,h){return new Mk(l,u,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,fw(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new tT(t._authCredentials,t._appCheckCredentials,t._queue,a,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Qn(en.fromBase64String(e))}catch(n){throw new xe(se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Qn(en.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Qn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(nl(e,Qn._jsonSchema))return Qn.fromBase64String(e.bytes)}}Qn._jsonSchemaVersion="firestore/bytes/1.0",Qn._jsonSchema={type:Ot("string",Qn._jsonSchemaVersion),bytes:Ot("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new xe(se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new xe(se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new xe(se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Le(this._lat,e._lat)||Le(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Sr._jsonSchemaVersion}}static fromJSON(e){if(nl(e,Sr._jsonSchema))return new Sr(e.latitude,e.longitude)}}Sr._jsonSchemaVersion="firestore/geoPoint/1.0",Sr._jsonSchema={type:Ot("string",Sr._jsonSchemaVersion),latitude:Ot("number"),longitude:Ot("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0}(this._values,e._values)}toJSON(){return{type:_r._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(nl(e,_r._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new _r(e.vectorValues);throw new xe(se.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}_r._jsonSchemaVersion="firestore/vectorValue/1.0",_r._jsonSchema={type:Ot("string",_r._jsonSchemaVersion),vectorValues:Ot("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cT=/^__.*__$/;class uT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new zs(e,this.data,this.fieldMask,n,this.fieldTransforms):new sl(e,this.data,n,this.fieldTransforms)}}class pw{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new zs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function gw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ce(40011,{Ec:t})}}class Uu{constructor(e,n,r,i,a,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,a===void 0&&this.Ac(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Uu(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Rc({path:r,mc:!1});return i.fc(e),i}gc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return su(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(gw(this.Ec)&&cT.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class dT{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Ou(e)}Dc(e,n,r,i=!1){return new Uu({Ec:e,methodName:n,bc:r,path:Xt.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function tp(t){const e=t._freezeSettings(),n=Ou(t._databaseId);return new dT(t._databaseId,!!e.ignoreUndefinedProperties,n)}function hT(t,e,n,r,i,a={}){const o=t.Dc(a.merge||a.mergeFields?2:0,e,n,i);ip("Data must be an object, but it was:",o,r);const l=xw(r,o);let u,d;if(a.merge)u=new Mn(o.fieldMask),d=o.fieldTransforms;else if(a.mergeFields){const h=[];for(const g of a.mergeFields){const x=gf(e,g,n);if(!o.contains(x))throw new xe(se.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);vw(h,x)||h.push(x)}u=new Mn(h),d=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,d=o.fieldTransforms;return new uT(new jn(l),u,d)}class qu extends ka{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof qu}}function fT(t,e,n){return new Uu({Ec:3,bc:e.settings.bc,methodName:t._methodName,mc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class np extends ka{_toFieldTransform(e){return new Dm(e.path,new qo)}isEqual(e){return e instanceof np}}class rp extends ka{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=fT(this,e,!0),r=this.vc.map(a=>Ea(a,n)),i=new fa(r);return new Dm(e.path,i)}isEqual(e){return e instanceof rp&&ca(this.vc,e.vc)}}class sp extends ka{constructor(e,n){super(e),this.Cc=n}_toFieldTransform(e){const n=new Go(e.serializer,Cb(e.serializer,this.Cc));return new Dm(e.path,n)}isEqual(e){return e instanceof sp&&this.Cc===e.Cc}}function mT(t,e,n,r){const i=t.Dc(1,e,n);ip("Data must be an object, but it was:",i,r);const a=[],o=jn.empty();Vs(r,(u,d)=>{const h=ap(e,u,n);d=Vn(d);const g=i.gc(h);if(d instanceof qu)a.push(h);else{const x=Ea(d,g);x!=null&&(a.push(h),o.set(h,x))}});const l=new Mn(a);return new pw(o,l,i.fieldTransforms)}function pT(t,e,n,r,i,a){const o=t.Dc(1,e,n),l=[gf(e,r,n)],u=[i];if(a.length%2!=0)throw new xe(se.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<a.length;x+=2)l.push(gf(e,a[x])),u.push(a[x+1]);const d=[],h=jn.empty();for(let x=l.length-1;x>=0;--x)if(!vw(d,l[x])){const N=l[x];let w=u[x];w=Vn(w);const k=o.gc(N);if(w instanceof qu)d.push(N);else{const I=Ea(w,k);I!=null&&(d.push(N),h.set(N,I))}}const g=new Mn(d);return new pw(h,g,o.fieldTransforms)}function gT(t,e,n,r=!1){return Ea(n,t.Dc(r?4:3,e))}function Ea(t,e){if(yw(t=Vn(t)))return ip("Unsupported field value:",e,t),xw(t,e);if(t instanceof ka)return function(r,i){if(!gw(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(i);a&&i.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(r,i){const a=[];let o=0;for(const l of r){let u=Ea(l,i.yc(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}}(t,e)}return function(r,i){if((r=Vn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Cb(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=pt.fromDate(r);return{timestampValue:Zc(i.serializer,a)}}if(r instanceof pt){const a=new pt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Zc(i.serializer,a)}}if(r instanceof Sr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Qn)return{bytesValue:Vb(i.serializer,r._byteString)};if(r instanceof Tt){const a=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(a))throw i.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Om(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof _r)return function(o,l){return{mapValue:{fields:{[db]:{stringValue:fb},[Yc]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw l.wc("VectorValues must only contain numeric values.");return Pm(l.serializer,d)})}}}}}}(r,i);throw i.wc(`Unsupported field value: ${Eu(r)}`)}(t,e)}function xw(t,e){const n={};return ib(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Vs(t,(r,i)=>{const a=Ea(i,e.Vc(r));a!=null&&(n[r]=a)}),{mapValue:{fields:n}}}function yw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof pt||t instanceof Sr||t instanceof Qn||t instanceof Tt||t instanceof ka||t instanceof _r)}function ip(t,e,n){if(!yw(n)||!rb(n)){const r=Eu(n);throw r==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+r)}}function gf(t,e,n){if((e=Vn(e))instanceof Bu)return e._internalPath;if(typeof e=="string")return ap(t,e);throw su("Field path arguments must be of type string or ",t,!1,void 0,n)}const xT=new RegExp("[~\\*/\\[\\]]");function ap(t,e,n){if(e.search(xT)>=0)throw su(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Bu(...e.split("."))._internalPath}catch{throw su(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function su(t,e,n,r,i){const a=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new xe(se.INVALID_ARGUMENT,l+t+u)}function vw(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw{constructor(e,n,r,i,a){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Tt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new yT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(op("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class yT extends bw{data(){return super.data()}}function op(t,e){return typeof e=="string"?ap(t,e):e instanceof Bu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ww(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new xe(se.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class lp{}class Nw extends lp{}function vT(t,e,...n){let r=[];e instanceof lp&&r.push(e),r=r.concat(n),function(a){const o=a.filter(u=>u instanceof cp).length,l=a.filter(u=>u instanceof Qu).length;if(o>1||o>0&&l>0)throw new xe(se.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Qu extends Nw{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Qu(e,n,r)}_apply(e){const n=this._parse(e);return jw(e._query,n),new $s(e.firestore,e.converter,af(e._query,n))}_parse(e){const n=tp(e.firestore);return function(a,o,l,u,d,h,g){let x;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new xe(se.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){Ax(g,h);const w=[];for(const k of g)w.push(Ix(u,a,k));x={arrayValue:{values:w}}}else x=Ix(u,a,g)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||Ax(g,h),x=gT(l,o,g,h==="in"||h==="not-in");return Lt.create(d,h,x)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function bT(t,e,n){const r=e,i=op("where",t);return Qu._create(i,r,n)}class cp extends lp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new cp(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:ur.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,a){let o=i;const l=a.getFlattenedFilters();for(const u of l)jw(o,u),o=af(o,u)}(e._query,n),new $s(e.firestore,e.converter,af(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class up extends Nw{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new up(e,n,r)}_apply(e){return new $s(e.firestore,e.converter,Jc(e._query,this._limit,this._limitType))}}function wT(t){return Sk("limit",t),up._create("limit",t,"F")}function Ix(t,e,n){if(typeof(n=Vn(n))=="string"){if(n==="")throw new xe(se.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!wb(e)&&n.indexOf("/")!==-1)throw new xe(se.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ct.fromString(n));if(!_e.isDocumentKey(r))throw new xe(se.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Gg(t,new _e(r))}if(n instanceof Tt)return Gg(t,n._key);throw new xe(se.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Eu(n)}.`)}function Ax(t,e){if(!Array.isArray(t)||t.length===0)throw new xe(se.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function jw(t,e){const n=function(i,a){for(const o of i)for(const l of o.getFlattenedFilters())if(a.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new xe(se.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new xe(se.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class NT{convertValue(e,n="none"){switch(As(e)){case 0:return null;case 1:return e.booleanValue;case 2:return At(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Is(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ce(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Vs(e,(i,a)=>{r[i]=this.convertValue(a,n)}),r}convertVectorValue(e){var n,r,i;const a=(i=(r=(n=e.fields)===null||n===void 0?void 0:n[Yc].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>At(o.doubleValue));return new _r(a)}convertGeoPoint(e){return new Sr(At(e.latitude),At(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Iu(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp($o(e));default:return null}}convertTimestamp(e){const n=Ts(e);return new pt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ct.fromString(e);tt(Qb(r),9688,{name:e});const i=new Bo(r.get(1),r.get(3)),a=new _e(r.popFirst(5));return i.isEqual(n)||Qr(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jT(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class so{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ii extends bw{constructor(e,n,r,i,a,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new xc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(op("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new xe(se.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=ii._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}ii._jsonSchemaVersion="firestore/documentSnapshot/1.0",ii._jsonSchema={type:Ot("string",ii._jsonSchemaVersion),bundleSource:Ot("string","DocumentSnapshot"),bundleName:Ot("string"),bundle:Ot("string")};class xc extends ii{data(e={}){return super.data(e)}}class ai{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new so(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new xc(this._firestore,this._userDataWriter,r.key,r,new so(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new xe(se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const u=new xc(i._firestore,i._userDataWriter,l.doc.key,l.doc,new so(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>a||l.type!==3).map(l=>{const u=new xc(i._firestore,i._userDataWriter,l.doc.key,l.doc,new so(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:ST(l.type),doc:u,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new xe(se.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ai._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Em.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(a=>{a._document!==null&&(n.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function ST(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ce(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rx(t){t=Wn(t,Tt);const e=Wn(t.firestore,mi);return sT($u(e),t._key).then(n=>_w(e,t,n))}ai._jsonSchemaVersion="firestore/querySnapshot/1.0",ai._jsonSchema={type:Ot("string",ai._jsonSchemaVersion),bundleSource:Ot("string","QuerySnapshot"),bundleName:Ot("string"),bundle:Ot("string")};class dp extends NT{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Tt(this.firestore,null,n)}}function Ga(t){t=Wn(t,$s);const e=Wn(t.firestore,mi),n=$u(e),r=new dp(e);return ww(t._query),iT(n,t._query).then(i=>new ai(e,r,t,i))}function Mi(t,e,n){t=Wn(t,Tt);const r=Wn(t.firestore,mi),i=jT(t.converter,e,n);return Sw(r,[hT(tp(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Nr.none())])}function Ha(t,e,n,...r){t=Wn(t,Tt);const i=Wn(t.firestore,mi),a=tp(i);let o;return o=typeof(e=Vn(e))=="string"||e instanceof Bu?pT(a,"updateDoc",t._key,e,n,r):mT(a,"updateDoc",t._key,e),Sw(i,[o.toMutation(t._key,Nr.exists(!0))])}function _T(t,...e){var n,r,i;t=Vn(t);let a={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Tx(e[o])||(a=e[o++]);const l={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(Tx(e[o])){const g=e[o];e[o]=(n=g.next)===null||n===void 0?void 0:n.bind(g),e[o+1]=(r=g.error)===null||r===void 0?void 0:r.bind(g),e[o+2]=(i=g.complete)===null||i===void 0?void 0:i.bind(g)}let u,d,h;if(t instanceof Tt)d=Wn(t.firestore,mi),h=Au(t._key.path),u={next:g=>{e[o]&&e[o](_w(d,t,g))},error:e[o+1],complete:e[o+2]};else{const g=Wn(t,$s);d=Wn(g.firestore,mi),h=g._query;const x=new dp(d);u={next:N=>{e[o]&&e[o](new ai(d,x,g,N))},error:e[o+1],complete:e[o+2]},ww(t._query)}return function(x,N,w,k){const I=new ep(k),C=new Xm(N,I,w);return x.asyncQueue.enqueueAndForget(async()=>Wm(await ru(x),C)),()=>{I.Ou(),x.asyncQueue.enqueueAndForget(async()=>Ym(await ru(x),C))}}($u(d),h,l,u)}function Sw(t,e){return function(r,i){const a=new Or;return r.asyncQueue.enqueueAndForget(async()=>GC(await rT(r),i,a)),a.promise}($u(t),e)}function _w(t,e,n){const r=n.docs.get(e._key),i=new dp(t);return new ii(t,i,e._key,r,new so(n.hasPendingWrites,n.fromCache),e.converter)}function nr(){return new np("serverTimestamp")}function Px(...t){return new rp("arrayUnion",t)}function Ei(t){return new sp("increment",t)}(function(e,n=!0){(function(i){Na=i})(tk),ks(new Ur("firestore",(r,{instanceIdentifier:i,options:a})=>{const o=r.getProvider("app").getImmediate(),l=new mi(new gk(r.getProvider("auth-internal")),new vk(o,r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new xe(se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bo(d.options.projectId,h)}(o,i),o);return a=Object.assign({useFetchStreams:n},a),l._setSettings(a),l},"PUBLIC").setMultipleInstances(!0)),br(Rg,Pg,e),br(Rg,Pg,"esm2017")})();const kw="@firebase/installations",hp="0.6.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ew=1e4,Cw=`w:${hp}`,Tw="FIS_v2",kT="https://firebaseinstallations.googleapis.com/v1",ET=60*60*1e3,CT="installations",TT="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IT={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},pi=new ku(CT,TT,IT);function Iw(t){return t instanceof Fs&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aw({projectId:t}){return`${kT}/projects/${t}/installations`}function Rw(t){return{token:t.token,requestStatus:2,expiresIn:RT(t.expiresIn),creationTime:Date.now()}}async function Pw(t,e){const r=(await e.json()).error;return pi.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function Dw({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function AT(t,{refreshToken:e}){const n=Dw(t);return n.append("Authorization",PT(e)),n}async function Mw(t){const e=await t();return e.status>=500&&e.status<600?t():e}function RT(t){return Number(t.replace("s","000"))}function PT(t){return`${Tw} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DT({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=Aw(t),i=Dw(t),a=e.getImmediate({optional:!0});if(a){const d=await a.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const o={fid:n,authVersion:Tw,appId:t.appId,sdkVersion:Cw},l={method:"POST",headers:i,body:JSON.stringify(o)},u=await Mw(()=>fetch(r,l));if(u.ok){const d=await u.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:Rw(d.authToken)}}else throw await Pw("Create Installation",u)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lw(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MT(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LT=/^[cdef][\w-]{21}$/,xf="";function OT(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=FT(t);return LT.test(n)?n:xf}catch{return xf}}function FT(t){return MT(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gu(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ow=new Map;function Fw(t,e){const n=Gu(t);Vw(n,e),VT(n,e)}function Vw(t,e){const n=Ow.get(t);if(n)for(const r of n)r(e)}function VT(t,e){const n=zT();n&&n.postMessage({key:t,fid:e}),$T()}let ei=null;function zT(){return!ei&&"BroadcastChannel"in self&&(ei=new BroadcastChannel("[Firebase] FID Change"),ei.onmessage=t=>{Vw(t.data.key,t.data.fid)}),ei}function $T(){Ow.size===0&&ei&&(ei.close(),ei=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BT="firebase-installations-database",UT=1,gi="firebase-installations-store";let Ud=null;function fp(){return Ud||(Ud=B1(BT,UT,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(gi)}}})),Ud}async function iu(t,e){const n=Gu(t),i=(await fp()).transaction(gi,"readwrite"),a=i.objectStore(gi),o=await a.get(n);return await a.put(e,n),await i.done,(!o||o.fid!==e.fid)&&Fw(t,e.fid),e}async function zw(t){const e=Gu(t),r=(await fp()).transaction(gi,"readwrite");await r.objectStore(gi).delete(e),await r.done}async function Hu(t,e){const n=Gu(t),i=(await fp()).transaction(gi,"readwrite"),a=i.objectStore(gi),o=await a.get(n),l=e(o);return l===void 0?await a.delete(n):await a.put(l,n),await i.done,l&&(!o||o.fid!==l.fid)&&Fw(t,l.fid),l}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mp(t){let e;const n=await Hu(t.appConfig,r=>{const i=qT(r),a=QT(t,i);return e=a.registrationPromise,a.installationEntry});return n.fid===xf?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function qT(t){const e=t||{fid:OT(),registrationStatus:0};return $w(e)}function QT(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(pi.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=GT(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:HT(t)}:{installationEntry:e}}async function GT(t,e){try{const n=await DT(t,e);return iu(t.appConfig,n)}catch(n){throw Iw(n)&&n.customData.serverCode===409?await zw(t.appConfig):await iu(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function HT(t){let e=await Dx(t.appConfig);for(;e.registrationStatus===1;)await Lw(100),e=await Dx(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await mp(t);return r||n}return e}function Dx(t){return Hu(t,e=>{if(!e)throw pi.create("installation-not-found");return $w(e)})}function $w(t){return WT(t)?{fid:t.fid,registrationStatus:0}:t}function WT(t){return t.registrationStatus===1&&t.registrationTime+Ew<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YT({appConfig:t,heartbeatServiceProvider:e},n){const r=KT(t,n),i=AT(t,n),a=e.getImmediate({optional:!0});if(a){const d=await a.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const o={installation:{sdkVersion:Cw,appId:t.appId}},l={method:"POST",headers:i,body:JSON.stringify(o)},u=await Mw(()=>fetch(r,l));if(u.ok){const d=await u.json();return Rw(d)}else throw await Pw("Generate Auth Token",u)}function KT(t,{fid:e}){return`${Aw(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pp(t,e=!1){let n;const r=await Hu(t.appConfig,a=>{if(!Bw(a))throw pi.create("not-registered");const o=a.authToken;if(!e&&ZT(o))return a;if(o.requestStatus===1)return n=XT(t,e),a;{if(!navigator.onLine)throw pi.create("app-offline");const l=tI(a);return n=JT(t,l),l}});return n?await n:r.authToken}async function XT(t,e){let n=await Mx(t.appConfig);for(;n.authToken.requestStatus===1;)await Lw(100),n=await Mx(t.appConfig);const r=n.authToken;return r.requestStatus===0?pp(t,e):r}function Mx(t){return Hu(t,e=>{if(!Bw(e))throw pi.create("not-registered");const n=e.authToken;return nI(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function JT(t,e){try{const n=await YT(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await iu(t.appConfig,r),n}catch(n){if(Iw(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await zw(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await iu(t.appConfig,r)}throw n}}function Bw(t){return t!==void 0&&t.registrationStatus===2}function ZT(t){return t.requestStatus===2&&!eI(t)}function eI(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+ET}function tI(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function nI(t){return t.requestStatus===1&&t.requestTime+Ew<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rI(t){const e=t,{installationEntry:n,registrationPromise:r}=await mp(e);return r?r.catch(console.error):pp(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sI(t,e=!1){const n=t;return await iI(n),(await pp(n,e)).token}async function iI(t){const{registrationPromise:e}=await mp(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aI(t){if(!t||!t.options)throw qd("App Configuration");if(!t.name)throw qd("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw qd(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function qd(t){return pi.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uw="installations",oI="installations-internal",lI=t=>{const e=t.getProvider("app").getImmediate(),n=aI(e),r=tl(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},cI=t=>{const e=t.getProvider("app").getImmediate(),n=tl(e,Uw).getImmediate();return{getId:()=>rI(n),getToken:i=>sI(n,i)}};function uI(){ks(new Ur(Uw,lI,"PUBLIC")),ks(new Ur(oI,cI,"PRIVATE"))}uI();br(kw,hp);br(kw,hp,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const au="analytics",dI="firebase_id",hI="origin",fI=60*1e3,mI="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",gp="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yn=new Sm("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pI={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},On=new ku("analytics","Analytics",pI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gI(t){if(!t.startsWith(gp)){const e=On.create("invalid-gtag-resource",{gtagURL:t});return yn.warn(e.message),""}return t}function qw(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function xI(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function yI(t,e){const n=xI("firebase-js-sdk-policy",{createScriptURL:gI}),r=document.createElement("script"),i=`${gp}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function vI(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function bI(t,e,n,r,i,a){const o=r[i];try{if(o)await e[o];else{const u=(await qw(n)).find(d=>d.measurementId===i);u&&await e[u.appId]}}catch(l){yn.error(l)}t("config",i,a)}async function wI(t,e,n,r,i){try{let a=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const l=await qw(n);for(const u of o){const d=l.find(g=>g.measurementId===u),h=d&&e[d.appId];if(h)a.push(h);else{a=[];break}}}a.length===0&&(a=Object.values(e)),await Promise.all(a),t("event",r,i||{})}catch(a){yn.error(a)}}function NI(t,e,n,r){async function i(a,...o){try{if(a==="event"){const[l,u]=o;await wI(t,e,n,l,u)}else if(a==="config"){const[l,u]=o;await bI(t,e,n,r,l,u)}else if(a==="consent"){const[l,u]=o;t("consent",l,u)}else if(a==="get"){const[l,u,d]=o;t("get",l,u,d)}else if(a==="set"){const[l]=o;t("set",l)}else t(a,...o)}catch(l){yn.error(l)}}return i}function jI(t,e,n,r,i){let a=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(a=window[i]),window[i]=NI(a,t,e,n),{gtagCore:a,wrappedGtag:window[i]}}function SI(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(gp)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I=30,kI=1e3;class EI{constructor(e={},n=kI){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const Qw=new EI;function CI(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function TI(t){var e;const{appId:n,apiKey:r}=t,i={method:"GET",headers:CI(r)},a=mI.replace("{app-id}",n),o=await fetch(a,i);if(o.status!==200&&o.status!==304){let l="";try{const u=await o.json();!((e=u.error)===null||e===void 0)&&e.message&&(l=u.error.message)}catch{}throw On.create("config-fetch-failed",{httpStatus:o.status,responseMessage:l})}return o.json()}async function II(t,e=Qw,n){const{appId:r,apiKey:i,measurementId:a}=t.options;if(!r)throw On.create("no-app-id");if(!i){if(a)return{measurementId:a,appId:r};throw On.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new PI;return setTimeout(async()=>{l.abort()},n!==void 0?n:fI),Gw({appId:r,apiKey:i,measurementId:a},o,l,e)}async function Gw(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=Qw){var a;const{appId:o,measurementId:l}=t;try{await AI(r,e)}catch(u){if(l)return yn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:o,measurementId:l};throw u}try{const u=await TI(t);return i.deleteThrottleMetadata(o),u}catch(u){const d=u;if(!RI(d)){if(i.deleteThrottleMetadata(o),l)return yn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:o,measurementId:l};throw u}const h=Number((a=d==null?void 0:d.customData)===null||a===void 0?void 0:a.httpStatus)===503?Ng(n,i.intervalMillis,_I):Ng(n,i.intervalMillis),g={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return i.setThrottleMetadata(o,g),yn.debug(`Calling attemptFetch again in ${h} millis`),Gw(t,g,r,i)}}function AI(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),a=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(a),r(On.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function RI(t){if(!(t instanceof Fs)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class PI{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function DI(t,e,n,r,i){if(i&&i.global){t("event",n,r);return}else{const a=await e,o=Object.assign(Object.assign({},r),{send_to:a});t("event",n,o)}}async function MI(t,e,n,r){if(r&&r.global)return t("set",{user_id:n}),Promise.resolve();{const i=await e;t("config",i,{update:!0,user_id:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LI(){if(F1())try{await V1()}catch(t){return yn.warn(On.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return yn.warn(On.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function OI(t,e,n,r,i,a,o){var l;const u=II(t);u.then(N=>{n[N.measurementId]=N.appId,t.options.measurementId&&N.measurementId!==t.options.measurementId&&yn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${N.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(N=>yn.error(N)),e.push(u);const d=LI().then(N=>{if(N)return r.getId()}),[h,g]=await Promise.all([u,d]);SI(a)||yI(a,h.measurementId),i("js",new Date);const x=(l=o==null?void 0:o.config)!==null&&l!==void 0?l:{};return x[hI]="firebase",x.update=!0,g!=null&&(x[dI]=g),i("config",h.measurementId,x),h.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FI=class{constructor(e){this.app=e}_delete(){return delete ta[this.app.options.appId],Promise.resolve()}},ta={},Lx=[];const Ox={};let Qd="dataLayer",VI="gtag",Fx,xp,Vx=!1;function zI(){const t=[];if(HS()&&t.push("This is a browser extension environment."),YS()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=On.create("invalid-analytics-context",{errorInfo:e});yn.warn(n.message)}}function $I(t,e,n){zI();const r=t.options.appId;if(!r)throw On.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)yn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw On.create("no-api-key");if(ta[r]!=null)throw On.create("already-exists",{id:r});if(!Vx){vI(Qd);const{wrappedGtag:a,gtagCore:o}=jI(ta,Lx,Ox,Qd,VI);xp=a,Fx=o,Vx=!0}return ta[r]=OI(t,Lx,Ox,e,Fx,Qd,n),new FI(t)}function BI(t=q1()){t=Vn(t);const e=tl(t,au);return e.isInitialized()?e.getImmediate():UI(t)}function UI(t,e={}){const n=tl(t,au);if(n.isInitialized()){const i=n.getImmediate();if(ca(e,n.getOptions()))return i;throw On.create("already-initialized")}return n.initialize({options:e})}function qI(t,e,n){t=Vn(t),MI(xp,ta[t.app.options.appId],e,n).catch(r=>yn.error(r))}function Hw(t,e,n,r){t=Vn(t),DI(xp,ta[t.app.options.appId],e,n,r).catch(i=>yn.error(i))}const zx="@firebase/analytics",$x="0.10.17";function QI(){ks(new Ur(au,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return $I(r,i,n)},"PUBLIC")),ks(new Ur("analytics-internal",t,"PRIVATE")),br(zx,$x),br(zx,$x,"esm2017");function t(e){try{const n=e.getProvider(au).getImmediate();return{logEvent:(r,i,a)=>Hw(n,r,i,a)}}catch(n){throw On.create("interop-component-reg-failed",{reason:n})}}}QI();const GI={apiKey:"AIzaSyBteLG6N6Sr-AXt0M13CYpS0Cflu6kv_AQ",authDomain:"quizify-43799.firebaseapp.com",projectId:"quizify-43799",storageBucket:"quizify-43799.firebasestorage.app",messagingSenderId:"389410159905",appId:"1:389410159905:web:e81a297fd64eb0bc4a1260",measurementId:"G-7BFF7BFNJS"},Ww=U1(GI),ln=oT(Ww);let Ho=null;const HI=!window.Capacitor||window.Capacitor.platform==="web";if(HI)try{Ho=BI(Ww)}catch(t){console.error("Analytics initialization failed:",t)}const Qs=(t,e={})=>{try{Ho&&(Hw(Ho,t,e),console.log("Event tracked:",t,e))}catch(n){console.error("Analytics error:",n)}},WI=t=>{try{Ho&&(qI(Ho,t),console.log("Analytics user set:",t))}catch(e){console.error("Set user ID error:",e)}},Ci=window.Capacitor&&window.Capacitor.platform!=="web";let YI=class{constructor(){this.sessionStart=Date.now(),this.userId=null,this.sessionId=null}async startSession(e){this.userId=null,this.sessionId=null,this.userId=e,this.sessionStart=Date.now(),this.sessionId=`${e}_${Date.now()}`,console.log("Analytics session started for:",e),Ci||(WI(e),Qs("session_start",{userId:e}));const n=new Date().toISOString().split("T")[0];try{await Mi(mr(ln,"sessions",this.sessionId),{userId:e,startTime:nr(),date:n,active:!0,events:[]});const r=mr(ln,"user_stats",e);(await Rx(r)).exists()?await Ha(r,{totalSessions:Ei(1),lastActive:nr()}):await Mi(r,{userId:e,totalSessions:1,totalQuizzes:0,totalScore:0,joinedDate:nr(),lastActive:nr()})}catch(r){console.error("Session tracking error:",r)}this.trackEventLocal("session_start",{userId:e})}async endSession(){var e,n,r,i;if(this.sessionId){const a=Math.floor((Date.now()-this.sessionStart)/1e3);Ci||Qs("session_end",{userId:this.userId,duration:a});try{const l=(await Rx(mr(ln,"sessions",this.sessionId))).data(),u={totalEvents:((e=l==null?void 0:l.events)==null?void 0:e.length)||0,uniqueButtons:[...new Set(((n=l==null?void 0:l.events)==null?void 0:n.map(d=>d.buttonName))||[])],uniqueScreens:[...new Set(((r=l==null?void 0:l.events)==null?void 0:r.map(d=>d.context))||[])],mostClickedButton:this.getMostFrequent(((i=l==null?void 0:l.events)==null?void 0:i.map(d=>d.buttonName))||[])};await Ha(mr(ln,"sessions",this.sessionId),{endTime:nr(),duration:a,active:!1,summary:u})}catch(o){console.error("End session error:",o)}}}logout(){console.log("Analytics logout - clearing user:",this.userId),this.userId=null,this.sessionId=null,this.sessionStart=Date.now(),localStorage.removeItem("analytics_events")}trackEvent(e,n={}){Ci||Qs(e,{userId:this.userId,...n}),this.trackEventLocal(e,n)}trackEventLocal(e,n={}){const r={event:e,userId:this.userId,timestamp:Date.now(),sessionDuration:Math.floor((Date.now()-this.sessionStart)/1e3),...n},i=JSON.parse(localStorage.getItem("analytics_events")||"[]");i.push(r),localStorage.setItem("analytics_events",JSON.stringify(i)),console.log("Event tracked locally:",r)}async trackQuizAttempt(e){const{mode:n,category:r,score:i,totalQuestions:a,timeSpent:o}=e,l=a>0?i/a*100:0;Ci||Qs("quiz_completed",{mode:n,category:r,score:i,accuracy:l,time_spent:o,userId:this.userId});try{await Mi(mr(ln,"quiz_attempts",`${this.userId}_${Date.now()}`),{userId:this.userId,sessionId:this.sessionId,mode:n,category:r,score:i,totalQuestions:a,accuracy:l,timeSpent:o,timestamp:nr()}),await Ha(mr(ln,"user_stats",this.userId),{totalQuizzes:Ei(1),totalScore:Ei(i),totalQuestions:Ei(a),lastActive:nr()})}catch(u){console.error("Quiz tracking error:",u)}this.updateDailyStats("quiz_completed",{score:i,category:r}),this.trackEventLocal("quiz_completed",{mode:n,category:r,score:i,totalQuestions:a,accuracy:l,timeSpent:o})}trackScreenView(e){Qs("screen_view",{screen_name:e,userId:this.userId})}async trackButtonClick(e,n){Ci||Qs("button_click",{button_name:e,context:n,userId:this.userId});try{await Mi(mr(ln,"events",`${this.userId}_${Date.now()}`),{userId:this.userId,eventType:"button_click",buttonName:e,context:n,timestamp:nr()})}catch(r){console.error("Button tracking error:",r)}if(this.sessionId)try{await Ha(mr(ln,"sessions",this.sessionId),{events:Px({type:"button_click",buttonName:e,context:n,timestamp:new Date().toISOString()})})}catch(r){console.error("Session event tracking error:",r)}this.updateDailyStats(e)}async updateDailyStats(e,n={}){if(!this.userId)return;const r=new Date().toISOString().split("T")[0],i=mr(ln,"user_daily_stats",`${this.userId}_${r}`);try{await Ha(i,{[`actions.${e}`]:Ei(1),totalActions:Ei(1),lastActive:nr()})}catch{try{await Mi(i,{userId:this.userId,date:r,actions:{[e]:1},totalActions:1,firstActive:nr(),lastActive:nr(),sessions:Px(this.sessionId)})}catch(o){console.error("Daily stats error:",o)}}}trackGameScore(e,n){this.trackQuizAttempt({mode:n,category:"general",score:e,totalQuestions:10,timeSpent:Math.floor((Date.now()-this.sessionStart)/1e3)})}getUserAnalytics(){var r;const n=JSON.parse(localStorage.getItem("analytics_events")||"[]").filter(i=>i.userId===this.userId);return{totalSessions:n.filter(i=>i.event==="session_start").length,totalGames:n.filter(i=>i.event==="quiz_completed").length,averageSessionTime:this.calculateAverageSessionTime(n),lastActive:(r=n[n.length-1])==null?void 0:r.timestamp}}calculateAverageSessionTime(e){const n=e.filter(i=>i.event==="session_start");if(n.length===0)return 0;const r=e.reduce((i,a)=>i+(a.sessionDuration||0),0);return Math.floor(r/n.length)}trackFeatureUsage(e,n={}){Ci||Qs("feature_used",{feature:e,userId:this.userId,...n})}getMostFrequent(e){if(!e.length)return null;const n=e.reduce((r,i)=>(r[i]=(r[i]||0)+1,r),{});return Object.keys(n).reduce((r,i)=>n[r]>n[i]?r:i)}};const mt=new YI;function KI({size:t=22,spinning:e=!1}){return s.jsx("div",{style:{width:t,height:t},className:"grid place-items-center",children:s.jsxs("svg",{viewBox:"0 0 100 100",className:`${e?"animate-[spin_0.8s_ease-out]":"motion-safe:animate-[spin_9s_linear_infinite]"} group-active:motion-safe:animate-[spin_1.2s_linear_infinite]`,style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"},children:[s.jsx("path",{d:"M50,50 L50,5 A45,45 0 0,1 86.97,25.98 Z",fill:"#6366F1"}),s.jsx("path",{d:"M50,50 L86.97,25.98 A45,45 0 0,1 86.97,74.02 Z",fill:"#22C55E"}),s.jsx("path",{d:"M50,50 L86.97,74.02 A45,45 0 0,1 50,95 Z",fill:"#F59E0B"}),s.jsx("path",{d:"M50,50 L50,95 A45,45 0 0,1 13.03,74.02 Z",fill:"#EF4444"}),s.jsx("path",{d:"M50,50 L13.03,74.02 A45,45 0 0,1 13.03,25.98 Z",fill:"#3B82F6"}),s.jsx("path",{d:"M50,50 L13.03,25.98 A45,45 0 0,1 50,5 Z",fill:"#8B5CF6"}),s.jsx("circle",{cx:"50",cy:"50",r:"9",fill:"#111827",stroke:"white",strokeWidth:"2"})]})})}function XI(){const t=Ye(),{pathname:e}=Pt(),n=f.useRef({}),r=f.useRef({}),[i,a]=f.useState(!1),o=f.useRef(null);f.useEffect(()=>{const v=o.current;if(!v)return;const P=D=>{D.preventDefault();const L=.1;v.scrollTop+=D.deltaY*L};return v.addEventListener("wheel",P,{passive:!1}),()=>{v.removeEventListener("wheel",P)}},[]);const l=v=>{if(navigator.vibrate)switch(v){case"light":navigator.vibrate(20);break;case"medium":navigator.vibrate(35);break;case"heavy":navigator.vibrate(50);break;case"double":navigator.vibrate([30,50,30]);break;case"success":navigator.vibrate([20,50,20,50,20]);break;default:navigator.vibrate(25)}};f.useCallback(()=>{var v;if(["/","/play","/swipe","/profile"].includes(e)){const P=((v=o.current)==null?void 0:v.scrollTop)||0,D=window.scrollY||window.pageYOffset||0,L=P>0?P:D;console.log(`Saving scroll for ${e}: main=${P}, window=${D}, saved=${L}`),n.current[e]=L}},[e]),f.useEffect(()=>{let v=null;const P=()=>{v&&cancelAnimationFrame(v),v=requestAnimationFrame(()=>{var L;if(["/","/play","/swipe","/profile"].includes(e)){const E=((L=o.current)==null?void 0:L.scrollTop)||0,m=window.scrollY||window.pageYOffset||0,y=E>0?E:m;n.current[e]=y,console.log(`Scroll position updated for ${e}: ${y}`)}})};window.addEventListener("scroll",P,{passive:!0});const D=o.current;return D&&D.addEventListener("scroll",P,{passive:!0}),()=>{v&&cancelAnimationFrame(v),window.removeEventListener("scroll",P),D&&D.removeEventListener("scroll",P)}},[e]),f.useEffect(()=>{if(o.current&&o.current.classList.add("navigating"),["/profile/","/quiz/","/practice/","/play/classic","/settings","/about"].some(D=>e.startsWith(D)))window.scrollTo(0,0),o.current&&(o.current.scrollTop=0),setTimeout(()=>{o.current&&o.current.classList.remove("navigating")},20);else{const D=n.current[e];if(console.log(`Attempting to restore scroll for ${e}: ${D}`),D!=null&&D>0){const L=(E=0)=>{E>=5||(o.current?(o.current.scrollTop=D,setTimeout(()=>{var y;const m=((y=o.current)==null?void 0:y.scrollTop)||0;Math.abs(m-D)>10?(window.scrollTo(0,D),setTimeout(()=>{const j=window.scrollY||window.pageYOffset||0;console.log(`Restore attempt ${E+1}: main=${m}, window=${j}, target=${D}`),Math.abs(j-D)>10&&Math.abs(m-D)>10&&L(E+1)},20)):console.log(`Successfully restored scroll to ${m}`)},20)):window.scrollTo(0,D))};L(0),setTimeout(()=>{o.current&&o.current.classList.remove("navigating")},20)}else window.scrollTo(0,0),o.current&&(o.current.scrollTop=0),setTimeout(()=>{o.current&&o.current.classList.remove("navigating")},20)}},[e]);const[u,d]=f.useState(!1),[h,g]=f.useState({open:!1,go:null}),[x,N]=f.useState(!1);f.useEffect(()=>{const v=()=>{N(document.body.classList.contains("hide-bottom-nav"))};v();const P=new MutationObserver(v);return P.observe(document.body,{attributes:!0,attributeFilter:["class"]}),()=>P.disconnect()},[]),f.useEffect(()=>{const v=new MutationObserver(()=>{d(document.body.classList.contains("modal-open"))});return v.observe(document.body,{attributes:!0,attributeFilter:["class"]}),()=>v.disconnect()},[]);const k=u||x||[/^\/quiz\//,/^\/practice\//,/^\/profile\//,/^\/play\/classic/].some(v=>v.test(e)),I=v=>v==="/"?e==="/":e.startsWith(v),C=f.useCallback(()=>{console.log("Scrolling to top"),window.scrollTo({top:0,behavior:"smooth"}),o.current&&o.current.scrollTo({top:0,behavior:"smooth"}),document.documentElement.scrollTop=0,document.body.scrollTop=0},[]),_=({path:v,icon:P,label:D,emoji:L})=>{const E=I(v),[m,y]=f.useState(!1),j=f.useCallback(()=>{var Z;const A=Date.now();if(mt.trackButtonClick(`nav_${D.toLowerCase()}`,"bottom_navigation"),E){const te=r.current[v]||0;console.log(`Active tab clicked. Time since last tap: ${A-te}ms`),A-te<500?(console.log("Double tap detected!"),C(),l("double"),r.current[v]=0):r.current[v]=A;return}if(["/","/play","/swipe","/profile"].includes(e)){const te=((Z=o.current)==null?void 0:Z.scrollTop)||0,K=window.scrollY||window.pageYOffset||0,$=te>0?te:K;console.log(`Manually saving scroll before navigation from ${e}: ${$}`),n.current[e]=$}const T=r.current[v]||0;if(A-T<500){console.log("Double tap on inactive tab - navigating and scrolling to top"),n.current[v]=0,v==="/play"?(a(!0),l("double"),setTimeout(()=>{t(`/play?view=modes&reset=${Date.now()}`),a(!1),setTimeout(C,100)},200)):(l("double"),t(v),setTimeout(C,100)),r.current[v]=0;return}r.current[v]=A,y(!0),setTimeout(()=>y(!1),600);const S=()=>{if(v==="/play"){a(!0),l("heavy"),setTimeout(()=>{t(`/play?view=modes&reset=${Date.now()}`),a(!1)},200);return}l("medium"),t(v)};if(localStorage.getItem("qp_in_question")==="true"){g({open:!0,go:S});return}S()},[E,v,e,t,C,l]);return s.jsxs("button",{type:"button",onClick:j,className:`group relative flex h-14 w-20 flex-col items-center justify-center rounded-xl transition-all
          ${E?"scale-110":"scale-100 hover:scale-105"}
          ${m?"animate-bounce":""}`,"aria-current":E?"page":void 0,children:[E&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"absolute -top-2 h-1.5 w-10 rounded-full bg-gradient-to-r from-transparent via-white to-transparent opacity-60"}),s.jsx("div",{className:"absolute inset-0 rounded-xl bg-white/10 blur-xl"})]}),s.jsx("div",{className:`leading-none text-2xl transition-transform ${E?"scale-125":""} ${v==="/play"&&i?"animate-spin":""}`,children:L||P}),s.jsx("span",{className:`mt-1 text-[10px] font-medium transition-all ${E?"text-white":"text-base-muted/80"}`,children:D})]})};return s.jsxs("div",{className:"min-h-screen bg-base-bg text-base-text",children:[s.jsx("style",{children:`
        .hide-bottom-nav nav[role="navigation"] {
         display: none !important;
        }
        main.navigating {
          visibility: hidden;
        }
        main {
          scroll-behavior: auto !important;
        }
      `}),s.jsx("main",{ref:o,className:"mx-auto w-full max-w-none px-1 sm:px-3 md:px-4 overscroll-y-contain",style:{height:k||document.body.classList.contains("hide-bottom-nav")?"100dvh":"calc(100dvh - (5.5rem + env(safe-area-inset-bottom)))",paddingTop:"calc(env(safe-area-inset-top) + 12px)",paddingBottom:k||document.body.classList.contains("hide-bottom-nav")?0:void 0,overflowY:"auto"},children:s.jsx(Qj,{})}),h.open&&s.jsxs("div",{className:"fixed inset-0 z-50 bg-black/70 backdrop-blur-sm flex items-center justify-center px-6",style:{animation:"fadeIn 0.2s ease-out"},children:[s.jsxs("div",{className:"w-full max-w-sm rounded-3xl bg-gradient-to-b from-base-card to-base-card/90 border border-base-border p-6 text-center shadow-2xl",style:{animation:"slideUp 0.3s ease-out"},children:[s.jsx("div",{className:"text-5xl mb-4",style:{animation:"bounce 0.6s ease-out"},children:""}),s.jsx("div",{className:"text-xl font-bold mb-2 bg-gradient-to-r from-red-400 to-orange-400 bg-clip-text text-transparent",children:"Leave the game?"}),s.jsx("p",{className:"text-base-muted mb-6 text-sm",children:"You'll lose your current progress!"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>{l("medium"),g({open:!1,go:null})},className:"flex-1 py-3 rounded-2xl border-2 border-green-500/30 bg-green-500/10 hover:bg-green-500/20 transition-all font-semibold text-green-400",children:"Keep Playing! "}),s.jsx("button",{onClick:()=>{l("heavy");const v=h.go;g({open:!1,go:null}),v==null||v()},className:"flex-1 py-3 rounded-2xl bg-gradient-to-r from-red-500/80 to-orange-500/80 text-white font-semibold hover:from-red-500 hover:to-orange-500 transition-all",children:"Leave "})]})]}),s.jsx("style",{children:`
            @keyframes fadeIn {
              from { opacity: 0; }
              to { opacity: 1; }
            }
            @keyframes slideUp {
              from { transform: translateY(20px); opacity: 0; }
              to { transform: translateY(0); opacity: 1; }
            }
          `})]}),!k&&s.jsxs("nav",{role:"navigation","aria-label":"Bottom navigation",className:"fixed inset-x-0 bottom-0 z-50",children:[s.jsx("div",{className:"absolute inset-x-0 bottom-0 bg-gradient-to-t from-[#0B0F1A] to-[#0B0F1A]/95 backdrop-blur-lg",style:{height:"calc(5.5rem + env(safe-area-inset-bottom))"},"aria-hidden":!0}),s.jsx("div",{className:"relative mx-auto max-w-md px-4 pb-[calc(env(safe-area-inset-bottom)+0.5rem)] pt-2",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 rounded-3xl bg-gradient-to-r from-purple-500/20 via-blue-500/20 to-green-500/20 blur-2xl"}),s.jsxs("div",{className:"relative flex h-[72px] items-center justify-around rounded-3xl border border-white/10 bg-gradient-to-b from-base-card/95 to-base-card/80 shadow-2xl backdrop-blur-xl",children:[s.jsx(_,{path:"/",emoji:"",label:"Home"}),s.jsx(_,{path:"/play",icon:s.jsx(KI,{size:26,spinning:i}),label:"Play"}),s.jsx(_,{path:"/swipe",emoji:"",label:"Swipe"}),s.jsx(_,{path:"/profile",emoji:"",label:"Profile"})]})]})})]})]})}function ou(){return ou=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ou.apply(null,arguments)}function JI(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function ZI(t){f.useEffect(t,[])}var e4=["id","volume","playbackRate","soundEnabled","interrupt","onload"];function Ft(t,e){var n=e===void 0?{}:e,r=n.volume,i=r===void 0?1:r,a=n.playbackRate,o=a===void 0?1:a,l=n.soundEnabled,u=l===void 0?!0:l,d=n.interrupt,h=d===void 0?!1:d,g=n.onload,x=JI(n,e4),N=pn.useRef(null),w=pn.useRef(!1),k=pn.useState(null),I=k[0],C=k[1],_=pn.useState(null),v=_[0],P=_[1],D=function(){typeof g=="function"&&g.call(this),w.current&&C(this.duration()*1e3),P(this)};ZI(function(){return mm(()=>import("./howler-af1369e6.js").then(j=>j.h),[]).then(function(j){if(!w.current){var A;N.current=(A=j.Howl)!==null&&A!==void 0?A:j.default.Howl,w.current=!0,new N.current(ou({src:Array.isArray(t)?t:[t],volume:i,rate:o,onload:D},x))}}),function(){w.current=!1}}),pn.useEffect(function(){N.current&&v&&P(new N.current(ou({src:Array.isArray(t)?t:[t],volume:i,onload:D},x)))},[JSON.stringify(t)]),pn.useEffect(function(){v&&(v.volume(i),x.sprite||v.rate(o))},[v,i,o]);var L=pn.useCallback(function(j){typeof j>"u"&&(j={}),!(!v||!u&&!j.forceSoundEnabled)&&(h&&v.stop(),j.playbackRate&&v.rate(j.playbackRate),v.play(j.id))},[v,u,h]),E=pn.useCallback(function(j){v&&v.stop(j)},[v]),m=pn.useCallback(function(j){v&&v.pause(j)},[v]),y=[L,{sound:v,stop:E,pause:m,duration:I}];return y}class t4{constructor(){console.log("UserService initialized")}getUserData(e){try{if(!e)return console.log("No phone provided to getUserData"),null;const r=JSON.parse(localStorage.getItem("users")||"{}")[e]||{},i=JSON.parse(localStorage.getItem(`user_profile_${e}`)||"{}"),a={...r,phone:e,username:i.name||r.username||"",email:i.email||"",city:i.city||"",state:i.state||"",country:i.country||""};return console.log("getUserData merged result:",a),a}catch(n){return console.error("Error in getUserData:",n),null}}getUserDataByIdentifier(e){try{const n=this.getUserData(e);if(n)return n;const r=JSON.parse(localStorage.getItem("users")||"{}");for(let i in r)if(r[i].username===e)return this.getUserData(i);return null}catch(n){return console.error("Error in getUserDataByIdentifier:",n),null}}userExists(e){try{return JSON.parse(localStorage.getItem("users")||"{}").hasOwnProperty(e)}catch(n){return console.error("Error checking if user exists:",n),!1}}createUser(e,n){try{console.log("Creating user:",e,n);const r=JSON.parse(localStorage.getItem("users")||"{}");return r[e]={username:n.username,password:n.password||"123456",avatar:n.avatar,gender:n.gender,ageGroup:n.ageGroup,phone:e,createdAt:new Date().toISOString()},localStorage.setItem("users",JSON.stringify(r)),this.setCurrentUser(e),console.log("User created successfully"),!0}catch(r){return console.error("Error creating user:",r),!1}}setCurrentUser(e){try{const n=this.getUserData(e);if(!n)return!1;const r={phone:e,username:n.username,avatar:n.avatar,gender:n.gender,ageGroup:n.ageGroup};localStorage.setItem("currentUser",JSON.stringify(r));const i=JSON.parse(localStorage.getItem("qp_player")||"{}");return i.name=n.username,localStorage.setItem("qp_player",JSON.stringify(i)),console.log("Current user set:",r),!0}catch(n){return console.error("Error setting current user:",n),!1}}updateUserProfile(e,n){try{if(console.log("Updating profile for:",e,n),n.name){const l=JSON.parse(localStorage.getItem("users")||"{}");if(l[e]){l[e].username=n.name;const u=l[e].password;l[e].password=u,localStorage.setItem("users",JSON.stringify(l))}}const r=`user_profile_${e}`,a={...JSON.parse(localStorage.getItem(r)||"{}"),...n};localStorage.setItem(r,JSON.stringify(a));const o=JSON.parse(localStorage.getItem("currentUser")||"{}");if(o.phone===e){o.username=n.name||o.username,localStorage.setItem("currentUser",JSON.stringify(o));const l=JSON.parse(localStorage.getItem("qp_player")||"{}");l.name=n.name||l.name,localStorage.setItem("qp_player",JSON.stringify(l))}return console.log("Profile updated successfully"),!0}catch(r){return console.error("Error updating profile:",r),!1}}getCurrentUser(){try{const e=JSON.parse(localStorage.getItem("currentUser")||"{}");return e.phone?this.getUserData(e.phone):null}catch(e){return console.error("Error getting current user:",e),null}}signOut(){try{return localStorage.removeItem("currentUser"),localStorage.removeItem("rememberCredentials"),sessionStorage.clear(),console.log("User signed out"),!0}catch(e){return console.error("Error signing out:",e),!1}}}const jt=new t4;window.userService=jt;class n4{constructor(){this.STORAGE_KEYS={COINS:"qp_coins",XP:"qp_xp",LEVEL:"qp_level",OWNED_CHARACTERS:"owned_characters",SOUND:"play_sound_on",GAME_STATS:"game_stats_",DAILY_PROGRESS:"daily_progress_",QUEST_DATA:"quest_data_",STREAK_DATA:"streak_data_",GAME_HISTORY:"game_history_",QUIZ_RESULTS:"quiz_current_results"}}getCoins(){return this.safeGet(this.STORAGE_KEYS.COINS,0)}setCoins(e){return this.safeSet(this.STORAGE_KEYS.COINS,e),e}addCoins(e,n=""){const i=this.getCoins()+e;this.setCoins(i);const a=jt.getCurrentUser();return a!=null&&a.phone&&(this.logCoinTransaction(a.phone,e,n),this.updateDailyCoins(a.phone,e)),i}spendCoins(e,n=""){const r=this.getCoins();if(r<e)return!1;const i=r-e;this.setCoins(i);const a=jt.getCurrentUser();return a!=null&&a.phone&&this.logCoinTransaction(a.phone,-e,n),!0}getXP(){return this.safeGet(this.STORAGE_KEYS.XP,0)}setXP(e){return this.safeSet(this.STORAGE_KEYS.XP,e),e}addXP(e){const r=this.getXP()+e;this.setXP(r),this.checkAndUpdateLevel(r);const i=jt.getCurrentUser();return i!=null&&i.phone&&this.updateDailyXP(i.phone,e),r}getLevel(){return this.safeGet(this.STORAGE_KEYS.LEVEL,1)}setLevel(e){return this.safeSet(this.STORAGE_KEYS.LEVEL,e),e}checkAndUpdateLevel(e=null){const n=e||this.getXP(),r=this.getLevel();let i=1,a=0;for(;a<=n;)i++,a=100*i*(i-1);if(i--,i>r){this.setLevel(i);const o=50*(i-r);return this.addCoins(o,`Level up to ${i}!`),!0}return!1}initializeUserData(e){if(!e)return;const n=this.getUserStats(e);if(n)return n;const r={stats:{totalQuizzes:0,totalPractice:0,totalCorrect:0,totalWrong:0,winStreak:0,bestStreak:0,highScore:0,gamesPlayed:0},quests:{daily:[{id:"quiz_3",type:"quiz",target:3,current:0,reward:60,completed:!1},{id:"practice_15",type:"practice",target:15,current:0,reward:100,completed:!1},{id:"win_5",type:"win_streak",target:5,current:0,reward:150,completed:!1},{id:"speed_run",type:"speed_run",target:1,current:0,reward:80,completed:!1}]},streak:{current:0,lastPlayedDate:null,longestStreak:0}};return this.safeSet(this.STORAGE_KEYS.GAME_STATS+e,r.stats),this.safeSet(this.STORAGE_KEYS.QUEST_DATA+e,r.quests),this.safeSet(this.STORAGE_KEYS.STREAK_DATA+e,r.streak),this.resetDailyProgress(e),r}getUserStats(e){return e?this.safeGet(this.STORAGE_KEYS.GAME_STATS+e,null):null}updateUserStats(e,n){if(!e)return null;const i={...this.getUserStats(e)||{},...n};return this.safeSet(this.STORAGE_KEYS.GAME_STATS+e,i),i}getDailyProgress(e){if(!e)return null;const n=this.safeGet(this.STORAGE_KEYS.DAILY_PROGRESS+e,null),r=new Date().toDateString();return!n||n.date!==r?this.resetDailyProgress(e):n}resetDailyProgress(e){if(!e)return null;const n={date:new Date().toDateString(),quizzesPlayed:0,practiceCompleted:0,coinsEarned:0,xpEarned:0,questsCompleted:[]};return this.safeSet(this.STORAGE_KEYS.DAILY_PROGRESS+e,n),this.resetDailyQuests(e),n}updateDailyCoins(e,n){if(!e)return;const r=this.getDailyProgress(e);r&&(r.coinsEarned+=n,this.safeSet(this.STORAGE_KEYS.DAILY_PROGRESS+e,r))}updateDailyXP(e,n){if(!e)return;const r=this.getDailyProgress(e);r&&(r.xpEarned+=n,this.safeSet(this.STORAGE_KEYS.DAILY_PROGRESS+e,r))}getQuestData(e){return e?this.safeGet(this.STORAGE_KEYS.QUEST_DATA+e,null):null}resetDailyQuests(e){if(!e)return null;const n={daily:[{id:"quiz_3",type:"quiz",target:3,current:0,reward:60,completed:!1},{id:"practice_15",type:"practice",target:15,current:0,reward:100,completed:!1},{id:"win_5",type:"win_streak",target:5,current:0,reward:150,completed:!1},{id:"speed_run",type:"speed_run",target:1,current:0,reward:80,completed:!1}]};return this.safeSet(this.STORAGE_KEYS.QUEST_DATA+e,n),n}updateQuestProgress(e,n,r=1){if(!e)return null;const i=this.getQuestData(e);if(!(i!=null&&i.daily))return null;let a=0;const o={...i,daily:i.daily.map(l=>{if(l.type===n&&!l.completed){const u=Math.min(l.current+r,l.target),d=u>=l.target;return d&&!l.completed&&(a+=l.reward,this.addCoins(l.reward,`Quest completed: ${l.id}`)),{...l,current:u,completed:d}}return l})};return this.safeSet(this.STORAGE_KEYS.QUEST_DATA+e,o),{updatedQuests:o,coinsEarned:a}}getStreakData(e){return e?this.safeGet(this.STORAGE_KEYS.STREAK_DATA+e,{current:0,lastPlayedDate:null,longestStreak:0}):null}updateStreak(e){if(!e)return null;const n=this.getStreakData(e),r=new Date().toDateString(),i=new Date(Date.now()-864e5).toDateString();return n.lastPlayedDate===r||(n.lastPlayedDate===i?n.current++:n.current=1,n.lastPlayedDate=r,n.longestStreak=Math.max(n.current,n.longestStreak),this.safeSet(this.STORAGE_KEYS.STREAK_DATA+e,n),n.current%7===0&&this.addCoins(100,"7-day streak bonus!")),n}recordQuizSession(e,n){const{score:r,totalQuestions:i,category:a,difficulty:o="medium",mode:l="classic"}=n,h=r*5+(r===i?20:0),g=r*10;if(this.addCoins(h,`Quiz: ${r}/${i}`),this.addXP(g),e){const x=this.getUserStats(e)||this.initializeUserData(e).stats;x.totalQuizzes++,x.totalCorrect+=r,x.totalWrong+=i-r,x.gamesPlayed++,r>=i*.7?(x.winStreak++,x.bestStreak=Math.max(x.winStreak,x.bestStreak)):x.winStreak=0,x.highScore=Math.max(x.highScore,r),this.updateUserStats(e,x);const N=this.getDailyProgress(e);N.quizzesPlayed++,this.safeSet(this.STORAGE_KEYS.DAILY_PROGRESS+e,N),this.updateQuestProgress(e,"quiz",1),x.winStreak>=5&&this.updateQuestProgress(e,"win_streak",x.winStreak),this.updateStreak(e),this.addToHistory(e,{type:"quiz",mode:l,category:a,score:r,totalQuestions:i,difficulty:o,coinsEarned:h,xpEarned:g,timestamp:new Date().toISOString()})}return{coinsEarned:h,xpEarned:g,newTotal:this.getCoins(),newXP:this.getXP(),newLevel:this.getLevel()}}recordPracticeSession(e,n){const{questionsCompleted:r,correctAnswers:i,category:a="general"}=n,o=r*2,l=r*5;if(this.addCoins(o,`Practice: ${r} questions`),this.addXP(l),e){const u=this.getUserStats(e)||this.initializeUserData(e).stats;u.totalPractice+=r,u.totalCorrect+=i,u.totalWrong+=r-i,this.updateUserStats(e,u);const d=this.getDailyProgress(e);d.practiceCompleted+=r,this.safeSet(this.STORAGE_KEYS.DAILY_PROGRESS+e,d),this.updateQuestProgress(e,"practice",r),this.updateStreak(e),this.addToHistory(e,{type:"practice",category:a,questionsCompleted:r,correctAnswers:i,coinsEarned:o,xpEarned:l,timestamp:new Date().toISOString()})}return{coinsEarned:o,xpEarned:l,newTotal:this.getCoins(),newXP:this.getXP()}}getGameHistory(e){return e?this.safeGet(this.STORAGE_KEYS.GAME_HISTORY+e,[]):[]}addToHistory(e,n){if(!e)return;const r=this.getGameHistory(e);r.unshift(n),r.length>50&&r.pop(),this.safeSet(this.STORAGE_KEYS.GAME_HISTORY+e,r)}getTodaySummary(e){var i;const n=e||((i=jt.getCurrentUser())==null?void 0:i.phone),r={totalCoins:this.getCoins(),totalXP:this.getXP(),level:this.getLevel(),xpProgress:this.getXP()%100,xpNeeded:100,todayCoins:0,todayXP:0,streak:0,questProgress:0,activeQuests:0};if(n){const a=this.getDailyProgress(n),o=this.getStreakData(n),l=this.getQuestData(n),u=this.getUserStats(n);if(a&&(r.todayCoins=a.coinsEarned,r.todayXP=a.xpEarned),o&&(r.streak=o.current),l!=null&&l.daily){const d=l.daily.filter(h=>h.completed).length;r.questProgress=Math.round(d/l.daily.length*100),r.activeQuests=l.daily.filter(h=>!h.completed).length}u&&(r.rank=23,r.winStreak=u.winStreak)}return r}logCoinTransaction(e,n,r){if(!e)return;const i="coin_transactions_"+e,a=this.safeGet(i,[]);a.push({amount:n,reason:r,timestamp:new Date().toISOString(),balance:this.getCoins()}),a.length>100&&a.shift(),this.safeSet(i,a)}storeCurrentResults(e){return this.safeSet(this.STORAGE_KEYS.QUIZ_RESULTS,{...e,timestamp:Date.now(),expiresAt:Date.now()+30*60*1e3}),!0}getCurrentResults(){const e=this.safeGet(this.STORAGE_KEYS.QUIZ_RESULTS,null);return e?e.expiresAt&&e.expiresAt<Date.now()?(this.clearCurrentResults(),null):e:null}clearCurrentResults(){localStorage.removeItem(this.STORAGE_KEYS.QUIZ_RESULTS)}safeGet(e,n=null){try{const r=localStorage.getItem(e);return r?JSON.parse(r):n}catch{return n}}safeSet(e,n){try{return localStorage.setItem(e,JSON.stringify(n)),!0}catch{return!1}}clearAllData(){Object.values(this.STORAGE_KEYS).forEach(e=>{typeof e=="string"&&!e.includes("_")&&localStorage.removeItem(e)})}clearUserData(e){if(!e)return;[this.STORAGE_KEYS.GAME_STATS+e,this.STORAGE_KEYS.DAILY_PROGRESS+e,this.STORAGE_KEYS.QUEST_DATA+e,this.STORAGE_KEYS.STREAK_DATA+e,this.STORAGE_KEYS.GAME_HISTORY+e,"coin_transactions_"+e].forEach(r=>localStorage.removeItem(r))}}const ye=new n4;var Yw={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){((n,r)=>{t.exports=r()})(_2,function n(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},i,a=!r.document&&!!r.postMessage,o=r.IS_PAPA_WORKER||!1,l={},u=0,d={};function h(m){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(y){var j=D(y);j.chunkSize=parseInt(j.chunkSize),y.step||y.chunk||(j.chunkSize=null),this._handle=new k(j),(this._handle.streamer=this)._config=j}).call(this,m),this.parseChunk=function(y,j){var A=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<A){let S=this._config.newline;S||(T=this._config.quoteChar||'"',S=this._handle.guessLineEndings(y,T)),y=[...y.split(S).slice(A)].join(S)}this.isFirstChunk&&E(this._config.beforeFirstChunk)&&(T=this._config.beforeFirstChunk(y))!==void 0&&(y=T),this.isFirstChunk=!1,this._halted=!1;var A=this._partialLine+y,T=(this._partialLine="",this._handle.parse(A,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(y=T.meta.cursor,A=(this._finished||(this._partialLine=A.substring(y-this._baseIndex),this._baseIndex=y),T&&T.data&&(this._rowCount+=T.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)r.postMessage({results:T,workerId:d.WORKER_ID,finished:A});else if(E(this._config.chunk)&&!j){if(this._config.chunk(T,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=T=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(T.data),this._completeResults.errors=this._completeResults.errors.concat(T.errors),this._completeResults.meta=T.meta),this._completed||!A||!E(this._config.complete)||T&&T.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),A||T&&T.meta.paused||this._nextChunk(),T}this._halted=!0},this._sendError=function(y){E(this._config.error)?this._config.error(y):o&&this._config.error&&r.postMessage({workerId:d.WORKER_ID,error:y,finished:!1})}}function g(m){var y;(m=m||{}).chunkSize||(m.chunkSize=d.RemoteChunkSize),h.call(this,m),this._nextChunk=a?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(j){this._input=j,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(y=new XMLHttpRequest,this._config.withCredentials&&(y.withCredentials=this._config.withCredentials),a||(y.onload=L(this._chunkLoaded,this),y.onerror=L(this._chunkError,this)),y.open(this._config.downloadRequestBody?"POST":"GET",this._input,!a),this._config.downloadRequestHeaders){var j,A=this._config.downloadRequestHeaders;for(j in A)y.setRequestHeader(j,A[j])}var T;this._config.chunkSize&&(T=this._start+this._config.chunkSize-1,y.setRequestHeader("Range","bytes="+this._start+"-"+T));try{y.send(this._config.downloadRequestBody)}catch(S){this._chunkError(S.message)}a&&y.status===0&&this._chunkError()}},this._chunkLoaded=function(){y.readyState===4&&(y.status<200||400<=y.status?this._chunkError():(this._start+=this._config.chunkSize||y.responseText.length,this._finished=!this._config.chunkSize||this._start>=(j=>(j=j.getResponseHeader("Content-Range"))!==null?parseInt(j.substring(j.lastIndexOf("/")+1)):-1)(y),this.parseChunk(y.responseText)))},this._chunkError=function(j){j=y.statusText||j,this._sendError(new Error(j))}}function x(m){(m=m||{}).chunkSize||(m.chunkSize=d.LocalChunkSize),h.call(this,m);var y,j,A=typeof FileReader<"u";this.stream=function(T){this._input=T,j=T.slice||T.webkitSlice||T.mozSlice,A?((y=new FileReader).onload=L(this._chunkLoaded,this),y.onerror=L(this._chunkError,this)):y=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var T=this._input,S=(this._config.chunkSize&&(S=Math.min(this._start+this._config.chunkSize,this._input.size),T=j.call(T,this._start,S)),y.readAsText(T,this._config.encoding));A||this._chunkLoaded({target:{result:S}})},this._chunkLoaded=function(T){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(T.target.result)},this._chunkError=function(){this._sendError(y.error)}}function N(m){var y;h.call(this,m=m||{}),this.stream=function(j){return y=j,this._nextChunk()},this._nextChunk=function(){var j,A;if(!this._finished)return j=this._config.chunkSize,y=j?(A=y.substring(0,j),y.substring(j)):(A=y,""),this._finished=!y,this.parseChunk(A)}}function w(m){h.call(this,m=m||{});var y=[],j=!0,A=!1;this.pause=function(){h.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){h.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(T){this._input=T,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){A&&y.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),y.length?this.parseChunk(y.shift()):j=!0},this._streamData=L(function(T){try{y.push(typeof T=="string"?T:T.toString(this._config.encoding)),j&&(j=!1,this._checkIsFinished(),this.parseChunk(y.shift()))}catch(S){this._streamError(S)}},this),this._streamError=L(function(T){this._streamCleanUp(),this._sendError(T)},this),this._streamEnd=L(function(){this._streamCleanUp(),A=!0,this._streamData("")},this),this._streamCleanUp=L(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function k(m){var y,j,A,T,S=Math.pow(2,53),G=-S,Z=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,te=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,K=this,$=0,O=0,V=!1,B=!1,M=[],z={data:[],errors:[],meta:{}};function H(X){return m.skipEmptyLines==="greedy"?X.join("").trim()==="":X.length===1&&X[0].length===0}function ne(){if(z&&A&&(ee("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),A=!1),m.skipEmptyLines&&(z.data=z.data.filter(function(ue){return!H(ue)})),q()){let ue=function(ae,ce){E(m.transformHeader)&&(ae=m.transformHeader(ae,ce)),M.push(ae)};if(z)if(Array.isArray(z.data[0])){for(var X=0;q()&&X<z.data.length;X++)z.data[X].forEach(ue);z.data.splice(0,1)}else z.data.forEach(ue)}function Q(ue,ae){for(var ce=m.header?{}:[],J=0;J<ue.length;J++){var W=J,F=ue[J],F=((re,le)=>(pe=>(m.dynamicTypingFunction&&m.dynamicTyping[pe]===void 0&&(m.dynamicTyping[pe]=m.dynamicTypingFunction(pe)),(m.dynamicTyping[pe]||m.dynamicTyping)===!0))(re)?le==="true"||le==="TRUE"||le!=="false"&&le!=="FALSE"&&((pe=>{if(Z.test(pe)&&(pe=parseFloat(pe),G<pe&&pe<S))return 1})(le)?parseFloat(le):te.test(le)?new Date(le):le===""?null:le):le)(W=m.header?J>=M.length?"__parsed_extra":M[J]:W,F=m.transform?m.transform(F,W):F);W==="__parsed_extra"?(ce[W]=ce[W]||[],ce[W].push(F)):ce[W]=F}return m.header&&(J>M.length?ee("FieldMismatch","TooManyFields","Too many fields: expected "+M.length+" fields but parsed "+J,O+ae):J<M.length&&ee("FieldMismatch","TooFewFields","Too few fields: expected "+M.length+" fields but parsed "+J,O+ae)),ce}var oe;z&&(m.header||m.dynamicTyping||m.transform)&&(oe=1,!z.data.length||Array.isArray(z.data[0])?(z.data=z.data.map(Q),oe=z.data.length):z.data=Q(z.data,0),m.header&&z.meta&&(z.meta.fields=M),O+=oe)}function q(){return m.header&&M.length===0}function ee(X,Q,oe,ue){X={type:X,code:Q,message:oe},ue!==void 0&&(X.row=ue),z.errors.push(X)}E(m.step)&&(T=m.step,m.step=function(X){z=X,q()?ne():(ne(),z.data.length!==0&&($+=X.data.length,m.preview&&$>m.preview?j.abort():(z.data=z.data[0],T(z,K))))}),this.parse=function(X,Q,oe){var ue=m.quoteChar||'"',ue=(m.newline||(m.newline=this.guessLineEndings(X,ue)),A=!1,m.delimiter?E(m.delimiter)&&(m.delimiter=m.delimiter(X),z.meta.delimiter=m.delimiter):((ue=((ae,ce,J,W,F)=>{var re,le,pe,Ne;F=F||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var Pe=0;Pe<F.length;Pe++){for(var De,xt=F[Pe],Be=0,ge=0,Te=0,Ie=(pe=void 0,new C({comments:W,delimiter:xt,newline:ce,preview:10}).parse(ae)),Me=0;Me<Ie.data.length;Me++)J&&H(Ie.data[Me])?Te++:(De=Ie.data[Me].length,ge+=De,pe===void 0?pe=De:0<De&&(Be+=Math.abs(De-pe),pe=De));0<Ie.data.length&&(ge/=Ie.data.length-Te),(le===void 0||Be<=le)&&(Ne===void 0||Ne<ge)&&1.99<ge&&(le=Be,re=xt,Ne=ge)}return{successful:!!(m.delimiter=re),bestDelimiter:re}})(X,m.newline,m.skipEmptyLines,m.comments,m.delimitersToGuess)).successful?m.delimiter=ue.bestDelimiter:(A=!0,m.delimiter=d.DefaultDelimiter),z.meta.delimiter=m.delimiter),D(m));return m.preview&&m.header&&ue.preview++,y=X,j=new C(ue),z=j.parse(y,Q,oe),ne(),V?{meta:{paused:!0}}:z||{meta:{paused:!1}}},this.paused=function(){return V},this.pause=function(){V=!0,j.abort(),y=E(m.chunk)?"":y.substring(j.getCharIndex())},this.resume=function(){K.streamer._halted?(V=!1,K.streamer.parseChunk(y,!0)):setTimeout(K.resume,3)},this.aborted=function(){return B},this.abort=function(){B=!0,j.abort(),z.meta.aborted=!0,E(m.complete)&&m.complete(z),y=""},this.guessLineEndings=function(ae,ue){ae=ae.substring(0,1048576);var ue=new RegExp(I(ue)+"([^]*?)"+I(ue),"gm"),oe=(ae=ae.replace(ue,"")).split("\r"),ue=ae.split(`
`),ae=1<ue.length&&ue[0].length<oe[0].length;if(oe.length===1||ae)return`
`;for(var ce=0,J=0;J<oe.length;J++)oe[J][0]===`
`&&ce++;return ce>=oe.length/2?`\r
`:"\r"}}function I(m){return m.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function C(m){var y=(m=m||{}).delimiter,j=m.newline,A=m.comments,T=m.step,S=m.preview,G=m.fastMode,Z=null,te=!1,K=m.quoteChar==null?'"':m.quoteChar,$=K;if(m.escapeChar!==void 0&&($=m.escapeChar),(typeof y!="string"||-1<d.BAD_DELIMITERS.indexOf(y))&&(y=","),A===y)throw new Error("Comment character same as delimiter");A===!0?A="#":(typeof A!="string"||-1<d.BAD_DELIMITERS.indexOf(A))&&(A=!1),j!==`
`&&j!=="\r"&&j!==`\r
`&&(j=`
`);var O=0,V=!1;this.parse=function(B,M,z){if(typeof B!="string")throw new Error("Input must be a string");var H=B.length,ne=y.length,q=j.length,ee=A.length,X=E(T),Q=[],oe=[],ue=[],ae=O=0;if(!B)return Be();if(G||G!==!1&&B.indexOf(K)===-1){for(var ce=B.split(j),J=0;J<ce.length;J++){if(ue=ce[J],O+=ue.length,J!==ce.length-1)O+=j.length;else if(z)return Be();if(!A||ue.substring(0,ee)!==A){if(X){if(Q=[],Ne(ue.split(y)),ge(),V)return Be()}else Ne(ue.split(y));if(S&&S<=J)return Q=Q.slice(0,S),Be(!0)}}return Be()}for(var W=B.indexOf(y,O),F=B.indexOf(j,O),re=new RegExp(I($)+I(K),"g"),le=B.indexOf(K,O);;)if(B[O]===K)for(le=O,O++;;){if((le=B.indexOf(K,le+1))===-1)return z||oe.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Q.length,index:O}),De();if(le===H-1)return De(B.substring(O,le).replace(re,K));if(K===$&&B[le+1]===$)le++;else if(K===$||le===0||B[le-1]!==$){W!==-1&&W<le+1&&(W=B.indexOf(y,le+1));var pe=Pe((F=F!==-1&&F<le+1?B.indexOf(j,le+1):F)===-1?W:Math.min(W,F));if(B.substr(le+1+pe,ne)===y){ue.push(B.substring(O,le).replace(re,K)),B[O=le+1+pe+ne]!==K&&(le=B.indexOf(K,O)),W=B.indexOf(y,O),F=B.indexOf(j,O);break}if(pe=Pe(F),B.substring(le+1+pe,le+1+pe+q)===j){if(ue.push(B.substring(O,le).replace(re,K)),xt(le+1+pe+q),W=B.indexOf(y,O),le=B.indexOf(K,O),X&&(ge(),V))return Be();if(S&&Q.length>=S)return Be(!0);break}oe.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Q.length,index:O}),le++}}else if(A&&ue.length===0&&B.substring(O,O+ee)===A){if(F===-1)return Be();O=F+q,F=B.indexOf(j,O),W=B.indexOf(y,O)}else if(W!==-1&&(W<F||F===-1))ue.push(B.substring(O,W)),O=W+ne,W=B.indexOf(y,O);else{if(F===-1)break;if(ue.push(B.substring(O,F)),xt(F+q),X&&(ge(),V))return Be();if(S&&Q.length>=S)return Be(!0)}return De();function Ne(Te){Q.push(Te),ae=O}function Pe(Te){var Ie=0;return Ie=Te!==-1&&(Te=B.substring(le+1,Te))&&Te.trim()===""?Te.length:Ie}function De(Te){return z||(Te===void 0&&(Te=B.substring(O)),ue.push(Te),O=H,Ne(ue),X&&ge()),Be()}function xt(Te){O=Te,Ne(ue),ue=[],F=B.indexOf(j,O)}function Be(Te){if(m.header&&!M&&Q.length&&!te){var Ie=Q[0],Me=Object.create(null),Oe=new Set(Ie);let yt=!1;for(let Vt=0;Vt<Ie.length;Vt++){let wt=Ie[Vt];if(Me[wt=E(m.transformHeader)?m.transformHeader(wt,Vt):wt]){let Ge,ot=Me[wt];for(;Ge=wt+"_"+ot,ot++,Oe.has(Ge););Oe.add(Ge),Ie[Vt]=Ge,Me[wt]++,yt=!0,(Z=Z===null?{}:Z)[Ge]=wt}else Me[wt]=1,Ie[Vt]=wt;Oe.add(wt)}yt&&console.warn("Duplicate headers found and renamed."),te=!0}return{data:Q,errors:oe,meta:{delimiter:y,linebreak:j,aborted:V,truncated:!!Te,cursor:ae+(M||0),renamedHeaders:Z}}}function ge(){T(Be()),Q=[],oe=[]}},this.abort=function(){V=!0},this.getCharIndex=function(){return O}}function _(m){var y=m.data,j=l[y.workerId],A=!1;if(y.error)j.userError(y.error,y.file);else if(y.results&&y.results.data){var T={abort:function(){A=!0,v(y.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:P,resume:P};if(E(j.userStep)){for(var S=0;S<y.results.data.length&&(j.userStep({data:y.results.data[S],errors:y.results.errors,meta:y.results.meta},T),!A);S++);delete y.results}else E(j.userChunk)&&(j.userChunk(y.results,T,y.file),delete y.results)}y.finished&&!A&&v(y.workerId,y.results)}function v(m,y){var j=l[m];E(j.userComplete)&&j.userComplete(y),j.terminate(),delete l[m]}function P(){throw new Error("Not implemented.")}function D(m){if(typeof m!="object"||m===null)return m;var y,j=Array.isArray(m)?[]:{};for(y in m)j[y]=D(m[y]);return j}function L(m,y){return function(){m.apply(y,arguments)}}function E(m){return typeof m=="function"}return d.parse=function(m,y){var j=(y=y||{}).dynamicTyping||!1;if(E(j)&&(y.dynamicTypingFunction=j,j={}),y.dynamicTyping=j,y.transform=!!E(y.transform)&&y.transform,!y.worker||!d.WORKERS_SUPPORTED)return j=null,d.NODE_STREAM_INPUT,typeof m=="string"?(m=(A=>A.charCodeAt(0)!==65279?A:A.slice(1))(m),j=new(y.download?g:N)(y)):m.readable===!0&&E(m.read)&&E(m.on)?j=new w(y):(r.File&&m instanceof File||m instanceof Object)&&(j=new x(y)),j.stream(m);(j=(()=>{var A;return!!d.WORKERS_SUPPORTED&&(A=(()=>{var T=r.URL||r.webkitURL||null,S=n.toString();return d.BLOB_URL||(d.BLOB_URL=T.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",S,")();"],{type:"text/javascript"})))})(),(A=new r.Worker(A)).onmessage=_,A.id=u++,l[A.id]=A)})()).userStep=y.step,j.userChunk=y.chunk,j.userComplete=y.complete,j.userError=y.error,y.step=E(y.step),y.chunk=E(y.chunk),y.complete=E(y.complete),y.error=E(y.error),delete y.worker,j.postMessage({input:m,config:y,workerId:j.id})},d.unparse=function(m,y){var j=!1,A=!0,T=",",S=`\r
`,G='"',Z=G+G,te=!1,K=null,$=!1,O=((()=>{if(typeof y=="object"){if(typeof y.delimiter!="string"||d.BAD_DELIMITERS.filter(function(M){return y.delimiter.indexOf(M)!==-1}).length||(T=y.delimiter),typeof y.quotes!="boolean"&&typeof y.quotes!="function"&&!Array.isArray(y.quotes)||(j=y.quotes),typeof y.skipEmptyLines!="boolean"&&typeof y.skipEmptyLines!="string"||(te=y.skipEmptyLines),typeof y.newline=="string"&&(S=y.newline),typeof y.quoteChar=="string"&&(G=y.quoteChar),typeof y.header=="boolean"&&(A=y.header),Array.isArray(y.columns)){if(y.columns.length===0)throw new Error("Option columns is empty");K=y.columns}y.escapeChar!==void 0&&(Z=y.escapeChar+G),y.escapeFormulae instanceof RegExp?$=y.escapeFormulae:typeof y.escapeFormulae=="boolean"&&y.escapeFormulae&&($=/^[=+\-@\t\r].*$/)}})(),new RegExp(I(G),"g"));if(typeof m=="string"&&(m=JSON.parse(m)),Array.isArray(m)){if(!m.length||Array.isArray(m[0]))return V(null,m,te);if(typeof m[0]=="object")return V(K||Object.keys(m[0]),m,te)}else if(typeof m=="object")return typeof m.data=="string"&&(m.data=JSON.parse(m.data)),Array.isArray(m.data)&&(m.fields||(m.fields=m.meta&&m.meta.fields||K),m.fields||(m.fields=Array.isArray(m.data[0])?m.fields:typeof m.data[0]=="object"?Object.keys(m.data[0]):[]),Array.isArray(m.data[0])||typeof m.data[0]=="object"||(m.data=[m.data])),V(m.fields||[],m.data||[],te);throw new Error("Unable to serialize unrecognized input");function V(M,z,H){var ne="",q=(typeof M=="string"&&(M=JSON.parse(M)),typeof z=="string"&&(z=JSON.parse(z)),Array.isArray(M)&&0<M.length),ee=!Array.isArray(z[0]);if(q&&A){for(var X=0;X<M.length;X++)0<X&&(ne+=T),ne+=B(M[X],X);0<z.length&&(ne+=S)}for(var Q=0;Q<z.length;Q++){var oe=(q?M:z[Q]).length,ue=!1,ae=q?Object.keys(z[Q]).length===0:z[Q].length===0;if(H&&!q&&(ue=H==="greedy"?z[Q].join("").trim()==="":z[Q].length===1&&z[Q][0].length===0),H==="greedy"&&q){for(var ce=[],J=0;J<oe;J++){var W=ee?M[J]:J;ce.push(z[Q][W])}ue=ce.join("").trim()===""}if(!ue){for(var F=0;F<oe;F++){0<F&&!ae&&(ne+=T);var re=q&&ee?M[F]:F;ne+=B(z[Q][re],F)}Q<z.length-1&&(!H||0<oe&&!ae)&&(ne+=S)}}return ne}function B(M,z){var H,ne;return M==null?"":M.constructor===Date?JSON.stringify(M).slice(1,25):(ne=!1,$&&typeof M=="string"&&$.test(M)&&(M="'"+M,ne=!0),H=M.toString().replace(O,Z),(ne=ne||j===!0||typeof j=="function"&&j(M,z)||Array.isArray(j)&&j[z]||((q,ee)=>{for(var X=0;X<ee.length;X++)if(-1<q.indexOf(ee[X]))return!0;return!1})(H,d.BAD_DELIMITERS)||-1<H.indexOf(T)||H.charAt(0)===" "||H.charAt(H.length-1)===" ")?G+H+G:H)}},d.RECORD_SEP=String.fromCharCode(30),d.UNIT_SEP=String.fromCharCode(31),d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!a&&!!r.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=C,d.ParserHandle=k,d.NetworkStreamer=g,d.FileStreamer=x,d.StringStreamer=N,d.ReadableStreamStreamer=w,r.jQuery&&((i=r.jQuery).fn.parse=function(m){var y=m.config||{},j=[];return this.each(function(S){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var G=0;G<this.files.length;G++)j.push({file:this.files[G],inputElem:this,instanceConfig:i.extend({},y)})}),A(),this;function A(){if(j.length===0)E(m.complete)&&m.complete();else{var S,G,Z,te,K=j[0];if(E(m.before)){var $=m.before(K.file,K.inputElem);if(typeof $=="object"){if($.action==="abort")return S="AbortError",G=K.file,Z=K.inputElem,te=$.reason,void(E(m.error)&&m.error({name:S},G,Z,te));if($.action==="skip")return void T();typeof $.config=="object"&&(K.instanceConfig=i.extend(K.instanceConfig,$.config))}else if($==="skip")return void T()}var O=K.instanceConfig.complete;K.instanceConfig.complete=function(V){E(O)&&O(V,K.file,K.inputElem),T()},d.parse(K.file,K.instanceConfig)}}function T(){j.splice(0,1),A()}}),o&&(r.onmessage=function(m){m=m.data,d.WORKER_ID===void 0&&m&&(d.WORKER_ID=m.workerId),typeof m.input=="string"?r.postMessage({workerId:d.WORKER_ID,results:d.parse(m.input,m.config),finished:!0}):(r.File&&m.input instanceof File||m.input instanceof Object)&&(m=d.parse(m.input,m.config))&&r.postMessage({workerId:d.WORKER_ID,results:m,finished:!0})}),(g.prototype=Object.create(h.prototype)).constructor=g,(x.prototype=Object.create(h.prototype)).constructor=x,(N.prototype=Object.create(N.prototype)).constructor=N,(w.prototype=Object.create(h.prototype)).constructor=w,d})})(Yw);var r4=Yw.exports;const wi=iy(r4);function Ds({startRect:t,targetRef:e,count:n=12,onDone:r}){return f.useEffect(()=>{const i=e==null?void 0:e.current;if(!t||!i){r==null||r();return}const a=i.getBoundingClientRect(),o=document.createElement("div");o.style.position="fixed",o.style.inset="0",o.style.pointerEvents="none",o.style.zIndex="9999",document.body.appendChild(o);const l=a.left+a.width/2,u=a.top+a.height/2,d=t.left+t.width/2,h=t.top+t.height/2,g=200;let x=0;function N(w){const k=document.createElement("div");k.textContent="",Object.assign(k.style,{position:"fixed",left:"0px",top:"0px",zIndex:"10000",pointerEvents:"none",fontSize:"22px",opacity:"1",willChange:"transform, opacity",transform:"translate(0px, 0px)"});const I=d,C=h,_=l,v=u;k.style.transform=`translate(${I}px, ${C}px) scale(1)`,o.appendChild(k),k.getBoundingClientRect(),k.style.transition=`transform ${g}ms cubic-bezier(.2,.8,.2,1), opacity ${g}ms linear`,requestAnimationFrame(()=>{k.style.transform=`translate(${_}px, ${v}px) scale(.6)`,k.style.opacity="0.1"}),setTimeout(()=>{k.remove(),x+=1,x===n&&(o.remove(),r==null||r())},g+50)}for(let w=0;w<n;w++)setTimeout(()=>N(),w*60);return()=>{try{o.remove()}catch{}}},[t,e,n,r]),null}const un={XP_PER_CORRECT:10,XP_PER_LEVEL:100,MAX_LEVEL:100,COINS_PER_CORRECT:5,MAX_ENERGY:5,ENERGY_REGEN_TIME:36e5,ENERGY_COST:{quiz:1,practice:0,daily:0},COMBO_MULTIPLIERS:{2:{multiplier:1.2,text:"Nice!"},3:{multiplier:1.5,text:"Great!"},5:{multiplier:2,text:"On Fire!"},10:{multiplier:3,text:"Legendary!"}},AVATARS:[{id:"wizard",emoji:"",name:"Knowledge Wizard",unlockLevel:1,bgColor:"from-purple-500 to-indigo-500"},{id:"knight",emoji:"",name:"Quiz Knight",unlockLevel:1,bgColor:"from-blue-500 to-cyan-500"},{id:"explorer",emoji:"",name:"Fact Explorer",unlockLevel:5,bgColor:"from-green-500 to-emerald-500"},{id:"scientist",emoji:"",name:"Science Master",unlockLevel:10,bgColor:"from-orange-500 to-red-500"},{id:"artist",emoji:"",name:"Creative Mind",unlockLevel:15,bgColor:"from-pink-500 to-rose-500"}],STORAGE_KEYS:{PLAYER:"qp_player",GAME_STATE:"qp_game_state",ENERGY:"qp_energy",CURRENT_COMBO:"qp_combo"}},Bx=t=>Math.floor(t/un.XP_PER_LEVEL)+1,s4=t=>{const e=t%un.XP_PER_LEVEL;return{current:e,required:un.XP_PER_LEVEL,percentage:e/un.XP_PER_LEVEL*100}};function i4({player:t,size:e="normal",showLevel:n=!0,showName:r=!0}){const i=un.AVATARS.find(o=>o.id===t.avatar)||un.AVATARS[0],a={small:"w-10 h-10 text-xl",normal:"w-14 h-14 text-2xl",large:"w-20 h-20 text-4xl"};return s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:`${a[e]} rounded-full bg-gradient-to-br ${i.bgColor} flex items-center justify-center shadow-lg`,children:s.jsx("span",{children:i.emoji})}),n&&s.jsx("div",{className:"absolute -bottom-1 -right-1 bg-yellow-500 text-black text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center border-2 border-base-bg",children:t.level})]}),r&&s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-sm",children:(()=>{const o=JSON.parse(localStorage.getItem("currentUser")||"{}");return o.username?o.username.split(" ")[0]:t.name})()}),s.jsx("div",{className:"text-xs text-base-muted",children:i.name})]})]})}function a4({current:t,required:e,level:n,animate:r=!0}){const[i,a]=f.useState(0),o=t/e*100;return f.useEffect(()=>{if(r){const l=setTimeout(()=>{a(o)},100);return()=>clearTimeout(l)}else a(o)},[o,r]),s.jsxs("div",{className:"w-full",children:[s.jsxs("div",{className:"flex justify-between items-center mb-1",children:[s.jsxs("span",{className:"text-xs font-medium",children:["Level ",n]}),s.jsxs("span",{className:"text-xs text-base-muted",children:[t,"/",e," XP"]})]}),s.jsx("div",{className:"h-2 bg-black/20 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-500 rounded-full transition-all duration-700 ease-out relative",style:{width:`${i}%`},children:s.jsx("div",{className:"absolute inset-0 bg-white/20 animate-pulse"})})})]})}const Kw=[{name:"GK",slug:"general-knowledge",questions:50,icon:"",color:"#FF6B6B",gradient:"from-red-500 to-pink-500"},{name:"Science",slug:"science",questions:45,icon:"",color:"#4ECDC4",gradient:"from-cyan-500 to-teal-500"},{name:"Fun Facts",slug:"fun-facts",questions:30,icon:"",color:"#FFD93D",gradient:"from-yellow-400 to-orange-500"},{name:"History",slug:"history",questions:42,icon:"",color:"#A8E6CF",gradient:"from-green-400 to-emerald-500"},{name:"AI & Tech",slug:"artificial-intelligence",questions:28,icon:"",color:"#C7B8FF",gradient:"from-purple-400 to-indigo-500"},{name:"More",slug:"more",questions:0,icon:"",color:"#FF8CC3",gradient:"from-pink-400 to-rose-500"}],Xw=[{name:"Geography",slug:"geography",questions:38,icon:"",color:"#FACC15",gradient:"from-yellow-400 to-amber-500"},{name:"Computer",slug:"computer",questions:34,icon:"",color:"#3B82F6",gradient:"from-blue-400 to-blue-600"},{name:"Aptitude",slug:"aptitude",questions:36,icon:"",color:"#EC4899",gradient:"from-pink-500 to-rose-500"},{name:"Iconic Figures",slug:"iconic-figures",questions:26,icon:"",color:"#8B5CF6",gradient:"from-purple-500 to-violet-600"}],Jw=[...Kw.filter(t=>t.slug!=="more"),...Xw];function o4(){const t=Ye(),[e,n]=f.useState(!1),[r,i]=f.useState([]);f.useEffect(()=>{const o=[...Array(6)].map((l,u)=>({id:u,left:Math.random()*100,delay:Math.random()*2,duration:2+Math.random()*2}));i(o)},[]);const a=()=>{mt.trackButtonClick("spin_and_win_play","home_screen"),t("/play/classic",{state:{from:"home"}})};return s.jsxs("div",{className:"relative overflow-hidden rounded-3xl pt-12 pb-12 px-6 mb-4 transform transition-all hover:scale-[1.01] active:scale-[0.99]",style:{background:"linear-gradient(135deg, #FF6B6B 0%, #4ECDC4 50%, #45B7D1 100%)",boxShadow:"0 10px 30px rgba(0,0,0,0.1)"},onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:[s.jsx("style",{jsx:!0,children:`
        @keyframes float {
          0%, 100% { transform: translateY(0) rotate(0deg); }
          50% { transform: translateY(-10px) rotate(5deg); }
        }
        
        @keyframes spin-slow {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
        
        @keyframes sparkle {
          0% { transform: translateY(0) scale(0); opacity: 0; }
          50% { transform: translateY(-50px) scale(1); opacity: 1; }
          100% { transform: translateY(-100px) scale(0); opacity: 0; }
        }
        
        @keyframes pulse-glow {
          0%, 100% { box-shadow: 0 0 10px rgba(255,255,255,0.5); }
          50% { box-shadow: 0 0 20px rgba(255,255,255,0.8); }
        }
        
        @keyframes bounce {
          0%, 100% { transform: translateY(0); }
          25% { transform: translateY(-5px); }
          75% { transform: translateY(2px); }
        }
      `}),r.map(o=>s.jsx("div",{className:"absolute text-lg pointer-events-none",style:{left:`${o.left}%`,bottom:"0",animation:`sparkle ${o.duration}s ease-out infinite`,animationDelay:`${o.delay}s`},children:""},o.id)),s.jsx("div",{className:"absolute -top-1 -right-2 text-7xl opacity-15",style:{animation:"spin-slow 20s linear infinite",transform:e?"scale(1.1)":"scale(1)",transition:"transform 0.3s"},children:""}),s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"relative w-14 h-14 flex-shrink-0",style:{animation:e?"bounce 1s ease-in-out infinite":"float 3s ease-in-out infinite"},children:s.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 100 100",className:"absolute inset-0",style:{animation:"spin-slow 4s linear infinite"},children:[[{color:"#FF6B6B",icon:""},{color:"#4ECDC4",icon:""},{color:"#45B7D1",icon:""},{color:"#FFD700",icon:""},{color:"#9370DB",icon:""},{color:"#FF9800",icon:""}].map((o,l)=>{const d=l*60,h=d+60,g=0,x=Math.PI*d/180,N=Math.PI*h/180,w=50+45*Math.cos(x),k=50-45*Math.sin(x),I=50+45*Math.cos(N),C=50-45*Math.sin(N);return s.jsx("g",{children:s.jsx("path",{d:`M50,50 L${w},${k} A45,45 0 ${g} 0 ${I},${C} Z`,fill:o.color,stroke:"rgba(255,255,255,0.3)",strokeWidth:"0.5"})},l)}),s.jsx("circle",{cx:"50",cy:"50",r:"12",fill:"white"}),s.jsx("text",{x:"50",y:"55",textAnchor:"middle",className:"text-xs font-bold fill-gray-800",children:""})]})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-black text-white drop-shadow-md whitespace-nowrap",children:"Spin & Win!"}),s.jsx("p",{className:"text-sm text-white/90",children:"Win amazing prizes!"})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute -top-2 -left-2 text-sm opacity-70",style:{animation:"float 3s ease-in-out infinite"},children:""}),s.jsx("div",{className:"absolute -top-2 -right-2 text-sm opacity-70",style:{animation:"float 3s ease-in-out infinite 0.5s"},children:""}),s.jsx("div",{className:"absolute -bottom-10 left-1/2 -translate-x-1/2 text-sm opacity-70",style:{animation:"float 3s ease-in-out infinite 1s"},children:""}),s.jsxs("button",{className:"relative bg-white text-gray-900 rounded-full font-bold shadow-lg hover:shadow-xl transition-all px-5 py-2.5 flex items-center gap-2",style:{animation:"pulse-glow 2s ease-in-out infinite"},onClick:o=>{o.stopPropagation(),a()},children:[s.jsx("span",{className:"text-sm font-black",children:"PLAY"}),s.jsx("span",{className:"text-base",children:""})]})]})]})]})}function l4({actions:t}){return s.jsx("div",{className:"grid grid-cols-4 gap-3 mb-8",children:t.map((e,n)=>s.jsxs("button",{onClick:e.action,className:`${e.color} aspect-square rounded-2xl flex flex-col items-center justify-center gap-1 transform transition-all hover:scale-105`,children:[s.jsx("div",{className:"text-2xl",children:e.icon}),s.jsx("div",{className:"text-[10px] font-medium text-white",children:e.label})]},n))})}function c4({categories:t,onCategorySelect:e}){return s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-lg font-bold mb-4",children:"Choose Your Adventure"}),s.jsx("div",{className:"grid grid-cols-3 gap-3",children:t.map(n=>s.jsxs("button",{onClick:()=>e(n),className:`bg-gradient-to-br ${n.gradient} aspect-square rounded-2xl p-4 flex flex-col items-center justify-center gap-2 transform transition-all hover:scale-105 hover:shadow-lg relative`,children:[s.jsx("div",{className:"text-3xl",children:n.icon}),s.jsx("div",{className:"text-xs font-bold text-white text-center",children:n.name}),n.questions>0&&s.jsxs("div",{className:"text-[10px] bg-white/20 px-2 py-0.5 rounded-full",children:[n.questions," Qs"]})]},n.name))})]})}function u4({onClick:t,isPulsing:e}){return s.jsxs("button",{onClick:t,className:`w-full rounded-2xl p-5 flex justify-between items-center transition-all ${e?"bg-green-500/20 border-2 border-green-500 animate-pulse":"bg-white/5 border border-base-border hover:bg-white/10"}`,children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-400 to-teal-500 rounded-xl grid place-items-center text-2xl",children:""}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-medium",children:"Practice Mode"}),s.jsx("div",{className:"text-xs text-base-muted",children:"No timer  No energy cost  Learn at your pace"})]})]}),s.jsx("div",{className:"text-xl",children:""})]})}function d4({coinPillRef:t}){const[e,n]=f.useState("idle"),[r,i]=f.useState([]),[a,o]=f.useState(0),[l,u]=f.useState([]),[d,h]=f.useState(0),[g,x]=f.useState(""),[N,w]=f.useState(null),[k,I]=f.useState(null),[C,_]=f.useState(!1),[v,P]=f.useState(!1),[D,L]=f.useState(!1),[E,m]=f.useState(null),[y,j]=f.useState(0),[A,T]=f.useState(0),S=f.useRef(null),G=f.useRef(null),[Z]=Ft("/sounds/correct.mp3",{volume:.6}),[te]=Ft("/sounds/wrong.mp3",{volume:.6}),[K]=Ft("/sounds/win.mp3",{volume:.7,duration:1e3}),[$]=Ft("/sounds/coin.mp3",{volume:.75}),O=3,V=10,B=2,M=50;f.useEffect(()=>{z();const ce=jt.getCurrentUser();if(ce!=null&&ce.phone){const W=ye.getTodaySummary(ce.phone);T((W==null?void 0:W.streak)||0)}const J=localStorage.getItem("dailyChallengeData");if(J){const W=JSON.parse(J),F=new Date(W.completedAt).toDateString(),re=new Date().toDateString();F===re&&(n("complete"),h(W.score),j(W.earnedCoins))}},[]),f.useEffect(()=>{if(e==="complete"){const ce=()=>{const W=new Date,F=new Date(W);F.setDate(F.getDate()+1),F.setHours(0,0,0,0);const re=F-W,le=Math.floor(re/(1e3*60*60)),pe=Math.floor(re%(1e3*60*60)/(1e3*60)),Ne=Math.floor(re%(1e3*60)/1e3),Pe=le.toString().padStart(2,"0"),De=pe.toString().padStart(2,"0"),xt=Ne.toString().padStart(2,"0");x(`${Pe}:${De}:${xt}`)};ce();const J=setInterval(ce,1e3);return()=>clearInterval(J)}},[e]);const z=async()=>{try{const J=await(await fetch("/data/quiz_questions_bank.csv")).text(),{data:W}=wi.parse(J,{header:!0,skipEmptyLines:!0}),F=W.filter(re=>re.question&&re.option1&&re.option2&&re.option3&&re.option4).map((re,le)=>{var pe;return{id:le,question:re.question,options:[re.option1,re.option2,re.option3,re.option4],correct:["A","B","C","D"].indexOf((pe=re.answer)==null?void 0:pe.toUpperCase())}}).filter(re=>re.correct>=0).sort(()=>Math.random()-.5).slice(0,O);i(F)}catch{i([{id:1,question:"What is the capital of France?",options:["London","Paris","Berlin","Madrid"],correct:1},{id:2,question:"What is 2 + 2?",options:["3","4","5","6"],correct:1},{id:3,question:"What color is the sky?",options:["Red","Green","Blue","Yellow"],correct:2}])}},H=()=>{mt.trackButtonClick("daily_challenge_start","home_screen"),n("playing"),o(0),u(new Array(O).fill(null)),h(0),_(!1),j(0)},ne=ce=>{const J=[...l];J[a]=ce,u(J);const W=ce===r[a].correct;P(W),_(!0),W?(Z&&Z(),L(!0),setTimeout(()=>L(!1),500)):te&&te();const F=J.filter(re=>re!==null).length;setTimeout(()=>{_(!1),F===O?(n("celebrating"),K&&K(),setTimeout(()=>{ee(J)},2e3)):q(J)},600)},q=ce=>{for(let J=a+1;J<O;J++)if(ce[J]===null){o(J);return}for(let J=0;J<a;J++)if(ce[J]===null){o(J);return}},ee=ce=>{const J=ce.reduce((re,le,pe)=>re+(le===r[pe].correct?1:0),0);h(J);const F=J===O?J*V*B:J*V;j(F),n("complete"),localStorage.setItem("dailyChallengeData",JSON.stringify({completedAt:new Date().toISOString(),score:J,earnedCoins:F})),setTimeout(()=>{if(F>0&&S.current&&(t!=null&&t.current)){const re=S.current.getBoundingClientRect();m({startRect:re,count:Math.min(F/5,10),amount:F}),$&&$()}},500)},X=ce=>{I(null),w(ce.targetTouches[0].clientX)},Q=ce=>{I(ce.targetTouches[0].clientX)},oe=()=>{if(!N||!k)return;const ce=N-k,J=ce>M,W=ce<-M;if(J){const F=(a+1)%O;o(F)}else if(W){const F=(a-1+O)%O;o(F)}},ue=({parentRef:ce})=>{var le;if(!D)return null;const J=(le=ce==null?void 0:ce.current)==null?void 0:le.getBoundingClientRect(),W=J?J.top:100,F=J?J.left:0,re=J?J.width:window.innerWidth;return s.jsx("div",{className:"fixed inset-0 pointer-events-none z-50",children:[...Array(12)].map((pe,Ne)=>s.jsx("div",{className:"absolute",style:{left:`${F+Math.random()*re}px`,top:`${W}px`,animation:`confettiFall ${2+Math.random()*1}s ease-out forwards`,animationDelay:`${Math.random()*.3}s`,fontSize:"24px",opacity:.9},children:["","","","",""][Math.floor(Math.random()*5)]},`${Date.now()}-${Ne}`))})};if(e==="celebrating")return s.jsxs("div",{className:"relative rounded-2xl bg-gradient-to-br from-purple-600/20 to-blue-600/20 backdrop-blur border border-white/10 p-8 mb-4 text-center",children:[s.jsx("div",{className:"animate-bounce-slow",children:s.jsx("span",{className:"text-5xl",children:""})}),s.jsx("h2",{className:"text-2xl font-bold mt-4 bg-gradient-to-r from-yellow-400 to-orange-400 bg-clip-text text-transparent",children:"Congratulations!"}),s.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You've completed today's challenge"})]});if(e==="complete"){const ce=Math.round(d/O*100),J=d===O;return s.jsxs(s.Fragment,{children:[E&&s.jsx(Ds,{startRect:E.startRect,targetRef:t,count:E.count,onDone:()=>{if(!E.processed){E.processed=!0;const W=jt.getCurrentUser();W!=null&&W.phone?(ye.addCoins(E.amount,"Daily Challenge"),ye.updateQuestProgress(W.phone,"daily_challenge",1)):ye.addCoins(E.amount,"Daily Challenge"),window.dispatchEvent(new Event("coinsUpdated"))}m(null)}}),s.jsx("div",{className:"relative rounded-2xl bg-gradient-to-br from-purple-600/10 to-blue-600/10 backdrop-blur border border-white/10 p-4 mb-4",children:s.jsxs("div",{ref:S,className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-yellow-400/20 to-orange-400/20 flex items-center justify-center",children:s.jsx("span",{className:"text-2xl",children:J?"":d>=2?"":""})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-yellow-400",children:"Challenge Complete!"}),s.jsxs("p",{className:"text-xs text-gray-400",children:["Come back in ",g]})]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-lg font-bold text-green-400",children:[ce,"%"]}),s.jsx("div",{className:"text-[10px] text-gray-500",children:"Accuracy"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-lg font-bold text-yellow-400",children:["+",y]}),s.jsx("div",{className:"text-[10px] text-gray-500",children:"Coins"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-lg font-bold text-orange-400 whitespace-nowrap",children:["",A]}),s.jsx("div",{className:"text-[10px] text-gray-500",children:"Streak"})]})]})]})})]})}if(e==="idle")return s.jsx("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-violet-500/30 to-blue-500/15 backdrop-blur border border-white/10 p-8 mb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Daily Challenge"}),s.jsxs("p",{className:"text-xs text-gray-400",children:[O," questions  Up to ",O*V*B," coins"]})]}),s.jsx("button",{onClick:H,className:"w-14 h-14 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center cursor-pointer hover:scale-110 active:scale-95 transition-transform",children:s.jsx("span",{className:"text-white",children:""})})]})});const ae=r[a];return s.jsxs(s.Fragment,{children:[s.jsx(ue,{parentRef:G}),s.jsxs("div",{ref:G,className:"relative rounded-2xl bg-gradient-to-br from-gray-800/30 to-gray-900/30 backdrop-blur border border-white/10 p-4 mb-4",onTouchStart:X,onTouchMove:Q,onTouchEnd:oe,children:[s.jsx("div",{className:"flex gap-1 mb-4",children:[...Array(O)].map((ce,J)=>{var W;return s.jsx("div",{className:`h-1 flex-1 rounded-full transition-all ${l[J]!==null?l[J]===((W=r[J])==null?void 0:W.correct)?"bg-green-500":"bg-red-500":J===a?"bg-blue-500":"bg-gray-700"}`},J)})}),s.jsx("h3",{className:"text-base font-medium mb-4",children:ae.question}),s.jsx("div",{className:"grid gap-2",children:ae.options.map((ce,J)=>{const W=l[a]===J,F=l[a]!==null,re=J===ae.correct,le=C&&(W||re);return s.jsx("button",{onClick:()=>!F&&ne(J),disabled:F,className:`
                  relative p-3 rounded-xl text-left text-sm font-medium transition-all
                  ${le&&re?"bg-green-500/30 border border-green-500 animate-pulse-once":le&&W&&!re?"bg-red-500/30 border border-red-500 animate-shake":W&&!C?"bg-blue-500/20 border border-blue-500":F?"bg-white/5 border border-transparent opacity-50":"bg-white/5 border border-white/10 hover:border-white/20 hover:bg-white/10 active:scale-[0.98]"}
                `,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"opacity-50",children:String.fromCharCode(65+J)}),s.jsx("span",{children:ce})]}),le&&re&&s.jsx("span",{className:"text-green-400 animate-fade-in",children:""}),le&&W&&!re&&s.jsx("span",{className:"text-red-400 animate-fade-in",children:""})]})},J)})}),s.jsx("style",{jsx:!0,children:`
          @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
          }
          
          @keyframes pulse-once {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; transform: scale(1.02); }
          }
          
          @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
          }
          
          @keyframes fade-in {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
          }
          
          @keyframes bounce-slow {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
          }
          
        @keyframes confettiFall {
        0% { 
            transform: translateY(0) translateX(0) rotate(0deg) scale(1);
            opacity: 0.9;
        }
        10% {
            opacity: 1;
        }
        25% {
            transform: translateY(25vh) translateX(10px) rotate(180deg) scale(1.1);
        }
        50% {
            transform: translateY(50vh) translateX(-10px) rotate(360deg) scale(1);
        }
        75% {
            transform: translateY(75vh) translateX(5px) rotate(540deg) scale(0.9);
            opacity: 0.8;
        }
        100% { 
            transform: translateY(100vh) translateX(0) rotate(720deg) scale(0.8);
            opacity: 0;
        }
        }
                
          .animate-shimmer {
            animation: shimmer 3s infinite;
          }
          
          .animate-pulse-once {
            animation: pulse-once 0.6s ease-out;
          }
          
          .animate-shake {
            animation: shake 0.4s ease-out;
          }
          
          .animate-fade-in {
            animation: fade-in 0.3s ease-out;
          }
          
          .animate-bounce-slow {
            animation: bounce-slow 1s ease-in-out infinite;
          }
          
          .animate-confetti {
            animation: confetti 2s ease-in forwards;
          }
        `})]})]})}function h4({show:t,onClose:e,player:n,changeAvatar:r,GAME_CONSTANTS:i}){return t?s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",onClick:a=>{a.target===a.currentTarget&&e()},children:s.jsxs("div",{className:"bg-base-card rounded-3xl p-6 w-full max-w-md border border-base-border max-h-[80vh] overflow-y-auto",onClick:a=>a.stopPropagation(),children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-xl font-bold",children:"Choose Your Avatar"}),s.jsx("button",{onClick:e,className:"w-8 h-8 rounded-lg bg-white/5 border border-base-border grid place-items-center hover:bg-white/10 transition",children:""})]}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:i.AVATARS.map(a=>{const o=!n.unlockedAvatars||!n.unlockedAvatars.includes(a.id),l=n.avatar===a.id;return s.jsxs("button",{onClick:()=>{o?mt.trackButtonClick(`avatar_locked_clicked_${a.id}`,"avatar_modal"):(mt.trackButtonClick(`avatar_selected_${a.id}`,"avatar_modal"),r(a.id),e())},className:`p-4 rounded-2xl border-2 transition-all ${l?"border-brand-blue bg-brand-blue/20":o?"border-gray-600 bg-gray-800/50 opacity-50":"border-base-border bg-white/5 hover:bg-white/10"}`,disabled:o,children:[s.jsx("div",{className:`text-4xl mb-2 ${o?"grayscale":""}`,children:a.emoji}),s.jsx("div",{className:"text-sm font-medium",children:a.name}),o&&s.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Unlock at Level ",a.unlockLevel]}),l&&s.jsx("div",{className:"text-xs text-brand-blue mt-1",children:"Current"})]},a.id)})})]})}):null}function f4({show:t,onClose:e,categories:n,onCategorySelect:r}){return t?s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",onClick:i=>{i.target===i.currentTarget&&e()},children:s.jsxs("div",{className:"bg-base-card rounded-3xl p-6 w-full max-w-md border border-base-border",onClick:i=>i.stopPropagation(),children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-xl font-bold",children:"More categories"}),s.jsx("button",{onClick:e,className:"w-8 h-8 rounded-lg bg-white/5 border border-base-border grid place-items-center hover:bg-white/10 transition",children:""})]}),s.jsx("div",{className:"grid grid-cols-2 gap-3 mb-4",children:n.map(i=>s.jsxs("button",{onClick:()=>{e(),r(i)},className:`bg-gradient-to-br ${i.gradient} p-4 rounded-2xl flex flex-col items-center gap-2 hover:scale-105 transition-transform relative`,children:[s.jsx("div",{className:"text-3xl",children:i.icon}),s.jsx("div",{className:"text-sm font-bold text-white",children:i.name}),s.jsxs("div",{className:"text-xs text-white/80",children:[i.questions," questions"]})]},i.name))})]})}):null}function m4({show:t,onClose:e,coins:n,onNavigateToPlay:r}){return t?s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",onClick:i=>{i.target===i.currentTarget&&e()},children:s.jsxs("div",{className:"bg-base-card rounded-3xl p-6 w-full max-w-md border border-base-border relative overflow-hidden",onClick:i=>i.stopPropagation(),children:[s.jsx("div",{className:"absolute inset-0 opacity-10",children:s.jsx("div",{className:"magic-gradient h-full"})}),s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"coin-3d text-5xl",style:{animation:"coinRotate 2s linear infinite, glow 2s ease-in-out infinite"},children:""}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-2xl font-bold bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent",children:"Your Treasure"}),s.jsxs("p",{className:"text-3xl font-bold text-white mt-1",children:[ye.getCoins()," Coins"]})]})]}),s.jsx("button",{onClick:e,className:"w-8 h-8 rounded-lg bg-white/5 border border-base-border grid place-items-center hover:bg-white/10 transition",children:""})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h4",{className:"text-sm font-medium text-base-muted mb-3",children:"Ways to Earn"}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-r from-green-500/10 to-emerald-500/10 border border-green-500/20 hover:scale-[1.02] transition-transform",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:""}),"Complete Quizzes"]}),s.jsx("div",{className:"text-xs text-base-muted mt-1",children:"+5 coins per correct answer"})]}),s.jsx("div",{className:"text-green-400 font-bold",children:"+5"})]})}),s.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-r from-blue-500/10 to-cyan-500/10 border border-blue-500/20 hover:scale-[1.02] transition-transform",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:""}),"Daily Challenge"]}),s.jsx("div",{className:"text-xs text-base-muted mt-1",children:"Complete daily for bonus"})]}),s.jsx("div",{className:"text-blue-400 font-bold",children:"+5"})]})}),s.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-r from-purple-500/10 to-pink-500/10 border border-purple-500/20 hover:scale-[1.02] transition-transform",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:""}),"Spin & Play"]}),s.jsx("div",{className:"text-xs text-base-muted mt-1",children:"Test your luck!"})]}),s.jsx("div",{className:"text-purple-400 font-bold",children:"+50"})]})}),s.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-r from-orange-500/10 to-red-500/10 border border-orange-500/20 hover:scale-[1.02] transition-transform",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:""}),"Achievements"]}),s.jsx("div",{className:"text-xs text-base-muted mt-1",children:"Unlock special rewards"})]}),s.jsx("div",{className:"text-orange-400 font-bold",children:"+???"})]})})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex justify-between text-xs text-base-muted mb-2",children:[s.jsx("span",{children:"Next reward"}),s.jsxs("span",{children:[100-n%100," coins to go"]})]}),s.jsx("div",{className:"h-2 bg-white/10 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full transition-all",style:{width:`${n%100}%`}})})]}),s.jsx("button",{onClick:()=>{AnalyticsService.trackButtonClick("start_earning_now","coins_modal"),r()},className:"w-full py-3 rounded-xl bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-bold hover:scale-[1.02] transition-transform shadow-lg",style:{boxShadow:"0 10px 30px rgba(251, 191, 36, 0.3)"},children:"Start Earning Now! "})]})]})}):null}function p4({show:t,onClose:e,selectedCategory:n,difficulty:r,setDifficulty:i,count:a,setCount:o,timer:l,setTimer:u,onStart:d}){return!t||!n?null:s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",style:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:h=>{h.target===h.currentTarget&&e()},children:s.jsxs("div",{className:"bg-base-card rounded-3xl p-6 w-full max-w-md border border-base-border",onClick:h=>h.stopPropagation(),children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-xl font-bold",children:"Quiz Mode"}),s.jsx("button",{onClick:e,className:"w-8 h-8 rounded-lg bg-white/5 border border-base-border grid place-items-center hover:bg-white/10 transition",children:""})]}),s.jsx("div",{className:"mb-4 p-3 rounded-xl bg-blue-500/10 border border-blue-500/30",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"text-2xl",children:n.icon}),s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium",children:["Category: ",n.name]}),s.jsxs("div",{className:"text-xs text-base-muted",children:[n.questions," questions available"]})]})]})}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"text-sm text-base-muted mb-2 block",children:"Difficulty"}),s.jsx("div",{className:"grid grid-cols-3 gap-2",children:["easy","medium","hard"].map(h=>s.jsx("button",{onClick:()=>i(h),className:`py-2 rounded-xl border ${r===h?"bg-brand-blue/30 border-brand-blue":"bg-white/5 border-base-border"}`,children:h.charAt(0).toUpperCase()+h.slice(1)},h))})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"text-sm text-base-muted mb-2 block",children:"Questions"}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:[5,10,20,30].map(h=>s.jsx("button",{onClick:()=>o(h),className:`py-2 rounded-xl border ${a===h?"bg-brand-blue/30 border-brand-blue":"bg-white/5 border-base-border"}`,children:h},h))})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"text-sm text-base-muted mb-2 block",children:"Timer (seconds per question)"}),s.jsx("input",{type:"number",value:l,onChange:h=>u(Number(h.target.value)||45),min:10,max:120,className:"w-full px-4 py-2 rounded-xl bg-white/5 border border-base-border"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:e,className:"flex-1 py-3 rounded-xl border border-base-border bg-white/5",children:"Cancel"}),s.jsx("button",{onClick:d,className:"flex-1 py-3 rounded-xl bg-gradient-to-r from-brand-blue to-brand-purple text-white font-medium",children:"Start Quiz"})]})]})})}function g4({show:t,onClose:e,allCategories:n,category:r,setCategory:i,difficulty:a,setDifficulty:o,count:l,setCount:u,onStart:d}){return t?s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",onClick:h=>{h.target===h.currentTarget&&e()},children:s.jsxs("div",{className:"bg-base-card rounded-3xl p-6 w-full max-w-md border border-base-border max-h-[90vh] overflow-y-auto",onClick:h=>h.stopPropagation(),children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-xl font-bold",children:"Practice Mode"}),s.jsx("button",{onClick:e,className:"w-8 h-8 rounded-lg bg-white/5 border border-base-border grid place-items-center hover:bg-white/10 transition",children:""})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"text-sm text-base-muted mb-2 block",children:"Category"}),s.jsx("div",{className:"grid grid-cols-3 gap-2 max-h-[200px] overflow-y-auto",children:n.map(h=>s.jsxs("button",{onClick:()=>i(h.slug),className:`p-3 rounded-xl border flex flex-col items-center gap-1 ${r===h.slug?"bg-brand-blue/30 border-brand-blue":"bg-white/5 border-base-border"}`,children:[s.jsx("div",{className:"text-xl",children:h.icon}),s.jsx("div",{className:"text-[10px] text-center",children:h.name})]},h.slug))})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"text-sm text-base-muted mb-2 block",children:"Difficulty"}),s.jsx("div",{className:"grid grid-cols-3 gap-2",children:["easy","medium","hard"].map(h=>s.jsx("button",{onClick:()=>o(h),className:`py-2 rounded-xl border ${a===h?"bg-brand-blue/30 border-brand-blue":"bg-white/5 border-base-border"}`,children:h.charAt(0).toUpperCase()+h.slice(1)},h))})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"text-sm text-base-muted mb-2 block",children:"Questions"}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:[5,10,20,30].map(h=>s.jsx("button",{onClick:()=>u(h),className:`py-2 rounded-xl border ${l===h?"bg-brand-blue/30 border-brand-blue":"bg-white/5 border-base-border"}`,children:h},h))})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:e,className:"flex-1 py-3 rounded-xl border border-base-border bg-white/5",children:"Cancel"}),s.jsx("button",{onClick:d,className:"flex-1 py-3 rounded-xl bg-gradient-to-r from-brand-blue to-brand-purple text-white font-medium",children:"Start Practice"})]})]})}):null}function x4({player:t,onContinue:e}){const[n,r]=f.useState(()=>sessionStorage.getItem("justSignedUp")==="true"?(sessionStorage.removeItem("justSignedUp"),!1):sessionStorage.getItem("welcomeShown")!=="true"),[i,a]=f.useState(!1),[o,l]=f.useState(!1),[u,d]=f.useState(""),[h,g]=f.useState(""),[x,N]=f.useState("Champion"),[w,k]=f.useState(1),[I,C]=f.useState(0),[_,v]=f.useState(0),P=()=>{try{const m=new Audio("/sounds/welcome.mp3");m.volume=.6,m.play()}catch{console.log("Welcome sound not available")}},D=()=>{navigator.vibrate&&navigator.vibrate([100,50,100])};f.useEffect(()=>{if((()=>{const S=JSON.parse(localStorage.getItem("currentUser")||"{}");let G="Champion",Z=1,te=0,K=0;if(S.phone){const O=JSON.parse(localStorage.getItem(`user_profile_${S.phone}`)||"{}"),B=JSON.parse(localStorage.getItem("users")||"{}")[S.phone]||{};O.name?G=O.name.split(" ")[0]:B.username?G=B.username.split(" ")[0]:S.username&&(G=S.username.split(" ")[0]),G&&G!=="Champion"&&(G=G.charAt(0).toUpperCase()+G.slice(1).toLowerCase())}else S.username&&(G=S.username.split(" ")[0]);const $=JSON.parse(localStorage.getItem("qp_player")||"{}");Z=(t==null?void 0:t.level)||$.level||1,te=ye.getCoins(),K=(t==null?void 0:t.currentStreak)||$.currentStreak||0,G!=="Champion"&&G!==$.name&&($.name=G,localStorage.setItem("qp_player",JSON.stringify($))),N(G),k(Z),C(te),v(K)})(),!n){e();return}sessionStorage.setItem("welcomeShown","true"),document.body.classList.add("hide-bottom-nav"),P(),D();const y=["","","","","","","","","",""];g(y[Math.floor(Math.random()*y.length)]);const j=setInterval(()=>{l(S=>!S)},2e3),A=[" New challenges await!"," Ready to be a champion?"," Your brain adventure starts now!"," Time for fun learning!"," The quiz circus is open!"," Blast off to knowledge!"," Let's play and learn!"," Rainbow of questions ahead!"];d(A[Math.floor(Math.random()*A.length)]);const T=setInterval(()=>{d(A[Math.floor(Math.random()*A.length)])},3e3);return()=>{document.body.classList.remove("hide-bottom-nav"),clearInterval(j),clearInterval(T)}},[n,e,t]);const L=()=>{try{const m=new Audio("/sounds/tap.mp3");m.volume=.5,m.play()}catch{console.log("Click sound not available")}navigator.vibrate&&navigator.vibrate(20),a(!0),document.body.classList.remove("hide-bottom-nav"),setTimeout(()=>{r(!1),e()},400)};if(!n)return null;const E=()=>{const m=new Date().getHours();return m<12?"Good morning":m<17?"Good afternoon":"Good evening"};return s.jsxs("div",{className:`fixed inset-0 z-50 flex items-center justify-center transition-all duration-500
      ${i?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:[s.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #fda085 75%, #f5a375 90%, #e08060 100%)"}}),s.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[[{top:"10%",left:"15%",size:"24px",delay:"0s"},{top:"20%",left:"75%",size:"20px",delay:"0.5s"},{top:"15%",left:"45%",size:"28px",delay:"1s"},{top:"30%",left:"85%",size:"22px",delay:"1.5s"},{top:"8%",left:"60%",size:"26px",delay:"2s"}].map((m,y)=>s.jsx("div",{className:"absolute animate-twinkle",style:{top:m.top,left:m.left,fontSize:m.size,animationDelay:m.delay},children:""},`star-${y}`)),s.jsxs("div",{className:"absolute top-10 left-0 w-full",children:[s.jsx("div",{className:"cloud cloud1",children:""}),s.jsx("div",{className:"cloud cloud2",children:""})]})]}),s.jsxs("div",{className:"relative z-10 text-center px-6 w-full max-w-sm mx-auto",children:[s.jsx("div",{className:`text-8xl mb-4 transition-transform duration-500 ${o?"scale-110 rotate-6":"scale-100 rotate-0"}`,children:h}),s.jsxs("div",{className:"relative rounded-3xl px-6 py-4 mb-6 shadow-xl overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-100 via-pink-100 to-blue-100"}),s.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2 w-6 h-6 bg-gradient-to-br from-purple-100 to-pink-100 rotate-45"}),s.jsxs("div",{className:"relative",children:[s.jsxs("h1",{className:"text-3xl font-bold text-purple-800",children:["Hello, ",x,"! "]}),s.jsx("p",{className:"text-sm text-purple-600 mt-1",children:E()})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[s.jsxs("div",{className:"relative rounded-2xl p-3 transform hover:scale-105 transition-transform overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-yellow-200 via-yellow-100 to-orange-100"}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"text-3xl mb-1",children:""}),s.jsx("div",{className:"text-2xl font-bold text-orange-800",children:w}),s.jsx("div",{className:"text-xs text-orange-600",children:"Level"})]})]}),s.jsxs("div",{className:"relative rounded-2xl p-3 transform hover:scale-105 transition-transform overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-200 via-cyan-100 to-teal-100"}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"text-3xl mb-1",children:""}),s.jsx("div",{className:"text-2xl font-bold text-teal-800",children:I}),s.jsx("div",{className:"text-xs text-teal-600",children:"Coins"})]})]}),s.jsxs("div",{className:"relative rounded-2xl p-3 transform hover:scale-105 transition-transform overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-200 via-red-100 to-pink-100"}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"text-3xl mb-1",children:""}),s.jsx("div",{className:"text-2xl font-bold text-orange-800",children:_}),s.jsx("div",{className:"text-xs text-orange-600",children:"Streak"})]})]})]}),s.jsx("div",{className:"h-4"}),s.jsx("div",{className:"text-white/90 font-medium animate-fade-slide mb-6",children:u}),s.jsxs("button",{onClick:L,className:"group relative w-full",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-green-400 to-blue-500 rounded-full blur-lg opacity-75 group-hover:opacity-100 transition-opacity"}),s.jsxs("div",{className:`relative bg-gradient-to-r from-green-400 to-blue-500 text-white py-5 px-8 rounded-full font-bold text-xl shadow-2xl 
            transform transition-all duration-300 hover:scale-105 active:scale-95 flex items-center justify-center gap-3`,children:[s.jsx("span",{children:"Let's Learn!"}),s.jsx("span",{className:"text-2xl animate-bounce",children:""})]})]})]}),s.jsx("style",{jsx:!0,children:`
        @keyframes twinkle {
          0%, 100% { 
            opacity: 0.3; 
            transform: scale(1);
          }
          50% { 
            opacity: 1; 
            transform: scale(1.2);
          }
        }
        
        @keyframes float-right {
          from { transform: translateX(-100px); }
          to { transform: translateX(calc(100vw + 100px)); }
        }
        
        @keyframes fade-slide {
          0%, 100% { opacity: 0.8; transform: translateY(0); }
          50% { opacity: 1; transform: translateY(-3px); }
        }
        
        .animate-twinkle {
          color: rgba(255, 255, 255, 0.9);
          animation: twinkle 3s ease-in-out infinite;
        }
        
        .cloud {
          position: absolute;
          font-size: 60px;
          opacity: 0.3;
          animation: float-right 20s linear infinite;
        }
        
        .cloud1 {
          top: 10%;
          animation-duration: 25s;
        }
        
        .cloud2 {
          top: 5%;
          animation-duration: 30s;
          animation-delay: 10s;
        }
        
        .animate-fade-slide {
          animation: fade-slide 3s ease-in-out infinite;
        }
        
        .hide-bottom-nav .bottom-nav {
          display: none !important;
        }
      `})]})}function Ux(){const[t,e]=f.useState(()=>{const H=sessionStorage.getItem("justSignedUp"),ne=sessionStorage.getItem("justSignedIn");return H==="true"||ne==="true"?(sessionStorage.removeItem("justSignedUp"),sessionStorage.removeItem("justSignedIn"),sessionStorage.setItem("welcomeShown","true"),!1):sessionStorage.getItem("welcomeShown")!=="true"}),n=Ye(),r=Wr(),{player:i,levelProgress:a,useEnergy:o,changeAvatar:l}=r,[,u]=f.useState({});Ft("/sounds/correct.mp3",{volume:.6}),Ft("/sounds/wrong.mp3",{volume:.6}),Ft("/sounds/coin.mp3",{volume:.75});const[d]=Ft("/sounds/levelup.mp3",{volume:.8}),h=f.useRef(i.level),g=f.useRef(null);f.useEffect(()=>{const H=()=>{};return window.addEventListener("focus",H),()=>window.removeEventListener("focus",H)},[]),f.useEffect(()=>{i.level>h.current&&(d==null||d(),h.current=i.level)},[i.level,d]),f.useEffect(()=>{const H=()=>{u({})};return window.addEventListener("storage",H),window.addEventListener("coinsUpdated",H),()=>{window.removeEventListener("storage",H),window.removeEventListener("coinsUpdated",H)}},[]);const[x,N]=f.useState(!1),[w,k]=f.useState(null),[I,C]=f.useState(!1),[_,v]=f.useState("medium"),[P,D]=f.useState(10),[L,E]=f.useState(45),[m,y]=f.useState(!1),[j,A]=f.useState(!1),[T,S]=f.useState(!1),[G,Z]=f.useState("general-knowledge"),[te,K]=f.useState("medium"),[$,O]=f.useState(10);f.useEffect(()=>{const H=sessionStorage.getItem("homeScrollPosition");H&&window.scrollTo(0,parseInt(H));const ne=()=>{sessionStorage.setItem("homeScrollPosition",window.scrollY.toString())};return window.addEventListener("scroll",ne),()=>window.removeEventListener("scroll",ne)},[]);const V=H=>{if(mt.trackButtonClick(`category_${H.slug}`,"home_screen"),H.slug==="more"){N(!0);return}k(H),C(!0)},B=()=>{console.log("Starting quiz with energy:",i.energy),console.log("Category:",w.slug),n(`/quiz/${w.slug}`,{state:{mode:"quiz",difficulty:_,count:P,timer:{type:"per_q",seconds:L},source:"adventure"}}),C(!1)},M=()=>{console.log("Starting practice, category:",G),n(`/quiz/${G}`,{state:{mode:"practice",difficulty:te,count:$,timer:{type:"off",seconds:0}}}),S(!1)},z=[{icon:"",label:"Quests",color:"bg-gradient-to-br from-orange-500 to-pink-500",action:()=>{mt.trackButtonClick("quests","home_screen"),sessionStorage.setItem("questsFromHome","true"),n("/profile/quests")}},{icon:"",label:"Streak",color:"bg-gradient-to-br from-red-500 to-orange-500",action:()=>{mt.trackButtonClick("streak","home_screen"),n("/profile/streaks")}},{icon:"",label:"Achieve",color:"bg-gradient-to-br from-blue-500 to-purple-500",action:()=>{mt.trackButtonClick("achievements","home_screen"),n("/profile/achievements")}},{icon:"",label:"Rewards",color:"bg-gradient-to-br from-green-500 to-teal-500",action:()=>{mt.trackButtonClick("rewards","home_screen"),n("/profile/rewards")}}];return s.jsxs(s.Fragment,{children:[t&&s.jsx(x4,{player:i,onContinue:()=>e(!1)}),s.jsxs("div",{className:"min-h-screen bg-base-bg text-base-text",children:[s.jsx("div",{className:"fixed inset-0 -z-10 pointer-events-none",style:{background:"linear-gradient(to bottom, #0B0F1A, #111827)"}}),s.jsxs("div",{className:"relative z-10 px-4 pt-4 pb-24",children:[s.jsx("style",{jsx:!0,children:`
          @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-5px) rotate(-2deg); }
            50% { transform: translateY(0) rotate(0deg); }
            75% { transform: translateY(-3px) rotate(2deg); }
          }
          
          @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
          }
          
          @keyframes shimmer {
            0% { background-position: -200% center; }
            100% { background-position: 200% center; }
          }
          
          @keyframes coinRotate {
            from { transform: rotateY(0deg); }
            to { transform: rotateY(360deg); }
          }
          
          @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(251, 191, 36, 0.5); }
            50% { box-shadow: 0 0 40px rgba(251, 191, 36, 0.8); }
          }
          
          .flip-card {
            perspective: 1000px;
          }
          
          .flip-card-inner {
            transition: transform 0.6s;
            transform-style: preserve-3d;
          }
          
          .flip-card-inner.flipped {
            transform: rotateY(180deg);
          }
          
          .flip-card-front, .flip-card-back {
            backface-visibility: hidden;
          }
          
          .flip-card-back {
            transform: rotateY(180deg);
          }
          
          .coin-3d {
            animation: coinRotate 2s linear infinite;
            transform-style: preserve-3d;
          }
          
          .magic-gradient {
            background: linear-gradient(45deg, #FFD700, #FFA500, #FF6B6B, #FF1493, #9370DB, #4169E1, #00CED1, #FFD700);
            background-size: 400% 400%;
            animation: gradientShift 8s ease infinite;
          }
          
          @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
          }
        `}),s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("div",{className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>{mt.trackButtonClick("avatar_modal_opened","home_screen"),A(!0)},children:s.jsx(i4,{player:i,size:"small",showLevel:!0,showName:!0})}),s.jsx("div",{className:"flex gap-2",children:s.jsxs("button",{ref:g,onClick:()=>{mt.trackButtonClick("coins_modal_opened","home_screen"),y(!0)},className:"px-3 py-1.5 rounded-xl bg-gradient-to-r from-yellow-500/10 to-orange-500/10 border border-yellow-500/30 flex items-center gap-2 hover:from-yellow-500/20 hover:to-orange-500/20 transition",children:[s.jsx("span",{className:"text-lg",children:""}),s.jsx("span",{className:"font-bold",children:ye.getCoins()})]})})]}),s.jsx(a4,{current:a.current,required:a.required,level:i.level,animate:!0})]}),s.jsx(o4,{}),s.jsx(l4,{actions:z}),s.jsx(d4,{coinPillRef:g}),s.jsx(c4,{categories:Kw,onCategorySelect:V}),s.jsx(u4,{onClick:()=>S(!0),isPulsing:i.energy<10}),s.jsxs("div",{onClick:()=>{mt.trackButtonClick("surprise_zone","home_screen"),n("/surprise")},className:"mt-6 relative overflow-hidden rounded-3xl bg-gradient-to-br from-purple-500/20 via-pink-500/20 to-yellow-500/20 backdrop-blur border border-white/10 p-12 mb-4 cursor-pointer hover:scale-[1.02] transition-all group",children:[s.jsxs("div",{className:"absolute inset-0 opacity-30",children:[s.jsx("div",{className:"absolute top-4 left-4 w-2 h-2 bg-yellow-400 rounded-full animate-pulse"}),s.jsx("div",{className:"absolute top-8 right-8 w-3 h-3 bg-pink-400 rounded-full animate-pulse",style:{animationDelay:"0.5s"}}),s.jsx("div",{className:"absolute bottom-6 left-12 w-2 h-2 bg-purple-400 rounded-full animate-pulse",style:{animationDelay:"1s"}}),s.jsx("div",{className:"absolute bottom-4 right-6 w-2 h-2 bg-blue-400 rounded-full animate-pulse",style:{animationDelay:"1.5s"}})]}),s.jsxs("div",{className:"relative flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold mb-1 bg-gradient-to-r from-purple-400 via-pink-400 to-yellow-400 bg-clip-text text-transparent",children:" Surprise Zone"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Mystery Box  Avatar Room  Fun Facts"})]}),s.jsx("div",{className:"text-4xl group-hover:rotate-12 transition-transform",children:""})]})]}),s.jsx(h4,{show:j,onClose:()=>A(!1),player:i,changeAvatar:l,GAME_CONSTANTS:un}),s.jsx(p4,{show:I,onClose:()=>C(!1),selectedCategory:w,difficulty:_,setDifficulty:v,count:P,setCount:D,timer:L,setTimer:E,onStart:B}),s.jsx(g4,{show:T,onClose:()=>S(!1),allCategories:Jw,category:G,setCategory:Z,difficulty:te,setDifficulty:K,count:$,setCount:O,onStart:M}),s.jsx(f4,{show:x,onClose:()=>N(!1),categories:Xw,onCategorySelect:V}),s.jsx(m4,{show:m,onClose:()=>y(!1),coins:i.coins,onNavigateToPlay:()=>{y(!1),n("/play")}})]})]})]})}const Ul={OWNED_CHARACTERS:"owned_characters",SOUND:"play_sound_on"},ql={get:(t,e=null)=>{try{const n=localStorage.getItem(t);return n?JSON.parse(n):e}catch{return e}},set:(t,e)=>{try{localStorage.setItem(t,JSON.stringify(e))}catch{}}};function Wu(){const[t,e]=f.useState(()=>ye.getCoins()),[n,r]=f.useState(()=>ye.getXP()),[i,a]=f.useState(()=>ye.getLevel()),[o,l]=f.useState(()=>ql.get(Ul.OWNED_CHARACTERS,[])),[u,d]=f.useState(()=>ql.get(Ul.SOUND,!0));f.useEffect(()=>{const P=jt.getCurrentUser();P!=null&&P.phone&&ye.initializeUserData(P.phone)},[]);const h=f.useCallback(P=>{const D=ye.addCoins(P,"Game reward");return e(D),D},[]),g=f.useCallback(P=>{const D=ye.addXP(P);r(D);const L=ye.getLevel();return L>i&&a(L),D},[i]),x=f.useCallback((P,D="Purchase")=>{if(ye.spendCoins(P,D)){const L=ye.getCoins();return e(L),!0}return!1},[]),N=f.useCallback(P=>{l(D=>{const L=[...new Set([...D,P])];return ql.set(Ul.OWNED_CHARACTERS,L),L})},[]),w=f.useCallback(()=>ye.checkAndUpdateLevel(),[]);f.useEffect(()=>{ql.set(Ul.SOUND,u)},[u]);const k=f.useCallback((P,D,L,E,m)=>{const y=jt.getCurrentUser(),j=ye.recordQuizSession(y==null?void 0:y.phone,{score:P,totalQuestions:D,category:L,difficulty:E,mode:m});return e(j.newTotal),r(j.newXP),a(j.newLevel),j},[]),I=f.useCallback((P,D,L)=>{const E=jt.getCurrentUser(),m=ye.recordPracticeSession(E==null?void 0:E.phone,{questionsCompleted:P,correctAnswers:D,category:L});return e(m.newTotal),r(m.newXP),m},[]),C=f.useCallback(()=>{const P=jt.getCurrentUser();return P!=null&&P.phone?ye.getUserStats(P.phone):null},[]),_=f.useCallback(()=>{const P=jt.getCurrentUser();return P!=null&&P.phone?ye.getQuestData(P.phone):null},[]),v=f.useCallback(()=>{const P=jt.getCurrentUser();return ye.getTodaySummary(P==null?void 0:P.phone)},[]);return{coins:t,xp:n,level:i,ownedCharacters:o,soundOn:u,addCoins:h,addXp:g,spendCoins:x,unlockCharacter:N,setSoundOn:d,checkLevelUp:w,recordQuizComplete:k,recordPracticeComplete:I,getUserStats:C,getQuestData:_,getTodaySummary:v,nextLevelThreshold:100*i*(i-1),xpProgress:n/Math.max(1,100*i*(i-1))}}const y4=[{name:"General Knowledge",questions:50,icon:"",color:"#7C3AED"},{name:"Artificial Intelligence",questions:28,icon:"",color:"#10B981"},{name:"Fun facts",questions:30,icon:"",color:"#EF4444"},{name:"Science",questions:45,icon:"",color:"#F59E0B"},{name:"History",questions:42,icon:"",color:"#2563EB"},{name:"Geography",questions:38,icon:"",color:"#FACC15"}],ir=y4.slice(0,6),ti=360/ir.length,v4={"general-knowledge":"TINA","artificial-intelligence":"ALBERT","fun-facts":"BONZO",science:"POP",history:"TITO",geography:"HECTOR"},Jr={FULL_TURNS:6,DURATION:2800,OVERSHOOT:12,SETTLE_DURATION:350},us=(t,e=.7)=>{try{const n=new Audio(t);return n.volume=e,n.play().catch(()=>{})}catch{}},Yu=t=>{navigator.vibrate&&navigator.vibrate(t)},ds=t=>t.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-"),qx=t=>(t%360+360)%360;function b4({run:t,coins:e,xp:n,level:r,ownedCharacters:i,onSpin:a,onBack:o,spinning:l,angle:u,transition:d,result:h,showCallout:g,glowColor:x,soundOn:N,setSoundOn:w,showSparkle:k,pulseIdx:I,nextProgressIdx:C,pendingProgressIdx:_,coinBurstTick:v,lastAnswerWasCorrect:P,coinPillRef:D,wheelRef:L}){const E=100*r*(r-1),[m,y]=f.useState(!1),[j,A]=f.useState(ye.getCoins());return f.useEffect(()=>{const T=()=>A(ye.getCoins());window.addEventListener("coinsUpdated",T),window.addEventListener("storage",T);const S=setInterval(T,1e3);return()=>{window.removeEventListener("coinsUpdated",T),window.removeEventListener("storage",T),clearInterval(S)}},[]),f.useEffect(()=>(document.body.classList.add("hide-bottom-nav"),()=>{document.body.classList.remove("hide-bottom-nav")}),[]),f.useEffect(()=>{if(_==null)return;y(!1);const T=setTimeout(()=>y(!0),30);return()=>clearTimeout(T)},[_]),s.jsxs("div",{className:"fixed inset-0 bg-gradient-to-b from-gray-900 via-purple-900/20 to-gray-900 text-white overflow-hidden",children:[s.jsx("style",{children:`
        @keyframes float {
          0%, 100% { 
            transform: translateY(0) scale(1);
          }
          50% { 
            transform: translateY(-10px) scale(1.02);
          }
        }
        
        @keyframes pulse-glow {
          0%, 100% { 
            opacity: 0.5;
          }
          50% { 
            opacity: 1;
          }
        }
        
        @keyframes shimmer {
          0% { background-position: -200% center; }
          100% { background-position: 200% center; }
        }
        
        @keyframes progress-fill {
          0% { 
            width: 0%;
            background-position: -200% center;
          }
          50% {
            background-position: 0% center;
          }
          100% { 
            width: 100%;
            background-position: 200% center;
          }
        }
        
        @keyframes star-bounce {
          0%, 100% { transform: scale(1) rotate(0deg); }
          50% { transform: scale(1.2) rotate(180deg); }
        }
      `}),s.jsxs("div",{className:"h-full flex flex-col mx-auto max-w-md px-5 pt-[calc(env(safe-area-inset-top)+2rem)]",children:[s.jsxs("header",{className:"flex items-center justify-between mb-4 mt-6",children:[s.jsx("button",{onClick:o,className:"h-12 w-12 rounded-2xl bg-white/10 backdrop-blur-xl border border-white/20 grid place-items-center hover:bg-white/20 transition-all",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15 19l-7-7 7-7"})})}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"px-4 py-2 rounded-2xl bg-white/10 backdrop-blur-xl border border-white/20",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-xs text-white/70",children:["Lvl ",r]}),s.jsx("div",{className:"w-16 h-1.5 bg-white/20 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-blue-400 to-purple-400 rounded-full transition-all duration-500",style:{width:`${Math.min(n/E,1)*100}%`}})})]})}),s.jsxs("button",{ref:D,className:"px-4 py-2 rounded-2xl bg-gradient-to-r from-yellow-500/20 to-orange-500/20 backdrop-blur-xl border border-yellow-500/30 flex items-center gap-2 hover:scale-105 transition-transform",children:[s.jsx("span",{className:"text-lg",children:""}),s.jsx("span",{className:"font-bold text-yellow-300",children:j})]})]}),s.jsx("button",{onClick:()=>w(!N),className:"h-12 w-12 rounded-2xl bg-white/10 backdrop-blur-xl border border-white/20 grid place-items-center hover:bg-white/20 transition-all",children:s.jsx("span",{className:"text-xl",children:N?"":""})})]}),i.length>0&&s.jsx("div",{className:"flex justify-center mb-4",children:s.jsxs("div",{className:"inline-flex gap-3 px-5 py-3 bg-white/5 backdrop-blur-xl rounded-3xl border border-white/10",children:[s.jsx("span",{className:"text-xs text-white/50 self-center",children:"Unlocked:"}),i.map(T=>{const S=ir.find(G=>ds(G.name)===T);return s.jsx("div",{className:"relative group",children:s.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-white/20 to-white/10 flex items-center justify-center border border-white/20 group-hover:scale-110 transition-transform",children:s.jsx("span",{className:"text-lg",children:S==null?void 0:S.icon})})},T)})]})}),s.jsx("div",{className:"flex justify-center gap-3 mb-6",children:[0,1,2].map(T=>{const S=!!t.progress[T],G=T===_;return s.jsxs("div",{className:"relative flex items-center",children:[T<2&&s.jsx("div",{className:"absolute left-full w-3 h-0.5 bg-white/20 top-1/2 z-0"}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("div",{className:`
                    w-12 h-12 rounded-full flex items-center justify-center
                    transition-all duration-700 transform
                    ${S?"bg-gradient-to-br from-green-400 to-emerald-500 scale-110":"bg-white/10 backdrop-blur border border-white/20"}
                    ${G?"animate-pulse scale-125":""}
                  `,children:S?s.jsx("span",{className:"text-xl",style:{animation:G?"star-bounce 1s ease-in-out":"none"},children:""}):s.jsx("span",{className:"text-white/40 font-bold text-sm",children:T+1})}),G&&s.jsx("div",{className:"absolute inset-0 rounded-full overflow-hidden",children:s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent",style:{animation:"shimmer 1s ease-out"}})}),k===T&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"absolute -top-1 -right-1 text-yellow-400 animate-ping",children:""}),s.jsx("div",{className:"absolute -bottom-1 -left-1 text-yellow-400 animate-ping",style:{animationDelay:"0.2s"},children:""})]})]})]},T)})}),s.jsx("section",{className:"flex-1 flex items-center justify-center pb-12",children:s.jsxs("div",{className:"relative w-full max-w-sm",children:[s.jsx("div",{className:"absolute inset-0",style:{animation:"pulse-glow 4s ease-in-out infinite"},children:s.jsx("div",{className:"absolute inset-6 bg-gradient-to-br from-purple-500/10 to-blue-500/10 rounded-full blur-3xl"})}),s.jsxs("div",{ref:L,className:"relative w-full aspect-square",style:{animation:l?"none":"float 6s ease-in-out infinite"},children:[s.jsx("div",{className:"absolute -bottom-6 left-1/2 -translate-x-1/2 w-3/4 h-8 bg-black/20 rounded-full blur-xl"}),x&&s.jsx("div",{className:"pointer-events-none absolute -inset-4 rounded-full animate-pulse",style:{boxShadow:`0 0 60px 20px ${x}40`,background:`radial-gradient(circle, ${x}20, transparent 70%)`}}),s.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-white/30 shadow-2xl overflow-hidden bg-gradient-to-br from-gray-800 to-gray-900",style:{transform:`rotate(${u}deg)`,transition:d,boxShadow:"inset 0 0 40px rgba(0,0,0,0.5), 0 20px 40px rgba(0,0,0,0.3)"},children:s.jsx("svg",{width:"100%",height:"100%",viewBox:"0 0 100 100",className:"block",children:ir.map((T,S)=>{const G=S*ti,Z=G+ti,te=ti>180?1:0,K=Math.PI*G/180,$=Math.PI*Z/180,O=50+48*Math.cos(K),V=50-48*Math.sin(K),B=50+48*Math.cos($),M=50-48*Math.sin($),z=G+ti/2,H=30,ne=50+H*Math.cos(z*Math.PI/180),q=50-H*Math.sin(z*Math.PI/180);return s.jsxs("g",{children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:`grad${S}`,x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[s.jsx("stop",{offset:"0%",stopColor:T.color,stopOpacity:"0.9"}),s.jsx("stop",{offset:"100%",stopColor:T.color,stopOpacity:"0.7"})]})}),s.jsx("path",{d:`M50,50 L${O},${V} A48,48 0 ${te} 0 ${B},${M} Z`,fill:`url(#grad${S})`,stroke:"rgba(255,255,255,0.2)",strokeWidth:"0.5"}),s.jsx("text",{x:ne,y:q,fill:"white",fontSize:"20",dominantBaseline:"middle",textAnchor:"middle",style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"},children:T.icon})]},S)})})}),s.jsxs("button",{onClick:()=>{mt.trackButtonClick("wheel_spin","classic_game"),a()},disabled:l,className:"absolute z-10 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 group",children:[s.jsx("div",{className:`
                  w-20 h-20 rounded-full 
                  bg-gradient-to-br from-white to-gray-100
                  shadow-2xl flex items-center justify-center
                  transition-all duration-300
                  ${l?"scale-90 opacity-80":"hover:scale-110 active:scale-95 hover:shadow-3xl"}
                `,children:s.jsx("span",{className:"font-black text-gray-800 text-sm",children:"SPIN"})}),!l&&s.jsx("div",{className:"absolute inset-0 rounded-full bg-white/30 animate-ping"})]}),g&&h&&s.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 -top-20 z-30",children:s.jsx("div",{className:"px-5 py-2 rounded-2xl bg-white/95 backdrop-blur-xl shadow-2xl animate-bounce",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:h.cat.icon}),s.jsx("span",{className:"font-bold text-gray-800",children:h.cat.name})]})})})]})]})}),s.jsx("div",{className:"text-center pb-12",children:s.jsx("p",{className:"text-white/30 text-xs",children:"Tap SPIN to begin your adventure"})})]})]})}var yc={linear:function(t,e,n,r){var i=n-e;return i*t/r+e},easeInQuad:function(t,e,n,r){var i=n-e;return i*(t/=r)*t+e},easeOutQuad:function(t,e,n,r){var i=n-e;return-i*(t/=r)*(t-2)+e},easeInOutQuad:function(t,e,n,r){var i=n-e;return(t/=r/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,r){var i=n-e;return i*(t/=r)*t*t+e},easeOutCubic:function(t,e,n,r){var i=n-e;return i*((t=t/r-1)*t*t+1)+e},easeInOutCubic:function(t,e,n,r){var i=n-e;return(t/=r/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,r){var i=n-e;return i*(t/=r)*t*t*t+e},easeOutQuart:function(t,e,n,r){var i=n-e;return-i*((t=t/r-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,n,r){var i=n-e;return(t/=r/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,r){var i=n-e;return i*(t/=r)*t*t*t*t+e},easeOutQuint:function(t,e,n,r){var i=n-e;return i*((t=t/r-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,r){var i=n-e;return(t/=r/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,r){var i=n-e;return-i*Math.cos(t/r*(Math.PI/2))+i+e},easeOutSine:function(t,e,n,r){var i=n-e;return i*Math.sin(t/r*(Math.PI/2))+e},easeInOutSine:function(t,e,n,r){var i=n-e;return-i/2*(Math.cos(Math.PI*t/r)-1)+e},easeInExpo:function(t,e,n,r){var i=n-e;return t==0?e:i*Math.pow(2,10*(t/r-1))+e},easeOutExpo:function(t,e,n,r){var i=n-e;return t==r?e+i:i*(-Math.pow(2,-10*t/r)+1)+e},easeInOutExpo:function(t,e,n,r){var i=n-e;return t===0?e:t===r?e+i:(t/=r/2)<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(-Math.pow(2,-10*--t)+2)+e},easeInCirc:function(t,e,n,r){var i=n-e;return-i*(Math.sqrt(1-(t/=r)*t)-1)+e},easeOutCirc:function(t,e,n,r){var i=n-e;return i*Math.sqrt(1-(t=t/r-1)*t)+e},easeInOutCirc:function(t,e,n,r){var i=n-e;return(t/=r/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,n,r){var i=n-e,a,o,l;return l=1.70158,o=0,a=i,t===0?e:(t/=r)===1?e+i:(o||(o=r*.3),a<Math.abs(i)?(a=i,l=o/4):l=o/(2*Math.PI)*Math.asin(i/a),-(a*Math.pow(2,10*(t-=1))*Math.sin((t*r-l)*(2*Math.PI)/o))+e)},easeOutElastic:function(t,e,n,r){var i=n-e,a,o,l;return l=1.70158,o=0,a=i,t===0?e:(t/=r)===1?e+i:(o||(o=r*.3),a<Math.abs(i)?(a=i,l=o/4):l=o/(2*Math.PI)*Math.asin(i/a),a*Math.pow(2,-10*t)*Math.sin((t*r-l)*(2*Math.PI)/o)+i+e)},easeInOutElastic:function(t,e,n,r){var i=n-e,a,o,l;return l=1.70158,o=0,a=i,t===0?e:(t/=r/2)===2?e+i:(o||(o=r*(.3*1.5)),a<Math.abs(i)?(a=i,l=o/4):l=o/(2*Math.PI)*Math.asin(i/a),t<1?-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*r-l)*(2*Math.PI)/o))+e:a*Math.pow(2,-10*(t-=1))*Math.sin((t*r-l)*(2*Math.PI)/o)*.5+i+e)},easeInBack:function(t,e,n,r,i){var a=n-e;return i===void 0&&(i=1.70158),a*(t/=r)*t*((i+1)*t-i)+e},easeOutBack:function(t,e,n,r,i){var a=n-e;return i===void 0&&(i=1.70158),a*((t=t/r-1)*t*((i+1)*t+i)+1)+e},easeInOutBack:function(t,e,n,r,i){var a=n-e;return i===void 0&&(i=1.70158),(t/=r/2)<1?a/2*(t*t*(((i*=1.525)+1)*t-i))+e:a/2*((t-=2)*t*(((i*=1.525)+1)*t+i)+2)+e},easeInBounce:function(t,e,n,r){var i=n-e,a;return a=yc.easeOutBounce(r-t,0,i,r),i-a+e},easeOutBounce:function(t,e,n,r){var i=n-e;return(t/=r)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,e,n,r){var i=n-e,a;return t<r/2?(a=yc.easeInBounce(t*2,0,i,r),a*.5+e):(a=yc.easeOutBounce(t*2-r,0,i,r),a*.5+i*.5+e)}},w4=yc;function N4(t){return t*Math.PI/180}function Rn(t,e){return t+Math.random()*(e-t)}function j4(t,e){return Math.floor(t+Math.random()*(e-t+1))}var bo;(function(t){t[t.Circle=0]="Circle",t[t.Square=1]="Square",t[t.Strip=2]="Strip"})(bo||(bo={}));var ss;(function(t){t[t.Positive=1]="Positive",t[t.Negative=-1]="Negative"})(ss||(ss={}));const S4=1e3/60;class _4{constructor(e,n,r,i){this.getOptions=n;const{colors:a,initialVelocityX:o,initialVelocityY:l}=this.getOptions();this.context=e,this.x=r,this.y=i,this.w=Rn(5,20),this.h=Rn(5,20),this.radius=Rn(5,10),this.vx=typeof o=="number"?Rn(-o,o):Rn(o.min,o.max),this.vy=typeof l=="number"?Rn(-l,0):Rn(l.min,l.max),this.shape=j4(0,2),this.angle=N4(Rn(0,360)),this.angularSpin=Rn(-.2,.2),this.color=a[Math.floor(Math.random()*a.length)],this.rotateY=Rn(0,1),this.rotationDirection=Rn(0,1)?ss.Positive:ss.Negative}update(e){const{gravity:n,wind:r,friction:i,opacity:a,drawShape:o}=this.getOptions(),l=e/S4;this.x+=this.vx*l,this.y+=this.vy*l,this.vy+=n*l,this.vx+=r*l,this.vx*=i**l,this.vy*=i**l,this.rotateY>=1&&this.rotationDirection===ss.Positive?this.rotationDirection=ss.Negative:this.rotateY<=-1&&this.rotationDirection===ss.Negative&&(this.rotationDirection=ss.Positive);const u=.1*this.rotationDirection*l;if(this.rotateY+=u,this.angle+=this.angularSpin,this.context.save(),this.context.translate(this.x,this.y),this.context.rotate(this.angle),this.context.scale(1,this.rotateY),this.context.rotate(this.angle),this.context.beginPath(),this.context.fillStyle=this.color,this.context.strokeStyle=this.color,this.context.globalAlpha=a,this.context.lineCap="round",this.context.lineWidth=2,o&&typeof o=="function")o.call(this,this.context);else switch(this.shape){case bo.Circle:{this.context.beginPath(),this.context.arc(0,0,this.radius,0,2*Math.PI),this.context.fill();break}case bo.Square:{this.context.fillRect(-this.w/2,-this.h/2,this.w,this.h);break}case bo.Strip:{this.context.fillRect(-this.w/6,-this.h/2,this.w/3,this.h);break}}this.context.closePath(),this.context.restore()}}class k4{constructor(e,n){this.x=0,this.y=0,this.w=0,this.h=0,this.lastNumberOfPieces=0,this.tweenProgress=0,this.tweenFrom=0,this.particles=[],this.particlesGenerated=0,this.removeParticleAt=i=>{this.particles.splice(i,1)},this.getParticle=()=>{const i=Rn(this.x,this.w+this.x),a=Rn(this.y,this.h+this.y);return new _4(this.context,this.getOptions,i,a)},this.animate=i=>{const{canvas:a,context:o,particlesGenerated:l,lastNumberOfPieces:u}=this,{run:d,recycle:h,numberOfPieces:g,debug:x,tweenFunction:N,tweenDuration:w}=this.getOptions();if(!d)return!1;const k=this.particles.length,I=h?k:l;if(I<g){u!==g&&(this.tweenProgress=0,this.tweenFrom=I,this.lastNumberOfPieces=g),this.tweenProgress=Math.min(w,Math.max(0,this.tweenProgress+i));const C=N(this.tweenProgress,this.tweenFrom,g,w),_=Math.round(C-I);for(let v=0;v<_;v++)this.particles.push(this.getParticle());this.particlesGenerated+=_}x&&(o.font="12px sans-serif",o.fillStyle="#333",o.textAlign="right",o.fillText(`Particles: ${k}`,a.width-10,a.height-20));for(let C=this.particles.length-1;C>=0;C--){const _=this.particles[C];_.update(i),(_.y>a.height||_.y<-100||_.x>a.width+100||_.x<-100)&&(h&&I<=g?this.particles[C]=this.getParticle():this.removeParticleAt(C))}return k>0||I<g},this.canvas=e;const r=this.canvas.getContext("2d");if(!r)throw new Error("Could not get canvas context");this.context=r,this.getOptions=n}}const yp={width:typeof window<"u"?window.innerWidth:300,height:typeof window<"u"?window.innerHeight:200,numberOfPieces:200,friction:.99,wind:0,gravity:.1,initialVelocityX:4,initialVelocityY:10,colors:["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722","#795548"],opacity:1,debug:!1,tweenFunction:w4.easeInOutQuad,tweenDuration:5e3,recycle:!0,run:!0};class E4{constructor(e,n){this.lastFrameTime=0,this.setOptionsWithDefaults=i=>{const a={confettiSource:{x:0,y:0,w:this.canvas.width,h:0}};this._options={...a,...yp,...i},Object.assign(this,i.confettiSource)},this.update=(i=0)=>{const{options:{run:a,onConfettiComplete:o,frameRate:l},canvas:u,context:d}=this,h=Math.min(i-this.lastFrameTime,50);if(l&&h<1e3/l){this.rafId=requestAnimationFrame(this.update);return}this.lastFrameTime=i-(l?h%l:0),a&&(d.fillStyle="white",d.clearRect(0,0,u.width,u.height)),this.generator.animate(h)?this.rafId=requestAnimationFrame(this.update):(o&&typeof o=="function"&&this.generator.particlesGenerated>0&&o.call(this,this),this._options.run=!1)},this.reset=()=>{this.generator&&this.generator.particlesGenerated>0&&(this.generator.particlesGenerated=0,this.generator.particles=[],this.generator.lastNumberOfPieces=0)},this.stop=()=>{this.options={run:!1},this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=void 0)},this.canvas=e;const r=this.canvas.getContext("2d");if(!r)throw new Error("Could not get canvas context");this.context=r,this.generator=new k4(this.canvas,()=>this.options),this.options=n,this.update()}get options(){return this._options}set options(e){var i,a;const n=(i=this._options)==null?void 0:i.run,r=(a=this._options)==null?void 0:a.recycle;this.setOptionsWithDefaults(e),this.generator&&(Object.assign(this.generator,this.options.confettiSource),typeof e.recycle=="boolean"&&e.recycle&&r===!1&&(this.generator.lastNumberOfPieces=this.generator.particles.length)),typeof e.run=="boolean"&&e.run&&n===!1&&this.update()}}const C4=pn.createRef();class vp extends pn.Component{constructor(e){super(e),this.canvas=pn.createRef(),this.canvas=e.canvasRef||C4}componentDidMount(){if(this.canvas.current){const e=Gd(this.props)[0];this.confetti=new E4(this.canvas.current,e)}}componentDidUpdate(){const e=Gd(this.props)[0];this.confetti&&(this.confetti.options=e)}componentWillUnmount(){this.confetti&&this.confetti.stop(),this.confetti=void 0}render(){const[e,n]=Gd(this.props),r={zIndex:2,position:"absolute",pointerEvents:"none",top:0,left:0,bottom:0,right:0,...n.style};return s.jsx("canvas",{width:e.width,height:e.height,ref:this.canvas,...n,style:r})}}vp.defaultProps={...yp};vp.displayName="ReactConfetti";function Gd(t){const e={},n={},r={},i=[...Object.keys(yp),"confettiSource","drawShape","onConfettiComplete","frameRate"],a=["canvasRef"];for(const o in t){const l=t[o];i.includes(o)?e[o]=l:a.includes(o)?a[o]=l:r[o]=l}return[e,r,n]}const Zw=pn.forwardRef((t,e)=>s.jsx(vp,{canvasRef:e,...t}));function Qx({question:t,category:e,onAnswer:n,run:r,timeLeft:i,usedLifelines:a,onUseLifeline:o,eliminatedOptions:l,audienceData:u,onBack:d,timeUp:h,onTimeUpBackToWheel:g,soundOn:x}){const[N,w]=f.useState(null),[k,I]=f.useState(!1),[C,_]=f.useState(!1),v=f.useRef(null),P=f.useRef(null),[D,L]=f.useState(null);f.useEffect(()=>(document.body.classList.add("hide-bottom-nav"),()=>{document.body.classList.remove("hide-bottom-nav")}),[]),f.useEffect(()=>{if(!k||!v.current)return;const y=v.current.getBoundingClientRect();L({x:y.left,y:y.top-300,w:y.width,h:8})},[k]);const E=y=>{if(k)return;w(y),I(!0);const j=y===t.correctIndex;Yu(j?[50,30,50]:[200]),x&&us(j?"/sounds/correct.mp3":"/sounds/wrong.mp3",.7),setTimeout(()=>{n(j,null)},1500)},m=N===t.correctIndex;return s.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-gray-900 to-black text-white overflow-hidden",children:s.jsxs("div",{ref:P,className:"relative h-full overflow-y-auto px-5 pt-16 pb-[calc(env(safe-area-inset-bottom)+5.25rem)]",children:[s.jsx("div",{className:"mb-4",children:s.jsx("button",{onClick:()=>_(!0),className:"h-10 w-10 rounded-full border border-base-border grid place-items-center bg-white/5 hover:bg-white/10 transition",children:""})}),s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:`text-4xl font-black mb-2 ${i<=10?"text-red-400 animate-pulse":"text-white"}`,children:i}),s.jsx("div",{className:"w-full bg-white/20 rounded-full h-2",children:s.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ${i<=10?"bg-red-400":"bg-blue-400"}`,style:{width:`${i/30*100}%`}})})]}),s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-2xl",style:{backgroundColor:e.color},children:e.icon}),s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-bold",children:e.name}),s.jsxs("div",{className:"text-sm text-gray-400",children:["Question ",r.qIndex+1,"/3"]})]})]}),s.jsx("h2",{ref:v,className:"text-xl font-semibold mb-6 leading-relaxed",children:t.prompt}),s.jsx("div",{className:"space-y-3 mb-6",children:t.options.map((y,j)=>{const A=l.includes(j),T=N===j,S=j===t.correctIndex;let G="bg-white/10 border-white/20",Z="opacity-100";return A?Z="opacity-30":k&&T?G=S?"bg-green-500/30 border-green-400":"bg-red-500/30 border-red-400":k&&S?G="bg-green-500/30 border-green-400":T&&(G="bg-white/20 border-white/40"),s.jsx("button",{onClick:()=>E(j),disabled:k||A,className:`w-full p-4 rounded-xl border-2 text-left transition-all duration-300 ${G} ${Z} ${!k&&!A?"hover:bg-white/15 active:scale-98":""}`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center font-bold text-sm",children:String.fromCharCode(65+j)}),s.jsx("span",{className:"font-medium flex-1",children:y}),u&&s.jsxs("span",{className:"text-xs text-base-muted",children:[Math.round(u[j]),"%"]})]})},j)})}),!k&&s.jsxs("div",{className:"flex gap-4 mb-8",children:[s.jsx("button",{onClick:()=>o("fifty"),disabled:a.fifty,className:`flex-1 p-4 rounded-2xl border-2 font-bold transition-all ${a.fifty?"bg-gray-700 border-gray-600 text-gray-400":"bg-purple-600 border-purple-400 text-white hover:bg-purple-500 active:scale-95"}`,children:"50:50"}),s.jsx("button",{onClick:()=>o("audience"),disabled:a.audience,className:`flex-1 p-4 rounded-2xl border-2 font-bold transition-all ${a.audience?"bg-gray-700 border-gray-600 text-gray-400":"bg-blue-600 border-blue-400 text-white hover:bg-blue-500 active:scale-95"}`,children:" Ask"})]}),k&&s.jsxs("div",{className:"relative text-center",children:[m&&s.jsx("div",{className:"absolute inset-0 pointer-events-none",children:s.jsx(Zw,{recycle:!1,numberOfPieces:120,gravity:.9,tweenDuration:1800,confettiSource:D||{x:0,y:0,w:typeof window<"u"?window.innerWidth:320,h:1}})}),s.jsx("button",{onClick:()=>n(m,null,!0),className:"relative z-10 bg-white text-black font-black py-4 px-8 rounded-2xl text-lg hover:bg-gray-100 transition-all active:scale-95",children:"Continue"})]}),h&&s.jsx("div",{className:"fixed inset-0 z-50 bg-black/60 flex items-center justify-center px-6",children:s.jsxs("div",{className:"w-full max-w-sm rounded-2xl bg-base-card border border-base-border p-5 text-center",children:[s.jsx("div",{className:"text-lg font-bold mb-2",children:"Time's up"}),s.jsx("p",{className:"text-base-muted mb-5",children:"You ran out of time."}),s.jsx("button",{onClick:g,className:"mx-auto w-48 py-3 rounded-xl bg-brand-blue text-white font-semibold hover:bg-brand-blue/90 transition",children:"Back to Wheel"})]})}),C&&s.jsx("div",{className:"fixed inset-0 z-50 bg-black/60 flex items-center justify-center px-6",children:s.jsxs("div",{className:"w-full max-w-sm rounded-2xl bg-base-card border border-base-border p-5 text-center",children:[s.jsx("div",{className:"text-lg font-bold mb-2",children:"Want to quit?"}),s.jsx("p",{className:"text-base-muted mb-5",children:"You'll lose this question's progress."}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>_(!1),className:"flex-1 py-3 rounded-xl border border-base-border bg-white/5 hover:bg-white/10 transition",children:"No"}),s.jsx("button",{onClick:d,className:"flex-1 py-3 rounded-xl bg-blue-600 text-white font-semibold hover:bg-blue-500 transition",children:"Yes"})]})]})})]})})}function Gx({category:t,onComplete:e,isBonus:n=!1,soundOn:r=!0}){const[i,a]=f.useState(!1);return f.useEffect(()=>{document.body.classList.add("hide-bottom-nav"),a(!0),r&&us("/sounds/flush.mp3",.8),Yu([50]);const o=setTimeout(e,2e3);return()=>{clearTimeout(o),document.body.classList.remove("hide-bottom-nav")}},[e,r]),n?s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-purple-900/20 to-gray-900 flex flex-col items-center justify-center text-white relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0",children:[...Array(20)].map((o,l)=>s.jsx("div",{className:"absolute w-2 h-2 bg-white/10 rounded-full animate-pulse",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*3}s`,animationDuration:`${3+Math.random()*2}s`}},l))}),s.jsxs("div",{className:`relative z-10 text-center transform transition-all duration-700 ${i?"scale-100 opacity-100":"scale-50 opacity-0"}`,children:[s.jsx("h2",{className:"text-4xl font-black mb-8 bg-gradient-to-r from-yellow-400 to-orange-400 bg-clip-text text-transparent",children:"Bonus Round!"}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-yellow-400/30 to-orange-400/30 rounded-full relative backdrop-blur-xl border-2 border-yellow-400/50",children:s.jsx("span",{className:"absolute top-1/2 left-1/2 text-6xl animate-pulse",style:{transform:"translate(-46%, -50%)"},children:""})}),s.jsx("div",{className:"absolute inset-0 rounded-full bg-yellow-400/20 animate-ping"})]}),s.jsx("p",{className:"mt-6 text-lg text-white/80",children:"Get ready for a special challenge!"})]})]}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-purple-900/20 to-gray-900 text-white flex items-center justify-center relative overflow-hidden",children:[s.jsx("style",{children:`
        @keyframes float-up {
          0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
          10% { opacity: 1; }
          90% { opacity: 1; }
          100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
        }
        
        @keyframes category-bounce {
          0% { transform: scale(0) rotate(-180deg); }
          50% { transform: scale(1.1) rotate(90deg); }
          70% { transform: scale(0.95) rotate(-20deg); }
          100% { transform: scale(1) rotate(0deg); }
        }
      `}),s.jsx("div",{className:"absolute inset-0 overflow-hidden",children:[...Array(8)].map((o,l)=>s.jsx("div",{className:"absolute w-4 h-4 rounded-full",style:{backgroundColor:`${t.color}40`,left:`${10+l*12}%`,animation:`float-up ${8+l*2}s linear infinite`,animationDelay:`${l*.5}s`}},l))}),s.jsxs("div",{className:"relative",style:{animation:i?"category-bounce 0.8s ease-out":"none"},children:[s.jsx("div",{className:"absolute -inset-20 rounded-full blur-3xl",style:{backgroundColor:`${t.color}20`}}),s.jsxs("div",{className:"relative w-96 h-96 rounded-full flex items-center justify-center shadow-2xl",style:{background:`linear-gradient(135deg, ${t.color}dd, ${t.color}99)`,boxShadow:`0 20px 60px ${t.color}40, inset 0 0 60px rgba(255,255,255,0.1)`},children:[s.jsx("div",{className:"absolute inset-4 rounded-full border-2 border-white/10"}),s.jsx("div",{className:"absolute inset-8 rounded-full border border-white/5"}),s.jsxs("div",{className:"relative z-10 text-center",children:[s.jsx("div",{className:"text-3xl font-black mb-4 text-white drop-shadow-lg",children:t.name}),s.jsx("div",{className:"w-24 h-24 bg-white/20 backdrop-blur rounded-2xl grid place-items-center mx-auto transform hover:scale-110 transition-transform",children:s.jsx("span",{className:"text-5xl filter drop-shadow-lg",children:t.icon})})]})]})]}),s.jsxs("div",{className:"absolute bottom-12 left-1/2 -translate-x-1/2 flex gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-white/30"}),s.jsx("div",{className:"w-2 h-2 rounded-full bg-white/60 animate-pulse"}),s.jsx("div",{className:"w-2 h-2 rounded-full bg-white/30"})]})]})}function T4({onDone:t}){const[e,n]=f.useState([!1,!1,!1,!1]);return f.useEffect(()=>{const r=[setTimeout(()=>n([!0,!1,!1,!1]),100),setTimeout(()=>n([!0,!0,!1,!1]),300),setTimeout(()=>n([!0,!0,!0,!1]),500),setTimeout(()=>n([!0,!0,!0,!0]),700),setTimeout(t,2500)];return()=>r.forEach(clearTimeout)},[t]),s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-emerald-600 via-green-600 to-teal-600 flex items-center justify-center text-white relative overflow-hidden",children:[s.jsx("style",{children:`
        @keyframes confetti-fall {
          0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
          100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        
        @keyframes star-pop {
          0% { transform: scale(0) rotate(0deg); }
          50% { transform: scale(1.3) rotate(180deg); }
          100% { transform: scale(1) rotate(360deg); }
        }
        
        @keyframes text-wave {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-10px); }
        }
      `}),s.jsx("div",{className:"absolute inset-0",children:[...Array(30)].map((r,i)=>s.jsx("div",{className:"absolute text-4xl",style:{left:`${Math.random()*100}%`,animation:`confetti-fall ${3+Math.random()*2}s linear infinite`,animationDelay:`${Math.random()*2}s`},children:["","","","",""][Math.floor(Math.random()*5)]},i))}),s.jsxs("div",{className:"relative z-10 text-center",children:[s.jsx("div",{className:"flex justify-center gap-6 mb-8",children:[0,1,2].map(r=>s.jsx("div",{className:`transform transition-all duration-500 ${e[r]?"scale-100 opacity-100":"scale-0 opacity-0"}`,style:{animation:e[r]?"star-pop 0.6s ease-out":"none"},children:s.jsx("div",{className:"w-20 h-20 bg-white/20 backdrop-blur rounded-2xl flex items-center justify-center",children:s.jsx("span",{className:"text-4xl",children:""})})},r))}),s.jsxs("div",{className:`transform transition-all duration-700 ${e[3]?"scale-100 opacity-100":"scale-0 opacity-0"}`,children:[s.jsxs("h2",{className:"text-4xl font-black mb-2",children:[s.jsx("span",{style:{animation:"text-wave 1s ease-in-out infinite"},children:"Perfect"})," ",s.jsx("span",{style:{animation:"text-wave 1s ease-in-out 0.1s infinite"},children:"Streak!"})]}),s.jsx("p",{className:"text-xl opacity-90",children:"3 correct in a row!"}),s.jsxs("div",{className:"mt-6 flex justify-center gap-4 text-3xl",children:[s.jsx("span",{className:"animate-bounce",style:{animationDelay:"0s"},children:""}),s.jsx("span",{className:"animate-bounce",style:{animationDelay:"0.1s"},children:""}),s.jsx("span",{className:"animate-bounce",style:{animationDelay:"0.2s"},children:""})]})]})]})]})}function I4({onSelect:t}){const[e,n]=f.useState(null);return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-purple-900/20 to-gray-900 text-white",children:[s.jsx("style",{children:`
        @keyframes character-float {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-5px); }
        }
        
        @keyframes shimmer {
          0% { background-position: -200% center; }
          100% { background-position: 200% center; }
        }
      `}),s.jsxs("div",{className:"mx-auto max-w-md px-5 pt-16 pb-8",children:[s.jsxs("header",{className:"text-center mb-10",children:[s.jsxs("div",{className:"relative inline-block mb-6",children:[s.jsx("div",{className:"absolute inset-0 bg-yellow-400/30 rounded-full blur-2xl animate-pulse"}),s.jsx("div",{className:"relative text-6xl animate-bounce",children:""})]}),s.jsx("h1",{className:"text-3xl font-black mb-3 bg-gradient-to-r from-yellow-400 to-orange-400 bg-clip-text text-transparent",children:"Perfect Round!"}),s.jsx("p",{className:"text-lg text-white/80",children:"Choose your reward character"})]}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:ir.map((r,i)=>{const a=v4[ds(r.name)],o=e===i;return s.jsxs("button",{onClick:()=>{Yu([20]),us("/sounds/select.mp3",.5),t(ds(r.name))},onMouseEnter:()=>n(i),onMouseLeave:()=>n(null),className:`
                  relative p-6 rounded-2xl backdrop-blur-xl
                  bg-white/10 border border-white/20
                  transform transition-all duration-300
                  hover:scale-105 hover:bg-white/15 active:scale-95
                  ${o?"shadow-2xl":"shadow-lg"}
                `,style:{animation:o?"character-float 2s ease-in-out infinite":"none",boxShadow:o?`0 10px 40px ${r.color}40`:""},children:[o&&s.jsx("div",{className:"absolute inset-0 rounded-2xl opacity-30",style:{background:"linear-gradient(105deg, transparent 40%, white 50%, transparent 60%)",animation:"shimmer 1s ease-out"}}),s.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-xl flex items-center justify-center",style:{background:`linear-gradient(135deg, ${r.color}40, ${r.color}20)`},children:s.jsx("span",{className:"text-3xl",children:r.icon})}),s.jsx("div",{className:"font-bold text-base mb-1",children:a}),s.jsx("div",{className:"text-xs text-white/60",children:r.name}),s.jsx("div",{className:"absolute top-2 right-2",children:s.jsx("span",{className:"text-xs",children:""})})]},ds(r.name))})}),s.jsx("p",{className:"text-center text-xs text-white/40 mt-6",children:"Tap to unlock and play bonus round!"})]})]})}function A4({stats:t,onPlayAgain:e,onExit:n,soundOn:r=!0}){const[i,a]=f.useState([!1,!1,!1,!1]),o=t||{correctAnswers:0,totalQuestions:3,coinsEarned:0,xpEarned:0,perfectRound:!1,characterUnlocked:null,bonusCorrect:!1},l=Math.round(o.correctAnswers/o.totalQuestions*100),u=o.perfectRound;return f.useEffect(()=>{document.body.classList.add("hide-bottom-nav"),r&&us(u?"/sounds/win.mp3":"/sounds/complete.mp3",.7);const d=[setTimeout(()=>a([!0,!1,!1,!1]),200),setTimeout(()=>a([!0,!0,!1,!1]),500),setTimeout(()=>a([!0,!0,!0,!1]),800),setTimeout(()=>a([!0,!0,!0,!0]),1100)];return()=>{d.forEach(clearTimeout),document.body.classList.remove("hide-bottom-nav")}},[r,u]),s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-purple-900/20 to-gray-900 text-white relative overflow-hidden",children:[s.jsx("style",{children:`
        @keyframes float-in {
          0% { transform: translateY(50px); opacity: 0; }
          100% { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes star-rain {
          0% { transform: translateY(-70vh) rotate(0deg); }
          100% { transform: translateY(100vh) rotate(360deg); }
        }
        
        @keyframes pulse-glow {
          0%, 100% { transform: scale(1); opacity: 0.5; }
          50% { transform: scale(1.1); opacity: 1; }
        }
      `}),u&&s.jsx("div",{className:"absolute inset-0",children:[...Array(20)].map((d,h)=>s.jsx("div",{className:"absolute text-2xl",style:{left:`${Math.random()*100}%`,animation:`star-rain ${5+Math.random()*3}s linear infinite`,animationDelay:`${Math.random()*3}s`},children:["","",""][Math.floor(Math.random()*3)]},h))}),s.jsxs("div",{className:"relative z-10 max-w-md mx-auto px-5 pt-16 pb-8",children:[s.jsxs("div",{className:`text-center mb-8 transform transition-all duration-700 ${i[0]?"translate-y-0 opacity-100":"translate-y-10 opacity-0"}`,children:[s.jsx("div",{className:"text-6xl mb-4",children:u?"":l>=66?"":""}),s.jsx("h1",{className:"text-3xl font-black mb-2 bg-gradient-to-r from-yellow-400 to-orange-400 bg-clip-text text-transparent",children:u?"Perfect Game!":l>=66?"Great Job!":"Good Try!"}),s.jsx("p",{className:"text-lg text-white/70",children:"Round Complete"})]}),s.jsxs("div",{className:"space-y-4 mb-8",children:[s.jsxs("div",{className:`bg-white/10 backdrop-blur-xl rounded-2xl p-6 border border-white/20 transform transition-all duration-700 ${i[1]?"translate-y-0 opacity-100":"translate-y-10 opacity-0"}`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("span",{className:"text-white/60",children:"Score"}),s.jsxs("span",{className:"text-2xl font-bold",children:[o.correctAnswers,"/",o.totalQuestions]})]}),s.jsx("div",{className:"h-3 bg-white/20 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-green-400 to-emerald-500 transition-all duration-1000",style:{width:`${i[1]?l:0}%`}})}),s.jsxs("div",{className:"text-right text-sm text-white/60 mt-2",children:[l,"% Accuracy"]})]}),s.jsxs("div",{className:`bg-white/10 backdrop-blur-xl rounded-2xl p-6 border border-white/20 transform transition-all duration-700 ${i[2]?"translate-y-0 opacity-100":"translate-y-10 opacity-0"}`,children:[s.jsx("div",{className:"text-white/60 mb-4",children:"Rewards Earned"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl mb-2",children:""}),s.jsxs("div",{className:"text-2xl font-bold text-yellow-400",children:["+",o.coinsEarned]}),s.jsx("div",{className:"text-xs text-white/60",children:"Coins"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl mb-2",children:""}),s.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:["+",o.xpEarned]}),s.jsx("div",{className:"text-xs text-white/60",children:"XP"})]})]})]}),o.characterUnlocked&&s.jsx("div",{className:`bg-gradient-to-br from-purple-500/20 to-pink-500/20 backdrop-blur-xl rounded-2xl p-6 border border-purple-400/30 transform transition-all duration-700 ${i[2]?"translate-y-0 opacity-100":"translate-y-10 opacity-0"}`,children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-4xl mb-2",children:o.characterUnlocked.icon}),s.jsx("div",{className:"text-lg font-bold text-purple-300",children:"Character Unlocked!"}),s.jsx("div",{className:"text-sm text-white/60",children:o.characterUnlocked.name})]})})]}),s.jsxs("div",{className:`space-y-3 transform transition-all duration-700 ${i[3]?"translate-y-0 opacity-100":"translate-y-10 opacity-0"}`,children:[s.jsx("button",{onClick:e,className:"w-full py-3 rounded-2xl bg-gradient-to-r from-blue-500 to-purple-500 text-white font-bold text-lg shadow-xl hover:scale-105 active:scale-95 transition-transform -mt-4",children:"Play Again"}),s.jsx("button",{onClick:n,className:"w-full py-3 rounded-2xl bg-white/10 backdrop-blur border border-white/20 text-white font-bold text-lg hover:bg-white/20 active:scale-95 transition-all",children:"Back to Games"})]})]})]})}function R4(){const t=Ye(),e=Pt(),n=()=>{var je;const he=((je=e.state)==null?void 0:je.from)==="home";t(he?"/":"/play")},{coins:r,xp:i,level:a,ownedCharacters:o,soundOn:l,unlockCharacter:u,setSoundOn:d}=Wu(),[h,g]=f.useState("wheel"),[x,N]=f.useState({qIndex:0,progress:[!1,!1,!1],lifelines:{fifty:!1,audience:!1}}),[w,k]=f.useState([]),[I,C]=f.useState(null),[_,v]=f.useState(null),[P,D]=f.useState(30),[L,E]=f.useState([]),[m,y]=f.useState(null),[j,A]=f.useState(null),[T,S]=f.useState(!1),[G,Z]=f.useState(0),[te,K]=f.useState(!1),[$,O]=f.useState(0),[V,B]=f.useState("none"),[M,z]=f.useState(!1),[H,ne]=f.useState(null),[q,ee]=f.useState(null),[X,Q]=f.useState(!1),[oe,ue]=f.useState(null),[ae,ce]=f.useState(-1),[J,W]=f.useState(0),[F,re]=f.useState(null),[le,pe]=f.useState(null),[Ne,Pe]=f.useState(!1),[De,xt]=f.useState(null),[Be,ge]=f.useState(-1),[Te,Ie]=f.useState([!1,!1,!1]),[Me,Oe]=f.useState(!1),[yt,Vt]=f.useState(!1),[wt,Ge]=f.useState(null),ot=f.useRef(null),qt=f.useRef(null),Cn=f.useRef(null),tn=f.useRef(null),mn=f.useRef(null),Tn=f.useMemo(()=>{var he;return((he=window.matchMedia)==null?void 0:he.call(window,"(prefers-reduced-motion: reduce)").matches)||!1},[]);f.useEffect(()=>(hr(),me(),window.history.pushState({mode:"classic"},"",window.location.href),()=>Se()),[]),f.useEffect(()=>{const he=je=>{var He;je.preventDefault();const Ke=((He=e.state)==null?void 0:He.from)==="home";t(Ke?"/":"/play")};return window.addEventListener("popstate",he),()=>window.removeEventListener("popstate",he)},[t,e]),f.useEffect(()=>(h==="question"&&P>0&&!yt?Cn.current=setTimeout(()=>{D(he=>{const je=he-1;return je===10&&l&&us("/sounds/tick.mp3",.8),je})},1e3):h==="question"&&P===0&&S(!0),()=>{Cn.current&&clearTimeout(Cn.current)}),[h,P,l,yt]),f.useEffect(()=>{if(h!=="wheel"||F==null)return;ce(F),l&&us("/sounds/progress.mp3",.6),ge(F);const he=setTimeout(()=>ge(-1),900),je=setTimeout(()=>ce(-1),900),Ke=setTimeout(()=>{De&&(De==="streakFlash"?g("streakFlash"):De==="characterPicker"?g("characterPicker"):De==="summary"?g("summary"):Fe(),xt(null)),re(null)},1800);return()=>{clearTimeout(he),clearTimeout(je),clearTimeout(Ke)}},[h,F,De,l]),f.useEffect(()=>{h!=="wheel"||!Me||(W(he=>he+1),Oe(!1))},[h,Me]),f.useEffect(()=>{if(h!=="wheel"||le==null)return;const je=setTimeout(()=>{re(le),pe(null)},Ne?1800:0);return()=>clearTimeout(je)},[h,le,Ne]);const hr=async()=>{try{const je=await(await fetch("/data/quiz_questions_bank.csv")).text(),{data:Ke}=wi.parse(je,{header:!0,skipEmptyLines:!0,transformHeader:Xe=>Xe.trim().toLowerCase()}),He=Ke.map((Xe,zt)=>{var Er;const It=[Xe.option1,Xe.option2,Xe.option3,Xe.option4].map(Bn=>(Bn||"").trim()).filter(Boolean);if(It.length<4)return null;let Zn={a:0,b:1,c:2,d:3}[(Er=Xe.answer)==null?void 0:Er.toLowerCase()];return Zn===void 0&&(Zn=It.findIndex(Bn=>Bn.toLowerCase()===(Xe.answer||"").toLowerCase())),Zn===-1&&(Zn=0),{id:Xe.id||`q_${zt}`,prompt:(Xe.question||"").trim(),options:It,correctIndex:Zn,category:(Xe.category||Xe.subject||"general knowledge").trim(),difficulty:(Xe.difficulty||"medium").toLowerCase(),explanation:(Xe.explanation||"").trim()}}).filter(Boolean);k(He)}catch(he){console.error("Failed to load questions:",he),k([])}},me=()=>{const he=new Audio("/sounds/spin.mp3");he.loop=!0,he.volume=.6,tn.current=he},Se=()=>{if(Cn.current&&clearTimeout(Cn.current),mn.current&&(clearTimeout(mn.current),mn.current=null),tn.current){try{tn.current.pause()}catch{}tn.current=null}},Ue=()=>{N({qIndex:0,progress:[!1,!1,!1],lifelines:{fifty:!1,audience:!1}}),Ie([!1,!1,!1]),C(null),v(null),A(null),E([]),y(null),S(!1),W(0),Z(0),K(!1),ee(null)},Fe=()=>{n(),Ue()},nt=()=>{if(l&&tn.current){try{tn.current.currentTime=0,tn.current.play()}catch{}mn.current&&clearTimeout(mn.current),mn.current=setTimeout(()=>{ze()},2e3)}},ze=()=>{if(mn.current&&(clearTimeout(mn.current),mn.current=null),tn.current)try{tn.current.pause(),tn.current.currentTime=0}catch{}},rt=()=>{if(M)return;ne(null),Q(!1),ue(null),z(!0),nt();const he=Math.floor(Math.random()*ir.length),je=ir[he],Ke=qx($),He=he*ti+ti/2,Xe=(Math.random()-.5)*(ti*.3),zt=360-He+Xe;let It=qx(zt-Ke);const In=Jr.FULL_TURNS*360+It,Zn=$+In+Jr.OVERSHOOT;B(`transform ${Tn?1e3:Jr.DURATION}ms cubic-bezier(0.25, 0.46, 0.45, 0.94)`),O(Zn),Yu([20,50,20]),setTimeout(()=>{B(`transform ${Tn?200:Jr.SETTLE_DURATION}ms cubic-bezier(0.68, -0.55, 0.265, 1.55)`),O(Er=>Er-Jr.OVERSHOOT)},Tn?1e3:Jr.DURATION),setTimeout(()=>{ze(),z(!1),ne({cat:je,index:he}),v(je),ue(je.color),Q(!0),setTimeout(()=>{Q(!1),g("interstitial")},1500),setTimeout(()=>ue(null),1e3)},(Tn?1e3:Jr.DURATION)+(Tn?200:Jr.SETTLE_DURATION)+100)},Ze=()=>{const he=w.filter(Ke=>{const He=Ke.category.toLowerCase(),Xe=_.name.toLowerCase();return He.includes(Xe)||Xe.includes(He)});let je;he.length>0?je=he[Math.floor(Math.random()*he.length)]:je=w[Math.floor(Math.random()*w.length)],je?(C(je),D(30),E([]),y(null),S(!1),Vt(!1),g("question")):g("wheel")},ve=(he,je,Ke=!1)=>{if(!Ke){Vt(!0);return}const He=x.qIndex,Xe=[...x.progress];Xe[He]=!0;const zt=[...Te];if(zt[He]=!!he,Ie(zt),N(It=>({...It,progress:Xe,qIndex:It.qIndex+1})),he&&(Z(It=>It+5),setTimeout(()=>{var In;const It=(In=qt.current)==null?void 0:In.getBoundingClientRect();It?Ge({startRect:It,targetRef:ot,count:5,amount:5}):(ye.addCoins(5,"Classic Mode - Correct Answer"),ye.addXP(1),window.dispatchEvent(new Event("coinsUpdated")),us("/sounds/coin.mp3",.7))},100)),pe(He),Pe(!!he),He===2)if(zt.every(Boolean))xt("streakFlash");else{const In={correctAnswers:zt.filter(Boolean).length,totalQuestions:3,coinsEarned:G,xpEarned:zt.filter(Boolean).length,perfectRound:!1,characterUnlocked:null,bonusCorrect:!1};ee(In),xt("summary")}else xt(null);g("wheel")},Ee=he=>{if(!(x.lifelines[he]||!I)){if(N(je=>({...je,lifelines:{...je.lifelines,[he]:!0}})),he==="fifty"){const Ke=I.options.map((He,Xe)=>Xe).filter(He=>He!==I.correctIndex).slice(0,2);E(Ke)}else if(he==="audience"){const je=40+Math.random()*25;let Ke=100-je;const He=[0,0,0,0];He[I.correctIndex]=Math.round(je);const Xe=[0,1,2,3].filter(zt=>zt!==I.correctIndex);Xe.forEach((zt,It)=>{if(It===Xe.length-1)He[zt]=Ke;else{const In=Math.floor(Math.random()*Ke);He[zt]=In,Ke-=In}}),y(He)}}},ke=he=>{A(he),g("bonusInterstitial")},at=he=>{K(he),he&&j&&(u(j),Z(Ke=>Ke+10));const je={correctAnswers:Te.filter(Boolean).length+(he?1:0),totalQuestions:4,coinsEarned:G+(he?10:0),xpEarned:Te.filter(Boolean).length+(he?2:0),perfectRound:Te.every(Boolean),characterUnlocked:j?ir.find(Ke=>ds(Ke.name)===j):null,bonusCorrect:he};ee(je),g("summary")},st=()=>{g("wheel")};switch(h){case"wheel":return s.jsxs(s.Fragment,{children:[wt&&s.jsx(Ds,{startRect:wt.startRect,targetRef:wt.targetRef,count:wt.count,onDone:()=>{ye.addCoins(wt.amount,"Classic Mode - Correct Answer"),ye.addXP(1),window.dispatchEvent(new Event("coinsUpdated")),us("/sounds/coin.mp3",.7),Ge(null)}}),s.jsx(b4,{run:x,coins:r,xp:i,level:a,ownedCharacters:o,onSpin:rt,onBack:n,spinning:M,angle:$,transition:V,result:H,showCallout:X,glowColor:oe,soundOn:l,setSoundOn:d,showSparkle:ae,pulseIdx:Be,coinBurstTick:J,pendingProgressIdx:F,lastAnswerWasCorrect:Ne,nextProgressIdx:le,coinPillRef:ot,wheelRef:qt})]});case"interstitial":return s.jsx(Gx,{category:_,onComplete:Ze,soundOn:l});case"streakFlash":return s.jsx(T4,{onDone:()=>g("characterPicker")});case"question":return s.jsx(Qx,{question:I,category:_,onAnswer:ve,run:x,timeLeft:P,usedLifelines:x.lifelines,onUseLifeline:Ee,eliminatedOptions:L,audienceData:m,onBack:st,timeUp:T,onTimeUpBackToWheel:()=>{S(!1),g("wheel")},soundOn:l});case"characterPicker":return s.jsx(I4,{onSelect:ke});case"bonusInterstitial":return s.jsx(Gx,{category:ir.find(he=>ds(he.name)===j),onComplete:()=>g("bonusQuestion"),isBonus:!0,soundOn:l});case"bonusQuestion":if(!I){const he=ir.find(je=>ds(je.name)===j);if(he&&w.length>0){const je=w.filter(He=>{const Xe=He.category.toLowerCase(),zt=he.name.toLowerCase();return Xe.includes(zt)||zt.includes(Xe)}),Ke=je.length>0?je[Math.floor(Math.random()*je.length)]:w[Math.floor(Math.random()*w.length)];C(Ke),D(30)}return s.jsx("div",{className:"min-h-screen bg-base-bg text-base-text flex items-center justify-center",children:s.jsx("div",{className:"text-lg",children:"Loading bonus question..."})})}return s.jsx(Qx,{question:I,category:ir.find(he=>ds(he.name)===j)||ir[0],onAnswer:at,run:{...x,lifelines:{fifty:!0,audience:!0}},timeLeft:P,usedLifelines:{fifty:!0,audience:!0},onUseLifeline:()=>{},eliminatedOptions:[],audienceData:null,onBack:n,soundOn:l});case"summary":return s.jsx(A4,{stats:q,onPlayAgain:()=>{Ue(),g("wheel")},onExit:n,soundOn:l});default:return s.jsx("div",{className:"min-h-screen bg-base-bg text-white flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl mb-4",children:"Unknown State"}),s.jsx("button",{onClick:()=>g("wheel"),className:"px-6 py-3 bg-blue-600 rounded-lg",children:"Back to Wheel"})]})})}}function P4({lives:t,maxLives:e=3}){const[n,r]=f.useState(null),[i,a]=f.useState(t);return f.useEffect(()=>{t<i?(r(i-1),setTimeout(()=>r(null),600)):t>i&&(r(t-1),setTimeout(()=>r(null),1e3)),a(t)},[t,i]),s.jsxs("div",{className:"relative",children:[s.jsx("style",{jsx:!0,children:`
        @keyframes heartBeat {
          0%, 100% { transform: scale(1); }
          25% { transform: scale(1.1); }
          50% { transform: scale(0.95); }
          75% { transform: scale(1.05); }
        }
        
        @keyframes heartLost {
          0% { 
            transform: scale(1) rotate(0deg);
            opacity: 1;
          }
          100% { 
            transform: scale(0) rotate(-180deg);
            opacity: 0;
          }
        }
        
        @keyframes heartGained {
          0% { 
            transform: scale(0) rotate(180deg);
            opacity: 0;
          }
          50% {
            transform: scale(1.3) rotate(90deg);
            opacity: 1;
          }
          100% { 
            transform: scale(1) rotate(0deg);
            opacity: 1;
          }
        }
        
        @keyframes glow {
          0%, 100% { 
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.4);
          }
          50% { 
            box-shadow: 0 0 30px rgba(239, 68, 68, 0.6);
          }
        }
        
        .heart-beat {
          animation: heartBeat 1.5s ease-in-out infinite;
        }
        
        .heart-lost {
          animation: heartLost 0.6s ease-out forwards;
        }
        
        .heart-gained {
          animation: heartGained 1s ease-out;
        }
        
        .heart-glow {
          animation: glow 2s ease-in-out infinite;
        }
      `}),s.jsxs("div",{className:"flex items-center gap-3 px-5 py-1.5 bg-gradient-to-r from-red-500/20 to-pink-500/20 rounded-full backdrop-blur-md border border-white/10 shadow-xl",children:[s.jsx("div",{className:"flex items-center gap-1.5",children:[...Array(e)].map((o,l)=>s.jsx("div",{className:`relative transition-all duration-300 ${l<t?"scale-100":"scale-75"}`,children:s.jsxs("div",{className:"relative",children:[l<t?s.jsxs("div",{className:`relative ${l===n&&t>i?"heart-gained":""}`,children:[s.jsx("span",{className:`text-3xl drop-shadow-lg ${l===t-1?"heart-beat":""}`,children:""}),l===t-1&&t===1&&s.jsx("div",{className:"absolute inset-0 rounded-full heart-glow"})]}):s.jsx("div",{className:`relative ${l===n&&t<i?"heart-lost":""}`,children:s.jsx("span",{className:"text-3xl opacity-20 grayscale",children:""})}),l===n&&t>i&&s.jsxs("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:[s.jsx("div",{className:"absolute w-10 h-10 bg-green-400 rounded-full animate-ping opacity-30"}),s.jsx("span",{className:"absolute text-sm font-bold text-green-400 animate-bounce",children:"+1"})]})]})},l))}),s.jsx("div",{className:"pr-1",children:s.jsxs("div",{className:`text-sm font-bold ${t===1?"text-red-400 animate-pulse":t===e?"text-green-400":"text-white"}`,children:[t,"/",e]})})]}),t===1&&s.jsx("div",{className:"absolute -bottom-10 left-1/2 -translate-x-1/2 whitespace-nowrap",children:s.jsx("div",{className:"px-3 py-1 bg-red-500/20 border border-red-500/50 rounded-full backdrop-blur-sm",children:s.jsx("span",{className:"text-xs font-medium text-red-400 animate-pulse",children:"Last life! Be careful! "})})})]})}function D4({question:t,onAnswer:e,lives:n,questionCount:r,correctStreak:i,totalScore:a,currentDifficulty:o,timeLeft:l,showFeedback:u,lastAnswerCorrect:d,checkpoint:h,onBack:g,soundOn:x,setSoundOn:N}){const[w,k]=f.useState(null),[I,C]=f.useState(!1),[_,v]=f.useState(!1),P={EASY:{emoji:"",color:"from-emerald-400 to-green-500",accentGradient:"from-emerald-500/20 to-green-600/20",label:"Sprout",motivationalText:"Great start! Keep growing! "},MEDIUM:{emoji:"",color:"from-yellow-400 to-amber-500",accentGradient:"from-yellow-500/20 to-amber-600/20",label:"Blooming",motivationalText:"You're blooming beautifully! "},HARD:{emoji:"",color:"from-orange-400 to-red-500",accentGradient:"from-orange-500/20 to-red-600/20",label:"On Fire",motivationalText:"You're on fire! Keep it up! "},EXPERT:{emoji:"",color:"from-purple-400 to-indigo-500",accentGradient:"from-purple-500/20 to-indigo-600/20",label:"Lightning",motivationalText:"Lightning fast thinking! "},LEGENDARY:{emoji:"",color:"from-pink-400 to-purple-600",accentGradient:"from-pink-500/20 to-purple-600/20",label:"Legendary",motivationalText:"Legendary performance! "}},D=P[o];f.useEffect(()=>{i>0&&i%5===0&&u&&d&&(C(!0),setTimeout(()=>C(!1),3e3))},[i,u,d]),f.useEffect(()=>{u&&d&&(v(!0),setTimeout(()=>v(!1),1e3))},[u,d]);const L=E=>{u||(k(E),e(E))};return f.useEffect(()=>(document.body.classList.add("hide-bottom-nav"),()=>{document.body.classList.remove("hide-bottom-nav")}),[]),s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-slate-900 to-black text-white relative overflow-hidden",children:[s.jsx("style",{jsx:!0,children:`
        @keyframes float {
          0%, 100% { transform: translateY(0) rotate(0deg); }
          50% { transform: translateY(-20px) rotate(5deg); }
        }
        
        @keyframes slideInTop {
          from { transform: translateY(-100px); opacity: 0; }
          to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes scorePopup {
          0% { transform: scale(1); }
          50% { transform: scale(1.3); }
          100% { transform: scale(1); }
        }
        
        @keyframes correctAnswer {
          0% { transform: scale(1) rotate(0deg); }
          50% { transform: scale(1.1) rotate(5deg); }
          100% { transform: scale(1) rotate(0deg); }
        }
        
        @keyframes wrongAnswer {
          0%, 100% { transform: translateX(0); }
          25% { transform: translateX(-10px); }
          75% { transform: translateX(10px); }
        }
        
        @keyframes streakFlame {
          0%, 100% { 
            transform: scale(1) translateY(0);
            filter: brightness(1);
          }
          50% { 
            transform: scale(1.2) translateY(-5px);
            filter: brightness(1.3);
          }
        }

        @keyframes coinFloat {
          0% { 
            transform: translateY(0) rotate(0deg);
            opacity: 1;
          }
          100% { 
            transform: translateY(-50px) rotate(360deg);
            opacity: 0;
          }
        }
        
        .float-animation {
          animation: float 4s ease-in-out infinite;
        }
        
        .slide-in {
          animation: slideInTop 0.5s ease-out;
        }
        
        .score-pulse {
          animation: scorePopup 0.5s ease-out;
        }
        
        .correct-bounce {
          animation: correctAnswer 0.6s ease-out;
        }
        
        .wrong-shake {
          animation: wrongAnswer 0.4s ease-out;
        }
        
        .streak-flame {
          animation: streakFlame 2s ease-in-out infinite;
        }

        .coin-animation {
          animation: coinFloat 1s ease-out forwards;
        }
        
        .glass-card {
          background: rgba(255, 255, 255, 0.08);
          backdrop-filter: blur(10px);
          -webkit-backdrop-filter: blur(10px);
          border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .progress-ring {
          transform: rotate(-90deg);
          transform-origin: center;
        }
      `}),s.jsxs("div",{className:"fixed inset-0 pointer-events-none",children:[s.jsx("div",{className:"absolute top-20 left-10 text-[100px] opacity-10 float-animation",children:D.emoji}),s.jsx("div",{className:"absolute top-40 right-20 text-[80px] opacity-10 float-animation",style:{animationDelay:"1s"},children:""}),s.jsx("div",{className:"absolute bottom-40 left-20 text-[90px] opacity-10 float-animation",style:{animationDelay:"2s"},children:""}),s.jsx("div",{className:"absolute bottom-20 right-10 text-[70px] opacity-10 float-animation",style:{animationDelay:"3s"},children:""})]}),s.jsxs("div",{className:"relative z-10 px-4 pt-[calc(env(safe-area-inset-top)+2rem)]",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8 slide-in",children:[s.jsx("button",{onClick:g,className:"w-12 h-12 glass-card rounded-2xl shadow-lg flex items-center justify-center hover:scale-105 transition-transform",children:s.jsx("span",{className:"text-xl",children:""})}),s.jsx(P4,{lives:n}),s.jsx("button",{onClick:()=>N(!x),className:"w-12 h-12 glass-card rounded-2xl shadow-lg flex items-center justify-center hover:scale-105 transition-transform",children:s.jsx("span",{className:"text-xl",children:x?"":""})})]}),s.jsx("div",{className:`glass-card rounded-3xl p-2 shadow-xl mb-2 mt-12 slide-in bg-gradient-to-r ${D.accentGradient}`,style:{animationDelay:"0.1s"},children:s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:`text-3xl font-black bg-gradient-to-r ${D.color} bg-clip-text text-transparent ${_?"score-pulse":""}`,children:a}),s.jsx("div",{className:"text-xs text-white/60 font-medium mt-1",children:"Points"}),u&&d&&s.jsx("div",{className:"absolute -top-2 left-1/2 -translate-x-1/2",children:s.jsxs("span",{className:"text-green-400 font-bold text-sm coin-animation",children:["+",P[o]?o==="EASY"?10:o==="MEDIUM"?20:o==="HARD"?30:o==="EXPERT"?50:100:10]})})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-black text-white",children:r}),s.jsx("div",{className:"text-xs text-white/60 font-medium mt-1",children:"Questions"})]}),s.jsxs("div",{className:"text-center relative",children:[s.jsx("div",{className:`text-3xl font-black text-orange-400 ${i>0?"streak-flame":""}`,children:i}),s.jsx("div",{className:"text-xs text-white/60 font-medium mt-1",children:"Streak "})]})]})}),s.jsxs("div",{className:"flex justify-between items-center mb-1 slide-in",style:{animationDelay:"0.2s"},children:[s.jsx("div",{className:`px-4 py-3 rounded-full bg-gradient-to-r ${D.color} text-white shadow-lg`,children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:D.emoji}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-sm",children:D.label}),s.jsxs("div",{className:"text-[10px] opacity-90",children:["Level ",r+1]})]})]})}),s.jsx("div",{className:"relative",children:s.jsxs("div",{className:"w-20 h-20 glass-card rounded-full shadow-xl flex items-center justify-center",children:[s.jsxs("svg",{className:"absolute inset-0 w-full h-full",children:[s.jsx("circle",{cx:"40",cy:"40",r:"35",fill:"none",stroke:"rgba(255, 255, 255, 0.1)",strokeWidth:"6",className:"progress-ring"}),s.jsx("circle",{cx:"40",cy:"40",r:"35",fill:"none",stroke:l<=5?"#ef4444":l<=10?"#f59e0b":"#10b981",strokeWidth:"6",strokeDasharray:`${l/30*220} 220`,strokeLinecap:"round",className:"progress-ring transition-all duration-1000"})]}),s.jsx("div",{className:"relative z-10",children:s.jsx("span",{className:`text-2xl font-black ${l<=5?"text-red-400 animate-pulse":l<=10?"text-amber-400":"text-white"}`,children:l})})]})})]})]}),s.jsxs("div",{className:"px-4 slide-in",style:{animationDelay:"0.3s"},children:[s.jsxs("div",{className:"glass-card rounded-3xl shadow-xl p-6 mb-6 border border-white/10",children:[s.jsx("div",{className:"text-center mb-2",children:s.jsxs("span",{className:"text-xs font-bold text-white/40 uppercase tracking-wider",children:["Question ",r+1]})}),s.jsx("h2",{className:"text-xl font-bold text-center text-white leading-relaxed",children:t.prompt})]}),s.jsx("div",{className:"space-y-3",children:t.options.map((E,m)=>{const y=["A","B","C","D"],j=["from-blue-400 to-blue-500","from-green-400 to-green-500","from-yellow-400 to-yellow-500","from-purple-400 to-purple-500"];let A="glass-card border border-white/10",T="";return u&&(m===t.correctIndex?(A="bg-gradient-to-r from-green-500/20 to-emerald-500/20 border-2 border-green-400",T="correct-bounce"):w===m&&!d&&(A="bg-gradient-to-r from-red-500/20 to-pink-500/20 border-2 border-red-400",T="wrong-shake")),s.jsx("button",{onClick:()=>L(m),disabled:u,className:`w-full p-4 rounded-2xl shadow-lg transition-all ${A} ${T} 
                  ${u?"":"hover:scale-[1.02] active:scale-[0.98] hover:bg-white/10"} slide-in`,style:{animationDelay:`${.4+m*.05}s`},children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`w-12 h-12 rounded-xl bg-gradient-to-br ${j[m]} 
                    text-white font-bold text-xl flex items-center justify-center shadow-md`,children:y[m]}),s.jsx("span",{className:"flex-1 text-left font-medium text-white",children:E}),u&&m===t.correctIndex&&s.jsx("span",{className:"text-2xl",children:""}),u&&w===m&&!d&&s.jsx("span",{className:"text-2xl",children:""})]})},m)})}),u&&s.jsx("div",{className:"mt-6 text-center slide-in",children:s.jsx("p",{className:"text-sm font-medium text-white/70",children:d?D.motivationalText:"No worries! Keep trying! "})}),h>0&&s.jsx("div",{className:"mt-4 flex justify-center slide-in",style:{animationDelay:"0.6s"},children:s.jsx("div",{className:"glass-card rounded-full px-4 py-2 shadow-lg border border-white/10",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xl",children:""}),s.jsxs("span",{className:"text-sm font-bold text-white/80",children:["Checkpoint: Question ",h]})]})})})]}),I&&s.jsx("div",{className:"fixed inset-0 pointer-events-none flex items-center justify-center z-50",children:s.jsx("div",{className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-8 py-6 rounded-3xl shadow-2xl animate-bounce",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-5xl mb-3",children:""}),s.jsx("div",{className:"text-2xl font-black mb-2",children:"AMAZING STREAK!"}),s.jsx("div",{className:"text-lg",children:"You earned a life back! "})]})})})]})}function M4({score:t,questionsAnswered:e,highScore:n,checkpoint:r,onRestart:i,onContinue:a,onBack:o}){const l=t>n,[u,d]=f.useState(!1),[h,g]=f.useState(0),[x,N]=f.useState(!1),w=f.useRef(null);return f.useEffect(()=>{const C=t/60;let _=0;const v=setInterval(()=>{_+=C,_>=t?(g(t),clearInterval(v),l&&(d(!0),setTimeout(()=>d(!1),5e3))):g(Math.floor(_))},2e3/60);return setTimeout(()=>N(!0),2200),()=>clearInterval(v)},[t,l]),f.useEffect(()=>(document.body.classList.add("hide-bottom-nav"),()=>{document.body.classList.remove("hide-bottom-nav")}),[]),s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-slate-900 to-black text-white relative overflow-hidden",children:[s.jsx("style",{jsx:!0,children:`
        @keyframes slideUp {
          from { transform: translateY(100px); opacity: 0; }
          to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        
        @keyframes bounce {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-20px); }
        }
        
        @keyframes float {
          0%, 100% { transform: translateY(0) rotate(0deg); }
          50% { transform: translateY(-30px) rotate(10deg); }
        }
        
        @keyframes sparkle {
          0%, 100% { opacity: 0; transform: scale(0); }
          50% { opacity: 1; transform: scale(1); }
        }
        
        @keyframes confettiFall {
          0% { 
            transform: translateY(-100vh) rotate(0deg); 
            opacity: 1; 
          }
          100% { 
            transform: translateY(100vh) rotate(720deg); 
            opacity: 0; 
          }
        }
        
        @keyframes glow {
          0%, 100% { 
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
          }
          50% { 
            text-shadow: 0 0 40px rgba(255, 255, 255, 0.8);
          }
        }
        
        @keyframes starPop {
          0% { transform: scale(0) rotate(0deg); }
          50% { transform: scale(1.2) rotate(180deg); }
          100% { transform: scale(1) rotate(360deg); }
        }
        
        .slide-up {
          animation: slideUp 0.6s ease-out forwards;
        }
        
        .fade-in {
          animation: fadeIn 0.8s ease-out forwards;
        }
        
        .bounce-animation {
          animation: bounce 2s ease-in-out infinite;
        }
        
        .float-animation {
          animation: float 3s ease-in-out infinite;
        }
        
        .sparkle-animation {
          animation: sparkle 1.5s ease-in-out infinite;
        }
        
        .confetti-fall {
          animation: confettiFall 3s linear infinite;
        }
        
        .glow-text {
          animation: glow 2s ease-in-out infinite;
        }
        
        .star-pop {
          animation: starPop 0.6s ease-out;
        }
        
        .glass-card {
          background: rgba(255, 255, 255, 0.08);
          backdrop-filter: blur(10px);
          -webkit-backdrop-filter: blur(10px);
          border: 1px solid rgba(255, 255, 255, 0.1);
        }
      `}),s.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[s.jsx("div",{className:"absolute top-20 left-10 text-[150px] opacity-5 float-animation",children:""}),s.jsx("div",{className:"absolute bottom-20 right-10 text-[120px] opacity-5 float-animation",style:{animationDelay:"1s"},children:""}),s.jsx("div",{className:"absolute top-40 right-20 text-[100px] opacity-5 float-animation",style:{animationDelay:"2s"},children:""})]}),u&&s.jsx("div",{className:"fixed inset-0 pointer-events-none z-50",children:[...Array(40)].map((k,I)=>s.jsx("div",{className:"absolute confetti-fall",style:{left:`${Math.random()*100}%`,animationDelay:`${Math.random()*3}s`,animationDuration:`${3+Math.random()*2}s`},children:s.jsx("span",{className:"text-3xl",children:["","","","","","",""][Math.floor(Math.random()*7)]})},I))}),s.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center min-h-screen px-6 text-center",children:[s.jsxs("div",{className:"mb-8 slide-up",children:[s.jsx("h1",{className:"text-6xl font-black mb-4 bg-gradient-to-r from-red-400 to-pink-500 bg-clip-text text-transparent",children:"GAME OVER"}),l&&s.jsx("div",{className:"fade-in",style:{animationDelay:"1s"},children:s.jsx("div",{className:"inline-block px-6 py-3 rounded-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-bold shadow-2xl glow-text",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-3xl",children:""}),s.jsx("span",{className:"text-xl",children:"NEW HIGH SCORE!"}),s.jsx("span",{className:"text-3xl",children:""})]})})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8 w-full max-w-md",children:[s.jsxs("div",{className:"glass-card rounded-2xl p-6 shadow-xl slide-up",style:{animationDelay:"0.4s"},children:[s.jsx("div",{className:"text-4xl mb-2",children:""}),s.jsx("div",{ref:w,className:`text-4xl font-black ${l?"text-yellow-400":"text-white"}`,children:h}),s.jsx("div",{className:"text-sm text-white/60 font-medium",children:"Points Earned"}),s.jsx("div",{className:"mt-3 pt-3 border-t border-white/10",children:s.jsxs("div",{className:"text-xs text-white/50",children:[e," questions"]})})]}),s.jsxs("div",{className:"glass-card rounded-2xl p-6 shadow-xl slide-up",style:{animationDelay:"0.5s"},children:[s.jsx("div",{className:"text-4xl mb-2",children:""}),s.jsx("div",{className:"text-4xl font-black text-white",children:e}),s.jsx("div",{className:"text-sm text-white/60 font-medium",children:"Questions"}),s.jsx("div",{className:"mt-3 pt-3 border-t border-white/10",children:s.jsxs("div",{className:"text-xs text-white/50",children:["Best: ",Math.max(n,t)]})})]})]}),s.jsx("div",{className:"glass-card rounded-2xl px-6 py-4 mb-8 w-full max-w-md slide-up",style:{animationDelay:"0.6s"},children:s.jsx("p",{className:"text-white/80 font-medium",children:e>=50?"Incredible performance! You're a quiz master! ":e>=20?"Great job! You're getting stronger! ":"Keep practicing! Every attempt makes you better! "})}),s.jsxs("div",{className:"space-y-3 w-full max-w-md",children:[r>0&&a&&s.jsx("button",{onClick:a,className:"w-full py-4 bg-gradient-to-r from-green-400 to-emerald-500 text-white rounded-2xl font-bold text-lg shadow-xl hover:shadow-2xl transition-all hover:scale-[1.02] active:scale-[0.98] slide-up",style:{animationDelay:"0.7s"},children:s.jsxs("div",{className:"flex items-center justify-center gap-3",children:[s.jsx("span",{className:"text-2xl",children:""}),s.jsxs("span",{children:["Continue from Question ",r]})]})}),s.jsx("button",{onClick:i,className:"w-full py-4 bg-gradient-to-r from-blue-400 to-indigo-500 text-white rounded-2xl font-bold text-lg shadow-xl hover:shadow-2xl transition-all hover:scale-[1.02] active:scale-[0.98] slide-up",style:{animationDelay:"0.8s"},children:s.jsxs("div",{className:"flex items-center justify-center gap-3",children:[s.jsx("span",{className:"text-2xl",children:""}),s.jsx("span",{children:"Play Again"})]})}),s.jsx("button",{onClick:()=>{window.skipSurvivalWarning=!0,o(),setTimeout(()=>{delete window.skipSurvivalWarning},500)},className:"w-full py-4 glass-card text-white rounded-2xl font-bold text-lg shadow-lg hover:shadow-xl transition-all hover:scale-[1.02] active:scale-[0.98] hover:bg-white/10 slide-up",style:{animationDelay:"0.9s"},children:s.jsxs("div",{className:"flex items-center justify-center gap-3",children:[s.jsx("span",{className:"text-2xl",children:""}),s.jsx("span",{children:"Back to Games"})]})})]})]})]})}const Hx={EASY:{min:0,max:9,timer:30,points:10},MEDIUM:{min:10,max:24,timer:25,points:20},HARD:{min:25,max:49,timer:20,points:30},EXPERT:{min:50,max:99,timer:15,points:50},LEGENDARY:{min:100,max:1/0,timer:10,points:100}};function L4({onBack:t,isFromQuest:e}){const{coins:n,xp:r,level:i,soundOn:a,setSoundOn:o}=Wu(),[l,u]=f.useState("playing"),[d,h]=f.useState(3),[g,x]=f.useState(0),[N,w]=f.useState(0),[k,I]=f.useState(0),[C,_]=f.useState("EASY"),[v,P]=f.useState([]),[D,L]=f.useState(null),[E,m]=f.useState(30),[y,j]=f.useState(!1),[A,T]=f.useState(!1),[S,G]=f.useState(0),[Z,te]=f.useState(!1),K=f.useRef(null),$=f.useRef(new Set);f.useEffect(()=>(V(),ee(),window.history.pushState({mode:"survival"},"",window.location.href),()=>{K.current&&clearTimeout(K.current)}),[]),f.useEffect(()=>(l==="playing"&&D&&E>0&&!y&&(K.current=setTimeout(()=>{m(F=>F<=1?(ne(),0):(F===6&&a&&J("/sounds/tick.mp3",.8),F-1))},1e3)),()=>{K.current&&clearTimeout(K.current)}),[l,D,E,y,a]),f.useEffect(()=>{const F=O(g);F!==C&&(_(F),a&&J("/sounds/levelup.mp3",.6))},[g,C,a]),f.useEffect(()=>{g>0&&g%10===0&&(q(),G(g),a&&J("/sounds/checkpoint.mp3",.7))},[g,a]),f.useEffect(()=>{const F=re=>{re.preventDefault(),te(!0),window.history.pushState({mode:"survival"},"",window.location.href)};return window.addEventListener("popstate",F),()=>{window.removeEventListener("popstate",F)}},[]);const O=F=>F>=100?"LEGENDARY":F>=50?"EXPERT":F>=25?"HARD":F>=10?"MEDIUM":"EASY",V=async()=>{try{const re=await(await fetch("/data/quiz_questions_bank.csv")).text(),{data:le}=wi.parse(re,{header:!0,skipEmptyLines:!0,transformHeader:Ne=>Ne.trim().toLowerCase()}),pe=le.map((Ne,Pe)=>{var ge;const De=[Ne.option1,Ne.option2,Ne.option3,Ne.option4].map(Te=>(Te||"").trim()).filter(Boolean);if(De.length<4)return null;let Be={a:0,b:1,c:2,d:3}[(ge=Ne.answer)==null?void 0:ge.toLowerCase()];return Be===void 0&&(Be=De.findIndex(Te=>Te.toLowerCase()===(Ne.answer||"").toLowerCase())),Be===-1&&(Be=0),{id:Ne.id||`q_${Pe}`,prompt:(Ne.question||"").trim(),options:De,correctIndex:Be,category:(Ne.category||Ne.subject||"general").trim(),difficulty:(Ne.difficulty||"medium").toLowerCase()}}).filter(Boolean);P(pe),B(pe)}catch(F){console.error("Failed to load questions:",F)}},B=(F=v)=>{const re=F.filter(Pe=>!$.current.has(Pe.id));re.length===0&&($.current.clear(),re.push(...F));const le=C.toLowerCase();let pe=re.filter(Pe=>Pe.difficulty===le||Pe.difficulty==="medium");pe.length===0&&(pe=re);const Ne=pe[Math.floor(Math.random()*pe.length)];Ne&&($.current.add(Ne.id),L(Ne),m(Hx[C].timer),j(!1))},M=F=>{if(y)return;const re=F===D.correctIndex;T(re),j(!0),re?z():H(),setTimeout(()=>{(d>0||re)&&(x(le=>le+1),B())},1500)},z=()=>{const F=Hx[C].points;I(re=>re+F),w(re=>{const le=re+1;if(e){const pe=JSON.parse(localStorage.getItem("questProgress")||"{}");pe.winStreak=Math.max(pe.winStreak||0,le),pe.date=`${new Date().getFullYear()}-${new Date().getMonth()+1}-${new Date().getDate()}`,localStorage.setItem("questProgress",JSON.stringify(pe)),le>=5&&console.log("Win streak quest completed!")}return le%5===0&&d<3&&(h(pe=>Math.min(pe+1,3)),a&&J("/sounds/lifeup.mp3",.8)),le}),ye.addCoins(Math.floor(F/10),"Survival Mode - Correct Answer"),ye.addXP(1),a&&J("/sounds/correct.mp3",.7)},H=()=>{w(0),h(F=>{const re=F-1;return re<=0&&(u("gameOver"),Q()),re}),a&&J("/sounds/wrong.mp3",.7),W([200])},ne=()=>{H()},q=()=>{const F={questionCount:g,totalScore:k,lives:d,correctStreak:N,timestamp:Date.now()};localStorage.setItem("survival_checkpoint",JSON.stringify(F))},ee=()=>{const F=localStorage.getItem("survival_checkpoint");if(F)try{const re=JSON.parse(F);Date.now()-re.timestamp<864e5?(x(re.questionCount),I(re.totalScore),h(re.lives),w(re.correctStreak),G(re.questionCount)):localStorage.removeItem("survival_checkpoint")}catch(re){console.error("Failed to load checkpoint:",re)}},X=()=>{localStorage.removeItem("survival_checkpoint"),G(0)},Q=()=>{const F=parseInt(localStorage.getItem("survival_highscore")||"0");k>F&&(localStorage.setItem("survival_highscore",k.toString()),localStorage.setItem("survival_highquestions",g.toString()))},oe=()=>{u("playing"),h(3),x(0),w(0),I(0),_("EASY"),$.current.clear(),X(),B()},ue=()=>{u("playing"),B()},ae=()=>{window.skipSurvivalWarning?ce():te(!0)},ce=()=>{if(e){const F=JSON.parse(localStorage.getItem("questProgress")||"{}");F.winStreak=Math.max(F.winStreak||0,N),F.date=`${new Date().getFullYear()}-${new Date().getMonth()+1}-${new Date().getDate()}`,localStorage.setItem("questProgress",JSON.stringify(F)),window.location.href="/profile/quests"}else window.history.go(-1),t()},J=(F,re=.5)=>{try{const le=new Audio(F);le.volume=re,le.play()}catch{}},W=F=>{navigator.vibrate&&navigator.vibrate(F)};return f.useEffect(()=>(document.body.classList.add("hide-bottom-nav"),()=>{document.body.classList.remove("hide-bottom-nav")}),[]),l==="gameOver"?s.jsxs(s.Fragment,{children:[s.jsx(M4,{score:k,questionsAnswered:g,highScore:parseInt(localStorage.getItem("survival_highscore")||"0"),checkpoint:S,onRestart:oe,onContinue:S>0?ue:null,onBack:ae}),Z&&s.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 px-6",children:s.jsxs("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-3xl p-6 max-w-sm w-full shadow-2xl slide-in border border-white/10",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"text-5xl mb-3",children:""}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Leave the game?"}),s.jsx("p",{className:"text-white/70",children:"Your progress saves at checkpoints!"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>te(!1),className:"flex-1 py-3 bg-gradient-to-r from-green-400 to-emerald-500 text-white rounded-2xl font-bold shadow-lg hover:shadow-xl transition-all hover:scale-[1.02]",children:"Keep Playing"}),s.jsx("button",{onClick:ce,className:"flex-1 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-2xl font-bold shadow-lg hover:shadow-xl transition-all hover:scale-[1.02]",children:"Exit"})]})]})})]}):D?s.jsxs(s.Fragment,{children:[s.jsx(D4,{question:D,onAnswer:M,lives:d,questionCount:g,correctStreak:N,totalScore:k,currentDifficulty:C,timeLeft:E,showFeedback:y,lastAnswerCorrect:A,checkpoint:S,onBack:ae,soundOn:a,setSoundOn:o}),Z&&s.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 px-6",children:s.jsxs("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-3xl p-6 max-w-sm w-full shadow-2xl slide-in border border-white/10",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"text-5xl mb-3",children:""}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Leave the game?"}),s.jsx("p",{className:"text-white/70",children:"Your progress saves at checkpoints!"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>te(!1),className:"flex-1 py-3 bg-gradient-to-r from-green-400 to-emerald-500 text-white rounded-2xl font-bold shadow-lg hover:shadow-xl transition-all hover:scale-[1.02]",children:"Keep Playing"}),s.jsx("button",{onClick:ce,className:"flex-1 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-2xl font-bold shadow-lg hover:shadow-xl transition-all hover:scale-[1.02]",children:"Exit"})]})]})})]}):s.jsx("div",{className:"min-h-screen bg-base-bg text-white flex items-center justify-center",children:s.jsx("div",{className:"text-xl",children:"Loading questions..."})})}const ni=[{id:1,name:"Sandy Beach",emoji:"",theme:{background:"from-yellow-300 via-orange-300 to-blue-400",accent:"from-yellow-400 to-orange-400",cardBg:"from-amber-500/20 to-yellow-500/20",unlockGradient:"from-yellow-400 to-amber-500"},difficulty:"EASY",difficultyRange:{min:0,max:9},questionDifficulty:["easy"],requiredCorrect:2,timeLimit:300,rewards:{perCorrectAnswer:10,gemChance:.3,gemBonus:5,speedBonus:3,perfectBonus:50,treasurePiece:"",completionCoins:30},description:"Start your adventure on the sunny shores! Easy questions to warm up.",unlockRequirement:null,visualElements:{bgEmojis:["","","","",""],diggingEmoji:"",foundEmojis:["","",""]}},{id:2,name:"Jungle Cave",emoji:"",theme:{background:"from-green-400 via-emerald-500 to-teal-600",accent:"from-green-500 to-emerald-600",cardBg:"from-green-500/20 to-emerald-500/20",unlockGradient:"from-green-400 to-emerald-500"},difficulty:"EASY-MEDIUM",difficultyRange:{min:10,max:24},questionDifficulty:["easy","medium"],requiredCorrect:2,timeLimit:300,rewards:{perCorrectAnswer:15,gemChance:.35,gemBonus:7,speedBonus:5,perfectBonus:75,treasurePiece:"",completionCoins:50},description:"Explore the mysterious jungle caves! Watch out for tricky vines!",unlockRequirement:{island:1,treasurePiece:!0},visualElements:{bgEmojis:["","","","",""],diggingEmoji:"",foundEmojis:["","",""]}},{id:3,name:"Crystal Mountain",emoji:"",theme:{background:"from-purple-400 via-pink-400 to-indigo-500",accent:"from-purple-500 to-pink-500",cardBg:"from-purple-500/20 to-pink-500/20",unlockGradient:"from-purple-400 to-pink-500"},difficulty:"MEDIUM",difficultyRange:{min:25,max:49},questionDifficulty:["medium"],requiredCorrect:2,timeLimit:300,rewards:{perCorrectAnswer:20,gemChance:.4,gemBonus:10,speedBonus:7,perfectBonus:100,treasurePiece:"",completionCoins:75},description:"Climb the sparkling crystal peaks! Medium challenges await!",unlockRequirement:{island:2,treasurePiece:!0},visualElements:{bgEmojis:["","","","",""],diggingEmoji:"",foundEmojis:["","",""]}},{id:4,name:"Pirate Ship",emoji:"",theme:{background:"from-slate-600 via-blue-600 to-cyan-500",accent:"from-slate-700 to-blue-700",cardBg:"from-slate-500/20 to-blue-500/20",unlockGradient:"from-slate-500 to-blue-600"},difficulty:"MEDIUM-HARD",difficultyRange:{min:50,max:99},questionDifficulty:["medium","hard"],requiredCorrect:2,timeLimit:300,rewards:{perCorrectAnswer:30,gemChance:.45,gemBonus:15,speedBonus:10,perfectBonus:150,treasurePiece:"",completionCoins:100},description:"Ahoy matey! Navigate the pirate ship's challenging puzzles!",unlockRequirement:{island:3,treasurePiece:!0},visualElements:{bgEmojis:["","","","",""],diggingEmoji:"",foundEmojis:["","",""]}},{id:5,name:"Volcano Peak",emoji:"",theme:{background:"from-red-500 via-orange-500 to-yellow-500",accent:"from-red-600 to-orange-600",cardBg:"from-red-500/20 to-orange-500/20",unlockGradient:"from-red-500 to-orange-500"},difficulty:"HARD",difficultyRange:{min:100,max:1/0},questionDifficulty:["hard"],requiredCorrect:2,timeLimit:300,rewards:{perCorrectAnswer:50,gemChance:.5,gemBonus:25,speedBonus:15,perfectBonus:200,treasurePiece:"",completionCoins:150},description:"The ultimate challenge! Can you conquer the volcano?",unlockRequirement:{island:4,treasurePiece:!0},visualElements:{bgEmojis:["","","","",""],diggingEmoji:"",foundEmojis:["","",""]}}],ft={SHOVELS_PER_ISLAND:3,QUESTIONS_PER_ISLAND:3,SPEED_BONUS_THRESHOLD:5,MIN_CORRECT_FOR_TREASURE:2,FINAL_TREASURE_REWARD:200,FINAL_TREASURE_TITLE:"Treasure Master",DIGGING_ANIMATION_DURATION:1500,REWARD_DISPLAY_DURATION:2e3,TRANSITION_DURATION:500,STORAGE_KEYS:{PROGRESS:"treasureHunt_progress",STATS:"treasureHunt_stats",UNLOCKED_ISLANDS:"treasureHunt_unlocked",COMPLETED_ISLANDS:"treasureHunt_completed",TREASURE_PIECES:"treasureHunt_pieces"},SOUNDS:{DIG:"/sounds/dig.mp3",TREASURE_FOUND:"/sounds/treasure.mp3",GEM_FOUND:"/sounds/gem.mp3",WRONG:"/sounds/wrong.mp3",ISLAND_COMPLETE:"/sounds/islandcomplete.mp3",ISLAND_UNLOCK:"/sounds/unlock.mp3",FINAL_TREASURE:"/sounds/victory.mp3",TICK:"/sounds/tick.mp3",SHOVEL_BREAK:"/sounds/break.mp3"}},Ir=t=>ni.find(e=>e.id===t),O4=(t,e)=>{const n=Ir(t);if(!n.unlockRequirement)return!0;const r=e[n.unlockRequirement.island];return r&&r.treasurePiece},F4=(t,e)=>{const n={0:["Keep trying! You'll get it! ","Don't give up! Adventure awaits! ","Practice makes perfect! "],1:["Good effort! Almost there! ","Nice try! Keep going! ","You're learning fast! "],2:["Awesome! You found treasure! ","Great job, explorer! ","You're amazing! "],3:["PERFECT! You're a champion! ","INCREDIBLE! Master explorer! ","LEGENDARY performance! "]},r=n[t]||n[0];return r[Math.floor(Math.random()*r.length)]},V4=t=>ni.map(e=>{var n;return{id:e.id,piece:e.rewards.treasurePiece,collected:((n=t[e.id])==null?void 0:n.treasurePiece)||!1}});function z4({islands:t,islandProgress:e,onSelectIsland:n,onBack:r,soundOn:i,setSoundOn:a,totalStats:o}){const[l,u]=f.useState(!1),d=V4(e),h=d.filter(x=>x.collected).length,g=Math.round(h/t.length*100);return f.useEffect(()=>(document.body.style.position="fixed",document.body.style.overflow="hidden",document.body.style.width="100%",document.body.style.height="100%",()=>{document.body.style.position="",document.body.style.overflow="",document.body.style.width="",document.body.style.height=""}),[]),s.jsxs("div",{className:"fixed inset-0 bg-gradient-to-b from-sky-400 via-blue-500 to-blue-600 overflow-hidden flex flex-col",children:[s.jsx("style",{jsx:!0,children:`
        @keyframes float {
          0%, 100% { transform: translateY(0) translateX(0) rotate(0deg); }
          33% { transform: translateY(-15px) translateX(5px) rotate(3deg); }
          66% { transform: translateY(5px) translateX(-5px) rotate(-3deg); }
        }
        
        @keyframes cloudDrift {
          0% { transform: translateX(-100px); opacity: 0.3; }
          50% { opacity: 0.7; }
          100% { transform: translateX(calc(100vw + 100px)); opacity: 0.3; }
        }
        
        @keyframes sparkle {
          0%, 100% { opacity: 0; transform: scale(0) rotate(0deg); }
          50% { opacity: 1; transform: scale(1) rotate(180deg); }
        }
        
        @keyframes pulse {
          0%, 100% { transform: scale(1); filter: brightness(1); }
          50% { transform: scale(1.05); filter: brightness(1.2); }
        }
        
        @keyframes bounce {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-20px); }
        }
        
        .float-animation {
          animation: float 4s ease-in-out infinite;
        }
        
        .cloud-drift {
          animation: cloudDrift 20s linear infinite;
        }
        
        .sparkle-animation {
          animation: sparkle 2s ease-in-out infinite;
        }
        
        .pulse-animation {
          animation: pulse 2s ease-in-out infinite;
        }
        
        .bounce-animation {
          animation: bounce 2s ease-in-out infinite;
        }
        
        .glass-card {
          background: rgba(255, 255, 255, 0.15);
          backdrop-filter: blur(10px);
          -webkit-backdrop-filter: blur(10px);
          border: 1px solid rgba(255, 255, 255, 0.3);
        }
      `}),s.jsxs("div",{className:"absolute inset-0",children:[s.jsx("div",{className:"absolute top-10 cloud-drift",style:{animationDelay:"0s"},children:s.jsx("div",{className:"text-6xl opacity-40",children:""})}),s.jsx("div",{className:"absolute top-12 cloud-drift",style:{animationDelay:"7s",animationDuration:"25s"},children:s.jsx("div",{className:"text-5xl opacity-40",children:""})}),s.jsx("div",{className:"absolute top-10 right-12",children:s.jsx("div",{className:"text-6xl pulse-animation opacity-80",children:""})}),s.jsx("div",{className:"absolute top-16 left-20 float-animation opacity-60",children:s.jsx("div",{className:"text-2xl",children:""})})]}),s.jsxs("div",{className:"relative z-20 px-4 pt-[calc(env(safe-area-inset-top)+3rem)]",children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsx("button",{onClick:r,className:"w-11 h-11 glass-card rounded-2xl shadow-lg flex items-center justify-center hover:scale-105 transition-transform",children:s.jsx("span",{className:"text-xl",children:""})}),s.jsx("div",{className:"glass-card rounded-2xl px-3 py-2 shadow-lg",children:s.jsxs("div",{className:"text-white font-bold text-center",children:[s.jsx("div",{className:"text-[10px] opacity-90",children:"TREASURE HUNT"}),s.jsx("div",{className:"text-sm",children:" Island Explorer "})]})}),s.jsx("button",{onClick:()=>a(!i),className:"w-11 h-11 glass-card rounded-2xl shadow-lg flex items-center justify-center hover:scale-105 transition-transform",children:s.jsx("span",{className:"text-xl",children:i?"":""})})]}),s.jsxs("div",{className:"glass-card rounded-2xl p-3 shadow-xl mt-2",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-white font-bold text-sm",children:"Adventure Progress"}),s.jsxs("span",{className:"text-white font-bold text-sm",children:[g,"%"]})]}),s.jsx("div",{className:"w-full h-2.5 bg-white/20 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-yellow-400 to-amber-500 transition-all duration-1000",style:{width:`${g}%`}})}),s.jsx("button",{onClick:()=>u(!0),className:"mt-2.5 w-full py-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl font-bold text-sm hover:scale-[1.02] transition-transform",children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),s.jsxs("span",{children:["Treasure Pieces: ",h,"/5"]}),s.jsx("span",{children:""})]})})]})]}),s.jsx("div",{className:"flex-1 flex items-center justify-center px-4 py-4",children:s.jsxs("div",{className:"w-full max-w-md",children:[s.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.slice(0,4).map(x=>{const N=e[x.id],w=N==null?void 0:N.unlocked,k=N==null?void 0:N.treasurePiece,I=N==null?void 0:N.perfectScore;return s.jsxs("button",{onClick:()=>n(x.id),disabled:!w,className:`relative aspect-square rounded-2xl transition-all ${w?"hover:scale-105 active:scale-95 shadow-xl":"opacity-50 grayscale"}`,children:[s.jsx("div",{className:`absolute inset-0 rounded-2xl bg-gradient-to-br ${w?x.theme.background:"from-gray-400 to-gray-500"}`,children:w&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"absolute top-1 right-1 text-lg sparkle-animation",children:""}),s.jsx("div",{className:"absolute bottom-1 left-1 text-sm sparkle-animation",style:{animationDelay:"1s"},children:""})]})}),!w&&s.jsx("div",{className:"absolute inset-0 rounded-2xl bg-black/30 flex items-center justify-center",children:s.jsx("div",{className:"text-4xl",children:""})}),s.jsxs("div",{className:"relative h-full flex flex-col items-center justify-center p-3",children:[s.jsx("div",{className:"absolute top-1 left-1 w-7 h-7 bg-white/30 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white font-bold text-sm",children:x.id})}),I&&s.jsx("div",{className:"absolute top-1 right-1 text-lg",children:""}),s.jsx("div",{className:`text-5xl mb-1 ${w?"bounce-animation":""}`,children:w?x.emoji:""}),s.jsx("div",{className:"text-white font-bold text-sm text-center mb-1",children:x.name}),s.jsx("div",{className:`px-2 py-0.5 rounded-full text-[10px] font-bold ${w?"bg-white/30":"bg-black/30"} text-white`,children:x.difficulty}),k&&s.jsx("div",{className:"absolute bottom-1 text-2xl pulse-animation",children:x.rewards.treasurePiece}),(N==null?void 0:N.attempts)>0&&s.jsxs("div",{className:"absolute -bottom-1 -right-1 bg-white/90 text-gray-800 rounded-full px-2 py-0.5 text-[10px] font-bold flex items-center gap-1",children:[s.jsxs("span",{children:[N.bestScore,"/3"]}),s.jsx("span",{children:""})]})]})]},x.id)})}),s.jsx("div",{className:"flex justify-center mt-3",children:t.slice(4,5).map(x=>{const N=e[x.id],w=N==null?void 0:N.unlocked,k=N==null?void 0:N.treasurePiece,I=N==null?void 0:N.perfectScore;return s.jsxs("button",{onClick:()=>n(x.id),disabled:!w,className:`relative w-[calc(50%-6px)] aspect-square rounded-2xl transition-all ${w?"hover:scale-105 active:scale-95 shadow-xl":"opacity-50 grayscale"}`,children:[s.jsxs("div",{className:`absolute inset-0 rounded-2xl bg-gradient-to-br ${w?x.theme.background:"from-gray-400 to-gray-500"}`,children:[w&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"absolute top-1 right-1 text-lg sparkle-animation",children:""}),s.jsx("div",{className:"absolute bottom-1 left-1 text-sm sparkle-animation",style:{animationDelay:"1s"},children:""})]}),!w&&s.jsx("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-t from-yellow-400/20 to-transparent animate-pulse"})]}),!w&&s.jsx("div",{className:"absolute inset-0 rounded-2xl bg-black/30 flex items-center justify-center",children:s.jsx("div",{className:"text-4xl",children:""})}),s.jsxs("div",{className:"relative h-full flex flex-col items-center justify-center p-3",children:[s.jsx("div",{className:"absolute top-1 left-1 w-7 h-7 bg-white/30 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white font-bold text-sm",children:x.id})}),I&&s.jsx("div",{className:"absolute top-1 right-1 text-lg",children:""}),s.jsx("div",{className:`text-5xl mb-1 ${w?"bounce-animation":""}`,children:w?x.emoji:""}),s.jsx("div",{className:"text-white font-bold text-sm text-center mb-1",children:x.name}),s.jsx("div",{className:`px-2 py-0.5 rounded-full text-[10px] font-bold ${w?"bg-white/30":"bg-black/30"} text-white`,children:x.difficulty}),k&&s.jsx("div",{className:"absolute bottom-1 text-2xl pulse-animation",children:x.rewards.treasurePiece}),(N==null?void 0:N.attempts)>0&&s.jsxs("div",{className:"absolute -bottom-1 -right-1 bg-white/90 text-gray-800 rounded-full px-2 py-0.5 text-[10px] font-bold flex items-center gap-1",children:[s.jsxs("span",{children:[N.bestScore,"/3"]}),s.jsx("span",{children:""})]})]})]},x.id)})})]})}),s.jsx("div",{className:"relative z-20 px-4 pb-[calc(env(safe-area-inset-bottom)+3rem)]",children:s.jsx("div",{className:"bg-gradient-to-r from-indigo-500/30 to-purple-500/30 backdrop-blur-lg rounded-2xl shadow-xl border border-white/20",children:s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"text-2xl mb-0.5 filter drop-shadow-lg",children:""}),s.jsx("div",{className:"text-yellow-300 font-black text-lg",children:o.totalCoinsEarned}),s.jsx("div",{className:"text-white/80 text-[10px] font-medium",children:"Total Coins"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"text-2xl mb-0.5 filter drop-shadow-lg",children:""}),s.jsx("div",{className:"text-cyan-300 font-black text-lg",children:o.totalGemsFound}),s.jsx("div",{className:"text-white/80 text-[10px] font-medium",children:"Gems Found"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"text-2xl mb-0.5 filter drop-shadow-lg",children:""}),s.jsxs("div",{className:"text-green-300 font-black text-lg",children:[o.totalCorrectAnswers,"/",o.totalQuestionsAnswered]}),s.jsx("div",{className:"text-white/80 text-[10px] font-medium",children:"Correct"})]})]})})}),l&&s.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 px-6",children:s.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-pink-600 rounded-3xl p-6 max-w-sm w-full shadow-2xl",children:[s.jsx("h3",{className:"text-2xl font-bold text-white text-center mb-6",children:" Treasure Collection "}),s.jsx("div",{className:"flex justify-center gap-4 mb-6",children:d.map((x,N)=>s.jsx("div",{className:`text-5xl ${x.collected?"":"opacity-30 grayscale"}`,children:x.collected?x.piece:""},x.id))}),s.jsx("div",{className:"text-center text-white mb-6",children:h===5?s.jsxs("div",{children:[s.jsx("p",{className:"text-lg font-bold mb-2",children:" COMPLETE! "}),s.jsx("p",{className:"text-sm opacity-90",children:"You're a true Treasure Master!"})]}):s.jsx("p",{className:"text-sm opacity-90",children:"Collect all 5 pieces to unlock the final treasure!"})}),s.jsx("button",{onClick:()=>u(!1),className:"w-full py-3 bg-white/20 backdrop-blur rounded-2xl text-white font-bold hover:bg-white/30 transition-colors",children:"Close"})]})})]})}function $4({island:t,progress:e,onStart:n,onClose:r,soundOn:i}){const[a,o]=f.useState(!1);f.useEffect(()=>{o(!0)},[]),f.useEffect(()=>{const x=N=>{r()};return window.history.pushState({islandDetail:!0},"",window.location.pathname),window.addEventListener("popstate",x),()=>window.removeEventListener("popstate",x)},[r]);const l=(e==null?void 0:e.attempts)>0,u=e==null?void 0:e.treasurePiece;e==null||e.perfectScore;const d=(e==null?void 0:e.bestScore)||0,h=()=>{if(i){const x=new Audio("/sounds/start.mp3");x.volume=.5,x.play().catch(()=>{})}n()},g=x=>{const N=Math.floor(x/60),w=x%60;return`${N}:${w.toString().padStart(2,"0")}`};return s.jsxs("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-md flex items-center justify-center z-50 p-4",children:[s.jsx("style",{jsx:!0,children:`
        @keyframes slideUp {
          from { transform: translateY(100px) scale(0.9); opacity: 0; }
          to { transform: translateY(0) scale(1); opacity: 1; }
        }
        
        @keyframes pulse {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.05); }
        }
        
        .slide-up {
          animation: slideUp 0.5s ease-out forwards;
        }
        
        .pulse-animation {
          animation: pulse 2s ease-in-out infinite;
        }
      `}),s.jsxs("div",{className:`relative w-full max-w-sm bg-gradient-to-br ${t.theme.background} rounded-2xl shadow-2xl ${a?"slide-up":""}`,children:[s.jsx("div",{className:"relative p-4 pb-2",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-6xl mb-2 pulse-animation",children:t.emoji}),s.jsx("h2",{className:"text-2xl font-black text-white",children:t.name}),s.jsx("div",{className:"inline-block px-3 py-1 bg-white/20 backdrop-blur rounded-full mt-2",children:s.jsxs("span",{className:"text-white font-bold text-sm",children:["Level ",t.id,"  ",t.difficulty]})})]})}),s.jsxs("div",{className:"px-4 py-3 space-y-2",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{className:"bg-black/10 backdrop-blur rounded-xl p-3 text-center",children:[s.jsx("div",{className:"text-white/70 text-xs mb-1",children:"Time"}),s.jsx("div",{className:"text-white font-bold",children:g(t.timeLimit)})]}),s.jsxs("div",{className:"bg-black/10 backdrop-blur rounded-xl p-3 text-center",children:[s.jsx("div",{className:"text-white/70 text-xs mb-1",children:"Questions"}),s.jsx("div",{className:"text-white font-bold",children:ft.QUESTIONS_PER_ISLAND})]})]}),s.jsxs("div",{className:"bg-black/10 backdrop-blur rounded-xl p-3 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:t.rewards.treasurePiece}),s.jsx("span",{className:"text-white font-medium",children:"To Win"})]}),s.jsxs("span",{className:"text-white font-bold",children:[t.requiredCorrect,"/3 Correct"]})]}),s.jsxs("div",{className:"bg-black/10 backdrop-blur rounded-xl p-3",children:[s.jsx("div",{className:"text-white font-bold text-sm mb-2",children:"Rewards"}),s.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-xl",children:""}),s.jsx("div",{className:"text-white/70 text-xs",children:t.rewards.perCorrectAnswer})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xl",children:""}),s.jsxs("div",{className:"text-white/70 text-xs",children:[Math.round(t.rewards.gemChance*100),"%"]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xl",children:""}),s.jsxs("div",{className:"text-white/70 text-xs",children:["+",t.rewards.speedBonus]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xl",children:""}),s.jsxs("div",{className:"text-white/70 text-xs",children:["+",t.rewards.perfectBonus]})]})]})]}),l&&s.jsx("div",{className:"bg-black/10 backdrop-blur rounded-xl p-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex gap-1",children:[...Array(3)].map((x,N)=>s.jsx("span",{className:"text-lg",children:N<d?"":""},N))}),s.jsxs("div",{className:"text-white text-sm",children:[s.jsxs("span",{className:"font-bold",children:[d,"/3"]}),"  ",e.attempts," tries"]}),u&&s.jsx("div",{className:"text-2xl",children:t.rewards.treasurePiece})]})})]}),s.jsxs("div",{className:"p-4 pt-2 space-y-2",children:[s.jsx("button",{onClick:h,className:"w-full py-3 bg-gradient-to-r from-green-400 to-emerald-500 text-white rounded-xl font-black text-base shadow-lg hover:shadow-xl transition-all hover:scale-[1.02] active:scale-[0.98]",children:s.jsxs("span",{className:"flex items-center justify-center gap-2",children:[s.jsx("span",{className:"text-xl",children:""}),s.jsx("span",{children:l?"Play Again":"Start Adventure"}),s.jsx("span",{className:"text-xl",children:""})]})}),s.jsx("button",{onClick:r,className:"w-full py-2 bg-white/20 backdrop-blur text-white rounded-xl font-bold text-sm hover:bg-white/30 transition-colors",children:"Back to Map"})]})]})]})}function B4({shovelsRemaining:t,showBreak:e=!1}){const[n,r]=f.useState(!1),[i,a]=f.useState(t),o=3;return f.useEffect(()=>{t<i&&(r(!0),setTimeout(()=>r(!1),1e3)),a(t)},[t,i]),s.jsxs("div",{className:"inline-block",children:[s.jsx("style",{jsx:!0,children:`
        @keyframes shovelBreak {
          0% { 
            transform: rotate(0deg) scale(1); 
            opacity: 1; 
          }
          25% { 
            transform: rotate(-15deg) scale(1.1); 
          }
          50% { 
            transform: rotate(45deg) scale(0.9); 
            opacity: 0.8;
          }
          75% {
            transform: rotate(90deg) scale(0.7);
            opacity: 0.5;
          }
          100% { 
            transform: rotate(135deg) scale(0.5); 
            opacity: 0;
          }
        }
        
        @keyframes shake {
          0%, 100% { transform: translateX(0) rotate(0deg); }
          10% { transform: translateX(-2px) rotate(-2deg); }
          20% { transform: translateX(2px) rotate(2deg); }
          30% { transform: translateX(-2px) rotate(-2deg); }
          40% { transform: translateX(2px) rotate(2deg); }
          50% { transform: translateX(0) rotate(0deg); }
        }
        
        @keyframes pulse {
          0%, 100% { 
            transform: scale(1); 
            filter: drop-shadow(0 0 0 rgba(251, 191, 36, 0));
          }
          50% { 
            transform: scale(1.05); 
            filter: drop-shadow(0 0 10px rgba(251, 191, 36, 0.6));
          }
        }
        
        @keyframes crack {
          0% { 
            clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
          }
          100% { 
            clip-path: polygon(0 0, 45% 0, 55% 45%, 45% 100%, 0 100%);
          }
        }
        
        @keyframes fall {
          0% { 
            transform: translateY(0) rotate(0deg);
            opacity: 1;
          }
          100% { 
            transform: translateY(30px) rotate(25deg);
            opacity: 0;
          }
        }
        
        .shovel-break {
          animation: shovelBreak 0.8s ease-out forwards;
        }
        
        .shovel-shake {
          animation: shake 0.5s ease-in-out;
        }
        
        .shovel-pulse {
          animation: pulse 2s ease-in-out infinite;
        }
        
        .shovel-crack {
          position: relative;
          animation: crack 0.3s ease-out forwards;
        }
        
        .shovel-fall {
          animation: fall 0.8s ease-out forwards;
        }
        
        .glass-badge {
          background: rgba(255, 255, 255, 0.1);
          backdrop-filter: blur(10px);
          -webkit-backdrop-filter: blur(10px);
          border: 1px solid rgba(255, 255, 255, 0.2);
        }
      `}),s.jsx("div",{className:"glass-badge rounded-xl px-4 py-2 shadow-lg",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-gray-800 font-bold text-xs",children:"Shovels:"}),s.jsx("div",{className:"flex gap-2",children:[...Array(o)].map((l,u)=>{const d=u<t,h=n&&u===t;return s.jsxs("div",{className:"relative w-10 h-10 flex items-center justify-center",children:[s.jsx("div",{className:`
                    text-3xl transition-all duration-300
                    ${d?"shovel-pulse":""}
                    ${h?"shovel-break":""}
                    ${!d&&!h?"opacity-30 grayscale":""}
                  `,children:d||h?"":""}),h&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"absolute inset-0 pointer-events-none",children:s.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 40 40",children:[s.jsx("path",{d:"M20,10 L18,20 L22,30",stroke:"#ff4444",strokeWidth:"2",fill:"none",opacity:"0.8",className:"shovel-crack"}),s.jsx("path",{d:"M15,15 L20,20 L25,18",stroke:"#ff4444",strokeWidth:"1.5",fill:"none",opacity:"0.6",className:"shovel-crack",style:{animationDelay:"0.1s"}})]})}),s.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[s.jsx("span",{className:"absolute top-0 left-1/2 text-xs shovel-fall",children:""}),s.jsx("span",{className:"absolute top-1/2 left-0 text-xs shovel-fall",style:{animationDelay:"0.2s"},children:""}),s.jsx("span",{className:"absolute top-1/2 right-0 text-xs shovel-fall",style:{animationDelay:"0.3s"},children:""})]})]}),s.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2",children:s.jsx("span",{className:`text-xs font-bold ${d?"text-blue-600":"text-white/30"}`,children:u+1})})]},u)})}),t===0&&s.jsx("span",{className:"text-red-400 text-sm font-bold animate-pulse ml-2",children:"No shovels left!"}),t===1&&s.jsx("span",{className:"text-red-500 text-sm font-bold ml-2",children:"Last chance!"})]})})]})}function U4({island:t,foundGem:e,onComplete:n}){const[r,i]=f.useState("digging"),[a,o]=f.useState(!1),[l,u]=f.useState(!1);return f.useEffect(()=>{(async()=>{await new Promise(h=>setTimeout(h,800)),i("revealing"),o(!0),e&&(await new Promise(h=>setTimeout(h,400)),u(!0)),await new Promise(h=>setTimeout(h,1e3)),i("complete"),await new Promise(h=>setTimeout(h,300)),n()})()},[e,n]),s.jsxs("div",{className:"fixed inset-0 z-40 pointer-events-none flex items-center justify-center",children:[s.jsx("style",{jsx:!0,children:`
        @keyframes dig {
          0%, 100% { 
            transform: rotate(-15deg) translateY(0); 
          }
          25% { 
            transform: rotate(15deg) translateY(-20px); 
          }
          50% { 
            transform: rotate(-15deg) translateY(10px); 
          }
          75% { 
            transform: rotate(15deg) translateY(-10px); 
          }
        }
        
        @keyframes dirtFly {
          0% { 
            transform: translate(0, 0) scale(1);
            opacity: 1;
          }
          100% { 
            transform: translate(var(--fly-x), var(--fly-y)) scale(0.3);
            opacity: 0;
          }
        }
        
        @keyframes treasureReveal {
          0% { 
            transform: translateY(50px) scale(0);
            opacity: 0;
          }
          50% {
            transform: translateY(-10px) scale(1.2);
            opacity: 1;
          }
          100% { 
            transform: translateY(0) scale(1);
            opacity: 1;
          }
        }
        
        @keyframes treasureFloat {
          0%, 100% { 
            transform: translateY(0) rotate(0deg);
          }
          50% { 
            transform: translateY(-10px) rotate(5deg);
          }
        }
        
        @keyframes gemSparkle {
          0% { 
            transform: scale(0) rotate(0deg);
            opacity: 0;
          }
          50% {
            transform: scale(1.3) rotate(180deg);
            opacity: 1;
          }
          100% { 
            transform: scale(1) rotate(360deg);
            opacity: 1;
          }
        }
        
        @keyframes coinSpin {
          0% { 
            transform: rotateY(0deg) scale(1);
          }
          100% { 
            transform: rotateY(360deg) scale(1);
          }
        }
        
        @keyframes starBurst {
          0% { 
            transform: scale(0) rotate(0deg);
            opacity: 1;
          }
          100% { 
            transform: scale(2) rotate(180deg);
            opacity: 0;
          }
        }
        
        @keyframes radiateGlow {
          0%, 100% { 
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
          }
          50% { 
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.9);
          }
        }
        
        .dig-animation {
          animation: dig 0.3s ease-in-out infinite;
        }
        
        .dirt-particle {
          position: absolute;
          animation: dirtFly 0.8s ease-out forwards;
        }
        
        .treasure-reveal {
          animation: treasureReveal 0.8s ease-out forwards;
        }
        
        .treasure-float {
          animation: treasureFloat 2s ease-in-out infinite;
        }
        
        .gem-sparkle {
          animation: gemSparkle 0.6s ease-out forwards;
        }
        
        .coin-spin {
          animation: coinSpin 2s linear infinite;
        }
        
        .star-burst {
          animation: starBurst 1s ease-out forwards;
        }
        
        .glow-effect {
          animation: radiateGlow 1.5s ease-in-out infinite;
        }
      `}),r==="digging"&&s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"text-8xl dig-animation",children:t.visualElements.diggingEmoji}),[...Array(8)].map((d,h)=>s.jsx("div",{className:"dirt-particle text-4xl",style:{"--fly-x":`${(Math.random()-.5)*200}px`,"--fly-y":`${-Math.random()*150-50}px`,left:"50%",top:"60%",animationDelay:`${h*.1}s`},children:""},h)),s.jsx("div",{className:"absolute -bottom-4 left-1/2 -translate-x-1/2",children:s.jsx("div",{className:"text-6xl opacity-50",children:""})})]}),r==="revealing"&&s.jsxs("div",{className:"relative",children:[a&&s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"w-32 h-32 rounded-full bg-yellow-400/30 blur-xl glow-effect"})}),s.jsxs("div",{className:"relative flex items-center justify-center",children:[s.jsx("div",{className:"text-7xl treasure-reveal treasure-float",children:""}),s.jsx("div",{className:"absolute text-5xl coin-spin",style:{left:"-30px"},children:""}),s.jsx("div",{className:"absolute text-5xl coin-spin",style:{right:"-30px",animationDelay:"0.5s"},children:""}),s.jsx("div",{className:"absolute text-4xl coin-spin",style:{top:"-30px",animationDelay:"1s"},children:""})]}),[...Array(6)].map((d,h)=>s.jsx("div",{className:"absolute text-3xl star-burst",style:{left:"50%",top:"50%",transform:`translate(-50%, -50%) rotate(${h*60}deg) translateY(-40px)`,animationDelay:`${h*.1}s`},children:""},h))]}),l&&s.jsxs("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"text-6xl gem-sparkle",children:""}),s.jsx("div",{className:"absolute -top-2 -left-2 text-2xl animate-pulse",children:""}),s.jsx("div",{className:"absolute -top-2 -right-2 text-2xl animate-pulse",style:{animationDelay:"0.3s"},children:""}),s.jsx("div",{className:"absolute -bottom-2 left-1/2 -translate-x-1/2 text-2xl animate-pulse",style:{animationDelay:"0.6s"},children:""})]}),s.jsx("div",{className:"absolute -bottom-8 left-1/2 -translate-x-1/2 whitespace-nowrap",children:s.jsx("span",{className:"text-cyan-300 font-black text-lg drop-shadow-lg",children:"RARE GEM!"})})]}),s.jsx("div",{className:"absolute -bottom-16 left-1/2 -translate-x-1/2 text-center",children:s.jsx("div",{className:"text-white font-black text-2xl drop-shadow-lg",children:e?"AMAZING FIND!":"TREASURE FOUND!"})})]}),r==="complete"&&s.jsx("div",{className:"relative opacity-0 transition-opacity duration-300",children:s.jsx("div",{className:"text-7xl",children:""})})]})}function q4({island:t,question:e,questionNumber:n,totalQuestions:r,shovelsRemaining:i,timeRemaining:a,coinsEarned:o,gemsFound:l,onAnswer:u,onQuit:d,soundOn:h,setSoundOn:g}){const[x,N]=f.useState(null),[w,k]=f.useState(!1),[I,C]=f.useState(!1),[_,v]=f.useState(!1),[P,D]=f.useState(!1),[L,E]=f.useState(!1),[m,y]=f.useState(!1),j=f.useRef(null);f.useEffect(()=>{N(null),k(!1),C(!1),v(!1),D(!1),y(!1)},[e]),f.useEffect(()=>{const Z=te=>{te.stopImmediatePropagation(),L||(E(!0),window.history.pushState({questionScreen:!0},"",window.location.pathname))};return window.history.pushState({questionScreen:!0},"",window.location.pathname),window.addEventListener("popstate",Z,!0),()=>window.removeEventListener("popstate",Z,!0)},[L]);const A=Z=>{const te=Math.floor(Z/60),K=Z%60;return`${te}:${K.toString().padStart(2,"0")}`},T=()=>a<=10?"critical":a<=30?"warning":"normal",S=Z=>{if(m||w)return;N(Z),y(!0);const te=Z===e.correctIndex;C(te),setTimeout(()=>{if(k(!0),h)if(te){const K=new Audio("/sounds/dig.mp3");K.volume=.5,K.play().catch(()=>{})}else{const K=new Audio("/sounds/wrong.mp3");K.volume=.5,K.play().catch(()=>{})}te&&(v(!0),Math.random()<t.rewards.gemChance&&setTimeout(()=>{if(D(!0),h){const $=new Audio("/sounds/gem.mp3");$.volume=.6,$.play().catch(()=>{})}},800)),setTimeout(()=>{u(Z)},te?2e3:1500)},300)},G=T();return s.jsxs("div",{className:`min-h-screen bg-gradient-to-br ${t.theme.background} relative overflow-hidden`,children:[s.jsx("style",{jsx:!0,children:`
        @keyframes shake {
          0%, 100% { transform: translateX(0); }
          25% { transform: translateX(-10px); }
          75% { transform: translateX(10px); }
        }
        
        @keyframes pulse {
          0%, 100% { transform: scale(1); filter: brightness(1); }
          50% { transform: scale(1.1); filter: brightness(1.2); }
        }
        
        @keyframes float {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-10px); }
        }
        
        @keyframes slideIn {
          from { transform: translateX(-100%); opacity: 0; }
          to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes correctPulse {
          0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
          50% { transform: scale(1.05); box-shadow: 0 0 20px 10px rgba(34, 197, 94, 0); }
          100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
        }
        
        @keyframes wrongShake {
          0%, 100% { transform: translateX(0); }
          10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
          20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        @keyframes coinFloat {
          0% { transform: translateY(0) rotate(0deg); opacity: 1; }
          100% { transform: translateY(-50px) rotate(360deg); opacity: 0; }
        }
        
        @keyframes gemSparkle {
          0%, 100% { transform: scale(1) rotate(0deg); filter: brightness(1); }
          50% { transform: scale(1.3) rotate(180deg); filter: brightness(1.5); }
        }
        
        @keyframes timePulse {
          0%, 100% { transform: scale(1); color: inherit; }
          50% { transform: scale(1.1); color: #ef4444; }
        }
        
        .shake-animation {
          animation: shake 0.5s ease-in-out;
        }
        
        .pulse-animation {
          animation: pulse 2s ease-in-out infinite;
        }
        
        .float-animation {
          animation: float 3s ease-in-out infinite;
        }
        
        .slide-in {
          animation: slideIn 0.5s ease-out;
        }
        
        .correct-pulse {
          animation: correctPulse 1s ease-out;
        }
        
        .wrong-shake {
          animation: wrongShake 0.5s ease-out;
        }
        
        .coin-float {
          animation: coinFloat 1s ease-out forwards;
        }
        
        .gem-sparkle {
          animation: gemSparkle 1s ease-in-out;
        }
        
        .time-pulse-critical {
          animation: timePulse 1s ease-in-out infinite;
        }
        
        .glass-card {
          background: rgba(255, 255, 255, 0.15);
          backdrop-filter: blur(10px);
          -webkit-backdrop-filter: blur(10px);
          border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .option-card {
          transition: all 0.3s ease;
          cursor: pointer;
        }
        
        .option-card:not(.disabled):hover {
          transform: translateY(-2px);
          box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .option-card.disabled {
          cursor: not-allowed;
          opacity: 0.7;
        }
        
        .progress-bar {
          transition: width 0.3s ease;
        }
      `}),s.jsx("div",{className:"absolute inset-0 pointer-events-none",children:t.visualElements.bgEmojis.map((Z,te)=>s.jsx("div",{className:"absolute text-7xl opacity-10 float-animation",style:{top:`${20+te*15}%`,left:`${10+te*18}%`,animationDelay:`${te*.5}s`,animationDuration:`${3+te}s`},children:Z},te))}),s.jsxs("div",{className:"relative z-10 px-3 pt-[calc(env(safe-area-inset-top)+4rem)]",children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsx("button",{onClick:()=>E(!0),className:"w-10 h-10 glass-card rounded-xl shadow-lg flex items-center justify-center hover:scale-105 transition-transform",children:s.jsx("span",{className:"text-xl",children:""})}),s.jsx("div",{className:"glass-card rounded-xl px-3 py-1.5 shadow-lg",children:s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("span",{className:"text-xl",children:t.emoji}),s.jsx("span",{className:"text-gray-800 font-bold text-sm",children:t.name})]})}),s.jsx("button",{onClick:()=>g(!h),className:"w-10 h-10 glass-card rounded-xl shadow-lg flex items-center justify-center hover:scale-105 transition-transform",children:s.jsx("span",{className:"text-xl",children:h?"":""})})]}),s.jsxs("div",{className:"glass-card rounded-xl p-3 shadow-xl mb-3",children:[s.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:`text-xl font-black ${G==="critical"?"text-red-600 time-pulse-critical":G==="warning"?"text-orange-600":"text-gray-800"}`,children:A(a)}),s.jsx("div",{className:"text-[10px] text-gray-700 font-medium",children:"Time"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-xl font-black text-gray-800",children:[n,"/",r]}),s.jsx("div",{className:"text-[10px] text-gray-700 font-medium",children:"Question"})]}),s.jsxs("div",{className:"text-center relative",children:[s.jsx("div",{className:"text-xl font-black text-orange-600",children:o}),s.jsx("div",{className:"text-[10px] text-gray-700 font-medium",children:"Coins"}),w&&I&&s.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:s.jsxs("span",{className:"text-orange-600 font-bold text-xs coin-float",children:["+",t.rewards.perCorrectAnswer]})})]}),s.jsxs("div",{className:"text-center relative",children:[s.jsx("div",{className:"text-xl font-black text-blue-600",children:l}),s.jsx("div",{className:"text-[10px] text-gray-700 font-medium",children:"Gems"}),P&&s.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:s.jsx("span",{className:"text-blue-600 text-xl gem-sparkle",children:""})})]})]}),s.jsx("div",{className:"mt-2",children:s.jsx("div",{className:"w-full h-1.5 bg-gray-800/20 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-green-500 to-emerald-600 progress-bar",style:{width:`${(n-1)/r*100}%`}})})})]}),s.jsx("div",{className:"flex justify-center mb-3 pt-2",children:s.jsx(B4,{shovelsRemaining:i,showBreak:w&&!I})})]}),s.jsxs("div",{className:"px-3 pt-8 slide-in",children:[s.jsxs("div",{ref:j,className:`glass-card rounded-2xl shadow-xl p-4 mb-4 ${w&&!I?"wrong-shake":""}`,children:[s.jsx("div",{className:"text-center mb-2",children:s.jsxs("span",{className:"text-xs font-bold text-gray-600 uppercase tracking-wider",children:["Question ",n]})}),s.jsx("h2",{className:"text-lg font-bold text-center text-gray-800 leading-relaxed",children:e.prompt})]}),s.jsx("div",{className:"space-y-2.5",children:e.options.map((Z,te)=>{const K=["A","B","C","D"],$=x===te,O=te===e.correctIndex;let V="glass-card option-card",B="border border-gray-800/20";return w&&(O?(V+=" correct-pulse",B="border-2 border-green-500 bg-green-400/20"):$&&!I&&(V+=" wrong-shake",B="border-2 border-red-500 bg-red-400/20"),V+=" disabled"),s.jsx("button",{onClick:()=>S(te),disabled:m,className:`w-full p-3 rounded-xl shadow-lg ${V} ${B}`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-10 h-10 rounded-lg bg-gradient-to-br ${te===0?"from-blue-400 to-blue-500":te===1?"from-green-400 to-green-500":te===2?"from-yellow-400 to-yellow-500":"from-purple-400 to-purple-500"} text-white font-bold text-lg flex items-center justify-center shadow-md`,children:K[te]}),s.jsx("span",{className:"flex-1 text-left font-medium text-gray-800 text-sm",children:Z}),w&&O&&s.jsx("span",{className:"text-2xl",children:""}),w&&$&&!I&&s.jsx("span",{className:"text-2xl",children:""})]})},te)})}),w&&s.jsx("div",{className:"mt-3 text-center slide-in",children:s.jsx("p",{className:"text-base font-bold text-gray-800",children:I?`Great job! Let's dig for treasure! ${t.visualElements.diggingEmoji}`:"Oops! Your shovel broke! Try the next question! "})})]}),_&&s.jsx(U4,{island:t,foundGem:P,onComplete:()=>v(!1)}),L&&s.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 px-6",children:s.jsxs("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-3xl p-6 max-w-sm w-full shadow-2xl slide-in border border-white/10",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"text-5xl mb-3",children:""}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Leave the Island?"}),s.jsx("p",{className:"text-white/70",children:"Your progress won't be saved!"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>E(!1),className:"flex-1 py-3 bg-gradient-to-r from-green-400 to-emerald-500 text-white rounded-2xl font-bold shadow-lg hover:shadow-xl transition-all hover:scale-[1.02]",children:"Keep Playing"}),s.jsx("button",{onClick:d,className:"flex-1 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-2xl font-bold shadow-lg hover:shadow-xl transition-all hover:scale-[1.02]",children:"Leave Island"})]})]})})]})}function Q4({island:t,session:e,earnedTreasure:n,onRetry:r,onContinue:i,soundOn:a}){const[o,l]=f.useState(0),[u,d]=f.useState(!1),[h,g]=f.useState(!1),x=e.correctAnswers===ft.QUESTIONS_PER_ISLAND,N=F4(e.correctAnswers,t.id);return f.useEffect(()=>{const w=e.coinsEarned,k=2e3,I=30,C=w/I;let _=0;const v=setInterval(()=>{_+=C,_>=w?(l(w),clearInterval(v),n&&setTimeout(()=>d(!0),500),setTimeout(()=>g(!0),n?1500:500)):l(Math.floor(_))},k/I);return()=>clearInterval(v)},[e.coinsEarned,n]),s.jsxs("div",{className:`fixed inset-0 bg-gradient-to-br ${t.theme.background} overflow-hidden flex flex-col`,children:[s.jsx("style",{jsx:!0,children:`
        @keyframes slideUp {
          from { transform: translateY(100px); opacity: 0; }
          to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes bounce {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-20px); }
        }
        
        @keyframes treasureShine {
          0% { transform: scale(0) rotate(0deg); opacity: 0; }
          50% { transform: scale(1.2) rotate(180deg); opacity: 1; }
          100% { transform: scale(1) rotate(360deg); opacity: 1; }
        }
        
        @keyframes starPop {
          0% { transform: scale(0) rotate(0deg); }
          50% { transform: scale(1.3) rotate(180deg); }
          100% { transform: scale(1) rotate(360deg); }
        }
        
        @keyframes float {
          0%, 100% { transform: translateY(0) rotate(0deg); }
          50% { transform: translateY(-15px) rotate(5deg); }
        }
        
        @keyframes confetti {
          0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
          100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        
        @keyframes pulse {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.05); }
        }
        
        .slide-up {
          animation: slideUp 0.6s ease-out forwards;
        }
        
        .bounce-animation {
          animation: bounce 2s ease-in-out infinite;
        }
        
        .treasure-shine {
          animation: treasureShine 1s ease-out forwards;
        }
        
        .star-pop {
          animation: starPop 0.5s ease-out forwards;
        }
        
        .float-animation {
          animation: float 3s ease-in-out infinite;
        }
        
        .confetti-fall {
          animation: confetti 3s linear infinite;
        }
        
        .pulse-animation {
          animation: pulse 2s ease-in-out infinite;
        }
        
        .glass-card {
          background: rgba(255, 255, 255, 0.15);
          backdrop-filter: blur(10px);
          -webkit-backdrop-filter: blur(10px);
          border: 1px solid rgba(255, 255, 255, 0.3);
        }
      `}),s.jsx("div",{className:"absolute inset-0 pointer-events-none",children:x&&[...Array(10)].map((w,k)=>s.jsx("div",{className:"absolute confetti-fall",style:{left:`${Math.random()*100}%`,animationDelay:`${Math.random()*3}s`,fontSize:`${20+Math.random()*20}px`},children:["","","",""][Math.floor(Math.random()*4)]},k))}),s.jsxs("div",{className:"relative z-10 flex-1 flex flex-col items-center justify-center px-4 py-4",children:[s.jsxs("div",{className:"mb-3 text-center slide-up",children:[s.jsx("h1",{className:"text-2xl font-black text-white mb-2",children:n?"TREASURE FOUND!":"ISLAND COMPLETE!"}),s.jsx("div",{className:"text-5xl bounce-animation",children:n?t.rewards.treasurePiece:""})]}),s.jsxs("div",{className:"glass-card rounded-2xl p-3 max-w-md w-full mb-2 slide-up",style:{animationDelay:"0.2s",background:"rgba(46, 46, 32, 0.25)"},children:[s.jsxs("div",{className:"text-center mb-2",children:[s.jsxs("div",{className:"text-3xl font-black text-white mb-1",children:[e.correctAnswers,"/",ft.QUESTIONS_PER_ISLAND]}),s.jsx("div",{className:"text-white/80 font-medium",children:"Questions Correct"})]}),h&&s.jsx("div",{className:"flex justify-center gap-2 mb-2",children:[...Array(3)].map((w,k)=>s.jsx("div",{className:`text-3xl ${k<e.correctAnswers?"star-pop":""}`,style:{animationDelay:`${k*.2}s`},children:k<e.correctAnswers?"":""},k))}),u&&n&&s.jsxs("div",{className:"text-center mb-2",children:[s.jsx("div",{className:"text-5xl treasure-shine mb-1",children:t.rewards.treasurePiece}),s.jsx("div",{className:"text-white font-bold text-lg",children:"Treasure Piece Earned!"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[s.jsxs("div",{className:"glass-card rounded-2xl p-4 text-center",children:[s.jsx("div",{className:"text-4xl mb-1",children:""}),s.jsx("div",{className:"text-3xl font-black text-yellow-300",children:o}),s.jsx("div",{className:"text-white/70 text-sm",children:"Coins Earned"})]}),s.jsxs("div",{className:"glass-card rounded-2xl p-4 text-center",children:[s.jsx("div",{className:"text-4xl mb-2",children:""}),s.jsx("div",{className:"text-3xl font-black text-cyan-300",children:e.gemsFound}),s.jsx("div",{className:"text-white/70 text-sm",children:"Gems Found"})]})]}),s.jsx("div",{className:"text-center p-4 bg-white/10 rounded-1xl",children:s.jsx("p",{className:"text-white font-medium text-lg",children:N})}),x&&s.jsx("div",{className:"mt-4 text-center",children:s.jsx("div",{className:"inline-block px-6 py-3 bg-gradient-to-r from-yellow-400 to-amber-500 rounded-full",children:s.jsx("span",{className:"text-white font-black text-lg",children:" PERFECT SCORE! "})})})]}),s.jsxs("div",{className:"space-y-3 w-full max-w-md slide-up",style:{animationDelay:"0.4s"},children:[!n&&s.jsx("button",{onClick:r,className:"w-full py-4 bg-gradient-to-r from-orange-400 to-red-500 text-white rounded-2xl font-black text-lg shadow-xl hover:shadow-2xl transition-all hover:scale-[1.02] active:scale-[0.98]",children:s.jsxs("div",{className:"flex items-center justify-center gap-3",children:[s.jsx("span",{className:"text-2xl",children:""}),s.jsx("span",{children:"Try Again"})]})}),s.jsx("button",{onClick:i,className:"w-full py-3 bg-gradient-to-r from-white to-gray-100 text-gray-800 rounded-2xl font-black text-lg shadow-xl hover:shadow-2xl transition-all hover:scale-[1.02] active:scale-[0.98]",children:s.jsxs("div",{className:"flex items-center justify-center gap-3",children:[s.jsx("span",{className:"text-2xl",children:""}),s.jsx("span",{children:"Back to Map"})]})})]})]})]})}function G4({totalStats:t,onContinue:e,soundOn:n}){const[r,i]=f.useState(!1),[a,o]=f.useState(!1),[l,u]=f.useState(!1),[d,h]=f.useState(!1),[g,x]=f.useState(!1);return f.useEffect(()=>{(async()=>{await new Promise(w=>setTimeout(w,500)),i(!0),await new Promise(w=>setTimeout(w,1e3)),o(!0),x(!0),await new Promise(w=>setTimeout(w,800)),u(!0),await new Promise(w=>setTimeout(w,1e3)),h(!0)})()},[]),s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-600 via-pink-600 to-yellow-500 relative overflow-hidden",children:[s.jsx("style",{jsx:!0,children:`
        @keyframes chestAppear {
          0% { transform: scale(0) rotate(0deg); opacity: 0; }
          50% { transform: scale(1.2) rotate(10deg); opacity: 1; }
          100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
        
        @keyframes chestOpen {
          0% { transform: rotateX(0deg); }
          100% { transform: rotateX(-25deg); }
        }
        
        @keyframes treasureGlow {
          0%, 100% { 
            filter: brightness(1) drop-shadow(0 0 30px rgba(255, 215, 0, 0.8)); 
          }
          50% { 
            filter: brightness(1.5) drop-shadow(0 0 50px rgba(255, 215, 0, 1)); 
          }
        }
        
        @keyframes float {
          0%, 100% { transform: translateY(0) rotate(0deg); }
          50% { transform: translateY(-20px) rotate(5deg); }
        }
        
        @keyframes coinRain {
          0% { 
            transform: translateY(-100vh) rotate(0deg); 
            opacity: 1; 
          }
          100% { 
            transform: translateY(100vh) rotate(720deg); 
            opacity: 0; 
          }
        }
        
        @keyframes firework {
          0% { 
            transform: scale(0) rotate(0deg); 
            opacity: 1; 
          }
          50% {
            transform: scale(1) rotate(180deg);
            opacity: 1;
          }
          100% { 
            transform: scale(1.5) rotate(360deg); 
            opacity: 0; 
          }
        }
        
        @keyframes titleShine {
          0% { background-position: -200% center; }
          100% { background-position: 200% center; }
        }
        
        @keyframes bounce {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-30px); }
        }
        
        @keyframes sparkle {
          0%, 100% { opacity: 0; transform: scale(0); }
          50% { opacity: 1; transform: scale(1); }
        }
        
        .chest-appear {
          animation: chestAppear 1s ease-out forwards;
        }
        
        .chest-open {
          animation: chestOpen 0.8s ease-out forwards;
          transform-origin: bottom center;
        }
        
        .treasure-glow {
          animation: treasureGlow 2s ease-in-out infinite;
        }
        
        .float-animation {
          animation: float 3s ease-in-out infinite;
        }
        
        .coin-rain {
          animation: coinRain 3s linear infinite;
        }
        
        .firework {
          animation: firework 1.5s ease-out forwards;
        }
        
        .title-shine {
          background: linear-gradient(90deg, 
            #fbbf24, 
            #fff, 
            #fbbf24
          );
          background-size: 200% 100%;
          animation: titleShine 3s linear infinite;
          -webkit-background-clip: text;
          background-clip: text;
        }
        
        .bounce-animation {
          animation: bounce 2s ease-in-out infinite;
        }
        
        .sparkle-animation {
          animation: sparkle 1.5s ease-in-out infinite;
        }
        
        .glass-card {
          background: rgba(255, 255, 255, 0.2);
          backdrop-filter: blur(10px);
          -webkit-backdrop-filter: blur(10px);
          border: 1px solid rgba(255, 255, 255, 0.3);
        }
      `}),g&&s.jsx("div",{className:"fixed inset-0 pointer-events-none",children:[...Array(15)].map((N,w)=>s.jsx("div",{className:"absolute firework",style:{left:`${20+Math.random()*60}%`,top:`${20+Math.random()*60}%`,animationDelay:`${Math.random()*2}s`,fontSize:`${40+Math.random()*40}px`},children:["","","",""][Math.floor(Math.random()*4)]},w))}),s.jsx("div",{className:"fixed inset-0 pointer-events-none",children:[...Array(20)].map((N,w)=>s.jsx("div",{className:"absolute coin-rain",style:{left:`${Math.random()*100}%`,animationDelay:`${Math.random()*3}s`,animationDuration:`${3+Math.random()*2}s`,fontSize:`${20+Math.random()*20}px`},children:["","",""][Math.floor(Math.random()*3)]},w))}),s.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center min-h-screen px-6",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-6xl font-black text-white mb-4",children:"LEGENDARY!"}),s.jsx("div",{className:"text-8xl bounce-animation",children:""})]}),r&&s.jsxs("div",{className:`relative mb-8 ${r?"chest-appear":""}`,children:[s.jsx("div",{className:`text-[150px] ${a?"chest-open":""}`,children:""}),a&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:ni.map((N,w)=>s.jsx("div",{className:"absolute text-6xl float-animation treasure-glow",style:{transform:`rotate(${w*72}deg) translateY(-100px)`,animationDelay:`${w*.2}s`},children:N.rewards.treasurePiece},N.id))})]}),l&&s.jsxs("div",{className:"glass-card rounded-3xl p-6 max-w-md w-full mb-6",children:[s.jsx("h2",{className:"text-2xl font-black text-white text-center mb-6",children:" FINAL TREASURE UNLOCKED! "}),s.jsx("div",{className:"bg-gradient-to-r from-yellow-400 to-amber-500 rounded-2xl p-4 mb-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-5xl mb-2",children:""}),s.jsx("div",{className:"text-4xl font-black text-white",children:ft.FINAL_TREASURE_REWARD}),s.jsx("div",{className:"text-white/90 font-medium",children:"Bonus Coins!"})]})}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[s.jsxs("div",{className:"glass-card rounded-xl p-3 text-center",children:[s.jsx("div",{className:"text-3xl mb-1",children:""}),s.jsx("div",{className:"text-2xl font-black text-white",children:"5/5"}),s.jsx("div",{className:"text-white/70 text-xs",children:"Islands"})]}),s.jsxs("div",{className:"glass-card rounded-xl p-3 text-center",children:[s.jsx("div",{className:"text-3xl mb-1",children:""}),s.jsx("div",{className:"text-2xl font-black text-white",children:"5/5"}),s.jsx("div",{className:"text-white/70 text-xs",children:"Treasures"})]}),s.jsxs("div",{className:"glass-card rounded-xl p-3 text-center",children:[s.jsx("div",{className:"text-3xl mb-1",children:""}),s.jsx("div",{className:"text-2xl font-black text-yellow-300",children:t.totalCoinsEarned+ft.FINAL_TREASURE_REWARD}),s.jsx("div",{className:"text-white/70 text-xs",children:"Total Coins"})]}),s.jsxs("div",{className:"glass-card rounded-xl p-3 text-center",children:[s.jsx("div",{className:"text-3xl mb-1",children:""}),s.jsx("div",{className:"text-2xl font-black text-cyan-300",children:t.totalGemsFound}),s.jsx("div",{className:"text-white/70 text-xs",children:"Total Gems"})]})]}),d&&s.jsxs("div",{className:"text-center p-4 bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl",children:[s.jsx("div",{className:"text-3xl mb-2",children:""}),s.jsx("div",{className:"text-xl font-black text-white title-shine",children:ft.FINAL_TREASURE_TITLE}),s.jsx("div",{className:"text-white/90 text-sm mt-1",children:"New Title Unlocked!"})]})]}),l&&s.jsx("button",{onClick:e,className:"w-full max-w-md py-4 bg-gradient-to-r from-white to-gray-100 text-gray-800 rounded-2xl font-black text-lg shadow-xl hover:shadow-2xl transition-all hover:scale-[1.02] active:scale-[0.98]",children:s.jsxs("div",{className:"flex items-center justify-center gap-3",children:[s.jsx("span",{className:"text-2xl",children:""}),s.jsx("span",{children:"Complete Adventure"}),s.jsx("span",{className:"text-2xl",children:""})]})}),s.jsx("div",{className:"absolute inset-0 pointer-events-none",children:[...Array(10)].map((N,w)=>s.jsx("div",{className:"absolute text-2xl sparkle-animation",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`},children:""},w))})]})]})}function H4({onBack:t}){const{coins:e,xp:n,level:r,soundOn:i,setSoundOn:a}=Wu(),[o,l]=f.useState(!1),[u,d]=f.useState("map"),[h,g]=f.useState(null),[x,N]=f.useState([]),[w,k]=f.useState(()=>{const V=localStorage.getItem(ft.STORAGE_KEYS.PROGRESS);if(V)try{return JSON.parse(V)}catch(B){console.error("Failed to load progress:",B)}return ni.reduce((B,M)=>(B[M.id]={unlocked:M.id===1,completed:!1,treasurePiece:!1,perfectScore:!1,bestScore:0,attempts:0},B),{})}),[I,C]=f.useState({islandId:null,questions:[],currentQuestionIndex:0,shovelsRemaining:ft.SHOVELS_PER_ISLAND,correctAnswers:0,wrongAnswers:0,timeRemaining:300,gemsFound:0,coinsEarned:0,questionTimes:[],startTime:null}),[_,v]=f.useState(()=>{const V=localStorage.getItem(ft.STORAGE_KEYS.STATS);if(V)try{return JSON.parse(V)}catch(B){console.error("Failed to load stats:",B)}return{totalCoinsEarned:0,totalGemsFound:0,totalTreasurePieces:0,totalQuestionsAnswered:0,totalCorrectAnswers:0,islandsCompleted:0,gameCompleted:!1}}),P=f.useRef(null),D=f.useRef(null);f.useEffect(()=>(L(),window.history.pushState({mode:"treasureHunt"},"",window.location.href),()=>{P.current&&clearInterval(P.current)}),[]),f.useEffect(()=>{localStorage.setItem(ft.STORAGE_KEYS.PROGRESS,JSON.stringify(w))},[w]),f.useEffect(()=>{localStorage.setItem(ft.STORAGE_KEYS.STATS,JSON.stringify(_))},[_]),f.useEffect(()=>(u==="playing"&&I.timeRemaining>0?P.current=setInterval(()=>{C(V=>{const B=V.timeRemaining-1;return B<=0?(A(),{...V,timeRemaining:0}):(B===30&&i&&K(ft.SOUNDS.TICK,.6),{...V,timeRemaining:B})})},1e3):P.current&&clearInterval(P.current),()=>{P.current&&clearInterval(P.current)}),[u,I.timeRemaining,i]),f.useEffect(()=>{const V=B=>{B.preventDefault(),u==="map"&&!o?(l(!0),window.history.pushState({mode:"treasureHunt"},"",window.location.href)):u!=="map"&&(d("map"),g(null),window.history.pushState({mode:"treasureHunt"},"",window.location.href))};return window.addEventListener("popstate",V),()=>window.removeEventListener("popstate",V)},[u,o]);const L=async()=>{try{const B=await(await fetch("/data/quiz_questions_bank.csv")).text(),{data:M}=wi.parse(B,{header:!0,skipEmptyLines:!0,transformHeader:H=>H.trim().toLowerCase()}),z=M.map((H,ne)=>{var Q;const q=[H.option1,H.option2,H.option3,H.option4].map(oe=>(oe||"").trim()).filter(Boolean);if(q.length<4)return null;let X={a:0,b:1,c:2,d:3}[(Q=H.answer)==null?void 0:Q.toLowerCase()];return X===void 0&&(X=q.findIndex(oe=>oe.toLowerCase()===(H.answer||"").toLowerCase())),X===-1&&(X=0),{id:H.id||`q_${ne}`,prompt:(H.question||"").trim(),options:q,correctIndex:X,category:(H.category||H.subject||"general").trim(),difficulty:(H.difficulty||"medium").toLowerCase()}}).filter(Boolean);N(z)}catch(V){console.error("Failed to load questions:",V)}},E=V=>{const B=Ir(V);if(!B||x.length===0)return[];let M=x.filter(H=>B.questionDifficulty.includes(H.difficulty));return M.length<ft.QUESTIONS_PER_ISLAND&&(M=x),[...M].sort(()=>Math.random()-.5).slice(0,ft.QUESTIONS_PER_ISLAND)},m=V=>{if(!O4(V,w)){i&&K("/sounds/locked.mp3",.5),$([100]);return}g(V),d("island-detail"),i&&K("/sounds/select.mp3",.5)},y=V=>{const B=Ir(V),M=E(V);C({islandId:V,questions:M,currentQuestionIndex:0,shovelsRemaining:ft.SHOVELS_PER_ISLAND,correctAnswers:0,wrongAnswers:0,timeRemaining:B.timeLimit,gemsFound:0,coinsEarned:0,questionTimes:[],startTime:Date.now()}),D.current=Date.now(),d("playing"),i&&K("/sounds/start.mp3",.6)},j=V=>{const B=I.questions[I.currentQuestionIndex],M=V===B.correctIndex,z=(Date.now()-D.current)/1e3;C(H=>{const ne={...H,questionTimes:[...H.questionTimes,z]};if(M){const q=Ir(H.islandId);let ee=q.rewards.perCorrectAnswer;z<ft.SPEED_BONUS_THRESHOLD&&(ee+=q.rewards.speedBonus),Math.random()<q.rewards.gemChance&&(ee+=q.rewards.gemBonus,ne.gemsFound=H.gemsFound+1),ne.correctAnswers=H.correctAnswers+1,ne.coinsEarned=H.coinsEarned+ee}else ne.wrongAnswers=H.wrongAnswers+1,ne.shovelsRemaining=H.shovelsRemaining-1,$([200]);return ne}),setTimeout(()=>{const H=I.currentQuestionIndex+1;I.shovelsRemaining===0&&!M||H>=ft.QUESTIONS_PER_ISLAND?T():(C(ne=>({...ne,currentQuestionIndex:H})),D.current=Date.now())},M?2e3:1500)},A=()=>{T()},T=()=>{const V=Ir(I.islandId),B=I.correctAnswers>=V.requiredCorrect,M=I.correctAnswers===ft.QUESTIONS_PER_ISLAND;let z=I.coinsEarned;M&&(z+=V.rewards.perfectBonus),B&&(z+=V.rewards.completionCoins),k(ne=>{const q={...ne},ee=q[I.islandId];if(ee.completed=!0,ee.attempts+=1,B&&!ee.treasurePiece){ee.treasurePiece=!0;const X=ni.find(Q=>Q.id===I.islandId+1);X&&q[X.id]&&(q[X.id].unlocked=!0,i&&setTimeout(()=>K(ft.SOUNDS.ISLAND_UNLOCK,.7),2e3))}return M&&(ee.perfectScore=!0),ee.bestScore=Math.max(ee.bestScore||0,I.correctAnswers),q}),v(ne=>({...ne,totalCoinsEarned:ne.totalCoinsEarned+z,totalGemsFound:ne.totalGemsFound+I.gemsFound,totalTreasurePieces:ne.totalTreasurePieces+(B&&!w[I.islandId].treasurePiece?1:0),totalQuestionsAnswered:ne.totalQuestionsAnswered+(I.correctAnswers+I.wrongAnswers),totalCorrectAnswers:ne.totalCorrectAnswers+I.correctAnswers,islandsCompleted:ne.islandsCompleted+(w[I.islandId].completed?0:1)})),ye.addCoins(z,`Treasure Hunt - ${V.name} Island`),ye.addXP(I.correctAnswers),C(ne=>({...ne,coinsEarned:z})),i&&K(B?ft.SOUNDS.TREASURE_FOUND:ft.SOUNDS.ISLAND_COMPLETE,.7),ni.every(ne=>{var q;return((q=w[ne.id])==null?void 0:q.treasurePiece)===!0})&&!_.gameCompleted?(v(ne=>({...ne,gameCompleted:!0})),setTimeout(()=>{d("final-treasure"),i&&K(ft.SOUNDS.FINAL_TREASURE,.8)},3e3)):d("reward")},S=()=>{y(I.islandId)},G=()=>{d("map"),g(null)},Z=()=>{ye.addCoins(ft.FINAL_TREASURE_REWARD,"Treasure Hunt - Final Treasure"),ye.addXP(10),v(V=>({...V,totalCoinsEarned:V.totalCoinsEarned+ft.FINAL_TREASURE_REWARD})),d("map")},te=()=>{window.history.go(-1),t()},K=(V,B=.5)=>{try{const M=new Audio(V);M.volume=B,M.play()}catch(M){console.error("Failed to play sound:",M)}},$=V=>{navigator.vibrate&&navigator.vibrate(V)};f.useEffect(()=>(document.body.classList.add("hide-bottom-nav"),()=>{document.body.classList.remove("hide-bottom-nav")}),[]);let O=null;switch(u){case"map":O=s.jsx(z4,{islands:ni,islandProgress:w,onSelectIsland:m,onBack:()=>l(!0),soundOn:i,setSoundOn:a,totalStats:_});break;case"island-detail":O=s.jsx($4,{island:Ir(h),progress:w[h],onStart:()=>y(h),onClose:()=>d("map"),soundOn:i});break;case"playing":O=s.jsx(q4,{island:Ir(I.islandId),question:I.questions[I.currentQuestionIndex],questionNumber:I.currentQuestionIndex+1,totalQuestions:ft.QUESTIONS_PER_ISLAND,shovelsRemaining:I.shovelsRemaining,timeRemaining:I.timeRemaining,coinsEarned:I.coinsEarned,gemsFound:I.gemsFound,onAnswer:j,onQuit:()=>d("map"),soundOn:i,setSoundOn:a});break;case"reward":O=s.jsx(Q4,{island:Ir(I.islandId),session:I,earnedTreasure:I.correctAnswers>=Ir(I.islandId).requiredCorrect,onRetry:S,onContinue:G,soundOn:i});break;case"final-treasure":O=s.jsx(G4,{totalStats:_,onContinue:Z,soundOn:i});break;default:O=null}return s.jsxs(s.Fragment,{children:[O,o&&s.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 px-6",children:s.jsxs("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-3xl p-6 max-w-sm w-full shadow-2xl border border-white/10",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"text-5xl mb-3",children:""}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Leave Treasure Hunt?"}),s.jsx("p",{className:"text-white/70",children:"Your island progress is saved!"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>l(!1),className:"flex-1 py-3 bg-gradient-to-r from-green-400 to-emerald-500 text-white rounded-2xl font-bold shadow-lg hover:shadow-xl transition-all hover:scale-[1.02]",children:"Keep Playing"}),s.jsx("button",{onClick:te,className:"flex-1 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-2xl font-bold shadow-lg hover:shadow-xl transition-all hover:scale-[1.02]",children:"Exit"})]})]})})]})}const W4=[{name:"General Knowledge",questions:50,icon:"",color:"#7C3AED"},{name:"Artificial Intelligence",questions:28,icon:"",color:"#10B981"},{name:"Fun facts",questions:30,icon:"",color:"#EF4444"},{name:"Science",questions:45,icon:"",color:"#F59E0B"},{name:"History",questions:42,icon:"",color:"#2563EB"},{name:"Geography",questions:38,icon:"",color:"#FACC15"}],e2=W4.slice(0,6),Hd=360/e2.length;function Y4({onModeSelect:t,onNavigateHome:e}){return s.jsx("div",{className:"fixed inset-0 bg-base-bg text-base-text overflow-hidden mt-12",children:s.jsxs("div",{className:"h-full overflow-y-auto mx-auto max-w-md px-4 pt-[calc(env(safe-area-inset-top)+2rem)] pb-[calc(env(safe-area-inset-bottom)+5.25rem)]",children:[s.jsx("header",{className:"flex items-center mb-8",children:s.jsx("h1",{className:"text-center text-xl font-bold w-full",children:"Choose a quiz mode"})}),s.jsxs("div",{className:"space-y-8",children:[s.jsxs("button",{onClick:()=>t("classic"),className:"w-full relative overflow-hidden rounded-3xl bg-gradient-to-r from-blue-400 to-blue-500 p-8 text-left shadow-lg hover:shadow-xl transition-all active:scale-[0.98]",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 opacity-30",children:s.jsxs("svg",{viewBox:"0 0 100 100",className:"w-full h-full animate-spin",style:{animationDuration:"20s"},children:[e2.map((n,r)=>{const i=r*Hd,a=i+Hd,o=Hd>180?1:0,l=Math.PI*i/180,u=Math.PI*a/180,d=50+40*Math.cos(l),h=50-40*Math.sin(l),g=50+40*Math.cos(u),x=50-40*Math.sin(u);return s.jsx("path",{d:`M50,50 L${d},${h} A40,40 0 ${o} 0 ${g},${x} Z`,fill:n.color,stroke:"white",strokeWidth:"0.5"},r)}),s.jsx("circle",{cx:"50",cy:"50",r:"8",fill:"white"})]})}),s.jsx("div",{className:"absolute top-2 left-8 text-3xl opacity-60",children:""}),s.jsx("div",{className:"absolute top-5 right-32 text-xl opacity-40",children:""}),s.jsx("div",{className:"absolute bottom-6 left-6 text-2xl opacity-50",children:""}),s.jsx("div",{className:"absolute bottom-1 right-12 text-3xl opacity-60",children:""}),s.jsx("div",{className:"absolute top-28 left-32 text-lg opacity-50",children:""}),s.jsx("h2",{className:"text-5xl font-black text-white mb-10 relative z-10",style:{transform:"translateX(-20px)"},children:"CLASSIC"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("button",{onClick:()=>t("survival"),className:"aspect-square rounded-3xl bg-gradient-to-br from-yellow-400 to-orange-400 p-4 text-left hover:shadow-xl transition-all active:scale-[0.98] relative overflow-hidden",children:[s.jsx("div",{className:"text-2xl mb-2",children:""}),s.jsx("h4",{className:"text-lg font-black text-white",children:"SURVIVAL"})]}),s.jsxs("button",{onClick:()=>t("treasureHunt"),className:"aspect-square rounded-3xl bg-gradient-to-br from-purple-400 to-green-500 p-4 text-left hover:shadow-xl transition-all active:scale-[0.98] relative overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 opacity-20",children:[s.jsx("div",{className:"absolute top-2 right-2 text-4xl animate-pulse",children:""}),s.jsx("div",{className:"absolute bottom-2 left-2 text-3xl animate-bounce",style:{animationDelay:"0.5s"},children:""}),s.jsx("div",{className:"absolute top-1/2 right-4 text-2xl animate-pulse",style:{animationDelay:"1s"},children:""})]}),s.jsx("div",{className:"text-2xl mb-2 relative z-10",children:""}),s.jsx("h4",{className:"text-lg font-black text-white relative z-10",children:"TREASURE HUNT"}),s.jsx("div",{className:"absolute bottom-2 right-2",children:s.jsx("span",{className:"text-xs bg-white/20 px-2 py-1 rounded-full text-white font-bold",children:"NEW!"})})]}),s.jsxs("button",{disabled:!0,className:"aspect-square rounded-3xl bg-gradient-to-br from-pink-500 to-purple-500 p-4 text-left opacity-60",children:[s.jsx("div",{className:"text-2xl mb-2",children:""}),s.jsx("h4",{className:"text-lg font-black text-white",children:"Coming Soon"})]}),s.jsxs("button",{disabled:!0,className:"aspect-square rounded-3xl bg-gradient-to-br from-blue-400 to-cyan-400 p-4 text-left opacity-60",children:[s.jsx("div",{className:"text-2xl mb-2",children:""}),s.jsx("h4",{className:"text-lg font-black text-white",children:"Coming Soon"})]})]})]})]})})}function K4(){const[t,e]=f.useState(null),n=Ye(),r=Pt();f.useEffect(()=>{const l=new URLSearchParams(r.search);l.get("mode")==="survival"&&l.get("from")==="quest"&&e("survival")},[r]);const i=l=>{if(l==="classic"){n("/play/classic",{state:{from:"play"}});return}else l==="survival"?e("survival"):l==="treasureHunt"&&e("treasureHunt")},a=()=>{n("/")},o=()=>{e(null)};if(t==="survival"){const u=new URLSearchParams(r.search).get("from")==="quest";return s.jsx(L4,{onBack:o,isFromQuest:u})}return t==="treasureHunt"?s.jsx(H4,{onBack:o}):s.jsx(Y4,{onModeSelect:i,onNavigateHome:a})}const X4=({session:t,mode:e,category:n,difficulty:r,timerConfig:i,onComplete:a,onQuit:o})=>{const l=Ye(),[u,d]=f.useState(0),[h,g]=f.useState([]),[x,N]=f.useState([]),[w,k]=f.useState([]),[I,C]=f.useState(!1),[_,v]=f.useState(null),[P,D]=f.useState(Date.now()),[L,E]=f.useState(0),[m,y]=f.useState([]);f.useState(!1),f.useState(!1);const[j,A]=f.useState({}),[T,S]=f.useState({}),[G,Z]=f.useState([]);f.useState(!0);const[te,K]=f.useState([]),[$,O]=f.useState(0),[V,B]=f.useState(0),[M,z]=f.useState(!1),[H,ne]=f.useState(!1),[q,ee]=f.useState(""),[X,Q]=f.useState(!1),[oe,ue]=f.useState(!1),[ae,ce]=f.useState(!0),[J,W]=f.useState(!1),[F,re]=f.useState(0),[le,pe]=f.useState(0),[Ne,Pe]=f.useState(0),[De,xt]=f.useState(0),[Be,ge]=f.useState(null),[Te,Ie]=f.useState(0);f.useRef(null);const Me=f.useRef(null),Oe=e==="practice",yt=h[u],Vt=ve=>{try{const Ee=new Audio(ve);Ee.volume=.6,Ee.play()}catch{console.log("Sound not available:",ve)}},wt=[{id:1,category:"General Knowledge",difficulty:"medium",prompt:"Which element has the atomic number 1?",options:["Helium","Carbon","Hydrogen","Oxygen"],answerIndex:2,explanation:"Hydrogen is the first element on the periodic table with atomic number 1!"},{id:2,category:"General Knowledge",difficulty:"medium",prompt:"What is the largest ocean on Earth?",options:["Atlantic","Pacific","Indian","Arctic"],answerIndex:1,explanation:"The Pacific Ocean covers about one-third of Earth's surface!"},{id:3,category:"General Knowledge",difficulty:"easy",prompt:"What color do you get when you mix red and yellow?",options:["Purple","Orange","Green","Pink"],answerIndex:1,explanation:"Red and yellow make orange - like a beautiful sunset!"}],Ge=t&&t.questions&&Array.isArray(t.questions)&&t.questions.length>0?t.questions:wt,ot=Ge[u]||Ge[0]||wt[0],qt=Ge.length;f.useEffect(()=>{const ve=ye.getCoins();Pe(ve)},[]),f.useEffect(()=>{Ge.length>0&&(g(new Array(Ge.length).fill(null)),N(new Array(Ge.length).fill(!1)),Z(new Array(Ge.length).fill(!1)),k(new Array(Ge.length).fill((i==null?void 0:i.seconds)||45)))},[Ge.length,i==null?void 0:i.seconds]);const Cn=()=>{const ve=new Date;return`${ve.getFullYear()}-${ve.getMonth()+1}-${ve.getDate()}`},tn=()=>{Oe&&window.location.search.includes("from=quest")?l("/profile/quests",{state:{questCompleted:!0,questType:"practiceQuestions"}}):o()},mn=f.useCallback((ve,Ee)=>{if(!ot||Oe&&G[u]||j[u]&&j[u].includes(ve))return;const ke=[...h];if(ke[u]=h[u]===ve?null:ve,g(ke),D(Date.now()),Oe&&!m.includes(u)&&ke[u]!==null){const st=m.length+1;if(E(st),y(he=>[...he,u]),window.location.search.includes("from=quest")){let he={};try{const Ke=localStorage.getItem("questProgress");Ke&&(he=JSON.parse(Ke))}catch(Ke){console.error("Error reading progress:",Ke)}const je=he.practiceQuestions||0;he.practiceQuestions=Math.max(je,st),he.date=`${new Date().getFullYear()}-${new Date().getMonth()+1}-${new Date().getDate()}`,localStorage.setItem("questProgress",JSON.stringify(he)),console.log("Saved practice progress:",he.practiceQuestions),window.dispatchEvent(new CustomEvent("questProgressUpdate",{detail:{practiceQuestions:he.practiceQuestions}}))}}ke[u]!==null&&(ce(!1),clearInterval(Me.current));const at=ke[u]===ot.answerIndex;if(at){const st=De+1;if(xt(st),O(he=>he+1),B(0),Oe){re(je=>je+1);const he=2;pe(je=>je+he),Pe(je=>je+he),Vt("/sounds/correct.mp3"),setTimeout(()=>Vt("/sounds/coin.mp3"),500),ue(!0),setTimeout(()=>ue(!1),2e3),ge({type:"correct",stars:1,coins:2}),setTimeout(()=>ge(null),2e3)}}else ke[u]!==null&&(xt(0),O(0),B(st=>st+1),Oe&&Vt("/sounds/wrong.mp3"));if(K(st=>[...st.slice(-2),at]),ke[u]!==null&&x[u]){const st=[...x];st[u]=!1,N(st)}Oe&&ke[u]!==null&&(Q(!0),Z(st=>{const he=[...st];return he[u]=!0,he}))},[ot,Oe,G,u,h,x,qt,De,j,te,$,L,m]),Tn=()=>{D(Date.now()),u>0&&(clearInterval(Me.current),ce(!1),d(ve=>ve-1),Q(!1),Oe&&h[u-1]!==null&&setTimeout(()=>Q(!0),100))},hr=()=>{if(D(Date.now()),clearInterval(Me.current),yt===null){const ve=[...x];ve[u]=!0,N(ve),xt(0)}ce(!1),Q(!1),u<qt-1?(d(ve=>ve+1),Oe&&h[u+1]!==null?setTimeout(()=>Q(!0),100):setTimeout(()=>ce(!0),100)):z(!0)},me=()=>{D(Date.now());const ve=[...x];ve[u]=!0,N(ve),xt(0),hr()},Se=()=>{const ve=Ge.reduce((Ee,ke,at)=>Ee+(h[at]===ke.answerIndex?1:0),0);if(Oe&&mt.trackFeatureUsage("practice_completed",{category:n,questionsAttempted:h.filter(Ee=>Ee!==null).length,correctAnswers:ve}),Oe&&window.location.search.includes("from=quest")){const Ee=h.filter(at=>at!==null).length,ke=JSON.parse(localStorage.getItem("questProgress")||"{}");ke.practiceQuestions=Math.min(Ee,15),ke.date=Cn(),localStorage.setItem("questProgress",JSON.stringify(ke)),console.log("Final practice progress saved:",ke.practiceQuestions)}if(Oe)a&&a({questions:Ge,answers:h,skipped:x,correct:ve,total:qt,mode:e,category:n,difficulty:r,earnedStars:F,earnedCoins:le,finalStreak:De});else{const Ee=ve*10;Ie(Ee),a&&a({questions:Ge,answers:h,skipped:x,correct:ve,total:qt,mode:e,category:n,difficulty:r,earnedStars:0,earnedCoins:Ee,finalStreak:De})}};f.useEffect(()=>{if(!(I||_!==null||M||!ae||h[u]!==null))return Me.current=setInterval(()=>{k(ve=>{const Ee=[...ve],ke=Ee[u];return ke<=1?(clearInterval(Me.current),u===qt-1?(Date.now()-P>=5e3&&z(!0),Ee):(v(u),Ee)):(Ee[u]=ke-1,Ee)})},1e3),()=>clearInterval(Me.current)},[I,_,u,M,qt,ae,h,P]),f.useEffect(()=>{h[u]===null&&!M&&!_?ce(!0):ce(!1)},[u,h,M,_]);const Ue=ve=>{const Ee=Math.floor(ve/60),ke=ve%60;return`${Ee}:${ke.toString().padStart(2,"0")}`},Fe=(u+1)/Ge.length*100,nt=h.filter(ve=>ve!==null).length,ze=x.filter(Boolean).length,rt=w[u]||0;Ge.reduce((ve,Ee,ke)=>ve+(h[ke]===Ee.answerIndex?1:0),0);const Ze=Oe&&X&&yt!==null;return s.jsxs("div",{className:"h-dvh bg-gray-900 text-white flex flex-col overflow-hidden pt-[env(safe-area-inset-top,0px)]",children:[Be&&s.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none",children:s.jsxs("div",{className:"bg-gradient-to-r from-yellow-500 to-orange-500 text-white px-8 py-4 rounded-full text-xl font-bold animate-bounce shadow-2xl",children:["+",Be.coins," Coins!"]})}),oe&&s.jsx("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-40 pointer-events-none",children:[...Array(8)].map((ve,Ee)=>s.jsx("div",{className:"absolute text-3xl animate-ping",style:{left:`${-30+Math.random()*60}px`,top:`${-30+Math.random()*60}px`,animationDelay:`${Ee*150}ms`,animationDuration:"2s"},children:""},Ee))}),s.jsxs("div",{className:"bg-gray-900 flex-shrink-0 pt-10",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-800 shadow-lg",children:[s.jsxs("button",{onClick:()=>ne(!0),className:"bg-gray-700 hover:bg-gray-600 px-3 py-1.5 rounded-full flex items-center gap-2 transition-colors text-sm",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),s.jsx("span",{className:"font-medium",children:"Back"})]}),s.jsx("div",{className:"flex-1"}),s.jsxs("div",{className:"flex items-center gap-2",children:[Oe&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-yellow-600/20 px-2 py-1 rounded-full flex items-center gap-1",children:[s.jsx("span",{className:"text-yellow-400 text-sm",children:""}),s.jsx("span",{className:"text-yellow-200 font-semibold text-sm",children:Ne})]}),s.jsxs("div",{className:"bg-orange-600/20 px-2 py-1 rounded-full flex items-center gap-1",children:[s.jsx("span",{className:"text-orange-400 text-sm",children:""}),s.jsx("span",{className:"text-orange-200 font-semibold text-sm",children:De})]})]}),s.jsx("div",{className:`px-2 py-1 rounded-full font-mono font-semibold text-sm ${rt<=10?"bg-red-600/20 text-red-400 animate-pulse":rt<=30?"bg-yellow-600/20 text-yellow-400":"bg-green-600/20 text-green-400"}`,children:Ue(rt)})]})]}),s.jsxs("div",{className:"px-4 pb-1 bg-gray-900",children:[s.jsxs("div",{className:"flex justify-between items-center mb-1",children:[s.jsxs("span",{className:"text-xs text-gray-400",children:["Question ",u+1," of ",qt]}),s.jsxs("span",{className:"text-xs text-gray-400",children:[Math.round(Fe),"% Complete"]})]}),s.jsx("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-500",style:{width:`${Fe}%`}})}),s.jsx("div",{className:"flex justify-center gap-1 mt-1",children:Array.from({length:qt}).map((ve,Ee)=>s.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition-all ${Ee===u?"bg-white scale-125":h[Ee]!==null?"bg-green-500":x[Ee]?"bg-yellow-500":"bg-gray-600"}`},Ee))}),s.jsx("div",{className:"text-center mt-4",children:s.jsx("span",{className:"text-xs text-gray-500",children:ot.category})})]})]}),s.jsx("div",{className:`flex-1 flex flex-col ${Ze?"overflow-y-auto":"overflow-hidden"}`,children:s.jsxs("div",{className:"px-4 py-4 flex-1 flex flex-col",children:[s.jsxs("div",{className:"relative bg-gradient-to-br from-blue-600 via-purple-600 to-indigo-700 rounded-3xl p-6 mb-4 shadow-2xl shadow-blue-600/20 border border-blue-400/20",children:[s.jsx("div",{className:"absolute top-2 right-2 w-16 h-16 bg-white/10 rounded-full blur-xl"}),s.jsx("div",{className:"absolute bottom-2 left-2 w-12 h-12 bg-white/5 rounded-full blur-lg"}),s.jsxs("div",{className:"relative text-center",children:[s.jsxs("div",{className:"inline-block bg-white/10 px-3 py-1 rounded-full text-xs font-medium text-blue-100 mb-3",children:["Question ",u+1]}),s.jsx("h2",{className:"text-xl font-bold leading-relaxed text-white tracking-wide",children:ot.prompt}),ot.difficulty&&s.jsx("div",{className:"mt-3 inline-block",children:s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${ot.difficulty==="easy"?"bg-green-500/20 text-green-300":ot.difficulty==="medium"?"bg-yellow-500/20 text-yellow-300":"bg-red-500/20 text-red-300"}`,children:ot.difficulty.toUpperCase()})})]})]}),s.jsx("div",{className:"grid grid-cols-1 gap-3 mb-4",children:ot.options.map((ve,Ee)=>{const ke=yt===Ee,at=Ee===ot.answerIndex,st=Oe&&yt!==null&&X,he=j[u]&&j[u].includes(Ee);let je="p-4 rounded-xl transition-all duration-300 border-2 min-h-[64px] flex items-center ";he?je+="bg-gray-700/30 border-gray-600/30 text-gray-500/50 cursor-not-allowed":(je+="cursor-pointer ",st?ke&&at?je+="bg-green-600 border-green-500 text-white shadow-lg shadow-green-600/25":ke&&!at?je+="bg-red-600 border-red-500 text-white shadow-lg shadow-red-600/25":!ke&&at?je+="bg-green-600/20 border-green-500 text-green-300 animate-pulse":je+="bg-gray-700 border-gray-600 text-gray-400":ke?je+="bg-gray-600 border-gray-500 text-white":je+="bg-gray-800 border-gray-700 text-gray-200 hover:bg-gray-750 hover:border-gray-600");const Ke=["","","",""];return s.jsx("button",{onClick:He=>mn(Ee,He),disabled:Oe&&G[u],className:je,children:s.jsxs("div",{className:"flex items-center gap-2 w-full",children:[s.jsx("div",{className:"text-lg flex-shrink-0 mr-1",children:Ke[Ee]}),s.jsx("div",{className:"flex-1 text-left font-semibold text-base leading-relaxed",children:ve}),T[u]&&T[u][Ee]>0&&!he&&s.jsxs("div",{className:"bg-purple-600/20 px-2 py-1 rounded-full text-xs text-purple-300",children:[T[u][Ee],"%"]}),st&&ke&&at&&!he&&s.jsx("div",{className:"text-lg animate-bounce",children:""}),st&&ke&&!at&&!he&&s.jsx("div",{className:"text-lg",children:""}),st&&!ke&&at&&!he&&s.jsx("div",{className:"text-base animate-pulse",children:""})]})},Ee)})}),Oe&&X&&yt!==null&&s.jsx("div",{className:"bg-gray-800 rounded-xl p-4 mb-4 border border-gray-700",children:s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"text-lg flex-shrink-0",children:yt===ot.answerIndex?"":""}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:`font-semibold mb-3 text-sm ${yt===ot.answerIndex?"text-green-400":"text-blue-400"}`,children:yt===ot.answerIndex?"Perfect! Well done!":"Good try! Here's why:"}),ot.explanation&&s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:ot.explanation})]})]})}),s.jsx("div",{className:"h-[200px]"})]})}),s.jsxs("div",{className:"fixed bottom-0 left-0 right-0 z-50",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-gray-900/95 to-gray-900/80 backdrop-blur-xl"}),s.jsxs("div",{className:"relative p-4 pb-8",children:[s.jsxs("div",{className:"flex gap-2 mb-3",children:[s.jsx("button",{onClick:Tn,disabled:u===0,className:`flex-1 bg-white/10 backdrop-blur-md border border-white/20 
                disabled:opacity-30 disabled:cursor-not-allowed
                py-3.5 rounded-2xl font-semibold transition-all transform active:scale-95
                hover:bg-white/15 text-white shadow-xl`,children:"Previous"}),s.jsx("button",{onClick:me,disabled:yt!==null,className:`flex-1 py-3.5 rounded-2xl font-semibold transition-all transform active:scale-95 shadow-xl ${yt!==null?"bg-white/5 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-amber-500 to-yellow-500 text-white hover:from-amber-600 hover:to-yellow-600"}`,children:"Skip"}),s.jsx("button",{onClick:hr,className:`flex-1 bg-gradient-to-r from-blue-500 to-indigo-500 
                hover:from-blue-600 hover:to-indigo-600
                py-3.5 rounded-2xl font-semibold transition-all transform active:scale-95
                text-white shadow-xl`,children:u===qt-1?"Finish":"Next"})]}),s.jsxs("button",{onClick:()=>z(!0),className:`w-full bg-gradient-to-r from-emerald-500 via-green-500 to-teal-500
              hover:from-emerald-600 hover:via-green-600 hover:to-teal-600
              py-4 rounded-2xl font-bold text-white transition-all transform active:scale-[0.98]
              shadow-2xl shadow-green-500/25 relative overflow-hidden group`,children:[s.jsx("div",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-700 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),s.jsx("span",{className:"relative",children:"Submit Quiz"})]})]})]}),H&&s.jsx("div",{className:"fixed inset-0 bg-black/75 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-gray-800 rounded-3xl p-6 max-w-sm w-full text-center border border-gray-700",children:[s.jsx("div",{className:"text-4xl mb-4",children:""}),s.jsx("h3",{className:"text-xl font-bold mb-2",children:"Leave Quiz?"}),s.jsx("p",{className:"text-gray-400 mb-6",children:"Your progress will be lost"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>ne(!1),className:"flex-1 bg-blue-600 hover:bg-blue-700 py-3 rounded-xl font-medium",children:"Stay"}),s.jsx("button",{onClick:tn,className:"flex-1 bg-gray-700 hover:bg-gray-600 py-3 rounded-xl font-medium",children:"Leave"})]})]})}),M&&!J&&s.jsx("div",{className:"fixed inset-0 bg-black/75 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-gray-800 rounded-3xl p-6 max-w-sm w-full text-center border border-gray-700",children:[s.jsx("div",{className:"text-4xl mb-4",children:""}),s.jsx("h3",{className:"text-xl font-bold mb-2",children:"Ready to finish?"}),s.jsxs("p",{className:"text-gray-400 mb-4",children:[nt," of ",qt," answered  ",ze," skipped"]}),Oe&&s.jsx("div",{className:"bg-gradient-to-r from-yellow-600/20 to-orange-600/20 p-4 rounded-2xl mb-6 border border-yellow-600/30",children:s.jsxs("div",{className:"flex justify-center gap-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl mb-1",children:""}),s.jsx("div",{className:"text-yellow-400 font-bold",children:F}),s.jsx("div",{className:"text-xs text-gray-400",children:"Stars"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl mb-1",children:""}),s.jsx("div",{className:"text-yellow-400 font-bold",children:le}),s.jsx("div",{className:"text-xs text-gray-400",children:"Coins"})]})]})}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>{z(!1),v(null),D(Date.now())},className:"flex-1 bg-gray-700 hover:bg-gray-600 py-3 rounded-xl font-medium",children:"Back"}),s.jsx("button",{onClick:ve=>{ve.preventDefault(),ve.stopPropagation(),console.log("Submit button clicked"),Se()},className:"flex-1 bg-green-600 hover:bg-green-700 py-3 rounded-xl font-medium",children:"Submit"})]})]})}),_===u&&!M&&s.jsx("div",{className:"fixed inset-0 bg-black/75 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-gray-800 rounded-3xl p-6 max-w-sm w-full text-center border border-gray-700",children:[s.jsx("div",{className:"text-4xl mb-4 animate-pulse",children:""}),s.jsx("h3",{className:"text-xl font-bold mb-2",children:"Time's Up!"}),s.jsx("p",{className:"text-gray-400 mb-6",children:"Let's move to the next question"}),s.jsx("button",{onClick:()=>{v(null),D(Date.now()),u<Ge.length-1?hr():z(!0)},className:"w-full bg-blue-600 hover:bg-blue-700 py-3 rounded-xl font-medium",children:u<Ge.length-1?"Continue":"See Results"})]})}),q&&s.jsx("div",{className:"fixed top-20 left-1/2 transform -translate-x-1/2 bg-red-600 text-white px-4 py-2 rounded-full font-medium animate-bounce z-50",children:q}),s.jsx("style",{jsx:!0,children:`
        .pt-safe {
            padding-top: env(safe-area-inset-top);
        }
        
        @keyframes fadeInOut {
          0% {
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.8);
          }
          15% {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1.05);
          }
          20% {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
          }
          80% {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
          }
          100% {
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.9);
          }
        }
        
        .animate-fadeInOut {
          animation: fadeInOut 3s ease-out forwards;
        }
      `})]})},Wa=[{name:"GK",slug:"general-knowledge",questions:50,icon:"",color:"#FF6B6B",gradient:"from-red-500 to-pink-500"},{name:"Science",slug:"science",questions:45,icon:"",color:"#4ECDC4",gradient:"from-cyan-500 to-teal-500"},{name:"Fun Facts",slug:"fun-facts",questions:30,icon:"",color:"#FFD93D",gradient:"from-yellow-400 to-orange-500"},{name:"History",slug:"history",questions:42,icon:"",color:"#A8E6CF",gradient:"from-green-400 to-emerald-500"},{name:"AI & Tech",slug:"artificial-intelligence",questions:28,icon:"",color:"#C7B8FF",gradient:"from-purple-400 to-indigo-500"},{name:"Geography",slug:"geography",questions:38,icon:"",color:"#FACC15",gradient:"from-yellow-400 to-amber-500"},{name:"Computer",slug:"computer",questions:34,icon:"",color:"#3B82F6",gradient:"from-blue-400 to-blue-600"},{name:"Aptitude",slug:"aptitude",questions:36,icon:"",color:"#EC4899",gradient:"from-pink-500 to-rose-500"},{name:"Iconic Figures",slug:"iconic-figures",questions:26,icon:"",color:"#8B5CF6",gradient:"from-purple-500 to-violet-600"}],J4=()=>s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),Z4=()=>s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e3=()=>s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),t3=()=>s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),n3=()=>s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),r3=({results:t={correct:8,total:10,category:"general-knowledge",mode:"quiz",elapsedMs:125e3,questions:[],returnPath:null,fromQuest:!1},onRetake:e=()=>{},onReview:n=()=>{},onNavigate:r=(u,d)=>{},isRetake:i=!1,isPractice:a=!1,player:o={level:1,coins:0,combo:0,energy:5},categories:l=[]})=>{const[u,d]=f.useState(ye.getCoins()),h=f.useRef(null),[g,x]=f.useState(null),[N]=Ft("/sounds/coin.mp3",{volume:.75}),[w,k]=f.useState(!1),[I,C]=f.useState(!1),[_,v]=f.useState(0),[P,D]=f.useState(!1),[L,E]=f.useState(!1),m=()=>{if(mt.trackButtonClick("quiz_results_back",t.isPractice?"practice":"quiz"),console.log("QuizResults handleBack:",{fromQuest:t.fromQuest,returnPath:t.returnPath,isPractice:t.isPractice||a}),t.fromQuest){const Q=t.isPractice||a?"practiceQuestions":"dailyQuizzes";t.isPractice||a?r("/profile/quests"):r("/profile/quests",{state:{questCompleted:!0,questType:Q,increment:1}})}else{const Q=t.returnPath||"/";r(Q)}},{correct:y,total:j,category:A,categorySlug:T,difficulty:S,mode:G,elapsedMs:Z}=t,te=j?Math.round(y/j*100):0,K=te===100,$=te>=80,O=Math.floor(Z/1e3),V=j>0?Math.floor(O/j):0,B=a?t.earnedCoins||0:Math.round(y*5*(K?1.5:$?1.2:1)),M=Wa.find(Q=>Q.slug===A)||Wa[0],H=(()=>K?{emoji:"",text:"Perfect!",color:"text-yellow-400"}:te>=90?{emoji:"",text:"Excellent!",color:"text-purple-400"}:te>=80?{emoji:"",text:"Great job!",color:"text-blue-400"}:te>=70?{emoji:"",text:"Good effort!",color:"text-green-400"}:te>=60?{emoji:"",text:"Keep going!",color:"text-orange-400"}:{emoji:"",text:"Keep practicing!",color:"text-gray-400"})();f.useEffect(()=>{const Q=ye.getCoins();d(Q)},[]),f.useEffect(()=>{t.coinsProcessed||B>0&&h.current&&setTimeout(()=>{h.current.getBoundingClientRect();const Q=new Audio("/sounds/coin.mp3");Q.volume=.75,Q.play().catch(oe=>{if(console.error("Audio play failed:",oe),N)try{N()}catch(ue){console.error("Hook play failed:",ue)}}),x({startRect:{left:window.innerWidth/2-50,top:window.innerHeight/2,width:100,height:100},count:Math.min(B,10),amount:B}),k(!0),t.coinsProcessed=!0},500)},[]),f.useEffect(()=>{document.documentElement.scrollIntoView({behavior:"smooth",block:"start"}),(K||$)&&(C(!0),setTimeout(()=>C(!1),3e3));let Q=0;const oe=y/20,ue=setInterval(()=>{Q+=oe,Q>=y?(v(y),clearInterval(ue)):v(Math.floor(Q))},50);return()=>clearInterval(ue)},[y,K,$]);const ne=[{score:7,total:10},{score:6,total:10},{score:8,total:10},{score:9,total:10},{score:y,total:j}],q=()=>{try{const Q=localStorage.getItem("qp_recent");if(Q)return JSON.parse(Q).slice(0,10).map(ue=>ue.slug||ue.cat).filter(ue=>ue&&ue!==t.categorySlug)}catch(Q){console.error("Error reading recent categories:",Q)}return[]},ee=()=>{const Q=T||A,oe=S||"medium",ue=q(),ae=(l||Wa||[]).filter(W=>W.slug!==Q&&!ue.slice(0,3).includes(W.slug)),J=(()=>{if(ae.length===0){const W=(l||Wa||[]).filter(F=>F.slug!==Q);return W[Math.floor(Math.random()*W.length)]||(l||Wa)[0]}return ae[Math.floor(Math.random()*ae.length)]})();if(te<60)return a?[{icon:"",title:"Try Fewer Questions",desc:"Start with just 5",color:"from-blue-500 to-cyan-500",action:()=>r(`/quiz/${Q}`,{state:{mode:"practice",difficulty:"easy",count:5,timer:{type:"off",seconds:0}}})},{icon:J.icon,title:J.name,desc:"Fresh start with new topic",color:J.gradient,action:()=>r(`/quiz/${J.slug}`,{state:{mode:"practice",difficulty:"easy",count:10,timer:{type:"off",seconds:0}}})},{icon:"",title:"Review Mistakes",desc:"Learn from errors",color:"from-purple-500 to-pink-500",action:()=>n()}]:[{icon:"",title:"Practice Mode",desc:"No timer, learn at your pace",color:"from-green-500 to-teal-500",action:()=>r(`/quiz/${Q}`,{state:{mode:"practice",difficulty:"easy",count:10,timer:{type:"off",seconds:0}}})},{icon:oe!=="easy"?"":"",title:oe!=="easy"?"Easy Mode":"Try Again",desc:oe!=="easy"?"Build confidence":"You can do this!",color:"from-blue-500 to-cyan-500",action:()=>oe!=="easy"?r(`/quiz/${Q}`,{state:{mode:"quiz",difficulty:"easy",count:5,timer:{type:"per_q",seconds:60}}}):e()},{icon:J.icon,title:J.name,desc:"Try something different",color:J.gradient,action:()=>r(`/quiz/${J.slug}`,{state:{mode:"practice",difficulty:"easy",count:10,timer:{type:"off",seconds:0}}})}];if(te>=80)return oe==="hard"&&te>=90?[{icon:"",title:"Lightning Round",desc:"20 questions, 10s each",color:"from-yellow-500 to-red-500",action:()=>r(`/quiz/${Q}`,{state:{mode:"quiz",difficulty:"hard",count:20,timer:{type:"per_q",seconds:10}}})},{icon:J.icon,title:`${J.name} Challenge`,desc:"Hard mode, new topic",color:J.gradient,action:()=>r(`/quiz/${J.slug}`,{state:{mode:"quiz",difficulty:"hard",count:15,timer:{type:"per_q",seconds:30}}})},{icon:"",title:"Mixed Categories",desc:"Test all your knowledge",color:"from-purple-500 to-indigo-500",action:()=>r("/quiz/mixed",{state:{mode:"quiz",difficulty:"hard",count:20,timer:{type:"per_q",seconds:30}}})}]:[{icon:oe==="hard"?"":"",title:oe==="hard"?"Perfect Score Challenge":"Hard Mode",desc:oe==="hard"?"Can you get 100%?":"Level up your skills",color:"from-red-500 to-orange-500",action:()=>r(`/quiz/${Q}`,{state:{mode:"quiz",difficulty:"hard",count:oe==="hard"?10:20,timer:{type:"per_q",seconds:30}}})},{icon:J.icon,title:J.name,desc:"Master new topics",color:J.gradient,action:()=>r(`/quiz/${J.slug}`,{state:{mode:"practice",difficulty:"easy",count:10,timer:{type:"off",seconds:0}}})},{icon:"",title:"Speed Challenge",desc:"10 questions, 15s each",color:"from-purple-500 to-pink-500",action:()=>r(`/quiz/${Q}`,{state:{mode:"quiz",difficulty:"medium",count:10,timer:{type:"per_q",seconds:15}}})}];{const W=te<70;return[{icon:W?"":"",title:W?"Practice More":"Try Again",desc:W?"Improve accuracy":"Beat your score",color:W?"from-green-500 to-teal-500":"from-blue-500 to-purple-500",action:W?()=>r(`/quiz/${Q}`,{state:{mode:"practice",difficulty:oe,count:10,timer:{type:"off",seconds:0}}}):()=>e()},{icon:J.icon,title:J.name,desc:"Explore new topics",color:J.gradient,action:()=>r(`/quiz/${J.slug}`,{state:{mode:"practice",difficulty:"easy",count:10,timer:{type:"off",seconds:0}}})},{icon:oe==="easy"?"":"",title:oe==="easy"?"Medium Difficulty":"More Questions",desc:oe==="easy"?"Ready for more?":"Test endurance",color:"from-indigo-500 to-purple-500",action:()=>r(`/quiz/${Q}`,{state:{mode:"quiz",difficulty:oe==="easy"?"medium":oe,count:oe==="easy"?10:20,timer:{type:"per_q",seconds:45}}})}]}},X=pn.useMemo(()=>ee(),[te,a,t.categorySlug,t.difficulty]);return s.jsx("div",{className:"h-screen overflow-y-auto bg-gradient-to-b from-gray-900 via-gray-800 to-black text-white",children:s.jsxs("div",{className:"min-h-full p-4 pt-10",children:[g&&s.jsx(Ds,{startRect:g.startRect,targetRef:h,count:g.count,onDone:()=>{if(g.amount>0&&!L){console.log("[QuizResults] Updating display with current total"),E(!0);const Q=ye.getCoins();d(Q)}x(null)}}),s.jsx("style",{children:`
        @keyframes coinRotate {
          from { transform: rotateY(0deg); }
          to { transform: rotateY(360deg); }
        }
      `}),I&&s.jsx("div",{className:"fixed inset-0 pointer-events-none z-50 flex items-center justify-center",children:s.jsx("div",{className:"text-8xl animate-bounce",children:K?"":""})}),s.jsxs("div",{className:"flex justify-between items-center mb-6 mt-1",children:[s.jsxs("button",{onClick:m,className:"p-2 rounded-xl bg-white/10 backdrop-blur hover:bg-white/20 transition-all flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),s.jsx("span",{className:"text-sm font-medium",children:"Back"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"px-3 py-1.5 rounded-full bg-white/10 backdrop-blur text-sm font-medium",children:["Level ",o.level]}),s.jsxs("button",{ref:h,onClick:()=>D(!0),className:"px-3 py-1.5 rounded-full bg-yellow-500/20 backdrop-blur text-sm font-medium text-yellow-300 hover:bg-yellow-500/30 transition-all cursor-pointer",children:[u," "]})]})]}),s.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-xl border border-white/20 p-8 mb-6",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-500/10 via-transparent to-blue-500/10 animate-pulse"}),s.jsxs("div",{className:"relative text-center",children:[s.jsxs("div",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white/10 backdrop-blur mb-4 ${H.color}`,children:[s.jsx("span",{className:"text-2xl",children:H.emoji}),s.jsx("span",{className:"font-semibold",children:H.text})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"text-7xl font-bold mb-2 bg-gradient-to-r from-white to-white/60 bg-clip-text text-transparent",children:[_,"/",j]}),s.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-white/60",children:[s.jsx("span",{className:"text-xl",children:M.icon}),s.jsx("span",{children:M.name})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 max-w-md mx-auto",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-3xl font-bold",children:[te,"%"]}),s.jsx("div",{className:"text-xs text-white/60",children:"Accuracy"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-3xl font-bold",children:[V,"s"]}),s.jsx("div",{className:"text-xs text-white/60",children:"Avg Speed"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-yellow-400",children:B>0?`+${B}`:"0"}),s.jsx("div",{className:"text-xs text-white/60",children:"Coins"})]})]})]})]}),s.jsxs("div",{className:"rounded-2xl bg-white/5 backdrop-blur border border-white/10 p-4 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(t3,{}),s.jsx("span",{className:"text-sm font-medium",children:"Your Progress"})]}),o.combo>0&&s.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded-full bg-orange-500/20 text-orange-400 text-xs",children:[s.jsx(n3,{}),o.combo," streak"]})]}),s.jsx("div",{className:"flex items-end gap-1 h-12 mb-2",children:ne.map((Q,oe)=>s.jsx("div",{className:`flex-1 rounded-t transition-all ${oe===ne.length-1?"bg-gradient-to-t from-purple-500 to-purple-400":"bg-white/20"}`,style:{height:`${Q.score/Q.total*100}%`,minHeight:"4px"}},oe))}),s.jsx("div",{className:"text-xs text-white/40 text-center",children:"Last 5 quizzes"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[s.jsxs("button",{onClick:n,className:"relative overflow-hidden group rounded-2xl bg-gradient-to-r from-blue-500 to-purple-500 p-4 transition-all hover:scale-105 active:scale-95",children:[s.jsx("div",{className:"absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform"}),s.jsxs("div",{className:"relative flex items-center justify-between",children:[s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-semibold",children:"Review"}),s.jsx("div",{className:"text-xs opacity-80",children:"Check answers"})]}),s.jsx(e3,{})]})]}),s.jsx("button",{onClick:e,className:"relative overflow-hidden group rounded-2xl bg-white/10 backdrop-blur border border-white/20 p-4 transition-all hover:scale-105 active:scale-95 hover:bg-white/15",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-semibold",children:"Try Again"}),s.jsx("div",{className:"text-xs opacity-60",children:"New questions"})]}),s.jsx(Z4,{})]})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"text-sm font-medium text-white/60 px-1",children:"Recommended for you"}),X.map((Q,oe)=>s.jsx("button",{onClick:()=>{mt.trackButtonClick(`suggestion_${Q.title}`,"quiz_results"),Q.action()},className:"w-full group relative overflow-hidden rounded-2xl bg-white/5 backdrop-blur border border-white/10 p-4 transition-all hover:bg-white/10 hover:border-white/20",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`p-2 rounded-xl bg-gradient-to-r ${Q.color} opacity-20 group-hover:opacity-30 transition-opacity`,children:s.jsx("span",{className:"text-xl",children:Q.icon})}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-medium text-sm",children:Q.title}),s.jsx("div",{className:"text-xs text-white/40",children:Q.desc})]})]}),s.jsx(J4,{})]})},oe))]}),s.jsx("div",{className:"mt-6 pt-6 border-t border-white/10",children:s.jsx("button",{onClick:()=>r("/profile/history",{state:{from:"results",returnToResults:!0}}),className:"w-full text-center text-sm text-white/40 hover:text-white/60 transition-colors",children:"View all history "})}),P&&s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",onClick:Q=>{Q.target===Q.currentTarget&&D(!1)},children:s.jsxs("div",{className:"bg-gray-800 rounded-3xl p-6 w-full max-w-md border border-gray-700 relative overflow-hidden",onClick:Q=>Q.stopPropagation(),children:[s.jsx("div",{className:"absolute inset-0 opacity-10",children:s.jsx("div",{className:"h-full bg-gradient-to-br from-yellow-400 to-orange-500"})}),s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"text-5xl",style:{animation:"coinRotate 2s linear infinite"},children:""}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-2xl font-bold bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent",children:"Your Treasure"}),s.jsxs("p",{className:"text-3xl font-bold text-white mt-1",children:[u," Coins"]})]})]}),s.jsx("button",{onClick:()=>D(!1),className:"w-8 h-8 rounded-lg bg-white/5 border border-gray-600 grid place-items-center hover:bg-white/10 transition",children:""})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-3",children:"Ways to Earn"}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-r from-green-500/10 to-emerald-500/10 border border-green-500/20 hover:scale-[1.02] transition-transform",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:""}),"Complete Quizzes"]}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"+5 coins per correct answer"})]}),s.jsx("div",{className:"text-green-400 font-bold",children:"+5"})]})}),s.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-r from-blue-500/10 to-cyan-500/10 border border-blue-500/20 hover:scale-[1.02] transition-transform",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:""}),"Daily Challenge"]}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Complete daily for bonus"})]}),s.jsx("div",{className:"text-blue-400 font-bold",children:"+5"})]})}),s.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-r from-purple-500/10 to-pink-500/10 border border-purple-500/20 hover:scale-[1.02] transition-transform",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:""}),"Spin & Play"]}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Test your luck!"})]}),s.jsx("div",{className:"text-purple-400 font-bold",children:"+50"})]})}),s.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-r from-orange-500/10 to-red-500/10 border border-orange-500/20 hover:scale-[1.02] transition-transform",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:""}),"Achievements"]}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Unlock special rewards"})]}),s.jsx("div",{className:"text-orange-400 font-bold",children:"+???"})]})})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mb-2",children:[s.jsx("span",{children:"Next reward"}),s.jsxs("span",{children:[100-o.coins%100," coins to go"]})]}),s.jsx("div",{className:"h-2 bg-white/10 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full transition-all",style:{width:`${o.coins%100}%`}})})]}),s.jsx("button",{onClick:()=>{D(!1),r("/play")},className:"w-full py-3 rounded-xl bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-bold hover:scale-[1.02] transition-transform shadow-lg",children:"Start Earning Now! "})]})]})})]})})},s3=({questions:t,answers:e,skipped:n,onBack:r,onRetake:i,fromHistory:a=!1})=>{const o=Ye(),[l,u]=f.useState(!0),d=f.useRef(0),h=f.useRef(null);f.useEffect(()=>{const k=()=>{const I=window.scrollY;h.current&&clearTimeout(h.current),I<d.current?u(!0):I>d.current&&I>100&&(h.current=setTimeout(()=>{u(!1)},150)),(I<=50||window.innerHeight+I>=document.body.scrollHeight-50)&&u(!0),d.current=I};return window.addEventListener("scroll",k),u(!0),()=>{window.removeEventListener("scroll",k),h.current&&clearTimeout(h.current)}},[]);const g=()=>{a?o("/profile/history",{replace:!0}):r?r():o(-1)},x=t.reduce((k,I,C)=>k+(e[C]===I.answerIndex?1:0),0),N=(n==null?void 0:n.filter(Boolean).length)||0,w=t.length-x-N;return s.jsxs("div",{className:"mt-2 card rounded-3xl p-5 w-full max-w-none mx-auto pb-24 h-full overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 pt-6",children:[s.jsx("button",{className:"px-3 py-1 rounded-xl border border-base-border bg-white/5",onClick:g,children:" Back"}),s.jsx("h2",{className:"text-lg font-semibold",children:"Review Answers"}),s.jsx("div",{className:"w-16"})," "]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[s.jsxs("div",{className:"rounded-xl bg-green-600/10 border border-green-500/30 p-2 text-center",children:[s.jsx("div",{className:"text-xs text-green-400",children:"Correct"}),s.jsx("div",{className:"text-lg font-bold text-green-400",children:x})]}),s.jsxs("div",{className:"rounded-xl bg-red-600/10 border border-red-500/30 p-2 text-center",children:[s.jsx("div",{className:"text-xs text-red-400",children:"Incorrect"}),s.jsx("div",{className:"text-lg font-bold text-red-400",children:w})]}),s.jsxs("div",{className:"rounded-xl bg-amber-600/10 border border-amber-500/30 p-2 text-center",children:[s.jsx("div",{className:"text-xs text-amber-400",children:"Skipped"}),s.jsx("div",{className:"text-lg font-bold text-amber-400",children:N})]})]}),s.jsx("ol",{className:"space-y-4",children:t.map((k,I)=>{const C=e[I],_=!C&&C!==0,v=C===k.answerIndex;return s.jsxs("li",{className:"rounded-2xl border border-base-border bg-white/5 p-4 md:p-5",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"text-sm md:text-base font-medium",children:["Q",I+1,". ",k.prompt]}),k.category&&s.jsxs("div",{className:"text-xs text-base-muted mt-1",children:["Category: ",k.category,"  Difficulty: ",k.difficulty||"Medium"]})]}),s.jsx("div",{className:"ml-2",children:_?s.jsx("span",{className:"px-2 py-1 rounded text-xs bg-amber-600/20 text-amber-400",children:"Skipped"}):v?s.jsx("span",{className:"px-2 py-1 rounded text-xs bg-green-600/20 text-green-400",children:" Correct"}):s.jsx("span",{className:"px-2 py-1 rounded text-xs bg-red-600/20 text-red-400",children:" Wrong"})})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:k.options.map((P,D)=>{const L=C===D,E=D===k.answerIndex;let m="w-full text-left px-3 py-2 rounded-xl border transition-all ";return E?m+="bg-green-600/20 border-green-500/50 text-green-300":L&&!E?m+="bg-red-600/20 border-red-500/50 text-red-300":m+="bg-base-bg/40 border-base-border text-base-muted",s.jsxs("div",{className:m,children:[s.jsxs("span",{className:"font-semibold mr-2",children:[["A","B","C","D"][D],"."]}),P,E&&s.jsx("span",{className:"ml-2 text-green-400",children:""}),L&&!E&&s.jsx("span",{className:"ml-2 text-red-400",children:""})]},D)})}),k.explanation&&s.jsxs("div",{className:"mt-3 p-3 rounded-xl bg-white/5 border border-base-border",children:[s.jsx("div",{className:"text-xs font-semibold text-brand-blue mb-1",children:"Explanation:"}),s.jsx("div",{className:"text-sm text-base-muted",children:k.explanation})]})]},k.id||I)})}),s.jsxs("div",{className:`fixed bottom-2 left-2 right-2 flex gap-2 justify-center transition-transform duration-300 ${l?"translate-y-0":"translate-y-24"}`,children:[s.jsx("button",{className:"flex-1 max-w-[150px] px-4 py-3 rounded-xl border border-base-border bg-base-card backdrop-blur shadow-lg",onClick:g,children:"Back to Results"}),i&&s.jsx("button",{className:"flex-1 max-w-[150px] px-4 py-3 rounded-xl bg-gradient-to-r from-brand-blue to-brand-purple text-white font-medium shadow-lg",onClick:i,children:"Retake Quiz"})]})]})},i3="qp_resume",Wx="qp_mistakes",Yx="qp_stats",Kx="qp_lastset",Xx="qp_recent",Wd="qp_review_snapshot",a3=50,Ti=(t="")=>t.replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase()),vc=(t="")=>t.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-"),o3=(t,e)=>t.slice().sort(()=>Math.random()-.5).slice(0,e),t2=t=>{const e=t.slice();for(let n=e.length-1;n>0;n--){const r=Math.floor(Math.random()*(n+1));[e[n],e[r]]=[e[r],e[n]]}return e},l3=(t,e,n)=>Math.max(e,Math.min(n,t)),Ya=(t,e)=>{try{const n=localStorage.getItem(t);return n?JSON.parse(n):e}catch{return e}};async function c3(){const t="/data/quiz_questions_bank.csv",e=await fetch(t);if(!e.ok)throw new Error(`CSV not found at ${t}`);const n=await e.text(),{data:r}=wi.parse(n,{header:!0,skipEmptyLines:!0,transformHeader:a=>String(a).trim().toLowerCase()}),i={a:0,b:1,c:2,d:3};return r.map((a,o)=>{var x;const l=[a.option1,a.option2,a.option3,a.option4].map(N=>(N??"").trim());if(l.some(N=>!N))return null;let u=-1;const d=String(a.answer??"").trim();if(i[d.toLowerCase()]!==void 0)u=i[d.toLowerCase()];else{const N=l.findIndex(w=>w.toLowerCase()===d.toLowerCase());u=N>=0?N:0}const h=String(a.category??a.subject??"General Knowledge").trim(),g=String(a.difficulty??"medium").toLowerCase().trim();return{id:((x=a.id)==null?void 0:x.trim())||`q_${o}`,category:h,difficulty:g,prompt:String(a.question??"").trim(),options:l,answerIndex:u,explanation:String(a.explanation??"").trim()}}).filter(Boolean)}function u3(t,{categorySlug:e,difficulty:n,count:r}){console.log("=== BUILD SESSION DEBUG ==="),console.log("categorySlug:",e),console.log("difficulty:",n),console.log("count:",r),console.log("Total questions available:",t.length);const a=e==="mixed"?()=>!0:h=>vc(h.category)===e,o=n?h=>(h.difficulty||"medium")===n:()=>!0,l=t.filter(h=>a(h)&&o(h));if(console.log("Filtered pool size:",l.length),console.log("Sample categories from all questions:",[...new Set(t.slice(0,10).map(h=>`"${h.category}" -> "${vc(h.category)}"`))]),l.length===0)return console.error("No questions match the filter criteria!"),console.log("Available categories:",[...new Set(t.map(h=>vc(h.category)))]),{questions:[],poolSize:0};const d=o3(l,Math.min(r,l.length)).map(h=>{const g=t2([0,1,2,3]),x=g.map(w=>h.options[w]),N=g.indexOf(h.answerIndex);return{...h,options:x,answerIndex:N}});return console.log("Final questions:",d.length),{questions:d,poolSize:l.length}}function d3(){const t=Ye(),{category:e}=Aj(),n=Pt(),{energy:r,useEnergy:i,player:a,updateDailyStreak:o}=Wr(),l=new URLSearchParams(n.search),u=l.get("review")==="1",d=l.get("retake")==="1",h=n.state||{},g=h.mode||"quiz",x=String(h.difficulty||"medium").toLowerCase(),N=h.returnPath||null,w=h.fromQuest||!1,k=l3(Number(h.count||10),1,50),I=h.timer||{type:"per_q",seconds:45};h.resume,h.daily,h.source;const C=d||!!h.retake,_=!!h.fromHistory,v=g==="practice";console.log("Quiz Component - Mode Detection:",{routerState:h,mode:g,isPractice:v,location:n.pathname,state:n.state});const[P,D]=f.useState([]),[L,E]=f.useState(!0),[m,y]=f.useState(""),[j,A]=f.useState({questions:[]}),[T,S]=f.useState("quiz"),[G,Z]=f.useState(null),[te,K]=f.useState(null),[$,O]=f.useState(0);f.useEffect(()=>{let q=!0;return(async()=>{try{const ee=await c3();if(!q)return;D(ee)}catch(ee){console.error(ee),y("Failed to load questions. Check /public/data/quiz_questions_bank.csv")}finally{E(!1)}})(),()=>{q=!1}},[]),f.useEffect(()=>{var q;if((q=n.state)!=null&&q.returnToResults){const ee=ye.getCurrentResults();ee&&(Z(ee),S("results"),E(!1),A({questions:[]}))}},[n.state]),f.useEffect(()=>{var ee;if(L||m||u||T==="review"||(ee=n.state)!=null&&ee.returnToResults||P.length===0)return;console.log("=== SESSION INIT ==="),console.log("Category:",e),console.log("Mode:",g),console.log("Difficulty:",x),console.log("Count:",k);const q=u3(P,{categorySlug:e,difficulty:x,count:k});if(q.questions.length===0){console.error("No questions found!"),console.log("Looking for category:",e),console.log("Available categories (first 10):",[...new Set(P.map(X=>vc(X.category)))].slice(0,10)),y(`No questions found for "${Ti(e)}" with difficulty "${x}"`);return}console.log("Session built with",q.questions.length,"questions"),S("quiz"),Z(null),A(q),K(Date.now()),O(0)},[P,e,g,x,k,n.pathname]),f.useEffect(()=>{if(u){console.log("Review mode detected from URL");try{const q=localStorage.getItem(Wd);if(!q){console.error("No review snapshot in localStorage");return}const ee=JSON.parse(q);console.log("Loaded review snapshot:",ee),Z({questions:(ee==null?void 0:ee.questions)||[],answers:(ee==null?void 0:ee.answers)||[],skipped:(ee==null?void 0:ee.skipped)||[],category:Ti(e),categorySlug:e,difficulty:x,mode:(ee==null?void 0:ee.mode)||"quiz",isPractice:(ee==null?void 0:ee.isPractice)||!1}),S("review"),E(!1)}catch(q){console.error("Error loading review snapshot:",q)}}},[u,e,x]),f.useEffect(()=>{if(T!=="quiz"||!te)return;const q=setInterval(()=>{O(Date.now()-te)},1e3);return()=>clearInterval(q)},[T,te]);const V=f.useCallback(q=>{console.log("Quiz completed - Mode:",g,"isPractice:",v,"Results:",q),console.log("handleQuizComplete called at:",new Date().toISOString());const ee=jt.getCurrentUser();if(ee&&ee.phone&&(mt.userId=null,mt.startSession(ee.phone)),mt.trackQuizAttempt({mode:v?"practice":"quiz",category:e,score:q.correct,totalQuestions:q.total,timeSpent:Math.floor($/1e3)}),window._quizCompleting){console.warn("Quiz completion already in progress, ignoring duplicate call");return}if(window._quizCompleting=!0,setTimeout(()=>{window._quizCompleting=!1},1e3),!q||!q.questions){console.error("Invalid results object:",q);return}const X=q.questions.filter((ae,ce)=>q.answers[ce]!==null&&q.answers[ce]!==ae.answerIndex).map(ae=>ae.id);try{const ae=Ya(Wx,[]),ce=Array.from(new Set([...X,...ae]));localStorage.setItem(Wx,JSON.stringify(ce))}catch(ae){console.error("Error saving mistakes:",ae)}try{const ae=Ya(Yx,{sessions:[]});ae.sessions.push({cat:Ti(e),mode:v?"practice":"quiz",total:q.total,correct:q.correct,skipped:q.skipped.filter(Boolean).length,ms:$,timestamp:Date.now(),earnedXP:v?0:q.correct*10,earnedCoins:v?0:q.correct*5}),localStorage.setItem(Yx,JSON.stringify(ae))}catch(ae){console.error("Error saving stats:",ae)}const Q={ts:Date.now(),slug:e,categoryLabel:Ti(e),mode:v?"practice":"quiz",difficulty:x,total:q.total,timer:v?null:I,ms:$,attempted:q.answers.filter(ae=>ae!==null).length,correct:q.correct,questions:q.questions,answers:q.answers,skipped:q.skipped,isPractice:v};try{localStorage.setItem(Kx,JSON.stringify(Q)),localStorage.setItem(Wd,JSON.stringify({questions:q.questions,answers:q.answers,skipped:q.skipped}));const ae=Ya(Xx,[]),J=[{id:Q.ts,ts:Q.ts,cat:Q.categoryLabel,slug:e,mode:v?"Practice":"Quiz",total:q.total,correct:q.correct,ms:$,snapshot:Q},...ae].slice(0,a3);localStorage.setItem(Xx,JSON.stringify(J))}catch(ae){console.error("Error saving snapshot:",ae)}localStorage.removeItem(i3);const oe=jt.getCurrentUser();if(oe&&oe.phone)if(v){const ae=ye.recordPracticeSession(oe.phone,{questionsCompleted:q.correct,correctAnswers:q.correct,category:e});q.earnedCoins=ae.coinsEarned}else{const ae=ye.recordQuizSession(oe.phone,{score:q.correct,totalQuestions:q.total,category:e,difficulty:x,mode:"quiz"});q.earnedCoins=ae.coinsEarned}else q.earnedCoins=0;o(),console.log("Setting review snapshot with:",{returnPath:N||"/",fromQuest:w||!1});const ue={...q,category:Ti(e),categorySlug:e,difficulty:x,mode:v?"practice":"quiz",elapsedMs:$,isPractice:v,hasTimer:!v,earnedXP:v?0:q.correct*10,earnedCoins:v?q.earnedCoins||0:q.correct*5,returnPath:N||"/",fromQuest:w||!1};ye.storeCurrentResults(ue),Z(ue),S("results")},[e,g,I,$,v,N,w,o]),B=()=>{const q=new Date;return`${q.getFullYear()}-${q.getMonth()+1}-${q.getDate()}`};f.useCallback(q=>{if(v&&w){const ee=JSON.parse(localStorage.getItem("questProgress")||"{}"),X=ee.practiceQuestions||0,Q=Math.min(X+q,15);ee.practiceQuestions=Q,ee.date=B(),localStorage.setItem("questProgress",JSON.stringify(ee)),console.log("Practice progress updated:",Q)}},[v,w]);const M=f.useCallback(()=>{N?t(N,{replace:!0}):_?t("/profile/history",{replace:!0,state:null}):t("/")},[_,t,N]),z=f.useCallback(()=>{console.log("Retake requested - Mode:",g,"isPractice:",v);const q=Ya(Kx,null);if(!q||q.slug!==e){t(`/quiz/${e}?r=${Date.now()}`,{replace:!0,state:{mode:v?"practice":"quiz",difficulty:x,count:k,timer:v?null:I,retake:!0}});return}const ee=q.questions.map(X=>{const Q=t2([0,1,2,3]);return{...X,options:Q.map(oe=>X.options[oe]),answerIndex:Q.indexOf(X.answerIndex)}});A({questions:ee,poolSize:ee.length}),K(Date.now()),O(0),S("quiz"),window.scrollTo(0,0)},[e,g,x,k,I,t,v]),H=f.useCallback((q=null)=>{if(q)Z(q);else if(!G){const ee=Ya(Wd,null);ee&&Z({questions:ee.questions||[],answers:ee.answers||[],skipped:ee.skipped||[]})}S("review")},[G]),ne=f.useCallback(()=>{_?t("/profile/history",{replace:!0}):S("results")},[_,t]);return L?s.jsx("div",{className:"fixed inset-0 bg-inherit text-white flex items-center justify-center",children:s.jsx("div",{className:"text-sm text-base-muted",children:"Loading questions"})}):m?s.jsx("div",{className:"fixed inset-0 bg-inherit text-white flex items-center justify-center",children:s.jsx("div",{className:"text-sm text-red-400",children:m})}):(console.log("Render - Current view:",T,"Session questions:",j.questions.length,"Mode:",g,"isPractice:",v),s.jsx("div",{className:"fixed inset-0 bg-inherit text-white z-0 overflow-hidden max-w-[100vw]",children:s.jsxs("div",{className:"h-full overflow-hidden px-0",children:[T==="quiz"&&j.questions.length>0&&s.jsx("div",{className:"h-full",children:s.jsx(X4,{session:j,mode:v?"practice":"quiz",category:Ti(e),difficulty:x,timerConfig:v?null:I,onComplete:V,onQuit:M,isPractice:v})}),T==="results"&&G&&s.jsx(r3,{results:G,onRetake:z,onReview:()=>H(G),isRetake:C,isPractice:v,player:a,categories:Jw,onNavigate:(q,ee)=>{console.log("onNavigate called with:",q,ee),ee!=null&&ee.state?t(q,{state:ee.state,replace:ee.replace||!1}):t(q)}}),T==="review"&&G&&s.jsx(s3,{questions:G.questions||[],answers:G.answers||[],skipped:G.skipped||[],onBack:ne,onRetake:z,fromHistory:_,isPractice:v})]})}))}const ts=[{label:"General Knowledge",slug:"general-knowledge",color:"#7C3AED",soon:!1},{label:"Current Affairs",slug:"current-affairs",color:"#2563EB",soon:!1},{label:"Fun Facts",slug:"fun-facts",color:"#EF4444",soon:!1},{label:"Science",slug:"science",color:"#10B981",soon:!1},{label:"History",slug:"history",color:"#F59E0B",soon:!0},{label:"Geography",slug:"geography",color:"#FACC15",soon:!0},{label:"Cat 1",slug:"cat-1",color:"#06B6D4",soon:!0},{label:"Cat 2",slug:"cat-2",color:"#D946EF",soon:!0}],Gs=360/ts.length,h3=42,Yd=3e3,Jx=10,Zx=260,f3="cubic-bezier(.15,.7,.1,1)",m3="cubic-bezier(.2,.7,.2,1)",Zr=5,p3=5,g3=(t="")=>String(t).toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-");function x3({muted:t=!1,size:e=18}){return s.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24","aria-hidden":"true",children:[s.jsx("path",{d:"M3 9h4l5-4v14l-5-4H3z",fill:"currentColor"}),!t&&s.jsxs(s.Fragment,{children:[s.jsx("path",{d:"M16 8c1.5 1.5 1.5 6 0 7.5",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round"}),s.jsx("path",{d:"M19 6c3 3 3 10 0 13",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round"})]}),t&&s.jsx("line",{x1:"3",y1:"21",x2:"21",y2:"3",stroke:"#EF4444",strokeWidth:"2.5",strokeLinecap:"round"})]})}function y3({q:t,locked:e,onPick:n,result:r}){if(!t)return null;const i=[t.option1,t.option2,t.option3,t.option4];return s.jsxs("div",{className:"mt-5 rounded-3xl bg-white/5 border border-white/10 p-4",children:[s.jsx("div",{className:"text-sm text-base-muted mb-1",children:"Quick question"}),s.jsx("div",{className:"text-xl font-semibold mb-4",children:t.question}),i.map((a,o)=>{const l=r&&a===t.answer,u=r&&r.pick===a&&a!==t.answer;return s.jsx("button",{disabled:e||!!r,onClick:()=>n(a),className:["w-full text-left px-4 py-2 rounded-xl mb-2 border transition",!r&&!e?"bg-white/5 hover:bg-white/10 border-white/10":"bg-white/5 border-white/10",l?"bg-green-600/20 border-green-400/60 text-green-200":"",u?"bg-red-600/20 border-red-400/60 text-red-200":""].join(" "),children:a},o)}),r&&s.jsxs("div",{className:"mt-3 text-sm",children:[r.correct?s.jsx("span",{className:"text-green-400 font-medium",children:" Correct!"}):s.jsxs("span",{className:"text-red-400 font-medium",children:[" Not quite. Answer: ",s.jsx("b",{children:t.answer})]}),t.explanation&&s.jsxs("div",{className:"text-xs text-base-muted mt-1",children:["Tip: ",t.explanation]})]})]})}function v3(){const t=Ye(),[e]=Ft("/sounds/correct.mp3",{volume:.7}),[n]=Ft("/sounds/wrong.mp3",{volume:.7}),[r,i]=f.useState(()=>[{name:"Player 1",color:"#60A5FA",scores:Array(Zr).fill(null)},{name:"Player 2",color:"#F472B6",scores:Array(Zr).fill(null)}]),[a,o]=f.useState(0),[l,u]=f.useState(1),d=r.reduce((X,Q)=>X+Q.scores.reduce((oe,ue)=>oe+(ue??0),0),0),[h,g]=f.useState(!0),x=f.useRef(null);f.useEffect(()=>{const X=new Audio("/sounds/spin.mp3");return X.loop=!0,X.volume=.7,x.current=X,()=>{try{X.pause(),X.src=""}catch{}}},[]);const N=()=>{if(h&&x.current)try{x.current.currentTime=0,x.current.play()}catch{}},w=()=>{if(x.current)try{x.current.pause(),x.current.currentTime=0}catch{}},[k,I]=f.useState(0),[C,_]=f.useState("none"),[v,P]=f.useState(!1),[D,L]=f.useState(null),[E,m]=f.useState(null),y=f.useMemo(()=>typeof window<"u"?window.matchMedia("(prefers-reduced-motion: reduce)").matches:!1,[]),[j,A]=f.useState([]);f.useEffect(()=>{(async()=>{try{const X=await fetch("/data/quiz_questions_bank.csv").then(ae=>ae.text()),{data:Q}=wi.parse(X,{header:!0,skipEmptyLines:!0,transformHeader:ae=>String(ae).trim().toLowerCase()}),oe={a:0,b:1,c:2,d:3},ue=Q.map((ae,ce)=>{var pe;const J=(ae.question??"").trim();if(!J)return null;const W=[ae.option1,ae.option2,ae.option3,ae.option4].map(Ne=>String(Ne??"").trim());if(W.some(Ne=>!Ne))return null;let F=String(ae.answer??"").trim(),re=oe[F.toLowerCase()];if(re===void 0){const Ne=W.findIndex(Pe=>Pe.toLowerCase()===F.toLowerCase());re=Ne>=0?Ne:0}const le=W[re];return{id:((pe=ae.id)==null?void 0:pe.trim())||`ps_${ce}`,question:J,option1:W[0],option2:W[1],option3:W[2],option4:W[3],answer:le,explanation:String(ae.explanation??"").trim(),catSlug:g3(ae.category??ae.subject??"general knowledge"),difficulty:String(ae.difficulty??"medium").toLowerCase().trim()}}).filter(Boolean);A(ue)}catch{A([])}})()},[]);const[T,S]=f.useState(null),[G,Z]=f.useState(null),[te,K]=f.useState(!1),$=X=>(X%360+360)%360,O=X=>$(X),V=l>Zr;function B(){if(r.length>=4)return;const X=["#60A5FA","#F472B6","#F59E0B","#34D399","#F87171","#A78BFA"],Q=X[(r.length*2+1)%X.length];i(oe=>[...oe,{name:`Player ${oe.length+1}`,color:Q,scores:Array(Zr).fill(null)}])}function M(){r.length<=2||(i(X=>X.slice(0,-1)),o(X=>Math.min(X,r.length-2)))}function z(X){i(Q=>Q.map((oe,ue)=>ue===a?{...oe,scores:oe.scores.map((ae,ce)=>ce===l-1?X:ae)}:oe))}function H(){if(v||V)return;L(null),m(null),S(null),Z(null),P(!0),N();const X=Math.floor(Math.random()*ts.length),Q=ts[X],oe=Gs*.28,ue=(Math.random()*2-1)*oe,ae=$(k),ce=180,W=X*Gs+Gs/2+ue;let F=O(W-ae-ce);const re=h3*360+F,le=k+re+Jx;_(`transform ${y?800:Yd}ms ${f3}`),I(le);try{navigator.vibrate&&!y&&navigator.vibrate([10,40,10])}catch{}setTimeout(()=>{_(`transform ${y?160:Zx}ms ${m3}`),I(pe=>pe-Jx)},y?800:Yd),setTimeout(()=>{if(w(),P(!1),L(X),m(Q.color),Q.soon)return;const pe=j.filter(Pe=>Pe.catSlug===Q.slug&&Pe.difficulty==="easy"),Ne=pe.length?pe:j.filter(Pe=>Pe.catSlug===Q.slug);if(Ne.length){const Pe=Ne[Math.floor(Math.random()*Ne.length)];S(Pe)}else S({question:"No question found for this category yet. Try re-spinning!",option1:"Okay",option2:"Okay",option3:"Okay",option4:"Okay",answer:"Okay",explanation:""})},(y?800:Yd)+(y?160:Zx)+40)}function ne(X){if(!T||G)return;const Q=X===T.answer;if(Z({correct:Q,pick:X}),Q){e(),K(!0),setTimeout(()=>K(!1),900);try{navigator.vibrate&&navigator.vibrate([8,16])}catch{}z(p3)}else{n();try{navigator.vibrate&&navigator.vibrate([4])}catch{}z(0)}}function q(){const X=(a+1)%r.length,Q=X===0?l+1:l;o(X),u(Q),L(null),m(null),S(null),Z(null)}function ee(){const X=r.map(ue=>ue.scores.reduce((ae,ce)=>ae+(ce??0),0)),Q=Math.max(...X),oe=r.filter((ue,ae)=>X[ae]===Q).map(ue=>ue.name).join(", ");alert(`${oe} win${oe.includes(",")?"":"s"} the pot of ${d} coins! `),t("/play")}return s.jsxs("div",{className:"min-h-screen bg-black text-white",children:[te&&s.jsx(Zw,{numberOfPieces:120,recycle:!1}),s.jsxs("div",{className:"mx-auto max-w-md px-5 pt-[calc(env(safe-area-inset-top)+1.25rem)] pb-[calc(5.25rem+env(safe-area-inset-bottom))]",children:[s.jsxs("header",{className:"flex items-center justify-between mb-4",children:[s.jsx("button",{onClick:()=>t("/play"),className:"h-10 w-10 grid place-items-center rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition","aria-label":"Back",children:""}),s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Party Spin"}),s.jsx("p",{className:"text-sm text-base-muted",children:"Pass & play  Winner takes the pot"})]}),s.jsx("button",{onClick:()=>g(X=>!X),className:"h-10 w-10 grid place-items-center rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition","aria-label":h?"Mute sound":"Unmute sound",title:h?"Sound on":"Sound off",children:s.jsx(x3,{muted:!h})})]}),s.jsxs("section",{className:"rounded-2xl border border-white/10 bg-white/5 p-3 mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"text-sm",children:["Round ",s.jsx("b",{children:Math.min(l,Zr)}),"/",s.jsx("b",{children:Zr})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:B,className:"btn-ghost px-2 py-1 text-sm",children:"+"}),s.jsx("span",{className:"text-sm text-base-muted",children:"Player"}),s.jsx("button",{onClick:M,className:"btn-ghost px-2 py-1 text-sm",children:""})]}),s.jsxs("div",{className:"text-sm",children:["Pot: ",s.jsx("b",{className:"text-yellow-300",children:d})," "]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full table-fixed text-sm tracking-tight tabular-nums",children:[s.jsxs("colgroup",{children:[s.jsx("col",{style:{width:"42%"}}),s.jsx("col",{style:{width:"9%"}}),s.jsx("col",{style:{width:"9%"}}),s.jsx("col",{style:{width:"9%"}}),s.jsx("col",{style:{width:"9%"}}),s.jsx("col",{style:{width:"9%"}}),s.jsx("col",{style:{width:"13%"}})]}),s.jsx("thead",{children:s.jsxs("tr",{className:"text-base-muted",children:[s.jsx("th",{className:"text-left font-medium py-1 pr-1",children:"Player"}),Array.from({length:Zr}).map((X,Q)=>s.jsxs("th",{className:"font-medium text-center",children:["R",Q+1]},Q)),s.jsx("th",{className:"font-medium text-right pr-1",children:"Total"})]})}),s.jsx("tbody",{children:r.map((X,Q)=>{const oe=X.scores.reduce((ae,ce)=>ae+(ce??0),0),ue=Q===a;return s.jsxs("tr",{className:ue?"bg-white/6":"",children:[s.jsx("td",{className:"py-1 pr-1",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"inline-block h-3 w-3 rounded-full shrink-0",style:{background:X.color}}),s.jsx("input",{className:"bg-transparent outline-none font-semibold w-full",value:X.name,onChange:ae=>i(ce=>ce.map((J,W)=>W===Q?{...J,name:ae.target.value}:J))})]})}),X.scores.map((ae,ce)=>s.jsx("td",{className:"text-center",children:ae===null?"":ae},ce)),s.jsx("td",{className:"text-right pr-1 font-semibold",children:oe})]},Q)})})]})})]}),s.jsx("section",{className:"flex flex-col items-center",children:s.jsxs("div",{className:"relative w-[320px] h-[320px] md:w-[380px] md:h-[380px] rounded-full select-none",children:[E&&s.jsx("div",{className:"pointer-events-none absolute -inset-2 rounded-full",style:{boxShadow:`0 0 0 6px ${E}33, 0 0 30px 8px ${E}44`}}),s.jsx("div",{className:"absolute inset-0 rounded-full border border-white/10 shadow-2xl bg-black/20 overflow-hidden will-change-transform",style:{transform:`rotate(${k}deg)`,transition:C},"aria-label":"Category wheel",role:"group",children:s.jsxs("svg",{width:"100%",height:"100%",viewBox:"0 0 100 100",className:"block",children:[ts.map((X,Q)=>{const oe=Q*Gs,ue=oe+Gs,ae=Gs>180?1:0,ce=Math.PI*oe/180,J=Math.PI*ue/180,W=50+50*Math.cos(ce),F=50-50*Math.sin(ce),re=50+50*Math.cos(J),le=50-50*Math.sin(J),pe=D===Q;return s.jsxs("g",{style:{opacity:D==null?.95:pe?1:.78,filter:D!=null&&!pe?"blur(0.6px)":"none"},children:[s.jsx("path",{d:`M50,50 L${W},${F} A50,50 0 ${ae} 0 ${re},${le} Z`,fill:X.color,stroke:pe?`${X.color}AA`:"rgba(255,255,255,0.14)",strokeWidth:pe?"1.2":"0.6"}),s.jsx("text",{x:"50",y:"50",fill:"#ffffff",fontSize:"4",fontWeight:"700",dominantBaseline:"middle",transform:`rotate(${oe+Gs/2} 50 50) translate(12 0)`,children:s.jsxs("tspan",{children:[X.label,X.soon?" (soon)":""]})})]},X.slug)}),s.jsx("circle",{cx:"50",cy:"50",r:"9",fill:"rgba(0,0,0,0.55)",stroke:"white",strokeOpacity:"0.25"})]})}),s.jsx("button",{onClick:H,disabled:v||V,className:["absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2","h-16 w-16 rounded-full grid place-items-center","bg-white text-black font-extrabold shadow-soft transition active:scale-[0.98]",v||V?"opacity-60 cursor-not-allowed":"hover:bg-gray-200"].join(" "),"aria-label":"Spin the wheel",children:"SPIN"}),s.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 -bottom-3 z-20",children:s.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 4 L20 20 L4 20 Z",fill:"#ffffff"})})}),D!=null&&!v&&s.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 -bottom-10",children:s.jsxs("div",{className:"px-3 py-1 rounded-full bg-white/10 border border-white/20 text-sm backdrop-blur",children:[s.jsx("span",{className:"inline-block h-2.5 w-2.5 rounded-full mr-2 align-middle",style:{background:ts[D].color}}),ts[D].label]})})]})}),s.jsx("section",{className:"mt-4",children:V?s.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:[s.jsx("div",{className:"text-xl font-semibold mb-2",children:"Match Over"}),s.jsxs("p",{className:"text-sm text-base-muted mb-3",children:["Top score takes the pot of ",s.jsx("b",{className:"text-yellow-300",children:d})," coins."]}),s.jsx("button",{className:"btn-primary w-full",onClick:ee,children:"End match"})]}):D!=null&&ts[D].soon?s.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:[s.jsx("div",{className:"text-lg font-semibold mb-1",children:ts[D].label}),s.jsx("p",{className:"text-sm text-base-muted mb-3",children:"This category is arriving soon. Spin again!"}),s.jsx("button",{className:"btn-primary",onClick:H,disabled:v,children:"Re-spin"})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"text-sm text-center text-base-muted mb-1",children:["Turn: ",s.jsx("span",{style:{color:r[a].color},children:r[a].name})," ","| Round ",l,"/",Zr]}),s.jsx(y3,{q:T,locked:v||!T,onPick:ne,result:G}),G&&s.jsx("div",{className:"mt-3 flex justify-center",children:s.jsx("button",{className:"btn-primary",onClick:q,children:"Next turn"})})]})})]}),s.jsx("div",{className:"pointer-events-none fixed inset-x-0 bottom-0 bg-[#0B0F1A]",style:{height:"calc(5.25rem + env(safe-area-inset-bottom))"},"aria-hidden":!0})]})}const b3=({onSelect:t})=>{const e=[{id:"random",emoji:"",title:"Random Mix",color:"from-purple-500 to-pink-500"},{id:"trending",emoji:"",title:"Trending Now",color:"from-blue-500 to-cyan-500"},{id:"level",emoji:"",title:"Your Level",color:"from-green-500 to-teal-500"},{id:"daily",emoji:"",title:"Daily Challenge",color:"from-orange-500 to-red-500"}];return s.jsxs("div",{className:"fixed inset-0 bg-gray-900 overflow-hidden flex flex-col justify-center items-center px-4",children:[s.jsx("h1",{className:"text-2xl font-bold text-white mb-20",children:"Choose a swipe mode"}),s.jsx("div",{className:"grid grid-cols-2 gap-4 w-full max-w-md h-[55vh]",children:e.map(n=>s.jsxs("button",{onClick:()=>t(n.id,n.title),className:`rounded-3xl bg-gradient-to-br ${n.color} p-6 flex flex-col items-center justify-center gap-3 transform hover:scale-105 transition-all shadow-xl`,children:[s.jsx("span",{className:"text-5xl",children:n.emoji}),s.jsx("span",{className:"text-white font-bold text-lg text-center",children:n.title})]},n.id))})]})},w3=()=>{Ye(),Wr();const[t,e]=f.useState([]),[n,r]=f.useState(0),[i,a]=f.useState({}),[o,l]=f.useState(0),[u,d]=f.useState(5),[h,g]=f.useState(0),[x,N]=f.useState(!0),[w,k]=f.useState(null),[I,C]=f.useState(!0),[_,v]=f.useState(null),[P,D]=f.useState(""),[L,E]=f.useState(!1),[m,y]=f.useState(""),[j,A]=f.useState(!1),[T,S]=f.useState(!1),[G,Z]=f.useState(!1),[te,K]=f.useState(!1),[$,O]=f.useState(!1),[V,B]=f.useState(!1),[M,z]=f.useState(0),[H,ne]=f.useState(0),[q,ee]=f.useState(-1),[X,Q]=f.useState(-1),[oe,ue]=f.useState({}),[ae,ce]=f.useState({}),[J,W]=f.useState(ye.getCoins()),F=f.useRef(null),[re,le]=f.useState(null),[pe,Ne]=f.useState(!1),Pe=f.useRef(null),De=f.useRef(null),[xt]=Ft("/sounds/correct.mp3",{volume:.6}),[Be]=Ft("/sounds/wrong.mp3",{volume:.6}),[ge]=Ft("/sounds/coin.mp3",{volume:.75}),Te=["","","","","","","","","",""],Ie=()=>{e([]),r(0),a({}),l(0),d(5),g(0),N(!0),k(null),E(!1),y(""),A(!1),S(!1),Z(!1),K(!1),O(!1),B(!1),z(0),ne(0),ee(-1),Q(-1),ue({}),ce({}),v(null),D(""),Oe(null),Ne(!1)};f.useEffect(()=>(Ie(),C(!0),()=>{document.body.classList.remove("hide-bottom-nav"),Ie(),De.current&&clearTimeout(De.current)}),[]),f.useEffect(()=>{const me=Se=>{!I&&t.length>0&&(Se.preventDefault(),S(!0))};return!I&&t.length>0&&window.history.pushState({inQuiz:!0},"",window.location.pathname),window.addEventListener("popstate",me),()=>window.removeEventListener("popstate",me)},[I,t.length]),f.useEffect(()=>{!I&&t.length>0?document.body.classList.add("hide-bottom-nav"):document.body.classList.remove("hide-bottom-nav")},[I,t.length]),f.useEffect(()=>{!I&&t.length>0&&K(!0)},[I,t.length]);const[Me,Oe]=f.useState(null);f.useEffect(()=>{const me=Se=>{var Ue;if(te&&!G){const Fe=Se.target.closest('button[type="button"]'),nt=(Ue=Fe==null?void 0:Fe.querySelector(".text-\\[10px\\]"))==null?void 0:Ue.textContent;nt&&["Home","Play","Profile","Swipe"].includes(nt)&&(Se.preventDefault(),Se.stopPropagation(),Oe({Home:"/",Play:"/play",Profile:"/profile",Swipe:"/swipe"}[nt]),S(!0))}};return document.addEventListener("click",me,!0),()=>document.removeEventListener("click",me,!0)},[te,G]),f.useEffect(()=>{const me=Pe.current;if(!me)return;let Se=!1,Ue=0,Fe=null;const nt=ve=>{!I&&t.length>0&&ve.preventDefault()},ze=ve=>{Ue=ve.touches[0].clientY,Se=!1},rt=ve=>{!I&&t.length>0&&!T&&!j&&ve.preventDefault()},Ze=ve=>{if(Se||T||j)return;const Ee=ve.changedTouches[0].clientY,ke=Ue-Ee;if(Math.abs(ke)>30){if(Se=!0,Fe&&clearTimeout(Fe),ke>0&&n<t.length-1){const at=n+1;r(at),me.scrollTo({top:at*window.innerHeight,behavior:"smooth"})}else if(ke<0&&n>0){const at=n-1;r(at),me.scrollTo({top:at*window.innerHeight,behavior:"smooth"})}Fe=setTimeout(()=>{Se=!1},800)}};return me.addEventListener("touchstart",ze,{passive:!1}),me.addEventListener("touchmove",rt,{passive:!1}),me.addEventListener("touchend",Ze,{passive:!1}),me.addEventListener("wheel",nt,{passive:!1}),()=>{me.removeEventListener("touchstart",ze),me.removeEventListener("touchmove",rt),me.removeEventListener("touchend",Ze),me.removeEventListener("wheel",nt),Fe&&clearTimeout(Fe)}},[n,t.length,I]),f.useEffect(()=>{const me=Pe.current;me&&(T||j?(me.style.overflow="hidden",me.style.touchAction="none"):(me.style.overflow="auto",me.style.touchAction="auto"))},[T,j]),f.useEffect(()=>{(T||j)&&De.current&&(clearTimeout(De.current),De.current=null)},[T,j]);const yt=async me=>{try{const Ue=await(await fetch("/data/quiz_questions_bank.csv")).text(),{data:Fe}=wi.parse(Ue,{header:!0,skipEmptyLines:!0}),rt=Fe.map((Ze,ve)=>{var at,st;const Ee=[Ze.option1,Ze.option2,Ze.option3,Ze.option4].filter(Boolean),ke={A:0,B:1,C:2,D:3};return{id:Ze.id||`q_${ve}`,prompt:Ze.question,options:Ee,answerIndex:ke[(at=Ze.answer)==null?void 0:at.toUpperCase()]||0,category:Ze.category||"General Knowledge",difficulty:((st=Ze.difficulty)==null?void 0:st.toLowerCase())||"medium",explanation:Ze.explanation||"",stats:{views:Math.floor(Math.random()*1e4)+1e3,attempted:Math.floor(Math.random()*5e3)+500,correctRate:Math.floor(Math.random()*40)+30}}}).filter(Ze=>Ze.prompt&&Ze.options.length===4).sort(()=>Math.random()-.5).slice(0,50).map(Ze=>({...Ze,mascot:Te[Math.floor(Math.random()*Te.length)]}));e(rt),N(!1)}catch(Se){console.error("Failed to load questions:",Se),N(!1)}},Vt=me=>me===1||me===3||me===7||me===10||me===15||me===20||me>20&&me%5===0,wt=(me,Se)=>{if(i[me]!==void 0)return;const Ue=t.find(ze=>ze.id===me),Fe=Se===Ue.answerIndex,nt=t.findIndex(ze=>ze.id===me);if(a(ze=>({...ze,[me]:Se})),z(ze=>ze+1),ne(ze=>ze+1),Fe){xt(),l(rt=>rt+1),g(rt=>rt+2),ye.addCoins(2,"Swipe Quiz Correct Answer");const ze=ye.getCoins();if(W(ze),B(!0),setTimeout(()=>{ge(),console.log("Coin pill ref:",F.current),F.current?le({startRect:{left:window.innerWidth/2-50,top:window.innerHeight/2,width:100,height:100},count:2,amount:2}):console.log("Coin pill ref not available")},300),setTimeout(()=>B(!1),2e3),Ge(),Vt(nt+1)){const rt=["Awesome!","Perfect!","Brilliant!","Outstanding!","Incredible!"];y(rt[Math.floor(Math.random()*rt.length)]),E(!0),setTimeout(()=>E(!1),2e3)}}else if(Be(),l(0),O(!0),setTimeout(()=>O(!1),1500),d(ze=>{const rt=Math.max(0,ze-1);return rt===0&&setTimeout(()=>A(!0),500),rt}),u>1&&Vt(nt+1)){const ze=["Keep trying!","You got this!","Don't give up!","Stay strong!","Keep going!"];y(ze[Math.floor(Math.random()*ze.length)]),E(!0),setTimeout(()=>E(!1),2e3)}(u>1||Fe)&&(De.current=setTimeout(()=>{ot()},2500))},Ge=()=>{const me=document.createElement("div");me.style.position="fixed",me.style.inset="0",me.style.pointerEvents="none",me.style.zIndex="1000",document.body.appendChild(me);const Se=["","","","",""];for(let Ue=0;Ue<20;Ue++){const Fe=document.createElement("div");Fe.textContent=Se[Math.floor(Math.random()*Se.length)],Fe.style.position="fixed",Fe.style.left=`${Math.random()*100}%`,Fe.style.top="-50px",Fe.style.fontSize="24px",Fe.style.animation=`fall ${2+Math.random()*2}s ease-out`,me.appendChild(Fe)}setTimeout(()=>me.remove(),4e3)},ot=()=>{if(!(T||j)&&n<t.length-1){const me=n+1,Se=document.getElementById(`question-${me}`);Se==null||Se.scrollIntoView({behavior:"smooth"}),r(me)}},qt=me=>{const Se=t.findIndex(ze=>ze.id===me);if(q>=0&&M<5){k(`After ${5-M} attempts`),setTimeout(()=>k(null),2e3);return}const Ue=t[Se],nt=[0,1,2,3].filter(ze=>ze!==Ue.answerIndex).sort(()=>Math.random()-.5).slice(0,2);ue({...oe,[me]:nt}),ee(Se),z(0)},Cn=me=>{const Se=t.findIndex(ve=>ve.id===me);if(X>=0&&H<5){k(`After ${5-H} attempts`),setTimeout(()=>k(null),2e3);return}const Fe=t[Se].answerIndex,nt=[0,0,0,0],ze=40+Math.floor(Math.random()*31);nt[Fe]=ze;let rt=100-ze;const Ze=[0,1,2,3].filter(ve=>ve!==Fe);for(let ve=0;ve<Ze.length-1;ve++){const Ee=Math.floor(Math.random()*(rt/2));nt[Ze[ve]]=Ee,rt-=Ee}nt[Ze[Ze.length-1]]=rt,ce({...ae,[me]:nt}),Q(Se),ne(0)},tn=(me,Se)=>{Ie(),v(me),D(Se),C(!1),yt()},mn=()=>{Oe("/swipe"),S(!0)},Tn=()=>{Z(!0),S(!1),document.body.classList.remove("hide-bottom-nav")},hr=()=>{const me=Object.keys(i).filter(Se=>{const Ue=t.find(Fe=>Fe.id===Se);return i[Se]===(Ue==null?void 0:Ue.answerIndex)}).length;return f.useEffect(()=>{const Se=ye.getCoins();W(Se)},[]),f.useEffect(()=>{document.body.classList.add("hide-bottom-nav"),h>0&&F.current&&!pe&&(Ne(!0),setTimeout(()=>{le({startRect:{left:window.innerWidth/2-50,top:window.innerHeight/2,width:100,height:100},count:Math.min(h,10),amount:h}),ge()},100));const Se=setTimeout(()=>{const Ue=ye.getCoins();W(Ue),Ie(),K(!1),Z(!1),C(!0),document.body.classList.remove("hide-bottom-nav")},2e3);return()=>{clearTimeout(Se),document.body.classList.remove("hide-bottom-nav")}},[h,pe]),s.jsxs("div",{className:"fixed inset-0 bg-gray-900 z-50",children:[re&&s.jsx(Ds,{startRect:re.startRect,targetRef:F,count:re.count,onDone:()=>{le(null)}}),s.jsx("div",{className:"fixed top-12 right-4 z-50",children:s.jsxs("div",{ref:F,className:"flex items-center gap-1 bg-yellow-500/20 px-3 py-1.5 rounded-full backdrop-blur",children:[s.jsx("span",{children:""}),s.jsx("span",{className:"font-bold text-yellow-400",children:J})]})}),s.jsx("div",{className:"flex items-center justify-center p-4 h-full",children:s.jsxs("div",{className:"bg-gray-800 rounded-3xl p-8 max-w-md w-full text-center border border-gray-700",children:[s.jsx("div",{className:"text-5xl mb-4",children:""}),s.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Session Complete!"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-700/50 rounded-xl p-4",children:[s.jsx("div",{className:"text-gray-400 text-sm mb-1",children:"Questions Answered"}),s.jsx("div",{className:"text-2xl font-bold text-white",children:Object.keys(i).length})]}),s.jsxs("div",{className:"bg-gray-700/50 rounded-xl p-4",children:[s.jsx("div",{className:"text-gray-400 text-sm mb-1",children:"Correct Answers"}),s.jsx("div",{className:"text-2xl font-bold text-green-400",children:me})]}),s.jsxs("div",{className:"bg-gray-700/50 rounded-xl p-4",children:[s.jsx("div",{className:"text-gray-400 text-sm mb-1",children:"Coins Earned"}),s.jsxs("div",{className:"text-2xl font-bold text-yellow-400",children:[" ",h]})]}),s.jsxs("div",{className:"bg-gray-700/50 rounded-xl p-4",children:[s.jsx("div",{className:"text-gray-400 text-sm mb-1",children:"Lives Remaining"}),s.jsx("div",{className:"text-2xl font-bold text-red-400",children:Array.from({length:5},(Se,Ue)=>s.jsx("span",{className:Ue<u?"":"opacity-30",children:""},Ue))})]})]})]})})]})};return G?s.jsx(hr,{}):I?s.jsx(b3,{onSelect:tn}):x?s.jsx("div",{className:"h-screen bg-gray-900 flex items-center justify-center",children:s.jsx("div",{className:"text-white",children:"Loading questions..."})}):s.jsxs("div",{className:"h-screen bg-gray-900 relative",children:[re&&s.jsx(Ds,{startRect:re.startRect,targetRef:F,count:re.count,onDone:()=>{const me=ye.getCoins();W(me),le(null)}}),s.jsxs("div",{className:"fixed top-0 left-0 right-0 bg-gray-900/95 backdrop-blur z-50 border-b border-gray-800 pt-12",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[s.jsx("button",{onClick:mn,className:"inline-flex items-center gap-2 px-4 py-2 bg-white/10 backdrop-blur-md border border-white/15 rounded-xl text-white text-sm font-medium hover:bg-white/15 transition-all",children:" Back"}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{ref:F,className:"flex items-center gap-1 bg-yellow-500/20 px-3 py-1 rounded-full",children:[s.jsx("span",{children:""}),s.jsx("span",{className:"font-bold text-yellow-400",children:J})]}),s.jsxs("div",{className:"flex items-center gap-1 bg-orange-500/20 px-3 py-1 rounded-full",children:[s.jsx("span",{children:""}),s.jsx("span",{className:"font-bold text-orange-400",children:o})]})]}),s.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:5},(me,Se)=>s.jsx("span",{className:`${Se<u?"text-red-500":"text-gray-600 opacity-30"} ${$&&Se===u-1?"animate-heartLoss":""}`,children:""},Se))})]}),P&&s.jsx("div",{className:"text-center py-1",children:s.jsx("span",{className:"text-xs text-gray-400",children:P})})]}),V&&s.jsx("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-[100] pointer-events-none",children:s.jsx("div",{className:"bg-yellow-500 text-white px-6 py-3 rounded-full font-bold text-2xl animate-coinFloat",children:"+2 "})}),s.jsx("div",{ref:Pe,className:"h-full overflow-y-hidden snap-y snap-mandatory pt-32",style:{scrollBehavior:"smooth",overscrollBehavior:"none",WebkitOverflowScrolling:"touch",touchAction:"none"},children:t.map((me,Se)=>s.jsx(N3,{question:me,index:Se,answered:i[me.id],onAnswer:Ue=>wt(me.id,Ue),onFiftyFifty:()=>qt(me.id),onAudience:()=>Cn(me.id),eliminated:oe[me.id]||[],audiencePercentages:ae[me.id],canUseFiftyFifty:q<0||M>=5,canUseAudience:X<0||H>=5},me.id))}),j&&s.jsx("div",{className:"fixed inset-0 bg-black/75 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-gray-800 rounded-3xl p-6 max-w-sm w-full text-center border border-gray-700",children:[s.jsx("div",{className:"text-5xl mb-4",children:""}),s.jsx("h3",{className:"text-xl font-bold mb-2 text-white",children:"No Lives Left!"}),s.jsx("p",{className:"text-gray-400 mb-6",children:"Sorry, you have no lives left to continue swiping."}),s.jsx("button",{onClick:()=>{Z(!0),document.body.classList.remove("hide-bottom-nav")},className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 py-3 rounded-xl text-white font-medium",children:"View Results"})]})}),T&&s.jsx("div",{className:"fixed inset-0 bg-black/75 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-gray-800 rounded-3xl p-6 max-w-sm w-full text-center border border-gray-700",children:[s.jsx("div",{className:"text-4xl mb-4",children:""}),s.jsx("h3",{className:"text-xl font-bold mb-2 text-white",children:"Leave Swipe Mode?"}),s.jsx("p",{className:"text-gray-400 mb-6",children:"Your progress will be saved"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>S(!1),className:"flex-1 bg-blue-600 hover:bg-blue-700 py-3 rounded-xl font-medium text-white",children:"Stay"}),s.jsx("button",{onClick:Tn,className:"flex-1 bg-gray-700 hover:bg-gray-600 py-3 rounded-xl font-medium text-white",children:"Leave"})]})]})}),L&&s.jsx("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50",children:s.jsx("div",{className:"bg-gradient-to-br from-purple-600 to-pink-600 px-8 py-6 rounded-3xl text-white font-bold text-2xl shadow-2xl animate-fadeIn",children:m})}),w&&s.jsx("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50 pointer-events-none",children:s.jsx("div",{className:"bg-gray-800/90 px-6 py-3 rounded-full text-white font-bold animate-fadeIn",children:w})}),s.jsx("style",{jsx:!0,children:`
        @keyframes fadeIn {
          from { opacity: 0; transform: scale(0.9); }
          to { opacity: 1; transform: scale(1); }
        }
        .animate-fadeIn {
          animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fall {
          to { 
            transform: translateY(100vh) rotate(360deg);
            opacity: 0;
          }
        }
        
        @keyframes float {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-10px); }
        }
        
        @keyframes heartLoss {
          0% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.5) rotate(-15deg); opacity: 0.8; }
          100% { transform: scale(0) rotate(-45deg); opacity: 0; }
        }
        
        @keyframes coinFloat {
          0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
          50% { transform: translate(-50%, -70%) scale(1.2); opacity: 1; }
          100% { transform: translate(-50%, -100%) scale(0.8); opacity: 0; }
        }
        
        .animate-heartLoss {
          animation: heartLoss 1.5s ease-out;
        }
        
        .animate-coinFloat {
          animation: coinFloat 2s ease-out;
        }
      `})]})},N3=({question:t,index:e,answered:n,onAnswer:r,onFiftyFifty:i,onAudience:a,eliminated:o,audiencePercentages:l,canUseFiftyFifty:u,canUseAudience:d})=>{const h=g=>{switch(g){case"easy":return"from-green-500 to-green-600";case"hard":return"from-red-500 to-red-600";default:return"from-yellow-500 to-yellow-600"}};return s.jsxs("div",{id:`question-${e}`,className:"h-screen snap-start flex flex-col px-4 pb-4",style:{paddingTop:"150px"},children:[s.jsx("div",{className:"flex justify-center py-2",children:s.jsx("span",{className:"text-8xl",style:{animation:"float 3s ease-in-out infinite"},children:t.mascot})}),s.jsxs("div",{className:"flex-1 flex flex-col justify-start max-w-md mx-auto w-full",children:[s.jsxs("div",{className:`bg-gradient-to-br ${h(t.difficulty)} p-6 rounded-3xl mb-4`,children:[s.jsxs("div",{className:"text-white/80 text-sm mb-2",children:["Question ",e+1]}),s.jsx("h2",{className:"text-2xl font-bold text-white",children:t.prompt})]}),s.jsx("div",{className:"space-y-3 mb-3",children:t.options.map((g,x)=>{const N=n!==void 0,w=n===x,k=x===t.answerIndex,I=o.includes(x);let C="w-full p-4 rounded-2xl font-medium transition-all ";return I?C+="bg-gray-700/30 text-gray-500/50 cursor-not-allowed":N?k?C+="bg-green-500 text-white":w?C+="bg-red-500 text-white":C+="bg-gray-700 text-gray-400":C+="bg-gray-800 text-white hover:bg-gray-700",s.jsx("button",{onClick:()=>!N&&!I&&r(x),disabled:N||I,className:C,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-lg",children:["","","",""][x]}),s.jsx("span",{className:"flex-1 text-left",children:g}),l&&l[x]>0&&s.jsxs("span",{className:"bg-purple-600/20 px-2 py-1 rounded-full text-xs",children:[l[x],"%"]}),N&&k&&s.jsx("span",{children:""})]})},x)})}),!n&&s.jsxs("div",{className:"flex justify-center gap-3 mb-3",children:[s.jsx("button",{onClick:i,disabled:!u,className:`px-4 py-2 rounded-lg font-medium text-sm ${u?"bg-orange-600 text-white":"bg-gray-700 text-gray-500"}`,children:" 50:50"}),s.jsx("button",{onClick:a,disabled:!d,className:`px-4 py-2 rounded-lg font-medium text-sm ${d?"bg-purple-600 text-white":"bg-gray-700 text-gray-500"}`,children:" Audience"})]}),s.jsx("div",{className:"text-center mt-3 mb-2",children:s.jsxs("div",{className:"text-gray-500 text-xs",children:[t.stats.views.toLocaleString()," views  ",t.stats.attempted.toLocaleString()," attempted  ",t.stats.correctRate,"% correct"]})}),s.jsx("div",{className:"text-center mt-12 mb-4",children:s.jsx("div",{className:"text-gray-500 text-sm animate-bounce",children:"Swipe up for next"})})]})]})};function j3(){const[t]=D1(),e=Ye();return Pt(),f.useEffect(()=>{const n=t.get("category"),r=t.get("difficulty"),i=t.get("from")==="quest",a=["general-knowledge","fun-facts","science","history","geography","computer","artificial-intelligence","sports","mixed"],o=["easy","medium","hard"],l=n==="random"?a[Math.floor(Math.random()*a.length)]:n||"mixed",u=r==="random"?o[Math.floor(Math.random()*o.length)]:r||"medium";console.log("QuizPlay - fromQuest:",i),console.log("QuizPlay - returnPath will be:",i?"/quests":"/"),e(`/quiz/${l}`,{replace:!0,state:{mode:"quiz",difficulty:u,count:5,timer:{type:"per_q",seconds:45},fromQuest:i,returnPath:i?"/profile/quests":"/"}})},[t,e]),s.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontSize:"20px"},children:"Starting your quiz..."})}function S3(){const[t]=D1(),e=Ye();return f.useEffect(()=>{const n=t.get("questions")||"15",r=t.get("difficulty")||"easy",i=t.get("category")||"mixed",a=t.get("from")==="quest",o=["general-knowledge","fun-facts","science","history","geography","computer","artificial-intelligence","sports"],l=i==="random"?o[Math.floor(Math.random()*o.length)]:i;console.log("PracticeStart - Launching practice mode:",{category:l,difficulty:r,questions:n,fromQuest:a}),e(`/quiz/${l}`,{replace:!0,state:{mode:"practice",difficulty:r,count:parseInt(n),timer:{type:"off",seconds:0},fromQuest:a,questType:a?"practiceQuestions":null,returnPath:a?"/profile/quests":"/"}})},[t,e]),s.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",background:"linear-gradient(135deg, #10B981 0%, #059669 100%)",color:"white",fontSize:"20px"},children:"Loading practice questions..."})}/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),k3=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),ey=t=>{const e=k3(t);return e.charAt(0).toUpperCase()+e.slice(1)},n2=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),E3=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var C3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T3=f.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:o,...l},u)=>f.createElement("svg",{ref:u,...C3,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:n2("lucide",i),...!a&&!E3(l)&&{"aria-hidden":"true"},...l},[...o.map(([d,h])=>f.createElement(d,h)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=(t,e)=>{const n=f.forwardRef(({className:r,...i},a)=>f.createElement(T3,{ref:a,iconNode:e,className:n2(`lucide-${_3(ey(t))}`,`lucide-${t}`,r),...i}));return n.displayName=ey(t),n};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],A3=Ca("chevron-left",I3);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],P3=Ca("gift",R3);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D3=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],M3=Ca("lock",D3);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],O3=Ca("shield",L3);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F3=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],ty=Ca("sparkles",F3);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V3=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],z3=Ca("timer",V3);function $3({show:t,onClose:e,coins:n,onNavigateToPlay:r}){return t?s.jsxs("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",onClick:i=>{i.target===i.currentTarget&&e()},children:[s.jsxs("div",{className:"bg-gray-800 rounded-3xl p-6 w-full max-w-md border border-gray-700 relative overflow-hidden",onClick:i=>i.stopPropagation(),children:[s.jsx("div",{className:"absolute inset-0 opacity-10",children:s.jsx("div",{className:"h-full bg-gradient-to-br from-yellow-400 to-orange-500"})}),s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"text-5xl",style:{animation:"coinRotate 2s linear infinite"},children:""}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-2xl font-bold bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent",children:"Your Treasure"}),s.jsxs("p",{className:"text-3xl font-bold text-white mt-1",children:[n," Coins"]})]})]}),s.jsx("button",{onClick:e,className:"w-8 h-8 rounded-lg bg-white/5 border border-gray-600 grid place-items-center hover:bg-white/10 transition",children:""})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-3",children:"Ways to Earn"}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-r from-green-500/10 to-emerald-500/10 border border-green-500/20 hover:scale-[1.02] transition-transform",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:""}),"Complete Quizzes"]}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"+5 coins per correct answer"})]}),s.jsx("div",{className:"text-green-400 font-bold",children:"+5"})]})}),s.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-r from-blue-500/10 to-cyan-500/10 border border-blue-500/20 hover:scale-[1.02] transition-transform",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:""}),"Daily Challenge"]}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Complete daily for bonus"})]}),s.jsx("div",{className:"text-blue-400 font-bold",children:"+5"})]})}),s.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-r from-purple-500/10 to-pink-500/10 border border-purple-500/20 hover:scale-[1.02] transition-transform",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:""}),"Spin & Play"]}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Test your luck!"})]}),s.jsx("div",{className:"text-purple-400 font-bold",children:"+50"})]})}),s.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-r from-orange-500/10 to-red-500/10 border border-orange-500/20 hover:scale-[1.02] transition-transform",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:""}),"Achievements"]}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Unlock special rewards"})]}),s.jsx("div",{className:"text-orange-400 font-bold",children:"+???"})]})})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mb-2",children:[s.jsx("span",{children:"Next reward"}),s.jsxs("span",{children:[100-n%100," coins to go"]})]}),s.jsx("div",{className:"h-2 bg-white/10 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full transition-all",style:{width:`${n%100}%`}})})]}),s.jsx("button",{onClick:r,className:"w-full py-3 rounded-xl bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-bold hover:scale-[1.02] transition-transform shadow-lg",children:"Start Earning Now! "})]})]}),s.jsx("style",{children:`
        @keyframes coinRotate {
          from { transform: rotateY(0deg); }
          to { transform: rotateY(360deg); }
        }
      `})]}):null}function B3(){const t=Ye();f.useEffect(()=>(document.body.classList.add("hide-bottom-nav"),document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden",()=>{document.body.classList.remove("hide-bottom-nav"),document.body.style.overflow="",document.documentElement.style.overflow=""}),[]);const[e]=Ft("/sounds/correct.mp3",{volume:.6}),[n]=Ft("/sounds/coin.mp3",{volume:.7}),[r]=Ft("/sounds/click.mp3",{volume:.5}),[i]=Ft("/sounds/wrong.mp3",{volume:.5}),a=f.useRef(null),o=f.useRef({}),[l,u]=f.useState(!1),[d,h]=f.useState(ye.getCoins()),[g,x]=f.useState(null),[N,w]=f.useState([{id:"bronze",name:"Bronze",opened:!1,reward:null,minCoins:5,maxCoins:15,color:"from-amber-600 to-amber-700",glow:"shadow-amber-500/30",miniGame:"tap",tapsRequired:3,tapsCount:0},{id:"silver",name:"Silver",opened:!1,reward:null,minCoins:20,maxCoins:40,color:"from-gray-400 to-gray-500",glow:"shadow-gray-400/30",miniGame:"swipe",swipePattern:null,swipeComplete:!1},{id:"gold",name:"Gold",opened:!1,reward:null,minCoins:50,maxCoins:100,color:"from-yellow-400 to-yellow-500",glow:"shadow-yellow-400/30",xpChance:.7,miniGame:"hold",holdDuration:2,holdProgress:0,isHolding:!1}]),[k,I]=f.useState(!1),[C,_]=f.useState(0),[v,P]=f.useState(null),[D,L]=f.useState(""),[E,m]=f.useState(null),[y,j]=f.useState(null),[A,T]=f.useState(null);f.useEffect(()=>{S();const M=setInterval(G,1e3);return()=>clearInterval(M)},[]);const S=()=>{const M=new Date().toDateString(),z=ye.safeGet("surprise_zone_data");if(z&&z.date===M)w(z.boxes),_(z.totalEarned),P(z.date);else{const H=[{id:"bronze",name:"Bronze",opened:!1,reward:null,minCoins:5,maxCoins:15,color:"from-amber-600 to-amber-700",glow:"shadow-amber-500/30",miniGame:"tap",tapsRequired:3,tapsCount:0},{id:"silver",name:"Silver",opened:!1,reward:null,minCoins:20,maxCoins:40,color:"from-gray-400 to-gray-500",glow:"shadow-gray-400/30",miniGame:"tap",tapsRequired:3,tapsCount:0},{id:"gold",name:"Gold",opened:!1,reward:null,minCoins:50,maxCoins:100,color:"from-yellow-400 to-yellow-500",glow:"shadow-yellow-400/30",xpChance:.7,miniGame:"tap",tapsRequired:3,tapsCount:0}];w(H),_(0),P(M),ye.safeSet("surprise_zone_data",{date:M,boxes:H,totalEarned:0})}},G=()=>{const M=new Date,z=new Date(M);z.setDate(z.getDate()+1),z.setHours(0,0,0,0);const H=z-M,ne=Math.floor(H/(1e3*60*60)),q=Math.floor(H%(1e3*60*60)/(1e3*60)),ee=Math.floor(H%(1e3*60)/1e3);L(`${ne.toString().padStart(2,"0")}:${q.toString().padStart(2,"0")}:${ee.toString().padStart(2,"0")}`)};f.useEffect(()=>{const M=setInterval(()=>{const z=ye.getCoins();z!==d&&h(z)},100);return()=>clearInterval(M)},[d]);const Z=(M,z)=>{if(k)return;const H=N.findIndex(q=>q.id===M),ne=N[H];ne.opened||(j(M),ne.miniGame==="tap"&&z==="tap"?te(H):ne.miniGame==="swipe"&&z==="swipe"?K(H):ne.miniGame==="hold"&&(z==="holdStart"?$(H):z==="holdEnd"&&O(H)))},te=M=>{const z=N[M],H=z.tapsCount+1;r();const ne=[...N];ne[M]={...z,tapsCount:H},w(ne),H>=z.tapsRequired&&setTimeout(()=>V(z.id),300)},K=M=>{const z=N[M];r();const H=[...N];H[M]={...z,swipeComplete:!0},w(H),setTimeout(()=>V(z.id),300)},$=M=>{const z=N[M],H=[...N];H[M]={...z,isHolding:!0,holdProgress:0},w(H);let ne=0;const q=setInterval(()=>{ne+=.05;const ee=[...N],X=ee[M];ne>=z.holdDuration?(clearInterval(q),ee[M]={...X,holdProgress:z.holdDuration,isHolding:!1},w(ee),V(z.id)):X.isHolding?(ee[M]={...X,holdProgress:ne},w(ee)):clearInterval(q)},50);T(q)},O=M=>{A&&(clearInterval(A),T(null));const z=N[M];if(z.holdProgress<z.holdDuration){i();const H=[...N];H[M]={...z,isHolding:!1,holdProgress:0},w(H)}},V=async M=>{if(k)return;const z=N.findIndex(Q=>Q.id===M),H=N[z];if(H.opened)return;I(!0);const ne=Math.floor(Math.random()*(H.maxCoins-H.minCoins+1))+H.minCoins,ee=H.xpChance&&Math.random()<H.xpChance?Math.floor(Math.random()*50)+25:0;if(m({boxId:M,coins:ne,xpBonus:ee}),e(),await new Promise(Q=>setTimeout(Q,600)),o.current[M]&&a.current){const Q=o.current[M].getBoundingClientRect();n(),x({startRect:Q,count:Math.min(ne,15),amount:ne,xpBonus:ee})}const X=[...N];X[z]={...H,opened:!0,reward:{coins:ne,xpBonus:ee}},w(X),_(Q=>Q+ne),ye.safeSet("surprise_zone_data",{date:v,boxes:X,totalEarned:C+ne}),setTimeout(()=>{m(null),j(null)},2e3),I(!1)},B=N.every(M=>M.opened);return s.jsxs("div",{className:"fixed inset-0 bg-black text-white overflow-hidden flex flex-col",children:[s.jsx("div",{className:"fixed inset-0 bg-gradient-to-b from-gray-900/50 to-black pointer-events-none"}),g&&s.jsx(Ds,{startRect:g.startRect,targetRef:a,count:g.count,onDone:()=>{ye.addCoins(g.amount,"Lucky Box"),g.xpBonus>0&&ye.addXP(g.xpBonus),h(ye.getCoins()),x(null)}}),E&&s.jsx("div",{className:"fixed inset-0 z-50 pointer-events-none flex items-center justify-center",children:s.jsx("div",{className:"animate-bounce",children:s.jsx("div",{className:"bg-black/90 backdrop-blur-xl rounded-3xl p-6 border border-white/20",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ty,{className:"w-12 h-12 text-yellow-400 mx-auto mb-3"}),s.jsxs("p",{className:"text-3xl font-bold text-yellow-400",children:["+",E.coins]}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"coins"}),E.xpBonus>0&&s.jsxs("p",{className:"text-lg text-blue-400 mt-2",children:["+",E.xpBonus," XP"]})]})})})}),s.jsxs("div",{className:"relative z-10 px-6 pt-14 pb-4 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("button",{onClick:()=>t("/"),className:"w-10 h-10 rounded-full bg-white/10 backdrop-blur-xl flex items-center justify-center hover:bg-white/20 transition-all active:scale-95",children:s.jsx(A3,{className:"w-5 h-5"})}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Daily Surprise"}),s.jsx("h1",{className:"text-2xl font-semibold",children:"Lucky Boxes"})]}),s.jsxs("button",{ref:a,onClick:()=>u(!0),className:"px-3 py-1.5 rounded-full bg-yellow-500/20 backdrop-blur-xl flex items-center gap-2 hover:bg-yellow-500/30 transition-all border border-yellow-500/30",children:[s.jsx("span",{className:"text-lg",children:""}),s.jsx("span",{className:"font-bold text-yellow-400",children:d})]})]}),s.jsx("div",{className:"mx-auto max-w-sm mb-8",children:s.jsx("div",{className:"bg-white/5 backdrop-blur-xl rounded-2xl p-4 border border-white/10",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(z3,{className:"w-4 h-4 text-gray-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-400",children:"Next reset in"}),s.jsx("p",{className:"text-lg font-mono font-semibold",children:D||"00:00:00"})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xs text-gray-400",children:"Earned today"}),s.jsxs("p",{className:"text-lg font-semibold text-yellow-400",children:[C," coins"]})]})]})})}),!B&&s.jsx("div",{className:"text-center mb-6",children:s.jsx("p",{className:"text-sm text-gray-500",children:"Complete mini-games to unlock rewards!"})})]}),s.jsxs("div",{className:"relative z-10 px-6 pb-8 flex-1 overflow-hidden",children:[s.jsx("div",{className:"max-w-sm mx-auto space-y-4",children:N.map((M,z)=>{var H,ne;return s.jsx("div",{ref:q=>o.current[M.id]=q,className:"relative",style:{animation:`fadeInUp 0.5s ease-out ${z*100}ms both`},children:s.jsxs("button",{onClick:()=>Z(M.id,"tap"),onMouseDown:()=>M.miniGame==="hold"&&Z(M.id,"holdStart"),onMouseUp:()=>M.miniGame==="hold"&&Z(M.id,"holdEnd"),onMouseLeave:()=>M.miniGame==="hold"&&Z(M.id,"holdEnd"),onTouchStart:()=>M.miniGame==="hold"&&Z(M.id,"holdStart"),onTouchEnd:()=>M.miniGame==="hold"&&Z(M.id,"holdEnd"),disabled:M.opened||k,className:`
                  w-full relative overflow-hidden rounded-3xl p-8
                  transition-all duration-500 transform
                  ${M.opened?"bg-white/5 scale-95 opacity-60":`bg-gradient-to-br ${M.color} hover:scale-[1.02] active:scale-[0.98] shadow-2xl ${M.glow}`}
                  ${k&&!M.opened?"animate-pulse":""}
                  ${!M.opened&&M.id==="bronze"&&M.tapsCount===0?"animate-pulse ring-2 ring-yellow-400/50":""}
                  disabled:cursor-not-allowed
                `,children:[!M.opened&&y===M.id&&s.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[M.miniGame==="tap"&&s.jsx("div",{className:"absolute top-2 right-2 flex gap-1",children:[...Array(M.tapsRequired)].map((q,ee)=>s.jsx("div",{className:`w-2 h-2 rounded-full ${ee<M.tapsCount?"bg-white":"bg-white/30"}`},ee))}),M.miniGame==="hold"&&M.isHolding&&s.jsx("div",{className:"absolute inset-x-0 bottom-0 h-1 bg-white/20",children:s.jsx("div",{className:"h-full bg-white transition-all",style:{width:`${M.holdProgress/M.holdDuration*100}%`}})})]}),!M.opened&&s.jsx("div",{className:"absolute inset-0 opacity-10",children:s.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`radial-gradient(circle at 20% 50%, white 1px, transparent 1px),
                                       radial-gradient(circle at 80% 80%, white 1px, transparent 1px),
                                       radial-gradient(circle at 40% 80%, white 1px, transparent 1px)`,backgroundSize:"50px 50px"}})}),s.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[s.jsxs("div",{className:"text-left",children:[s.jsxs("p",{className:`text-sm font-medium ${M.opened?"text-gray-400":"text-white/80"}`,children:[M.name," Box"]}),s.jsx("p",{className:`text-2xl font-bold mt-1 ${M.opened?"text-gray-300":"text-white"}`,children:M.opened?s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-yellow-400",children:["+",(H=M.reward)==null?void 0:H.coins]}),s.jsx("span",{className:"text-sm",children:"coins"}),((ne=M.reward)==null?void 0:ne.xpBonus)>0&&s.jsxs("span",{className:"text-sm text-blue-400 ml-2",children:["+",M.reward.xpBonus," XP"]})]}):s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsxs("span",{children:[M.minCoins,"-",M.maxCoins]}),s.jsx("span",{className:"text-sm",children:"coins"})]})}),!M.opened&&s.jsxs("p",{className:"text-xs text-white/50 mt-1",children:[M.miniGame==="tap"&&`Tap ${M.tapsRequired} times`,M.miniGame==="hold"&&`Hold for ${M.holdDuration} seconds`]})]}),s.jsx("div",{className:`
                    w-16 h-16 rounded-2xl flex items-center justify-center
                    ${M.opened?"bg-white/10":"bg-white/20 backdrop-blur-xl"}
                    transition-all duration-300
                  `,children:M.opened?s.jsx(ty,{className:"w-8 h-8 text-yellow-400"}):y===M.id?s.jsx(O3,{className:"w-8 h-8 text-white animate-pulse"}):s.jsx(P3,{className:`w-8 h-8 text-white ${k?"":"animate-pulse"}`})})]})]})},M.id)})}),B&&s.jsxs("div",{className:"mt-6 text-center space-y-2",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 px-6 py-3 rounded-full bg-white/5 backdrop-blur-xl border border-white/10",children:[s.jsx(M3,{className:"w-4 h-4 text-gray-400"}),s.jsx("p",{className:"text-sm text-gray-400",children:"All boxes opened! Come back tomorrow"})]}),s.jsx("div",{className:"text-center",children:s.jsxs("p",{className:"text-2xl font-bold text-yellow-400",children:[" ",C," coins earned!"]})})]})]}),s.jsx($3,{show:l,onClose:()=>u(!1),coins:d,onNavigateToPlay:()=>{u(!1),t("/play")}}),s.jsx("style",{jsx:!0,children:`
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
      `})]})}function U3(){var N,w;const t=Ye(),[e,n]=f.useState(""),[r,i]=f.useState(null),{player:a,levelProgress:o}=Wr(),u=(()=>{const k=JSON.parse(localStorage.getItem("currentUser")||"{}");return((k.phone?JSON.parse(localStorage.getItem(`user_profile_${k.phone}`)||"{}"):{}).name||k.username||(a==null?void 0:a.name)||"Player").split(" ")[0]})(),d=()=>{if((r==null?void 0:r.todayCoins)!==void 0)return r.todayCoins;try{const k=JSON.parse(localStorage.getItem("qp_stats")||'{"sessions":[]}'),I=new Date().setHours(0,0,0,0);return k.sessions.filter(_=>new Date(_.timestamp).setHours(0,0,0,0)===I).reduce((_,v)=>_+(v.earnedCoins||0),0)}catch{return 0}},h={name:u,rank:(r==null?void 0:r.rank)||23,streak:(r==null?void 0:r.streak)||(a==null?void 0:a.currentStreak)||0,todayQuizzes:((N=r==null?void 0:r.daily)==null?void 0:N.quizzesPlayed)||3,todayCoins:d()};f.useEffect(()=>{const k=new Date().getHours();k<12?n("Good morning"):k<17?n("Good afternoon"):n("Good evening")},[]),f.useEffect(()=>{const k=()=>{const I=jt.getCurrentUser();if(I!=null&&I.phone){ye.initializeUserData(I.phone);const C=ye.getTodaySummary(I.phone);i(C)}};return k(),window.addEventListener("focus",k),()=>window.removeEventListener("focus",k)},[]);const g=`
    rounded-3xl p-5 text-left text-white 
    transition-all duration-300 ease-out
    active:scale-[0.97] hover:scale-[1.02]
    shadow-[0_8px_32px_rgba(0,0,0,0.3)]
    hover:shadow-[0_12px_48px_rgba(0,0,0,0.4)]
    relative overflow-hidden
    before:absolute before:inset-0 before:bg-white/5 before:opacity-0 
    hover:before:opacity-100 before:transition-opacity before:duration-300
  `,x=r!=null&&r.xpProgress?r.xpProgress/(r.xpNeeded||100)*100:o.required>0?o.current/o.required*100:0;return s.jsxs("div",{className:"min-h-full bg-[#0B0C10] text-white pt-4 px-3",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{children:s.jsxs("h1",{className:"text-2xl font-bold px-3",children:[e,", ",u," "]})}),["+919701019117"].includes((w=jt.getCurrentUser())==null?void 0:w.phone)&&s.jsx("button",{onClick:()=>t("/admin"),className:"w-10 h-10 rounded-2xl bg-gradient-to-br from-purple-500/20 to-blue-500/20 border border-purple-500/30 grid place-items-center hover:from-purple-500/30 hover:to-blue-500/30 transition mr-2",title:"Admin Dashboard",children:s.jsx("span",{className:"text-xl",children:""})}),s.jsx("button",{onClick:()=>t("/profile/settings"),className:"w-10 h-10 rounded-2xl bg-white/10 border border-white/20 grid place-items-center hover:bg-white/20 transition",children:s.jsx("span",{className:"text-xl",children:""})})]}),s.jsxs("div",{className:"rounded-3xl bg-gradient-to-r from-slate-800/50 to-slate-900/50 border border-white/10 p-4 backdrop-blur-sm",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[s.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-blue-500 to-purple-600 grid place-items-center text-2xl font-bold",children:u[0].toUpperCase()}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-lg font-semibold",children:u}),s.jsxs("div",{className:"text-white/60 text-sm",children:["Level ",(r==null?void 0:r.level)||a.level||1]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-yellow-400 font-bold text-lg",children:[(r==null?void 0:r.totalCoins)||a.coins||0," "]}),s.jsxs("div",{className:"text-white/60 text-sm",children:["Rank #",h.rank]})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("div",{className:"flex justify-between text-xs text-white/60 mb-1",children:[s.jsx("span",{children:"XP Progress"}),s.jsxs("span",{children:[(r==null?void 0:r.xpProgress)||o.current,"/",(r==null?void 0:r.xpNeeded)||o.required]})]}),s.jsx("div",{className:"h-2 bg-white/10 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-blue-400 to-purple-500 rounded-full transition-all duration-1000 ease-out",style:{width:`${x}%`}})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"text-center p-2 rounded-xl bg-white/5",children:[s.jsxs("div",{className:"text-orange-400 font-bold text-lg",children:[" ",h.streak]}),s.jsx("div",{className:"text-white/60 text-xs",children:"Day Streak"})]}),s.jsxs("div",{className:"text-center p-2 rounded-xl bg-white/5",children:[s.jsxs("div",{className:"text-green-400 font-bold text-lg",children:["+",h.todayCoins]}),s.jsx("div",{className:"text-white/60 text-xs",children:"Today"})]})]})]})]}),s.jsxs("button",{onClick:()=>t("/profile/leaderboard"),className:`${g} w-full mb-4 bg-gradient-to-br from-[#5AA9FF] via-[#6C63FF] to-[#9C6BFF]`,children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full -translate-y-8 translate-x-8 animate-pulse"}),s.jsxs("div",{className:"relative flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-xs opacity-90 mb-1",children:" Rank & Coins"}),s.jsx("div",{className:"text-3xl font-extrabold tracking-tight mb-2",children:"LEADERBOARD"}),s.jsxs("div",{className:"text-xs opacity-75 flex items-center gap-2",children:[s.jsx("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),"Weekly reset  Ends in 2d 14h"]})]}),s.jsx("div",{className:"w-16 h-16 rounded-2xl bg-white/20 backdrop-blur-sm grid place-items-center text-2xl border border-white/30",children:""})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("button",{onClick:()=>t("/profile/history"),className:`${g} bg-gradient-to-br from-[#D19A00] to-[#C94B4B] relative`,children:[s.jsx("div",{className:"absolute top-2 right-2 w-3 h-3 bg-white/20 rounded-full"}),s.jsx("div",{className:"text-3xl mb-3",children:""}),s.jsx("div",{className:"text-sm font-bold mb-1",children:"HISTORY"}),s.jsx("div",{className:"text-[11px] opacity-80",children:"Quizzes & Practice"}),s.jsxs("div",{className:"text-[10px] opacity-60 mt-1",children:["+",h.todayQuizzes," today"]})]}),s.jsxs("button",{onClick:()=>t("/profile/rewards"),className:`${g} bg-gradient-to-br from-[#2EB872] to-[#1EA07A] relative`,children:[s.jsx("div",{className:"absolute top-2 right-2 w-2 h-2 bg-red-500 rounded-full animate-bounce"}),s.jsx("div",{className:"text-3xl mb-3",children:""}),s.jsx("div",{className:"text-sm font-bold mb-1",children:"REWARDS"}),s.jsx("div",{className:"text-[11px] opacity-80",children:"Claim & Redeem"}),s.jsx("div",{className:"text-[10px] opacity-60 mt-1",children:"2 available"})]}),s.jsxs("button",{onClick:()=>t("/profile/badges"),className:`${g} bg-gradient-to-br from-[#E65C00] to-[#F9D423] relative`,children:[s.jsx("div",{className:"absolute -top-1 -right-1 w-6 h-6 bg-purple-600 rounded-full grid place-items-center text-[10px] font-bold animate-pulse",children:"NEW"}),s.jsx("div",{className:"text-3xl mb-3",children:""}),s.jsx("div",{className:"text-sm font-bold mb-1",children:"BADGES"}),s.jsx("div",{className:"text-[11px] opacity-80",children:"Collectables"}),s.jsx("div",{className:"text-[10px] opacity-60 mt-1",children:"4/15 unlocked"})]}),s.jsxs("button",{onClick:()=>t("/profile/achievements"),className:`${g} bg-gradient-to-br from-[#5D26C1] to-[#A17FE0] relative`,children:[s.jsx("div",{className:"text-3xl mb-3",children:""}),s.jsx("div",{className:"text-sm font-bold mb-1",children:"ACHIEVEMENTS"}),s.jsx("div",{className:"text-[11px] opacity-80",children:"Milestones"}),s.jsx("div",{className:"text-[10px] opacity-60 mt-1",children:"67% complete"})]})]}),s.jsxs("div",{className:"mt-4 space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx("button",{onClick:()=>t("/profile/streaks"),className:`${g} bg-gradient-to-r from-orange-600/80 to-red-600/80 backdrop-blur-sm border border-orange-500/30`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"text-2xl",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-bold",children:"STREAK"}),s.jsxs("div",{className:"text-[11px] opacity-80",children:[h.streak," days strong"]})]})]})}),s.jsx("button",{onClick:()=>t("/profile/quests"),className:`${g} bg-gradient-to-r from-blue-600/80 to-cyan-600/80 backdrop-blur-sm border border-blue-500/30`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"text-2xl",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-bold",children:"QUESTS"}),s.jsxs("div",{className:"text-[11px] opacity-80",children:[(r==null?void 0:r.activeQuests)||2," active goals"]})]})]})})]}),s.jsx("button",{onClick:()=>t("/profile/settings"),className:`${g} w-full bg-gradient-to-r from-slate-700/50 to-slate-800/50 backdrop-blur-sm border border-white/10`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-2xl bg-white/10 grid place-items-center text-xl",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-bold",children:"SETTINGS"}),s.jsx("div",{className:"text-[11px] opacity-70",children:"Customize your experience"})]})]}),s.jsx("div",{className:"text-white/40",children:""})]})})]}),s.jsx("div",{className:"h-6"})]})}const Ka="",Ql={global:[{rank:1,name:"Bryan Wolf",handle:"@bryan",score:43,avatar:"/profile/rank1.png",trend:"+5",streak:12,country:""},{rank:2,name:"Meghan Jess",handle:"@meghan",score:40,avatar:"/profile/rank2.png",trend:"+2",streak:8,country:""},{rank:3,name:"Alex Turner",handle:"@alex",score:38,avatar:"/profile/rank3.png",trend:"0",streak:15,country:""},{rank:4,name:"Marsha Fisher",handle:"@marsha",score:36,trend:"-1",streak:5,country:""},{rank:5,name:"Juanita Cormier",handle:"@juanita",score:35,trend:"+1",streak:3,country:""},{rank:6,name:"You",handle:"@you",score:34,you:!0,avatar:"/profile/avatar.png",trend:"+3",streak:7,country:""},{rank:7,name:"Tamara Schmidt",handle:"@tamara",score:33,trend:"-2",streak:2,country:""},{rank:8,name:"Ricardo Veum",handle:"@ricardo",score:32,trend:"+1",streak:4,country:""}],friends:[{rank:1,name:"You",handle:"@you",score:34,you:!0,avatar:"/profile/avatar.png",trend:"+2",streak:7,country:""},{rank:2,name:"Sarah Chen",handle:"@sarah",score:31,trend:"-1",streak:4,country:"",friend:!0},{rank:3,name:"Mike Johnson",handle:"@mike",score:29,trend:"+3",streak:2,country:"",friend:!0},{rank:4,name:"Priya Sharma",handle:"@priya",score:27,trend:"0",streak:5,country:"",friend:!0},{rank:5,name:"David Kim",handle:"@david",score:25,trend:"+1",streak:3,country:"",friend:!0},{rank:6,name:"Emma Wilson",handle:"@emma",score:23,trend:"-2",streak:1,country:"",friend:!0}],india:[{rank:1,name:"Rohit Sharma",handle:"@rohit",score:45,trend:"+4",streak:10,country:""},{rank:2,name:"Priya Patel",handle:"@priya",score:42,trend:"+1",streak:8,country:""},{rank:3,name:"You",handle:"@you",score:34,you:!0,avatar:"/profile/avatar.png",trend:"+3",streak:7,country:""},{rank:4,name:"Arjun Singh",handle:"@arjun",score:32,trend:"-1",streak:5,country:""},{rank:5,name:"Kavya Reddy",handle:"@kavya",score:30,trend:"+2",streak:3,country:""},{rank:6,name:"Vikram Gupta",handle:"@vikram",score:28,trend:"0",streak:4,country:""}]},Gl=[{name:"Diamond",min:40,color:"from-cyan-400 to-blue-600",icon:""},{name:"Gold",min:30,color:"from-yellow-400 to-orange-500",icon:""},{name:"Silver",min:20,color:"from-gray-300 to-gray-500",icon:""},{name:"Bronze",min:10,color:"from-orange-600 to-red-600",icon:""}];function q3(){var x,N;const t=Ye(),{player:e}=Wr(),n={global:Ql.global.map(w=>w.you?{...w,name:(e==null?void 0:e.name)||"You",score:(e==null?void 0:e.coins)||0,streak:(e==null?void 0:e.currentStreak)||0}:w),friends:Ql.friends.map(w=>w.you?{...w,name:(e==null?void 0:e.name)||"You",score:(e==null?void 0:e.coins)||0,streak:(e==null?void 0:e.currentStreak)||0}:w),india:Ql.india.map(w=>w.you?{...w,name:(e==null?void 0:e.name)||"You",score:(e==null?void 0:e.coins)||0,streak:(e==null?void 0:e.currentStreak)||0}:w)};console.log("Debug - Player coins:",e==null?void 0:e.coins),console.log("Debug - Friends data:",n.friends[0]);const[r,i]=f.useState({days:2,hours:14,minutes:17}),[a,o]=f.useState("global"),l=n[a]||n.global;console.log("Player coins:",e==null?void 0:e.coins,"Current user score:",(x=l.find(w=>w.you))==null?void 0:x.score);const u=l.find(w=>w.you),d=l.slice(0,3),h=l.slice(3);f.useEffect(()=>{const w=setInterval(()=>{i(k=>k.minutes>0?{...k,minutes:k.minutes-1}:k.hours>0?{...k,hours:k.hours-1,minutes:59}:k.days>0?{...k,days:k.days-1,hours:23,minutes:59}:k)},6e4);return()=>clearInterval(w)},[]);const g=w=>{const k=Math.max(...l.map(C=>C.score)),I=w/k*100;return I>=90?Gl[0]:I>=70?Gl[1]:I>=40?Gl[2]:Gl[3]};return s.jsxs("div",{className:"min-h-screen bg-black text-white pt-12",children:[s.jsxs("div",{className:"flex items-center justify-between mb-5",children:[s.jsx("button",{onClick:()=>t(-1),className:"px-3 py-1.5 rounded-xl border border-white/10 bg-white/5 text-sm hover:bg-white/10 transition",children:" Back"}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-lg font-bold",children:" Leaderboard"}),s.jsxs("div",{className:"text-xs text-white/60",children:["Ends in ",r.days,"d ",r.hours,"h ",r.minutes,"m"]})]}),s.jsx("button",{className:"px-3 py-1.5 rounded-xl border border-white/10 bg-white/5 text-sm hover:bg-white/10 transition",children:""})]}),s.jsxs("div",{className:`mb-5 rounded-2xl bg-gradient-to-r ${g(u==null?void 0:u.score).color} p-4 text-center relative overflow-hidden`,children:[s.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -translate-y-10 translate-x-10 animate-pulse"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-16 h-16 bg-white/5 rounded-full translate-y-8 -translate-x-8"}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("div",{className:"text-2xl mb-1",children:g(u==null?void 0:u.score).icon}),s.jsxs("div",{className:"text-sm font-bold text-white",children:[g(u==null?void 0:u.score).name," League"]}),s.jsx("div",{className:"text-xs text-white/80",children:a==="friends"?"Competing with friends!":"You're competing with the best!"})]})]}),s.jsx("div",{className:"flex gap-2 mb-5",children:[{key:"global",label:" Global",count:"10M+"},{key:"friends",label:" Friends",count:Ql.friends.length},{key:"india",label:" India",count:"2.5M"}].map(w=>s.jsxs("button",{onClick:()=>o(w.key),className:`flex-1 px-2 py-2 rounded-xl text-xs font-semibold transition-all duration-300 ${a===w.key?"bg-lime-500 text-black shadow-lg scale-105":"border border-white/10 bg-white/5 hover:bg-white/10"}`,children:[s.jsx("div",{children:w.label}),s.jsx("div",{className:`text-[10px] ${a===w.key?"text-black/70":"text-white/60"}`,children:w.count})]},w.key))}),s.jsx("div",{className:"mb-5 rounded-2xl bg-gradient-to-r from-lime-500/20 to-green-500/20 border border-lime-500/30 p-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-xl bg-lime-500/20 grid place-items-center text-lg",children:""}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-lime-400 text-sm",children:"Your Position"}),s.jsxs("div",{className:"text-xs text-white/70 flex items-center gap-2",children:[s.jsxs("span",{children:["Rank #",u==null?void 0:u.rank]}),s.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[9px] font-bold ${u!=null&&u.trend.startsWith("+")?"bg-green-500/20 text-green-400":u!=null&&u.trend.startsWith("-")?"bg-red-500/20 text-red-400":"bg-gray-500/20 text-gray-400"}`,children:u==null?void 0:u.trend}),s.jsxs("span",{className:"text-white/50 text-[10px]",children:["in ",a==="global"?"Global":a==="friends"?"Friends":"India"]})]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-lg font-bold text-lime-400",children:[u==null?void 0:u.score," ",Ka]}),s.jsxs("div",{className:"text-xs text-white/60",children:[" ",u==null?void 0:u.streak," streak"]})]})]})}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-center text-sm font-semibold text-white/80 mb-4",children:" Hall of Fame"}),s.jsxs("div",{className:"bg-gradient-to-b from-white/5 to-white/10 rounded-2xl p-4 border border-white/10 relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-4 left-6 text-2xl opacity-40 animate-pulse",children:""}),s.jsx("div",{className:"absolute top-8 right-8 text-lg opacity-40 animate-bounce",style:{animationDelay:"1s"},children:""}),s.jsx("div",{className:"absolute bottom-6 left-12 text-xl opacity-10 animate-pulse",style:{animationDelay:"2s"},children:""}),s.jsx("div",{className:"absolute bottom-4 right-6 text-lg opacity-40 animate-bounce",style:{animationDelay:"0.5s"},children:""}),s.jsxs("div",{className:"flex items-end justify-center gap-8 relative z-10",children:[d[1]&&s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsxs("div",{className:"relative mb-2",children:[s.jsx(Hl,{src:d[1].avatar,fallback:d[1].name,size:56}),s.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-7 h-7 bg-gradient-to-br from-gray-300 to-gray-500 rounded-full grid place-items-center text-sm font-bold text-black shadow-lg",children:"2"})]}),s.jsx("div",{className:"text-sm font-semibold mb-1 mt-1",children:Wl(d[1].name,8)}),s.jsxs("div",{className:"text-xs text-lime-400 font-bold",children:[d[1].score," ",Ka]})]}),d[0]&&s.jsxs("div",{className:"flex flex-col items-center -mb-3",children:[s.jsxs("div",{className:"relative mb-2",children:[s.jsx(Hl,{src:d[0].avatar,fallback:d[0].name,size:72}),s.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:s.jsx(Q3,{})}),s.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-8 h-8 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full grid place-items-center text-base font-bold text-black shadow-lg animate-pulse",children:"1"})]}),s.jsx("div",{className:"text-sm font-bold mb-1 mt-1",children:Wl(d[0].name,8)}),s.jsxs("div",{className:"text-sm text-lime-400 font-bold mb-1",children:[d[0].score," ",Ka]}),s.jsx("div",{className:"px-2 py-1 bg-yellow-400/20 rounded-full text-[9px] text-yellow-400 font-bold",children:"CHAMPION"})]}),d[2]&&s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsxs("div",{className:"relative mb-2",children:[s.jsx(Hl,{src:d[2].avatar,fallback:d[2].name,size:56}),s.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-7 h-7 bg-gradient-to-br from-orange-600 to-red-600 rounded-full grid place-items-center text-sm font-bold text-white shadow-lg",children:"3"})]}),s.jsx("div",{className:"text-sm font-semibold mb-1 mt-1",children:Wl(d[2].name,8)}),s.jsxs("div",{className:"text-xs text-lime-400 font-bold",children:[d[2].score," ",Ka]})]})]})]})]}),h.length>0&&s.jsxs("div",{className:"rounded-3xl bg-white/5 border border-white/10 p-2 mb-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2 px-2",children:[s.jsx("h3",{className:"text-sm font-semibold",children:"Rankings"}),s.jsx("div",{className:"text-xs text-white/60",children:"Live updates"})]}),s.jsx("ul",{className:"space-y-1.5",children:h.map((w,k)=>s.jsxs("li",{className:`flex items-center justify-between px-3 py-2.5 rounded-xl transition-all duration-300 ${w.you?"bg-lime-500/90 text-black shadow-lg shadow-lime-500/20 scale-[1.02]":"bg-white/5 hover:bg-white/10"}`,style:{animationDelay:`${k*100}ms`,animation:"fadeInUp 0.6s ease-out forwards"},children:[s.jsxs("div",{className:"flex items-center gap-2.5",children:[s.jsx(G3,{n:w.rank,you:w.you}),s.jsx(Hl,{src:w.avatar,fallback:w.name,size:36}),s.jsxs("div",{className:"flex flex-col leading-tight",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-semibold",children:Wl(w.name,12)}),s.jsx("span",{className:"text-xs",children:w.country}),w.friend&&s.jsx("span",{className:"text-[9px] bg-blue-500/20 text-blue-400 px-1 py-0.5 rounded-full",children:"Friend"})]}),s.jsxs("div",{className:`text-xs flex items-center gap-1.5 ${w.you?"text-black/70":"text-white/60"}`,children:[s.jsx("span",{children:w.handle}),s.jsxs("span",{children:["",w.streak]})]})]})]}),s.jsxs("div",{className:"flex flex-col items-end",children:[s.jsxs("div",{className:"flex items-center gap-1 text-sm font-bold",children:[s.jsx("span",{children:w.score}),s.jsx("span",{className:w.you?"opacity-90":"opacity-80",children:Ka})]}),s.jsx("div",{className:`text-xs px-1.5 py-0.5 rounded-full font-bold ${w.trend.startsWith("+")?"bg-green-500/20 text-green-400":w.trend.startsWith("-")?"bg-red-500/20 text-red-400":"bg-gray-500/20 text-gray-400"}`,children:w.trend})]})]},`${a}-${w.rank}`))})]}),u&&u.rank>1&&s.jsxs("div",{className:"mb-4 p-3 rounded-2xl bg-gradient-to-r from-purple-600/20 to-pink-600/20 border border-purple-500/30 text-center",children:[s.jsx("div",{className:"text-sm font-semibold mb-2",children:" Climb Higher!"}),s.jsx("div",{className:"text-xs text-white/70 mb-3",children:a==="friends"&&u.rank===1?" You're #1 among friends!":`You need ${Math.max(0,(((N=l[u.rank-2])==null?void 0:N.score)||0)-u.score+1)} more coins to reach rank #${u.rank-1}`}),!(a==="friends"&&u.rank===1)&&s.jsx("button",{onClick:()=>t("/play"),className:"px-5 py-2 bg-gradient-to-r from-purple-600 to-pink-600 rounded-xl text-sm font-bold hover:scale-105 transition-transform",children:"Play Now "})]}),s.jsx("style",{jsx:!0,children:`
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
      `})]})}function Hl({src:t,fallback:e,size:n=56}){const r=H3(e);return s.jsx("div",{className:"grid place-items-center rounded-full bg-white/10 overflow-hidden border-2 border-white/20",style:{width:n,height:n},children:t?s.jsx("img",{src:t,alt:"",className:"w-full h-full object-cover"}):s.jsx("span",{className:"text-sm font-semibold",children:r})})}function Q3(){return s.jsxs("div",{className:"w-7 h-5 bg-gradient-to-t from-yellow-400 to-yellow-300 rounded-b-lg shadow-lg relative",children:[s.jsxs("svg",{viewBox:"0 0 100 40",className:"w-full h-full",children:[s.jsx("path",{d:"M15,35 L15,18 L35,28 L50,10 L65,28 L85,18 L85,35 Z",fill:"url(#crownGradient)"}),s.jsx("defs",{children:s.jsxs("linearGradient",{id:"crownGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[s.jsx("stop",{offset:"0%",stopColor:"#FCD34D"}),s.jsx("stop",{offset:"100%",stopColor:"#F59E0B"})]})})]}),s.jsx("div",{className:"absolute top-0.5 left-1/2 -translate-x-1/2 w-1 h-1 bg-red-400 rounded-full animate-pulse"})]})}function G3({n:t,you:e}){return s.jsx("div",{className:`w-7 h-7 grid place-items-center rounded-full text-sm font-bold ${e?"bg-black/10 text-black":"bg-white/10 text-white"}`,children:t})}function Wl(t,e=12){return(t==null?void 0:t.length)>e?t.slice(0,e-1)+"":t}function H3(t=""){var n;const e=t.trim().split(/\s+/);return e.length===1?e[0].slice(0,2).toUpperCase():(e[0][0]+(((n=e[1])==null?void 0:n[0])||"")).toUpperCase()}const W3="qp_recent",Y3="qp_review_snapshot",ny=[{id:Date.now()-864e5,type:"quiz",category:"General Knowledge",difficulty:"easy",score:8,total:10,accuracy:80,time:"02:31",ms:151e3,date:"Yesterday",timestamp:Date.now()-864e5,mode:"Quiz"},{id:Date.now()-1728e5,type:"practice",category:"Science",difficulty:"medium",score:12,total:15,accuracy:80,time:"06:02",ms:362e3,date:"2 days ago",timestamp:Date.now()-1728e5,mode:"Practice"},{id:Date.now()-2592e5,type:"quiz",category:"Fun Facts",difficulty:"easy",score:9,total:10,accuracy:90,time:"02:05",ms:125e3,date:"3 days ago",timestamp:Date.now()-2592e5,mode:"Quiz"}];function K3(){const[t,e]=f.useState("quizzes"),[n,r]=f.useState(null),[i,a]=f.useState(!1),[o,l]=f.useState("all"),[u,d]=f.useState("all"),[h,g]=f.useState("date"),[x,N]=f.useState([]),[w,k]=f.useState(!0),I=Ye(),C=Pt(),_=m=>{if(!m)return"00:00";const y=Math.floor(m/1e3),j=Math.floor(y/60),A=y%60;return`${String(j).padStart(2,"0")}:${String(A).padStart(2,"0")}`},v=m=>{if(!m)return"Unknown";const y=new Date(m),A=Math.floor((new Date-y)/(1e3*60*60*24));return A===0?"Today":A===1?"Yesterday":A<7?`${A} days ago`:`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][y.getMonth()]} ${y.getDate()}`};f.useEffect(()=>{let m=!1;k(!0);const y=T=>{try{return JSON.parse(T)}catch{return null}},j=T=>encodeURIComponent(String(T).trim().toLowerCase().replace(/\s+/g,"-")),A=T=>{var M,z,H,ne;const S=Number(T.ts??T.timestamp??T.id)||Date.now(),G=Number(T.ms)||0,Z=Number(T.total)||0,te=Number(T.correct)||0,$=String(T.mode||"").toLowerCase().includes("practice")?"practice":"quiz",O=((M=T.snapshot)==null?void 0:M.category)||((z=T.snapshot)==null?void 0:z.categoryLabel)||T.cat||T.category||"Unknown",V=((H=T.snapshot)==null?void 0:H.categoryParam)||j(O),B=String(((ne=T.snapshot)==null?void 0:ne.difficulty)||T.difficulty||"medium").toLowerCase();return{id:T.id??S,type:$,category:O,categoryParam:V,difficulty:B,score:te,total:Z,accuracy:Z?Math.round(te/Z*100):0,time:_(G),ms:G,date:v(S),timestamp:S,snapshot:T.snapshot??null,mode:T.mode||($==="practice"?"Practice":"Quiz")}};try{const T=localStorage.getItem(W3),S=T?y(T):null,Z=(Array.isArray(S)&&S.length?S:ny).map(A).filter(te=>te&&te.timestamp).sort((te,K)=>K.timestamp-te.timestamp);m||N(Z)}catch(T){console.error("Error loading history:",T),m||N(ny)}finally{m||k(!1)}return()=>{m=!0}},[]);const P=f.useMemo(()=>{const m=new Set(x.map(y=>y.category));return Array.from(m)},[x]),D=f.useMemo(()=>{let m=x.filter(y=>t==="quizzes"?y.type==="quiz":y.type==="practice");return o!=="all"&&(m=m.filter(y=>y.category===o)),u!=="all"&&(m=m.filter(y=>y.difficulty===u)),m.sort((y,j)=>h==="date"?j.timestamp-y.timestamp:h==="score"?j.accuracy-y.accuracy:h==="time"?y.ms-j.ms:0),m},[x,t,o,u,h]),L=f.useMemo(()=>{if(D.length===0)return null;const m=D.reduce((T,S)=>T+S.score,0),y=D.reduce((T,S)=>T+S.total,0),j=y?Math.round(m/y*100):0,A=D.reduce((T,S)=>T+S.ms,0);return{count:D.length,avgAccuracy:j,totalTime:_(A),bestScore:Math.max(...D.map(T=>T.accuracy))}},[D]),E=m=>m>=80?"text-green-400":m>=60?"text-blue-400":m>=40?"text-yellow-400":"text-red-400";return w?s.jsx("div",{className:"min-h-full bg-gradient-to-br from-gray-900 via-purple-900/20 to-gray-900 flex items-center justify-center",children:s.jsx("div",{className:"text-white",children:"Loading history..."})}):s.jsxs("div",{className:"min-h-full bg-gradient-to-br from-gray-900 via-purple-900/20 to-gray-900 pt-12",children:[s.jsx("div",{className:"",children:s.jsxs("div",{className:"px-4 pt-4 pb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("button",{onClick:()=>{var m;if(((m=C.state)==null?void 0:m.from)==="results"){const y=ye.getCurrentResults();y?I(`/quiz/${y.categorySlug}`,{state:{returnToResults:!0}}):I("/profile")}else I("/profile")},className:"px-3 py-1.5 rounded-xl border border-white/20 bg-white/10 text-white text-sm flex items-center gap-1",children:" Back"}),s.jsx("button",{onClick:()=>a(!i),className:"p-2 rounded-xl border border-white/20 bg-white/10 text-white",children:s.jsx(Z3,{})})]}),s.jsx("h1",{className:"text-2xl font-bold text-white mb-1",children:"History"}),s.jsx("p",{className:"text-white/70 text-sm",children:"Track your progress"})]})}),s.jsxs("div",{className:"px-4 pb-20",children:[s.jsx("div",{className:`
             sticky top-0 z-[60] isolate
            -mx-4 px-4
            py-4 mb-2
            bg-gray-900/95
            backdrop-blur-md
            border-b border-white/10
        `,children:s.jsx("div",{className:"flex items-center",children:s.jsx("div",{className:"inline-flex p-1 rounded-2xl bg-white/10 border border-white/20",children:[{value:"quizzes",label:"Quizzes",icon:""},{value:"practice",label:"Practice",icon:""}].map(m=>s.jsxs("button",{onClick:()=>e(m.value),className:`px-12 py-2 text-sm rounded-xl transition-all duration-200 ${t===m.value?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"text-white/70 hover:text-white"}`,children:[s.jsx("span",{className:"mr-1",children:m.icon}),m.label]},m.value))})})}),L&&s.jsx("div",{className:"mb-4 p-4 rounded-2xl bg-gradient-to-br from-purple-500/20 to-blue-500/20 border border-white/20",children:s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[s.jsx(Yl,{label:"Total",value:L.count}),s.jsx(Yl,{label:"Avg Score",value:`${L.avgAccuracy}%`,color:E(L.avgAccuracy)}),s.jsx(Yl,{label:"Best Score",value:`${L.bestScore}%`,color:"text-green-400"}),s.jsx(Yl,{label:"Total Time",value:L.totalTime})]})}),i&&s.jsx("div",{className:"mb-4 p-4 rounded-2xl bg-white/10 border border-white/20",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Category"}),s.jsxs("select",{value:o,onChange:m=>l(m.target.value),className:"w-full px-3 py-2 rounded-xl bg-black/30 border border-white/20 text-white text-sm",children:[s.jsx("option",{value:"all",children:"All Categories"}),P.map(m=>s.jsx("option",{value:m,children:m},m))]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Difficulty"}),s.jsxs("select",{value:u,onChange:m=>d(m.target.value),className:"w-full px-3 py-2 rounded-xl bg-black/30 border border-white/20 text-white text-sm",children:[s.jsx("option",{value:"all",children:"All"}),s.jsx("option",{value:"easy",children:"Easy"}),s.jsx("option",{value:"medium",children:"Medium"}),s.jsx("option",{value:"hard",children:"Hard"})]})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Sort By"}),s.jsxs("select",{value:h,onChange:m=>g(m.target.value),className:"w-full px-3 py-2 rounded-xl bg-black/30 border border-white/20 text-white text-sm",children:[s.jsx("option",{value:"date",children:"Date"}),s.jsx("option",{value:"score",children:"Score"}),s.jsx("option",{value:"time",children:"Time"})]})]})]})]})}),D.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"text-4xl mb-3",children:""}),s.jsxs("p",{className:"text-white/60",children:["No ",t," history yet"]}),s.jsx("p",{className:"text-white/40 text-sm mt-1",children:"Start playing to see your progress here!"})]}):s.jsx("div",{className:"space-y-3",children:D.map((m,y)=>s.jsx(X3,{item:m,index:y,onClick:()=>r(m)},m.id))})]}),n&&s.jsx(J3,{item:n,onClose:()=>r(null)})]})}function Yl({label:t,value:e,color:n="text-white"}){return s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-xs text-white/60 mb-1",children:t}),s.jsx("div",{className:`text-lg font-bold ${n}`,children:e})]})}function X3({item:t,index:e,onClick:n}){const r=o=>o>=80?"from-green-500/20 to-green-600/10 border-green-500/30":o>=60?"from-blue-500/20 to-blue-600/10 border-blue-500/30":o>=40?"from-yellow-500/20 to-yellow-600/10 border-yellow-500/30":"from-red-500/20 to-red-600/10 border-red-500/30",a=(o=>{const l=o==null?void 0:o.toLowerCase();return l==="easy"?{bg:"bg-green-500/20",text:"text-green-400",border:"border-green-500/30"}:l==="medium"?{bg:"bg-yellow-500/20",text:"text-yellow-400",border:"border-yellow-500/30"}:l==="hard"?{bg:"bg-red-500/20",text:"text-red-400",border:"border-red-500/30"}:{bg:"bg-gray-500/20",text:"text-gray-400",border:"border-gray-500/30"}})(t.difficulty);return s.jsxs("div",{onClick:n,className:`
        relative rounded-2xl p-4 cursor-pointer
        bg-gradient-to-br ${r(t.accuracy)}
        border transform transition-all duration-300 hover:scale-[1.02]
      `,children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"text-lg",children:t.type==="quiz"?"":""}),s.jsx("h3",{className:"font-semibold text-white",children:t.category})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs ${a.bg} ${a.text} ${a.border} border`,children:t.difficulty}),s.jsx("span",{className:"text-xs text-white/50",children:t.date})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:`text-2xl font-bold ${t.accuracy>=80?"text-green-400":t.accuracy>=60?"text-blue-400":t.accuracy>=40?"text-yellow-400":"text-red-400"}`,children:[t.accuracy,"%"]}),s.jsxs("div",{className:"text-xs text-white/60",children:[t.score,"/",t.total]})]})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsxs("div",{className:"flex items-center gap-3 text-white/60",children:[s.jsxs("span",{children:[" ",t.time]}),s.jsx("span",{children:t.mode})]}),s.jsx("span",{className:"text-white/40",children:"Tap to review "})]})]})}function J3({item:t,onClose:e}){const n=Ye();return f.useEffect(()=>{const r=i=>{i.key==="Escape"&&e()};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[e]),s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80",onClick:e,children:s.jsxs("div",{className:"w-full max-w-md bg-gray-900 rounded-3xl p-6 border border-white/20",onClick:r=>r.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl font-bold text-white",children:"Quiz Details"}),s.jsx("button",{onClick:e,className:"p-2 rounded-xl bg-white/10 hover:bg-white/20 transition-colors text-white",children:""})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-4 rounded-2xl bg-white/5 border border-white/10",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-white/60",children:"Category"}),s.jsx("span",{className:"text-white font-medium",children:t.category})]}),s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-white/60",children:"Difficulty"}),s.jsx("span",{className:`${t.difficulty==="easy"?"text-green-400":t.difficulty==="medium"?"text-yellow-400":"text-red-400"} font-medium`,children:t.difficulty})]}),s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-white/60",children:"Score"}),s.jsxs("span",{className:"text-white font-medium",children:[t.score,"/",t.total]})]}),s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-white/60",children:"Accuracy"}),s.jsxs("span",{className:`${t.accuracy>=80?"text-green-400":t.accuracy>=60?"text-blue-400":"text-yellow-400"} font-medium`,children:[t.accuracy,"%"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-white/60",children:"Time"}),s.jsx("span",{className:"text-white font-medium",children:t.time})]})]}),t.snapshot&&s.jsx("button",{onClick:()=>{e(),localStorage.setItem(Y3,JSON.stringify(t.snapshot)),n(`/quiz/${t.categoryParam}?review=1&attempt=${t.id}`,{state:{reviewFrom:"history",historyPath:"/profile/history",fromHistory:!0}})},className:"w-full py-3 rounded-2xl bg-gradient-to-r from-blue-500 to-purple-500 text-white font-medium hover:opacity-90 transition-opacity",children:"Review Answers"}),s.jsx("button",{onClick:()=>{var r;e(),n(`/quiz/${t.categoryParam}`,{state:{mode:t.type==="practice"?"practice":"quiz",retake:!0,difficulty:t.difficulty,count:t.total,timer:((r=t.snapshot)==null?void 0:r.timer)||{type:"per_q",seconds:45},fromHistory:!0}})},className:"w-full py-3 rounded-2xl border border-white/20 text-white font-medium hover:bg-white/10 transition-colors",children:"Retake Quiz"})]})]})})}function Z3(){return s.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:s.jsx("path",{d:"M3 6h18M7 12h10M10 18h4",strokeLinecap:"round",strokeLinejoin:"round"})})}const eA=f.createContext({});function r2(t){const e=f.useRef(null);return e.current===null&&(e.current=t()),e.current}const tA=typeof window<"u",nA=tA?f.useLayoutEffect:f.useEffect,s2=f.createContext(null);function rA(t){return typeof t=="object"&&t!==null}function sA(t){return rA(t)&&"offsetHeight"in t}const iA=f.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class aA extends f.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=n.offsetParent,i=sA(r)&&r.offsetWidth||0,a=this.props.sizeRef.current;a.height=n.offsetHeight||0,a.width=n.offsetWidth||0,a.top=n.offsetTop,a.left=n.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function oA({children:t,isPresent:e,anchorX:n,root:r}){const i=f.useId(),a=f.useRef(null),o=f.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=f.useContext(iA);return f.useInsertionEffect(()=>{const{width:u,height:d,top:h,left:g,right:x}=o.current;if(e||!a.current||!u||!d)return;const N=n==="left"?`left: ${g}`:`right: ${x}`;a.current.dataset.motionPopId=i;const w=document.createElement("style");l&&(w.nonce=l);const k=r??document.head;return k.appendChild(w),w.sheet&&w.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${d}px !important;
            ${N}px !important;
            top: ${h}px !important;
          }
        `),()=>{k.contains(w)&&k.removeChild(w)}},[e]),s.jsx(aA,{isPresent:e,childRef:a,sizeRef:o,children:f.cloneElement(t,{ref:a})})}const lA=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:a,mode:o,anchorX:l,root:u})=>{const d=r2(cA),h=f.useId();let g=!0,x=f.useMemo(()=>(g=!1,{id:h,initial:e,isPresent:n,custom:i,onExitComplete:N=>{d.set(N,!0);for(const w of d.values())if(!w)return;r&&r()},register:N=>(d.set(N,!1),()=>d.delete(N))}),[n,d,r]);return a&&g&&(x={...x}),f.useMemo(()=>{d.forEach((N,w)=>d.set(w,!1))},[n]),f.useEffect(()=>{!n&&!d.size&&r&&r()},[n]),o==="popLayout"&&(t=s.jsx(oA,{isPresent:n,anchorX:l,root:u,children:t})),s.jsx(s2.Provider,{value:x,children:t})};function cA(){return new Map}function uA(t=!0){const e=f.useContext(s2);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:i}=e,a=f.useId();f.useEffect(()=>{if(t)return i(a)},[t]);const o=f.useCallback(()=>t&&r&&r(a),[a,r,t]);return!n&&r?[!1,o]:[!0]}const Kl=t=>t.key||"";function ry(t){const e=[];return f.Children.forEach(t,n=>{f.isValidElement(n)&&e.push(n)}),e}const Kd=({children:t,custom:e,initial:n=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:a="sync",propagate:o=!1,anchorX:l="left",root:u})=>{const[d,h]=uA(o),g=f.useMemo(()=>ry(t),[t]),x=o&&!d?[]:g.map(Kl),N=f.useRef(!0),w=f.useRef(g),k=r2(()=>new Map),[I,C]=f.useState(g),[_,v]=f.useState(g);nA(()=>{N.current=!1,w.current=g;for(let L=0;L<_.length;L++){const E=Kl(_[L]);x.includes(E)?k.delete(E):k.get(E)!==!0&&k.set(E,!1)}},[_,x.length,x.join("-")]);const P=[];if(g!==I){let L=[...g];for(let E=0;E<_.length;E++){const m=_[E],y=Kl(m);x.includes(y)||(L.splice(E,0,m),P.push(m))}return a==="wait"&&P.length&&(L=P),v(ry(L)),C(g),null}const{forceRender:D}=f.useContext(eA);return s.jsx(s.Fragment,{children:_.map(L=>{const E=Kl(L),m=o&&!d?!1:g===_||x.includes(E),y=()=>{if(k.has(E))k.set(E,!0);else return;let j=!0;k.forEach(A=>{A||(j=!1)}),j&&(D==null||D(),v(w.current),o&&(h==null||h()),r&&r())};return s.jsx(lA,{isPresent:m,initial:!N.current||n?void 0:!1,custom:e,presenceAffectsLayout:i,mode:a,root:u,onExitComplete:m?void 0:y,anchorX:l,children:L},E)})})},dA=()=>{const t=Ye(),[e,n]=f.useState(null);f.useEffect(()=>{if(typeof window<"u"){const W=sessionStorage.getItem("navigationSource");W&&n(W)}},[]);const r=W=>{typeof window<"u"&&(sessionStorage.setItem("navigationSource","/rewards"),window.location.href=W)},i=()=>{t(-1)},a=[{id:1,type:"coins",value:100,icon:"",label:"100 Coins",cost:0},{id:2,type:"life",value:1,icon:"",label:"1 Life",cost:50},{id:3,type:"coins",value:200,icon:"",label:"200 Coins",cost:0},{id:4,type:"wildcard",value:1,icon:"",label:"Wild Card",cost:100},{id:5,type:"coins",value:500,icon:"",label:"500 Coins",cost:0,milestone:!0},{id:6,type:"fifty-fifty",value:1,icon:"",label:"50:50",cost:150},{id:7,type:"life",value:2,icon:"",label:"2 Lives",cost:100},{id:8,type:"vehicle",value:"bike",icon:"",label:"Motorcycle",cost:300},{id:9,type:"mystery",value:1,icon:"",label:"Mystery Box",cost:200},{id:10,type:"coins",value:750,icon:"",label:"750 Coins",cost:0,milestone:!0},{id:11,type:"life",value:3,icon:"",label:"3 Lives",cost:150},{id:12,type:"wildcard",value:2,icon:"",label:"2x Wild Card",cost:250},{id:13,type:"vehicle",value:"car",icon:"",label:"Car",cost:500},{id:14,type:"fifty-fifty",value:2,icon:"",label:"2x 50:50",cost:300},{id:15,type:"coins",value:1e3,icon:"",label:"1000 Coins",cost:0,milestone:!0}],o={cycle:{icon:"",name:"Bicycle"},bike:{icon:"",name:"Motorcycle"},car:{icon:"",name:"Car"}};Wr();const[l,u]=f.useState(4),[d,h]=f.useState(ye.getCoins()),[g,x]=f.useState(4),[N,w]=f.useState(!1),[k,I]=f.useState(!1),[C,_]=f.useState(0),[v,P]=f.useState(0),[D,L]=f.useState("cycle"),[E,m]=f.useState([{type:"vehicle",icon:"",name:"Bicycle",count:1},{type:"wildcard",icon:"",name:"Wild Card",count:2},{type:"fifty-fifty",icon:"",name:"50:50 Helper",count:1}]),[y,j]=f.useState([0,1,2,3]),[A,T]=f.useState(!1),[S,G]=f.useState(!1),[Z,te]=f.useState(null),[K,$]=f.useState(null),[O,V]=f.useState(!1),[B,M]=f.useState(null),[z,H]=f.useState(!1),ne=f.useRef(null),q=f.useRef(null),ee=f.useRef(null);f.useEffect(()=>{ne.current=new Audio("/sounds/reward.mp3"),q.current=new Audio("/sounds/reward_progress.mp3"),[ne,q].forEach(W=>{var F;(F=W.current)==null||F.addEventListener("error",()=>{console.log("Sound file not found")})})},[]);const X=W=>{try{W.current&&(W.current.currentTime=0,W.current.play().catch(F=>console.log("Audio play failed:",F)))}catch(F){console.log("Sound play error:",F)}},Q=(W,F)=>{if(W>l){$(F),G(!0);return}W===l&&ue(W,F)},oe=W=>{var re;const F=(re=ee.current)==null?void 0:re.querySelector(`[data-index="${W}"]`);if(F){const le=F.getBoundingClientRect(),pe=window.pageYOffset||document.documentElement.scrollTop,Ne=le.top+pe-window.innerHeight/2+50;window.scrollTo({top:Ne,behavior:"smooth"})}},ue=(W,F)=>{if(!y.includes(W)){if(F.cost>0&&d<F.cost){$(F),G(!0);return}F.cost>0&&(h(re=>re-F.cost),ye.addCoins(-F.cost,`Reward Purchase: ${F.label}`)),X(ne),T(!0),$(F),j(re=>[...re,W]),setTimeout(()=>{T(!1),F.type==="coins"?(_(F.value),w(!0),setTimeout(()=>{h(re=>re+F.value),ye.addCoins(F.value,`Reward Claimed: ${F.label}`),setTimeout(()=>{w(!1),_(0)},500)},300)):F.type==="life"?(P(F.value),I(!0),setTimeout(()=>{x(re=>re+F.value),setTimeout(()=>{I(!1),P(0)},500)},300)):(M({icon:F.icon,startX:window.innerWidth/2,startY:window.innerHeight/2}),setTimeout(()=>{M(null),H(!0),ae(F),F.type==="vehicle"&&L(F.value),setTimeout(()=>{H(!1)},500)},800)),setTimeout(()=>{if(l<a.length-1){const re=l+1;oe(re),setTimeout(()=>{V(!0),X(q),u(re),setTimeout(()=>{V(!1)},500)},300)}},1200)},1500)}},ae=W=>{m(F=>F.find(le=>le.icon===W.icon)?F.map(le=>le.icon===W.icon?{...le,count:le.count+1}:le):[...F,{type:W.type,icon:W.icon,name:W.label,count:1}])},ce=W=>30+W*100,J=()=>30+l*100;return s.jsxs("div",{className:"rewards-page",children:[s.jsx("style",{jsx:!0,children:`
        .rewards-page {
          min-height: 100vh;
          background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%);
          color: white;
          font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
          display: flex;
          flex-direction: column;
        }

        .non-sticky-header {
          padding: 40px 16px 16px 16px;
        }

        .back-button {
          display: inline-flex;
          align-items: center;
          gap: 6px;
          padding: 8px 16px;
          background: rgba(255, 255, 255, 0.06);
          backdrop-filter: blur(20px);
          border: 1px solid rgba(255, 255, 255, 0.1);
          border-radius: 10px;
          color: white;
          font-size: 14px;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s;
        }

        .back-button:hover {
          background: rgba(255, 255, 255, 0.1);
        }

        .sticky-section {
          position: sticky;
          top: 0;
          z-index: 50;
          background: linear-gradient(180deg, rgba(26, 26, 46, 0.95) 0%, rgba(22, 33, 62, 0.95) 100%);
          backdrop-filter: blur(20px);
          padding: 12px;
          border-bottom: 1px solid rgba(255, 255, 255, 0.06);
          box-shadow: 0 2px 20px rgba(0, 0, 0, 0.2);
        }

        .header-wrapper {
          background: rgba(255, 255, 255, 0.03);
          border: 1px solid rgba(255, 255, 255, 0.08);
          border-radius: 14px;
          padding: 12px;
          margin-bottom: 10px;
        }

        .title-row {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 8px;
        }

        .title {
          font-size: 22px;
          font-weight: 700;
          margin: 0;
          letter-spacing: -0.3px;
        }

        .subtitle {
          font-size: 12px;
          color: rgba(255, 255, 255, 0.5);
          margin: 0;
        }

        .play-quiz-btn {
          padding: 7px 16px;
          background: #5E5CE6;
          border: none;
          border-radius: 8px;
          color: white;
          font-size: 12px;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .play-quiz-btn:hover {
          background: #6E6CF6;
        }

        .balance-row {
          display: flex;
          align-items: center;
          gap: 16px;
        }

        .balance-item {
          flex: 1;
          display: flex;
          align-items: center;
          gap: 6px;
        }

        .balance-label {
          font-size: 10px;
          color: rgba(255, 255, 255, 0.4);
          text-transform: uppercase;
          letter-spacing: 0.8px;
        }

        .balance-value {
          font-size: 20px;
          font-weight: 600;
          display: flex;
          align-items: center;
          gap: 4px;
          position: relative;
        }

        .balance-value.animating {
          animation: pulse 0.4s ease;
        }

        @keyframes pulse {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.08); }
        }

        .value-change {
          position: absolute;
          top: -14px;
          right: 0;
          font-size: 11px;
          font-weight: 600;
          color: #34C759;
          animation: slideUp 0.8s ease forwards;
        }

        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(5px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .stats-cards-container {
          background: rgba(255, 255, 255, 0.03);
          border: 1px solid rgba(255, 255, 255, 0.08);
          border-radius: 14px;
          padding: 10px;
        }

        .info-grid {
          display: grid;
          grid-template-columns: 1fr 1fr 1fr;
          gap: 8px;
        }

        .info-card {
          background: rgba(255, 255, 255, 0.04);
          border: 1px solid rgba(255, 255, 255, 0.06);
          border-radius: 10px;
          padding: 8px;
          text-align: center;
        }

        .info-icon {
          font-size: 18px;
          margin-bottom: 2px;
        }

        .info-value {
          font-size: 14px;
          font-weight: 600;
          margin-bottom: 2px;
        }

        .info-label {
          font-size: 9px;
          color: rgba(255, 255, 255, 0.4);
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }

        .cards-section {
          grid-column: span 3;
          padding: 12px;
          background: rgba(255, 255, 255, 0.02);
          border-radius: 8px;
        }

        .cards-label {
          font-size: 11px;
          color: rgba(255, 255, 255, 0.5);
          text-transform: uppercase;
          letter-spacing: 0.5px;
          margin-bottom: 10px;
          text-align: center;
        }

        .card-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
          gap: 10px;
          max-width: 300px;
          margin: 0 auto;
        }

        .card-item {
          position: relative;
          cursor: pointer;
          transition: all 0.2s;
        }

        .card-item:hover {
          transform: translateY(-4px) scale(1.05);
        }

        .large-card {
          width: 100%;
          height: 90px;
          background: linear-gradient(135deg, #ffffff 0%, #f5f5f7 100%);
          border-radius: 10px;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          gap: 4px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          border: 1px solid rgba(0, 0, 0, 0.06);
        }

        .large-card-icon {
          font-size: 32px;
        }

        .large-card-name {
          font-size: 10px;
          color: #333;
          font-weight: 600;
        }

        .card-count-badge {
          position: absolute;
          bottom: -4px;
          right: -4px;
          background: #5E5CE6;
          color: white;
          min-width: 20px;
          height: 20px;
          border-radius: 10px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 11px;
          font-weight: 700;
          padding: 0 6px;
          box-shadow: 0 2px 6px rgba(94, 92, 230, 0.4);
        }

        .cards-section.animating {
          animation: highlight 0.4s ease;
        }

        @keyframes highlight {
          0%, 100% { 
            background: rgba(255, 255, 255, 0.02);
          }
          50% { 
            background: rgba(94, 92, 230, 0.12);
          }
        }

        .scrollable-journey {
          flex: 1;
          overflow-y: auto;
          padding-bottom: 40px;
        }

        .journey-container {
          position: relative;
          padding: 40px 20px;
          min-height: ${a.length*100+200}px;
        }

        .journey-track {
          position: relative;
          width: 100%;
          height: ${a.length*100+100}px;
        }

        .curvy-road {
          position: absolute;
          left: 50%;
          top: 30px;
          width: 60px;
          height: calc(100% - 60px);
          transform: translateX(-50%);
        }

        .road-svg {
          width: 100%;
          height: 100%;
        }

        .road-path {
          stroke: rgba(255, 255, 255, 0.08);
          stroke-width: 4;
          fill: none;
        }

        .road-progress {
          stroke: #5E5CE6;
          stroke-width: 4;
          fill: none;
          opacity: 0.8;
          transition: stroke-dashoffset 1s ease;
        }

        .rewards-list {
          position: relative;
          z-index: 2;
        }

        .reward-row {
          position: absolute;
          width: 100%;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .reward-item {
          display: flex;
          align-items: center;
          gap: 12px;
          position: relative;
        }

        .reward-item.left {
          flex-direction: row-reverse;
          transform: translateX(-60%);
        }

        .reward-item.right {
          transform: translateX(60%);
        }

        .checkpoint {
          width: 64px;
          height: 64px;
          border-radius: 50%;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          cursor: pointer;
          transition: all 0.3s;
          position: relative;
          background: rgba(255, 255, 255, 0.08);
          backdrop-filter: blur(20px);
          border: 2px solid rgba(255, 255, 255, 0.12);
        }

        .checkpoint.current {
          background: #5E5CE6;
          border-color: #5E5CE6;
          animation: checkpointPulse 2s infinite;
          transform: scale(1.1);
        }

        .checkpoint.claimed {
          background: #34C759;
          border-color: #34C759;
        }

        .checkpoint.locked {
          opacity: 0.4;
          background: rgba(0, 0, 0, 0.2);
        }

        @keyframes checkpointPulse {
          0%, 100% {
            box-shadow: 0 0 0 0 rgba(94, 92, 230, 0.6);
          }
          50% {
            box-shadow: 0 0 0 12px rgba(94, 92, 230, 0);
          }
        }

        .checkpoint-icon {
          font-size: 24px;
        }

        .checkpoint-value {
          font-size: 11px;
          font-weight: 600;
          margin-top: 2px;
        }

        .reward-info {
          background: rgba(0, 0, 0, 0.3);
          backdrop-filter: blur(20px);
          padding: 10px 14px;
          border-radius: 12px;
          border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .reward-name {
          font-size: 13px;
          color: white;
          font-weight: 500;
        }

        .step-label {
          font-size: 11px;
          color: rgba(255, 255, 255, 0.5);
          margin-top: 2px;
        }

        .avatar-tracker {
          position: absolute;
          left: 50%;
          transform: translateX(-50%);
          z-index: 10;
          transition: top 1s cubic-bezier(0.4, 0, 0.2, 1);
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 4px;
        }

        .avatar-img {
          width: 32px;
          height: 32px;
          border-radius: 50%;
          background: white;
          border: 3px solid #5E5CE6;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .tracker-vehicle {
          font-size: 22px;
          filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
        }

        .lock-icon {
          position: absolute;
          top: -6px;
          right: -6px;
          background: rgba(0, 0, 0, 0.6);
          border-radius: 50%;
          width: 22px;
          height: 22px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 11px;
        }

        .milestone-badge {
          position: absolute;
          top: -8px;
          left: -8px;
          background: linear-gradient(135deg, #FFD60A, #FFB800);
          color: black;
          padding: 3px 8px;
          border-radius: 8px;
          font-size: 10px;
          font-weight: 700;
        }

        .flying-card {
          position: fixed;
          font-size: 40px;
          z-index: 1000;
          pointer-events: none;
          animation: flyToCards 0.8s ease-out forwards;
        }

        @keyframes flyToCards {
          0% {
            transform: translate(0, 0) scale(1);
            opacity: 1;
          }
          100% {
            transform: translate(calc(50vw - var(--startX)), calc(-50vh + 200px)) scale(0.5);
            opacity: 0;
          }
        }

        .claim-overlay {
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.7);
          backdrop-filter: blur(10px);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 100;
        }

        .modal {
          background: rgba(30, 30, 46, 0.98);
          backdrop-filter: blur(30px);
          padding: 32px;
          border-radius: 20px;
          text-align: center;
          animation: modalSlideUp 0.3s ease;
          border: 1px solid rgba(255, 255, 255, 0.08);
          max-width: 360px;
        }

        @keyframes modalSlideUp {
          from {
            transform: translateY(20px) scale(0.95);
            opacity: 0;
          }
          to {
            transform: translateY(0) scale(1);
            opacity: 1;
          }
        }

        .modal-icon {
          font-size: 64px;
          margin-bottom: 20px;
        }

        .modal-title {
          font-size: 24px;
          font-weight: 700;
          margin-bottom: 8px;
        }

        .modal-subtitle {
          font-size: 15px;
          color: rgba(255, 255, 255, 0.6);
          margin-bottom: 24px;
        }

        .modal-value {
          font-size: 32px;
          font-weight: 700;
          color: #34C759;
        }

        .modal-buttons {
          display: flex;
          gap: 12px;
          justify-content: center;
          margin-top: 24px;
        }

        .modal-btn {
          padding: 12px 24px;
          border-radius: 12px;
          border: none;
          font-size: 15px;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .modal-btn-primary {
          background: #5E5CE6;
          color: white;
        }

        .modal-btn-secondary {
          background: rgba(255, 255, 255, 0.08);
          color: white;
        }

        .modal-btn:hover {
          transform: scale(1.02);
        }

        .card-detail-name {
          font-size: 18px;
          font-weight: 600;
          margin-top: 12px;
          margin-bottom: 8px;
        }

        .card-detail-desc {
          font-size: 14px;
          color: rgba(255, 255, 255, 0.6);
        }
      `}),s.jsx("div",{className:"non-sticky-header",children:s.jsx("button",{className:"back-button",onClick:i,children:" Back"})}),s.jsxs("div",{className:"sticky-section",children:[s.jsxs("div",{className:"header-wrapper",children:[s.jsxs("div",{className:"title-row",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"title",children:"Rewards"}),s.jsx("p",{className:"subtitle",children:"Claim amazing prizes"})]}),s.jsx("button",{className:"play-quiz-btn",onClick:()=>r("/play"),children:"Play Quiz"})]}),s.jsx("div",{className:"balance-row",children:s.jsx("div",{className:"balance-item",children:s.jsxs("div",{children:[s.jsx("div",{className:"balance-label",children:"Balance"}),s.jsxs("div",{className:`balance-value ${N?"animating":""}`,children:[d.toLocaleString()," ",N&&s.jsxs("span",{className:"value-change",children:["+",C]})]})]})})})]}),s.jsx("div",{className:"stats-cards-container",children:s.jsxs("div",{className:"info-grid",children:[s.jsxs("div",{className:"info-card",children:[s.jsx("div",{className:"info-icon",children:""}),s.jsxs("div",{className:`info-value ${k?"animating":""}`,children:[g,k&&s.jsxs("span",{className:"value-change",children:["+",v]})]}),s.jsx("div",{className:"info-label",children:"Lives"})]}),s.jsxs("div",{className:"info-card",children:[s.jsx("div",{className:"info-icon",children:""}),s.jsx("div",{className:"info-value",children:"5"}),s.jsx("div",{className:"info-label",children:"Level"})]}),s.jsxs("div",{className:"info-card",children:[s.jsx("div",{className:"info-icon",children:o[D].icon}),s.jsx("div",{className:"info-value",children:o[D].name}),s.jsx("div",{className:"info-label",children:"Vehicle"})]}),s.jsxs("div",{className:`cards-section ${z?"animating":""}`,children:[s.jsx("div",{className:"cards-label",children:"Your Cards"}),s.jsx("div",{className:"card-grid",children:E.map((W,F)=>s.jsxs("div",{className:"card-item",onClick:()=>te(W),children:[s.jsxs("div",{className:"large-card",children:[s.jsx("div",{className:"large-card-icon",children:W.icon}),s.jsx("div",{className:"large-card-name",children:W.name})]}),W.count>1&&s.jsx("div",{className:"card-count-badge",children:W.count})]},F))})]})]})})]}),s.jsx("div",{className:"scrollable-journey",children:s.jsx("div",{className:"journey-container",ref:ee,children:s.jsxs("div",{className:"journey-track",children:[s.jsx("div",{className:"curvy-road",children:s.jsxs("svg",{className:"road-svg",viewBox:"0 0 60 1500",preserveAspectRatio:"none",children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"roadGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[s.jsx("stop",{offset:"0%",stopColor:"#5E5CE6"}),s.jsx("stop",{offset:"100%",stopColor:"#5E5CE6"})]})}),s.jsx("path",{className:"road-path",d:"M 30 0 Q 45 50, 30 100 T 30 200 Q 15 250, 30 300 T 30 400 Q 45 450, 30 500 T 30 600 Q 15 650, 30 700 T 30 800 Q 45 850, 30 900 T 30 1000 Q 15 1050, 30 1100 T 30 1200 Q 45 1250, 30 1300 T 30 1400 L 30 1500"}),s.jsx("path",{className:"road-progress",d:"M 30 0 Q 45 50, 30 100 T 30 200 Q 15 250, 30 300 T 30 400 Q 45 450, 30 500 T 30 600 Q 15 650, 30 700 T 30 800 Q 45 850, 30 900 T 30 1000 Q 15 1050, 30 1100 T 30 1200 Q 45 1250, 30 1300 T 30 1400 L 30 1500",strokeDasharray:"1500",strokeDashoffset:1500-l/(a.length-1)*1500})]})}),s.jsxs("div",{className:"avatar-tracker",style:{top:`${J()}px`},children:[s.jsx("img",{className:"avatar-img",src:"/profile/avatar.png",alt:"You",onError:W=>{W.target.style.display="none"}}),s.jsx("div",{className:"tracker-vehicle",children:o[D].icon})]}),s.jsx("div",{className:"rewards-list",children:a.map((W,F)=>{const re=F%2===0,le=F>l,pe=y.includes(F),Ne=F===l;return s.jsx("div",{className:"reward-row","data-index":F,style:{top:`${ce(F)}px`},children:s.jsxs("div",{className:`reward-item ${re?"left":"right"}`,children:[s.jsxs("div",{className:`checkpoint ${Ne?"current":pe?"claimed":le?"locked":""}`,onClick:()=>Q(F,W),children:[s.jsx("div",{className:"checkpoint-icon",children:W.icon}),s.jsx("div",{className:"checkpoint-value",children:W.label.split(" ")[0]}),W.milestone&&s.jsx("div",{className:"milestone-badge",children:"BONUS"}),le&&s.jsx("div",{className:"lock-icon",children:""})]}),s.jsxs("div",{className:"reward-info",children:[s.jsx("div",{className:"reward-name",children:W.label}),s.jsxs("div",{className:"step-label",children:["Step ",F+1]})]})]})},W.id)})})]})})}),B&&s.jsx("div",{className:"flying-card",style:{left:`${B.startX}px`,top:`${B.startY}px`,"--startX":`${B.startX}px`},children:B.icon}),s.jsx(Kd,{children:Z&&s.jsx("div",{className:"claim-overlay",onClick:()=>te(null),children:s.jsxs("div",{className:"modal",onClick:W=>W.stopPropagation(),children:[s.jsx("div",{className:"modal-icon",children:Z.icon}),s.jsx("div",{className:"card-detail-name",children:Z.name}),s.jsxs("div",{className:"card-detail-desc",children:["You have ",Z.count," of these cards"]}),s.jsx("div",{className:"modal-buttons",children:s.jsx("button",{className:"modal-btn modal-btn-secondary",onClick:()=>te(null),children:"Close"})})]})})}),s.jsx(Kd,{children:A&&K&&s.jsx("div",{className:"claim-overlay",children:s.jsxs("div",{className:"modal",children:[s.jsx("div",{className:"modal-title",children:"WELL DONE!"}),s.jsx("div",{className:"modal-subtitle",children:"Here's a reward for you."}),s.jsx("div",{className:"modal-icon",children:K.icon}),s.jsxs("div",{className:"modal-value",children:["+",K.value," ",K.type==="coins"?"Coins":K.type==="life"?"Lives":K.label]})]})})}),s.jsx(Kd,{children:S&&K&&s.jsx("div",{className:"claim-overlay",onClick:()=>G(!1),children:s.jsxs("div",{className:"modal",onClick:W=>W.stopPropagation(),children:[s.jsx("div",{className:"modal-icon",children:""}),s.jsx("div",{className:"modal-title",children:"Need More Coins"}),s.jsx("div",{className:"modal-subtitle",children:K.cost>0?`You need ${K.cost-d} more coins`:"Complete previous rewards first"}),s.jsxs("div",{className:"modal-buttons",children:[s.jsx("button",{className:"modal-btn modal-btn-primary",onClick:()=>r("/play"),children:"Play Quiz"}),s.jsx("button",{className:"modal-btn modal-btn-secondary",onClick:()=>G(!1),children:"Cancel"})]})]})})})]})},Xl=[{id:1,name:"First Win",emoji:"",unlocked:!0,hint:"Win your first quiz",progress:100,color:"#FFD700"},{id:2,name:"On Fire",emoji:"",unlocked:!0,hint:"3-day winning streak",progress:100,color:"#FF6B35"},{id:3,name:"Perfectionist",emoji:"",unlocked:!1,hint:"Score 10/10 in any quiz",progress:75,color:"#9333EA"},{id:4,name:"Early Bird",emoji:"",unlocked:!0,hint:"Play before 9 AM",progress:100,color:"#F59E0B"},{id:5,name:"Scholar",emoji:"",unlocked:!1,hint:"Master 5 categories",progress:40,color:"#3B82F6"},{id:6,name:"Lightning",emoji:"",unlocked:!1,hint:"Complete in under 2 minutes",progress:20,color:"#10B981"},{id:7,name:"Champion",emoji:"",unlocked:!1,hint:"Win 50 quizzes",progress:30,color:"#EC4899"},{id:8,name:"Explorer",emoji:"",unlocked:!1,hint:"Try all categories",progress:60,color:"#06B6D4"},{id:9,name:"Strategist",emoji:"",unlocked:!0,hint:"Use 3 power-ups wisely",progress:100,color:"#8B5CF6"}];function hA(){const[t,e]=f.useState(null),n=Xl.filter(i=>i.unlocked).length,r=Math.round(n/Xl.length*100);return s.jsxs("div",{className:"badges-screen",children:[s.jsx("style",{jsx:!0,children:`
        .badges-screen {
          min-height: 100vh;
          background: linear-gradient(180deg, #3d4491 0%, #6b63b5 50%, #8679c7 100%);
          color: white;
          padding: 20px;
          font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', sans-serif;
        }

        .header {
          margin-bottom: 24px;
          animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .back-button {
          display: inline-flex;
          align-items: center;
          gap: 8px;
          padding: 10px 16px;
          background: rgba(255, 255, 255, 0.15);
          backdrop-filter: blur(20px);
          border: 1px solid rgba(255, 255, 255, 0.2);
          border-radius: 12px;
          color: white;
          font-size: 15px;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s;
          margin-bottom: 20px;
          margin-top: 12px;
        }

        .back-button:hover {
          background: rgba(255, 255, 255, 0.25);
          transform: translateX(-2px);
        }

        .title-section {
          text-align: center;
          margin-bottom: 32px;
        }

        .main-title {
          font-size: 36px;
          font-weight: 700;
          margin-bottom: 8px;
          background: linear-gradient(to right, #ffffff, #f0f0f0);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          letter-spacing: -0.5px;
        }

        .subtitle {
          font-size: 16px;
          color: rgba(255, 255, 255, 0.85);
          font-weight: 400;
        }

        .progress-card {
          background: rgba(255, 255, 255, 0.12);
          backdrop-filter: blur(40px);
          border-radius: 20px;
          padding: 20px;
          margin-bottom: 28px;
          border: 1px solid rgba(255, 255, 255, 0.18);
          animation: fadeInScale 0.6s ease-out 0.2s both;
        }

        @keyframes fadeInScale {
          from {
            opacity: 0;
            transform: scale(0.95);
          }
          to {
            opacity: 1;
            transform: scale(1);
          }
        }

        .progress-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 12px;
        }

        .progress-label {
          font-size: 14px;
          color: rgba(255, 255, 255, 0.9);
          font-weight: 500;
        }

        .progress-value {
          font-size: 24px;
          font-weight: 700;
          background: linear-gradient(135deg, #FFD700, #FFA500);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
        }

        .progress-bar-container {
          width: 100%;
          height: 8px;
          background: rgba(255, 255, 255, 0.2);
          border-radius: 100px;
          overflow: hidden;
          position: relative;
        }

        .progress-bar-fill {
          height: 100%;
          background: linear-gradient(90deg, #FFD700, #FFA500);
          border-radius: 100px;
          transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
          position: relative;
          overflow: hidden;
        }

        .progress-bar-fill::after {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
          animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
          from {
            transform: translateX(-100%);
          }
          to {
            transform: translateX(100%);
          }
        }

        .badges-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 12px;
          margin-bottom: 24px;
        }

        .badge-card {
          aspect-ratio: 1;
          background: rgba(255, 255, 255, 0.1);
          backdrop-filter: blur(30px);
          border-radius: 20px;
          border: 1.5px solid rgba(255, 255, 255, 0.15);
          padding: 12px;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          cursor: pointer;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          position: relative;
          overflow: hidden;
          animation: fadeInUp 0.5s ease-out both;
        }

        .badge-card:nth-child(1) { animation-delay: 0.1s; }
        .badge-card:nth-child(2) { animation-delay: 0.15s; }
        .badge-card:nth-child(3) { animation-delay: 0.2s; }
        .badge-card:nth-child(4) { animation-delay: 0.25s; }
        .badge-card:nth-child(5) { animation-delay: 0.3s; }
        .badge-card:nth-child(6) { animation-delay: 0.35s; }
        .badge-card:nth-child(7) { animation-delay: 0.4s; }
        .badge-card:nth-child(8) { animation-delay: 0.45s; }
        .badge-card:nth-child(9) { animation-delay: 0.5s; }

        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .badge-card.unlocked {
          background: rgba(255, 255, 255, 0.18);
          border-color: rgba(255, 255, 255, 0.3);
        }

        .badge-card:hover {
          transform: translateY(-4px) scale(1.05);
          box-shadow: 0 12px 32px rgba(0, 0, 0, 0.2);
        }

        .badge-card.unlocked:hover {
          background: rgba(255, 255, 255, 0.22);
        }

        .badge-glow {
          position: absolute;
          top: -50%;
          left: -50%;
          right: -50%;
          bottom: -50%;
          background: radial-gradient(circle, var(--badge-color) 0%, transparent 70%);
          opacity: 0;
          transition: opacity 0.3s;
          pointer-events: none;
        }

        .badge-card.unlocked .badge-glow {
          opacity: 0.15;
        }

        .badge-emoji {
          font-size: 36px;
          margin-bottom: 6px;
          filter: grayscale(100%) opacity(0.5);
          transition: all 0.3s;
        }

        .badge-card.unlocked .badge-emoji {
          filter: none;
          animation: bounce 0.5s ease-out;
        }

        @keyframes bounce {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-8px); }
        }

        .badge-name {
          font-size: 11px;
          font-weight: 600;
          text-align: center;
          line-height: 1.2;
          margin-bottom: 4px;
          color: rgba(255, 255, 255, 0.7);
        }

        .badge-card.unlocked .badge-name {
          color: white;
        }

        .badge-progress {
          width: 100%;
          height: 3px;
          background: rgba(255, 255, 255, 0.15);
          border-radius: 100px;
          overflow: hidden;
          margin-top: 4px;
        }

        .badge-progress-fill {
          height: 100%;
          background: linear-gradient(90deg, var(--badge-color), var(--badge-color));
          border-radius: 100px;
          transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .lock-indicator {
          position: absolute;
          top: 8px;
          right: 8px;
          width: 20px;
          height: 20px;
          background: rgba(0, 0, 0, 0.4);
          backdrop-filter: blur(10px);
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 10px;
        }

        .badge-modal {
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.8);
          backdrop-filter: blur(20px);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          padding: 20px;
          animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }

        .modal-content {
          background: linear-gradient(135deg, rgba(45, 45, 65, 0.98), rgba(55, 55, 75, 0.95));
          border-radius: 24px;
          padding: 28px;
          max-width: 320px;
          width: 100%;
          text-align: center;
          animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
          position: relative;
          border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(40px) scale(0.95);
          }
          to {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }

        .modal-badge {
          font-size: 72px;
          margin-bottom: 16px;
          filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.15));
        }

        .modal-badge.locked {
          filter: grayscale(100%) opacity(0.6);
        }

        .modal-title {
          font-size: 24px;
          font-weight: 700;
          color: #ffffff;
          margin-bottom: 8px;
        }

        .modal-status {
          display: inline-block;
          padding: 4px 12px;
          background: linear-gradient(135deg, #10B981, #059669);
          color: white;
          font-size: 11px;
          font-weight: 600;
          border-radius: 100px;
          margin-bottom: 12px;
        }

        .modal-status.locked {
          background: linear-gradient(135deg, #6B7280, #4B5563);
        }

        .modal-description {
          font-size: 14px;
          color: rgba(255, 255, 255, 0.7);
          line-height: 1.5;
          margin-bottom: 16px;
        }

        .modal-progress-section {
          background: rgba(255, 255, 255, 0.08);
          border-radius: 12px;
          padding: 12px;
          margin-bottom: 20px;
        }

        .modal-progress-label {
          font-size: 12px;
          color: rgba(255, 255, 255, 0.5);
          margin-bottom: 8px;
        }

        .modal-progress-bar {
          width: 100%;
          height: 8px;
          background: rgba(255, 255, 255, 0.15);
          border-radius: 100px;
          overflow: hidden;
        }

        .modal-progress-fill {
          height: 100%;
          background: linear-gradient(90deg, var(--badge-color), var(--badge-color));
          border-radius: 100px;
          transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal-progress-text {
          font-size: 18px;
          font-weight: 700;
          color: #ffffff;
          margin-top: 8px;
        }

        .modal-close {
          padding: 12px 24px;
          background: linear-gradient(135deg, #667eea, #764ba2);
          color: white;
          border: none;
          border-radius: 12px;
          font-size: 15px;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
          width: 100%;
        }

        .modal-close:hover {
          transform: scale(1.02);
          box-shadow: 0 4px 16px rgba(102, 126, 234, 0.4);
        }

        .tips-card {
          background: rgba(255, 255, 255, 0.08);
          border: 1px solid rgba(255, 255, 255, 0.12);
          border-radius: 16px;
          padding: 16px;
          animation: fadeIn 0.8s ease-out 0.6s both;
        }

        .tips-title {
          font-size: 14px;
          font-weight: 600;
          margin-bottom: 8px;
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .tips-content {
          font-size: 13px;
          color: rgba(255, 255, 255, 0.8);
          line-height: 1.5;
        }
      `}),s.jsxs("div",{className:"header",children:[s.jsx("button",{className:"back-button",onClick:()=>window.history.back(),children:" Back"}),s.jsxs("div",{className:"title-section",children:[s.jsx("h1",{className:"main-title",children:"Badge Collection"}),s.jsx("p",{className:"subtitle",children:"Unlock achievements and show your skills"})]})]}),s.jsxs("div",{className:"progress-card",children:[s.jsxs("div",{className:"progress-header",children:[s.jsx("span",{className:"progress-label",children:"Collection Progress"}),s.jsxs("span",{className:"progress-value",children:[n,"/",Xl.length]})]}),s.jsx("div",{className:"progress-bar-container",children:s.jsx("div",{className:"progress-bar-fill",style:{width:`${r}%`}})})]}),s.jsx("div",{className:"badges-grid",children:Xl.map(i=>s.jsxs("div",{className:`badge-card ${i.unlocked?"unlocked":""}`,style:{"--badge-color":i.color},onClick:()=>e(i),children:[s.jsx("div",{className:"badge-glow"}),s.jsx("div",{className:"badge-emoji",children:i.emoji}),s.jsx("div",{className:"badge-name",children:i.name}),!i.unlocked&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"badge-progress",children:s.jsx("div",{className:"badge-progress-fill",style:{width:`${i.progress}%`}})}),s.jsx("div",{className:"lock-indicator",children:""})]})]},i.id))}),s.jsxs("div",{className:"tips-card",children:[s.jsxs("div",{className:"tips-title",children:[s.jsx("span",{children:""}),s.jsx("span",{children:"Pro Tip"})]}),s.jsx("div",{className:"tips-content",children:"Complete daily challenges and maintain streaks to unlock rare badges faster. Each badge gives you bonus XP and special rewards!"})]}),t&&s.jsx("div",{className:"badge-modal",onClick:()=>e(null),children:s.jsxs("div",{className:"modal-content",onClick:i=>i.stopPropagation(),children:[s.jsx("div",{className:`modal-badge ${t.unlocked?"":"locked"}`,children:t.emoji}),s.jsx("h3",{className:"modal-title",children:t.name}),s.jsx("span",{className:`modal-status ${t.unlocked?"":"locked"}`,children:t.unlocked?" Unlocked":" Locked"}),s.jsx("p",{className:"modal-description",children:t.hint}),!t.unlocked&&s.jsxs("div",{className:"modal-progress-section",children:[s.jsx("div",{className:"modal-progress-label",children:"Progress"}),s.jsx("div",{className:"modal-progress-bar",children:s.jsx("div",{className:"modal-progress-fill",style:{width:`${t.progress}%`,"--badge-color":t.color}})}),s.jsxs("div",{className:"modal-progress-text",children:[t.progress,"%"]})]}),s.jsx("button",{className:"modal-close",onClick:()=>e(null),children:t.unlocked?"Awesome!":"Keep Going!"})]})})]})}const fA=[{id:1,title:"Quiz Master",subtitle:"Play 10 quizzes",current:7,target:10,reward:150,claimed:!1,icon:"",color:"#FF6B6B"},{id:2,title:"Coin Collector",subtitle:"Earn 2,000 coins",current:1240,target:2e3,reward:200,claimed:!1,icon:"",color:"#4ECDC4"},{id:3,title:"Winning Streak",subtitle:"Win 3 in a row",current:3,target:3,reward:100,claimed:!0,icon:"",color:"#FFD93D"},{id:4,title:"Speed Demon",subtitle:"Complete 5 under 2min",current:2,target:5,reward:300,claimed:!1,icon:"",color:"#A8E6CF"},{id:5,title:"Perfect Score",subtitle:"Get 100% accuracy",current:0,target:1,reward:250,claimed:!1,icon:"",color:"#C7B8FF"}];function mA(){Wr();const[t,e]=f.useState(fA),[n,r]=f.useState(null),[i,a]=f.useState(ye.getCoins()),[o,l]=f.useState(!1),[u,d]=f.useState([]),h=t.length,g=t.filter(w=>w.current>=w.target).length,x=Math.round(g/h*100);f.useEffect(()=>{const w=setInterval(()=>{d(k=>{const I={id:Date.now(),x:Math.random()*100,y:Math.random()*100,size:Math.random()*20+10};return[...k.slice(-4),I]})},3e3);return()=>clearInterval(w)},[]);const N=(w,k)=>{r(w),navigator.vibrate&&navigator.vibrate([20,10,20]),setTimeout(()=>{var I;e(C=>C.map(_=>_.id===w?{..._,claimed:!0}:_)),a(C=>C+k),ye.addCoins(k,`Achievement: ${((I=t.find(C=>C.id===w))==null?void 0:I.title)||"Completed"}`),r(null),l(!0),setTimeout(()=>l(!1),2e3)},600)};return s.jsxs("div",{className:"achievements-screen",children:[s.jsx("style",{jsx:!0,children:`
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }
        html {
            scroll-behavior: smooth;
            }

        .achievements-screen {
          min-height: 100vh;
          background: linear-gradient(135deg, #1a1a2e 0%, #16213e 30%, #0f3460 100%);
          padding: 20px;
          font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
          color: white;
          position: relative;
          overflow-x: hidden;
          scroll-behavior: smooth;  /* Add this line */
          -webkit-overflow-scrolling: touch;  /* Add this line for iOS */


        }

        .animated-background {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          pointer-events: none;
          overflow: hidden;
        }

        .sparkle {
          position: absolute;
          border-radius: 50%;
          background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, transparent 70%);
        //   animation: twinkle 3s ease-out forwards;
        }

        @keyframes twinkle {
          0% {
            transform: scale(0) rotate(0deg);
            opacity: 1;
          }
          50% {
            transform: scale(1) rotate(180deg);
            opacity: 0.8;
          }
          100% {
            transform: scale(0) rotate(360deg);
            opacity: 0;
          }
        }

        .floating-shapes {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          pointer-events: none;
        }

        .shape {
          position: absolute;
          opacity: 0.05;
        //   animation: float 20s infinite ease-in-out;
        }

        .shape-1 {
          width: 300px;
          height: 300px;
          background: linear-gradient(135deg, #FF6B6B, #4ECDC4);
          border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
          top: -150px;
          right: -100px;
          animation-delay: 0s;
        }

        .shape-2 {
          width: 200px;
          height: 200px;
          background: linear-gradient(135deg, #FFD93D, #A8E6CF);
          border-radius: 70% 30% 30% 70% / 70% 70% 30% 30%;
          bottom: -100px;
          left: -50px;
          animation-delay: 5s;
        }

        @keyframes float {
          0%, 100% { transform: translate(0, 0) rotate(0deg); }
          33% { transform: translate(30px, -30px) rotate(120deg); }
          66% { transform: translate(-20px, 20px) rotate(240deg); }
        }

        .header {
          position: relative;
          z-index: 10;
          margin-bottom: 24px;
          animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .back-button {
          display: inline-flex;
          align-items: center;
          gap: 8px;
          padding: 10px 16px;
          background: rgba(255, 255, 255, 0.1);
          backdrop-filter: blur(20px);
          border: 1px solid rgba(255, 255, 255, 0.15);
          border-radius: 12px;
          color: white;
          font-size: 15px;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s;
          margin-top: 15px;  /* Add this line */
          margin-bottom: 20px;
        }

        .back-button:hover {
          background: rgba(255, 255, 255, 0.15);
          transform: translateX(-2px);
        }

        .title-section {
          text-align: center;
          margin-bottom: 24px;
        }

        .main-title {
          font-size: 42px;
          font-weight: 800;
          margin-bottom: 8px;
          background: linear-gradient(135deg, #FFD93D, #FF6B6B, #4ECDC4);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          text-shadow: 0 0 30px rgba(255, 217, 61, 0.3);
        //   animation: glow 3s ease-in-out infinite;
        }

        @keyframes glow {
          0%, 100% { filter: brightness(1); }
          50% { filter: brightness(1.2); }
        }

        .subtitle {
          font-size: 16px;
          color: rgba(255, 255, 255, 0.8);
        }

        .coins-display {
          position: absolute;
          top: 20px;
          right: 20px;
          background: linear-gradient(135deg, #FFD93D, #FFA500);
          padding: 10px 18px;
          border-radius: 25px;
          display: flex;
          align-items: center;
          gap: 8px;
          font-weight: 700;
          font-size: 20px;
          color: #1a1a1a;
          box-shadow: 0 4px 15px rgba(255, 217, 61, 0.4);
        //   animation: float-coin 3s ease-in-out infinite;
        }

        @keyframes float-coin {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-5px); }
        }

        .progress-overview {
          background: linear-gradient(135deg, rgba(78, 205, 196, 0.15), rgba(255, 107, 107, 0.15));
          backdrop-filter: blur(20px);
          border-radius: 24px;
          padding: 24px;
          margin-bottom: 28px;
          border: 2px solid rgba(255, 255, 255, 0.1);
          animation: fadeInScale 0.6s ease-out 0.2s both;
          position: relative;
          overflow: hidden;
        }

        // .progress-overview::before {
        //   content: '';
        //   position: absolute;
        //   top: -2px;
        //   left: -2px;
        //   right: -2px;
        //   bottom: -2px;
        //   background: linear-gradient(45deg, #FFD93D, #FF6B6B, #4ECDC4, #FFD93D);
        //   border-radius: 24px;
        //   opacity: 0.5;
        //   z-index: -1;
        //   animation: rotate-border 3s linear infinite;
        // }

        @keyframes rotate-border {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }

        @keyframes fadeInScale {
          from {
            opacity: 0;
            transform: scale(0.95);
          }
          to {
            opacity: 1;
            transform: scale(1);
          }
        }

        .overview-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 16px;
        }

        .overview-label {
          font-size: 16px;
          color: white;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 1px;
        }

        .overview-stats {
          display: flex;
          align-items: center;
          gap: 10px;
        }

        .trophy-icon {
          font-size: 32px;
          filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        //   animation: bounce-trophy 2s ease-in-out infinite;
        }

        @keyframes bounce-trophy {
          0%, 100% { transform: translateY(0) rotate(0deg); }
          25% { transform: translateY(-3px) rotate(-5deg); }
          75% { transform: translateY(-3px) rotate(5deg); }
        }

        .overview-value {
          font-size: 28px;
          font-weight: 800;
          color: #FFD93D;
          text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .progress-bar-main {
          width: 100%;
          height: 16px;
          background: rgba(0, 0, 0, 0.3);
          border-radius: 100px;
          overflow: hidden;
          position: relative;
          box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
        }

        .progress-fill-main {
          height: 100%;
          background: linear-gradient(90deg, #FFD93D, #FF6B6B, #4ECDC4);
          border-radius: 100px;
          transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
          position: relative;
          overflow: hidden;
          box-shadow: 0 2px 8px rgba(255, 217, 61, 0.4);
        }

        .progress-fill-main::after {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.6), transparent);
        //   animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
          from { transform: translateX(-100%); }
          to { transform: translateX(100%); }
        }

        .achievements-list {
          display: flex;
          flex-direction: column;
          gap: 16px;
          position: relative;
          z-index: 10;
        }

        .achievement-card {
          background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
        //   backdrop-filter: blur(20px);
          border-radius: 24px;
          padding: 20px;
          position: relative;
          overflow: hidden;
          animation: slideUp 0.5s ease-out both;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          border: 2px solid rgba(255, 255, 255, 0.1);
          will-change: transform;        /* ADD THIS LINE */
          transform: translateZ(0);       /* ADD THIS LINE */

        }

        .achievement-card:nth-child(1) { animation-delay: 0.1s; }
        .achievement-card:nth-child(2) { animation-delay: 0.2s; }
        .achievement-card:nth-child(3) { animation-delay: 0.3s; }
        .achievement-card:nth-child(4) { animation-delay: 0.4s; }
        .achievement-card:nth-child(5) { animation-delay: 0.5s; }

        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .achievement-card:hover {
          transform: translateY(-4px) scale(1.02);
          box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
          border-color: var(--card-color);
        }

        .achievement-card.completed {
          background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.08));
          border-color: rgba(255, 217, 61, 0.3);
        }

        .card-glow {
          position: absolute;
          top: -50%;
          left: -50%;
          width: 200%;
          height: 200%;
          background: radial-gradient(circle, var(--card-color) 0%, transparent 70%);
          opacity: 0.1;
          animation: pulse-glow 3s ease-in-out infinite;
        }

        @keyframes pulse-glow {
          0%, 100% { opacity: 0.05; }
          50% { opacity: 0.15; }
        }

        .card-content {
          display: flex;
          align-items: center;
          gap: 16px;
          position: relative;
        }

        .achievement-icon {
          width: 72px;
          height: 72px;
          background: linear-gradient(135deg, var(--card-color), var(--card-color-dark));
          border-radius: 20px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 36px;
          flex-shrink: 0;
          box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
          position: relative;
        //   animation: icon-float 3s ease-in-out infinite;
        }

        @keyframes icon-float {
          0%, 100% { transform: translateY(0) rotate(0deg); }
          50% { transform: translateY(-5px) rotate(5deg); }
        }

        .achievement-icon::after {
          content: '';
          position: absolute;
          inset: -2px;
          background: linear-gradient(45deg, var(--card-color), transparent, var(--card-color));
          border-radius: 20px;
          opacity: 0.5;
          z-index: -1;
        //   animation: rotate-border 2s linear infinite;
        }

        .achievement-details {
          flex: 1;
          min-width: 0;
        }

        .achievement-title {
          font-size: 18px;
          font-weight: 800;
          color: white;
          margin-bottom: 4px;
          text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .achievement-subtitle {
          font-size: 14px;
          color: rgba(255, 255, 255, 0.7);
          margin-bottom: 12px;
        }

        .progress-container {
          position: relative;
        }

        .progress-bar {
          width: 100%;
          height: 12px;
          background: rgba(0, 0, 0, 0.3);
          border-radius: 100px;
          overflow: hidden;
          box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
        }

        .progress-fill {
          height: 100%;
          background: linear-gradient(90deg, var(--card-color), var(--card-color-dark));
          border-radius: 100px;
          transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
          box-shadow: 0 2px 8px var(--card-color);
          position: relative;
        }

        .progress-fill::after {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.5), transparent);
          animation: shimmer 2s infinite;
        }

        .progress-text {
          font-size: 12px;
          color: rgba(255, 255, 255, 0.8);
          margin-top: 6px;
          display: flex;
          justify-content: space-between;
          align-items: center;
        }

        .reward-badge {
          display: inline-flex;
          align-items: center;
          gap: 4px;
          padding: 4px 10px;
          background: linear-gradient(135deg, #FFD93D, #FFA500);
          color: #1a1a1a;
          border-radius: 100px;
          font-size: 12px;
          font-weight: 700;
          box-shadow: 0 2px 8px rgba(255, 217, 61, 0.3);
        //   animation: pulse-reward 2s ease-in-out infinite;
        }

        @keyframes pulse-reward {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.05); }
        }

        .claim-button {
          padding: 12px 24px;
          border-radius: 16px;
          font-size: 15px;
          font-weight: 700;
          border: none;
          cursor: pointer;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          min-width: 110px;
          position: relative;
          overflow: hidden;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }

        .claim-button.can-claim {
          background: linear-gradient(135deg, #10B981, #059669);
          color: white;
          box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        //   animation: pulse-button 2s ease-in-out infinite;
        }

        @keyframes pulse-button {
          0%, 100% { 
            transform: scale(1);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
          }
          50% { 
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.5);
          }
        }

        .claim-button.can-claim:hover {
          transform: scale(1.08) rotate(-2deg);
          box-shadow: 0 8px 30px rgba(16, 185, 129, 0.5);
        }

        .claim-button.can-claim::before {
          content: '';
          position: absolute;
          top: -50%;
          left: -50%;
          width: 200%;
          height: 200%;
          background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
          transform: rotate(45deg);
          animation: shine 3s infinite;
        }

        @keyframes shine {
          0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
          100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .claim-button.claimed {
          background: rgba(255, 255, 255, 0.1);
          color: rgba(255, 255, 255, 0.5);
          cursor: not-allowed;
        }

        .claim-button.in-progress {
          background: rgba(255, 255, 255, 0.05);
          color: rgba(255, 255, 255, 0.4);
          cursor: not-allowed;
          border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .claim-button.claiming {
          animation: bounceScale 0.6s ease;
        }

        @keyframes bounceScale {
          0%, 100% { transform: scale(1); }
          30% { transform: scale(0.9); }
          60% { transform: scale(1.15); }
        }

        .celebration {
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          font-size: 120px;
          z-index: 1000;
          pointer-events: none;
          animation: celebrate 2s ease-out forwards;
        }

        @keyframes celebrate {
          0% {
            transform: translate(-50%, -50%) scale(0) rotate(0deg);
            opacity: 1;
          }
          50% {
            transform: translate(-50%, -50%) scale(1.2) rotate(180deg);
            opacity: 1;
          }
          100% {
            transform: translate(-50%, -50%) scale(0.8) rotate(360deg);
            opacity: 0;
          }
        }

        .completed-badge {
          position: absolute;
          top: 10px;
          right: 10px;
          width: 32px;
          height: 32px;
          background: linear-gradient(135deg, #FFD93D, #FFA500);
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 18px;
          color: #1a1a1a;
          font-weight: bold;
          box-shadow: 0 4px 12px rgba(255, 217, 61, 0.4);
          animation: pop-in 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes pop-in {
          0% { transform: scale(0) rotate(0deg); }
          50% { transform: scale(1.2) rotate(180deg); }
          100% { transform: scale(1) rotate(360deg); }
        }
      `}),s.jsxs("div",{className:"floating-shapes",children:[s.jsx("div",{className:"shape shape-1"}),s.jsx("div",{className:"shape shape-2"})]}),s.jsxs("div",{className:"header",children:[s.jsx("button",{className:"back-button",onClick:()=>window.history.back(),children:" Back"}),s.jsxs("div",{className:"coins-display",children:[" ",i.toLocaleString()]}),s.jsxs("div",{className:"title-section",children:[s.jsx("h1",{className:"main-title",children:"ACHIEVEMENTS"}),s.jsx("p",{className:"subtitle",children:"Complete challenges and earn awesome rewards!"})]})]}),s.jsxs("div",{className:"progress-overview",children:[s.jsx("div",{className:"card-glow",style:{"--card-color":"#FFD93D"}}),s.jsxs("div",{className:"overview-header",children:[s.jsx("span",{className:"overview-label",children:" Progress Tracker"}),s.jsxs("div",{className:"overview-stats",children:[s.jsx("span",{className:"trophy-icon",children:""}),s.jsxs("span",{className:"overview-value",children:[g,"/",h]})]})]}),s.jsx("div",{className:"progress-bar-main",children:s.jsx("div",{className:"progress-fill-main",style:{width:`${x}%`}})})]}),s.jsx("div",{className:"achievements-list",children:t.map(w=>{const k=Math.min(100,Math.round(w.current/w.target*100)),I=k===100,C=w.color+"CC";return s.jsxs("div",{className:`achievement-card ${I?"completed":""}`,style:{"--card-color":w.color,"--card-color-dark":C},children:[s.jsx("div",{className:"card-glow"}),I&&w.claimed&&s.jsx("div",{className:"completed-badge",children:""}),s.jsxs("div",{className:"card-content",children:[s.jsx("div",{className:"achievement-icon",children:w.icon}),s.jsxs("div",{className:"achievement-details",children:[s.jsx("div",{className:"achievement-title",children:w.title}),s.jsx("div",{className:"achievement-subtitle",children:w.subtitle}),s.jsxs("div",{className:"progress-container",children:[s.jsx("div",{className:"progress-bar",children:s.jsx("div",{className:"progress-fill",style:{width:`${k}%`}})}),s.jsxs("div",{className:"progress-text",children:[s.jsxs("span",{children:[w.current,"/",w.target]}),s.jsxs("span",{className:"reward-badge",children:[" ",w.reward]})]})]})]}),s.jsx("button",{onClick:()=>N(w.id,w.reward),disabled:!I||w.claimed,className:`claim-button ${w.claimed?"claimed":I?"can-claim":"in-progress"} ${n===w.id?"claiming":""}`,children:w.claimed?"":I?"CLAIM!":`${k}%`})]})]},w.id)})}),o&&s.jsx("div",{className:"celebration",children:""})]})}function pA(){const{player:t,updateDailyStreak:e}=Wr(),n=(t==null?void 0:t.currentStreak)||0,r=(t==null?void 0:t.bestStreak)||0,i=(t==null?void 0:t.totalDays)||0;t!=null&&t.coins;const a=Ye(),o=new Date,l=o.getDay(),u=()=>{const O=new Date(o);return O.setDate(o.getDate()-o.getDay()),O.toISOString().split("T")[0]},[d,h]=f.useState(null),[g,x]=f.useState(!1),[N,w]=f.useState(null),[k,I]=f.useState(null),[C,_]=f.useState(!1),v=f.useRef(null),P=f.useRef(null),[D]=Ft("/sounds/coin.mp3",{volume:.75}),[L]=Ft("/sounds/correct.mp3",{volume:.6}),[E,m]=f.useState(()=>{const O=localStorage.getItem("streaks_claimed")||"[]",V=JSON.parse(O),B=u(),M=V.filter(z=>z!==`week_${B}_day_0`);return localStorage.setItem("streaks_claimed",JSON.stringify(M)),M});f.useEffect(()=>{const O=()=>{window.scrollTo(0,0),document.documentElement.scrollTop=0,document.body.scrollTop=0;const B=document.querySelector("main");B&&(B.scrollTop=0)};O(),requestAnimationFrame(O);const V=setTimeout(O,100);return()=>clearTimeout(V)},[]),f.useEffect(()=>{_(!0),setTimeout(()=>_(!1),3e3)},[]);const y=[{label:"Mon",short:"M",dayIndex:1},{label:"Tue",short:"T",dayIndex:2},{label:"Wed",short:"W",dayIndex:3},{label:"Thu",short:"T",dayIndex:4},{label:"Fri",short:"F",dayIndex:5},{label:"Sat",short:"S",dayIndex:6},{label:"Sun",short:"S",dayIndex:0}],j=[{day:0,reward:"10",type:"coins",icon:"",label:"Welcome Bonus"},{day:1,reward:"50",type:"coins",icon:"",label:"50 Coins"},{day:2,reward:"100",type:"coins",icon:"",label:"100 Coins"},{day:3,reward:"2x",type:"xp",icon:"",label:"2x XP Boost"},{day:4,reward:"150",type:"coins",icon:"",label:"150 Coins"},{day:5,reward:"Full",type:"energy",icon:"",label:"Energy Refill"},{day:6,reward:"200",type:"coins",icon:"",label:"200 Coins"},{day:7,reward:"Mystery",type:"mystery",icon:"",label:"Mystery Box"}],A=O=>{const V=E.includes(`week_${u()}_day_${O}`);if(O===0)return{isCompleted:!0,isClaimed:V,canClaim:!V,isLocked:!1};const B=n>=O,M=B&&!V,z=n<O;return{isCompleted:B,isClaimed:V,canClaim:M,isLocked:z}},T=(O,V,B)=>{const M=A(V);if(M.isLocked){I({day:V,currentStreak:n}),setTimeout(()=>I(null),2e3);return}M.isClaimed||M.canClaim&&(h({...O,day:V}),x(!1),setTimeout(()=>{x(!0),L(),setTimeout(()=>{if(O.type==="coins"){const ne=parseInt(O.reward);if(P.current&&v.current){const q=P.current.getBoundingClientRect();D(),w({startRect:q,count:10,amount:ne})}}const z=`week_${u()}_day_${V}`,H=[...E,z];m(H),localStorage.setItem("streaks_claimed",JSON.stringify(H))},500),setTimeout(()=>{h(null),x(!1)},2500)},500))},S=(O,V)=>{if(y[V].dayIndex===l)return n>0?"today-completed":"today-pending";if(V<y.findIndex(M=>M.dayIndex===l)){const M=y.findIndex(z=>z.dayIndex===l)-V;return n>=M?"completed":"missed"}else return"future"},G=[{days:3,emoji:"",label:"Starter",achieved:n>=3},{days:7,emoji:"",label:"Week Warrior",achieved:n>=7},{days:30,emoji:"",label:"Champion",achieved:n>=30},{days:100,emoji:"",label:"Legend",achieved:n>=100}],Z=G.find(O=>O.days>n)||G[G.length-1],te=Math.min(100,n/Z.days*100),K=()=>{window.location.href="/play"},$=()=>{a(-1)};return s.jsxs("div",{className:"streaks-screen",children:[s.jsx("style",{jsx:!0,children:`
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }

        .streaks-screen {
        min-height: 100vh;
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        padding: 32px 16px 16px 16px;  /* Increased top padding from 16px to 32px */
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
        color: white;
        position: relative;
        overflow-x: hidden;
        max-width: 100vw;
        }

        .header {
          position: relative;
          z-index: 10;
          margin-bottom: 24px;
        }

        .header-top {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 20px;
        }

        .back-button {
          display: inline-flex;
          align-items: center;
          gap: 8px;
          padding: 10px 16px;
          background: rgba(255, 255, 255, 0.1);
          backdrop-filter: blur(20px);
          border: 1px solid rgba(255, 255, 255, 0.15);
          border-radius: 12px;
          color: white;
          font-size: 15px;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s;
        }

        .back-button:hover {
          background: rgba(255, 255, 255, 0.15);
          transform: translateX(-2px);
        }

        .coin-pill {
          display: flex;
          align-items: center;
          gap: 6px;
          padding: 8px 16px;
          background: linear-gradient(135deg, rgba(255, 217, 61, 0.2), rgba(255, 165, 0, 0.2));
          border: 1px solid rgba(255, 217, 61, 0.3);
          border-radius: 20px;
          font-weight: 600;
          position: relative;
        }

        .coin-icon {
          font-size: 18px;
        }

        .coin-amount {
          font-size: 16px;
          color: #FFD93D;
        }

        .title-section {
          text-align: center;
          margin-bottom: 24px;
        }

        .main-title {
          font-size: 36px;
          font-weight: 800;
          margin-bottom: 6px;
          background: linear-gradient(135deg, #FFD93D, #FF6B6B);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
        }

        .subtitle {
          font-size: 14px;
          color: rgba(255, 255, 255, 0.7);
        }

        .streak-hero {
          background: rgba(255, 255, 255, 0.08);
          border-radius: 20px;
          padding: 24px;
          margin-bottom: 20px;
          text-align: center;
          position: relative;
          border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .fire-animation {
          font-size: 64px;
          margin-bottom: 12px;
          display: inline-block;
          animation: flame 2s ease-in-out infinite;
        }

        @keyframes flame {
          0%, 100% { 
            transform: scale(1) rotate(0deg);
            filter: brightness(1);
          }
          25% { 
            transform: scale(1.05) rotate(-3deg);
            filter: brightness(1.1);
          }
          50% { 
            transform: scale(1.1) rotate(3deg);
            filter: brightness(1.2);
          }
          75% { 
            transform: scale(1.05) rotate(-3deg);
            filter: brightness(1.1);
          }
        }

        .streak-number {
          font-size: 56px;
          font-weight: 900;
          line-height: 1;
          margin-bottom: 6px;
          background: linear-gradient(135deg, #FFD93D, #FFA500);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
        }

        .streak-label {
          font-size: 20px;
          font-weight: 600;
          color: rgba(255, 255, 255, 0.9);
          margin-bottom: 20px;
        }

        .stats-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 10px;
          margin-top: 20px;
        }

        .stat-card {
          background: rgba(255, 255, 255, 0.05);
          border-radius: 14px;
          padding: 12px;
          text-align: center;
          border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .stat-value {
          font-size: 24px;
          font-weight: 700;
          color: #4ECDC4;
          margin-bottom: 2px;
        }

        .stat-label {
          font-size: 11px;
          color: rgba(255, 255, 255, 0.6);
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }

        .weekly-progress-card {
          background: linear-gradient(135deg, rgba(255, 107, 107, 0.15), rgba(255, 217, 61, 0.15));
          border-radius: 20px;
          padding: 20px;
          margin-bottom: 20px;
          border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .weekly-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 16px;
        }

        .weekly-title {
          font-size: 16px;
          font-weight: 700;
          color: white;
        }

        .weekly-counter {
          display: flex;
          align-items: center;
          gap: 6px;
          padding: 4px 10px;
          background: rgba(255, 255, 255, 0.1);
          border-radius: 20px;
        }

        .weekly-counter-icon {
          font-size: 16px;
        }

        .weekly-counter-text {
          font-size: 14px;
          font-weight: 600;
        }

        .weekly-days {
          display: grid;
          grid-template-columns: repeat(7, 1fr);
          gap: 6px;
          margin-bottom: 20px;
        }

        .day-item {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 6px;
        }

        .day-circle {
          width: 42px;
          height: 42px;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          font-weight: 700;
          font-size: 14px;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          position: relative;
        }

        .day-circle.completed {
          background: linear-gradient(135deg, #10B981, #059669);
          color: white;
          box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .day-circle.today-completed {
          background: linear-gradient(135deg, #34D399, #10B981);
          color: white;
          box-shadow: 0 0 0 3px rgba(52, 211, 153, 0.3);
          animation: pulse 2s ease-in-out infinite;
        }

        .day-circle.today-pending {
          background: linear-gradient(135deg, #FBBF24, #F59E0B);
          color: white;
          box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.3);
          animation: pulse 2s ease-in-out infinite;
        }

        .day-circle.pending {
          background: rgba(255, 255, 255, 0.08);
          border: 1px solid rgba(255, 255, 255, 0.2);
          color: rgba(255, 255, 255, 0.5);
        }

        .day-circle.future {
          background: rgba(255, 255, 255, 0.05);
          border: 1px solid rgba(255, 255, 255, 0.1);
          color: rgba(255, 255, 255, 0.3);
        }
        .day-circle.missed {
            background: linear-gradient(135deg, #EF4444, #DC2626);
            color: white;
            opacity: 0.8;
            }

        .day-circle.missed::after {
            content: '';
            position: absolute;
            font-size: 18px;
            color: white;
            }

        .day-circle.completed::after,
        .day-circle.today-completed::after {
          content: '';
          position: absolute;
          font-size: 18px;
          color: white;
        }

        @keyframes pulse {
          0%, 100% {
            box-shadow: 0 0 0 3px rgba(52, 211, 153, 0.3);
          }
          50% {
            box-shadow: 0 0 0 6px rgba(52, 211, 153, 0.1);
          }
        }

        .day-label {
          font-size: 10px;
          color: rgba(255, 255, 255, 0.5);
          text-transform: uppercase;
        }

        .day-label.today {
          color: #34D399;
          font-weight: 600;
        }

        .rewards-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(95px, 1fr));
          gap: 8px;
        }

        .reward-item {
          background: rgba(255, 255, 255, 0.05);
          border-radius: 12px;
          padding: 10px;
          text-align: center;
          border: 1px solid rgba(255, 255, 255, 0.1);
          transition: all 0.3s;
          cursor: pointer;
          position: relative;
          overflow: hidden;
        }

        .reward-item.completed {
          background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(5, 150, 105, 0.2));
          border-color: rgba(16, 185, 129, 0.3);
        }

        .reward-item.can-claim {
          background: linear-gradient(135deg, rgba(255, 217, 61, 0.2), rgba(255, 165, 0, 0.2));
          border-color: rgba(255, 217, 61, 0.5);
          animation: glow 2s ease-in-out infinite;
        }

        @keyframes glow {
          0%, 100% {
            box-shadow: 0 0 10px rgba(255, 217, 61, 0.3);
          }
          50% {
            box-shadow: 0 0 20px rgba(255, 217, 61, 0.5);
          }
        }

        .reward-item.locked {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .reward-item.locked::before {
          content: '';
          position: absolute;
          top: 5px;
          right: 5px;
          font-size: 12px;
        }

        .reward-day {
          font-size: 10px;
          color: rgba(255, 255, 255, 0.5);
          margin-bottom: 4px;
        }

        .reward-icon {
          font-size: 24px;
          margin-bottom: 4px;
        }

        .reward-text {
          font-size: 11px;
          color: rgba(255, 255, 255, 0.8);
          font-weight: 600;
        }

        .reward-modal {
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          z-index: 1000;
        }

        .gift-box {
          width: 200px;
          height: 200px;
          position: relative;
          animation: float 2s ease-in-out infinite;
        }

        @keyframes float {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-10px); }
        }

        .gift-box-body {
          width: 100%;
          height: 150px;
          background: linear-gradient(135deg, #FFD700, #FFA500);
          border-radius: 20px;
          position: absolute;
          bottom: 0;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .gift-box-lid {
          width: 110%;
          height: 60px;
          background: linear-gradient(135deg, #FF6B6B, #FF1493);
          border-radius: 15px;
          position: absolute;
          top: 40px;
          left: -5%;
          transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
          transform-origin: bottom left;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        .gift-box-lid.opening {
          transform: rotate(-45deg) translateY(-50px);
        }

        .gift-box-ribbon {
          position: absolute;
          width: 30px;
          height: 100%;
          background: linear-gradient(135deg, #9370DB, #4169E1);
          left: 50%;
          transform: translateX(-50%);
          border-radius: 5px;
        }

        .gift-box-ribbon-horizontal {
          position: absolute;
          width: 100%;
          height: 30px;
          background: linear-gradient(135deg, #9370DB, #4169E1);
          top: 50%;
          transform: translateY(-50%);
          border-radius: 5px;
        }

        .gift-box-bow {
          position: absolute;
          top: 30px;
          left: 50%;
          transform: translateX(-50%);
          font-size: 40px;
        }

        .gift-content {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          text-align: center;
          opacity: 0;
          transition: opacity 0.5s ease;
        }

        .gift-content.show {
          opacity: 1;
        }

        .gift-content-icon {
          font-size: 64px;
          margin-bottom: 16px;
          animation: bounce 1s ease-in-out infinite;
        }

        @keyframes bounce {
          0%, 100% {
            transform: translateY(0);
          }
          50% {
            transform: translateY(-10px);
          }
        }

        .gift-content-title {
        font-size: 20px;
        font-weight: 700;
        margin-bottom: 4px;
        color: #1a1a2e;  /* Dark color for contrast */
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .gift-content-desc {
        font-size: 14px;
        color: #16213e;  /* Dark color for contrast */
        font-weight: 600;
        }

        .modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.6);
          z-index: 999;
        }

        .locked-message {
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background: rgba(0, 0, 0, 0.9);
          border: 1px solid rgba(255, 255, 255, 0.2);
          border-radius: 12px;
          padding: 16px 24px;
          z-index: 1001;
          animation: messageFade 2s ease-out forwards;
        }

        @keyframes messageFade {
          0% {
            opacity: 0;
            transform: translate(-50%, -60%);
          }
          20% {
            opacity: 1;
            transform: translate(-50%, -50%);
          }
          80% {
            opacity: 1;
            transform: translate(-50%, -50%);
          }
          100% {
            opacity: 0;
            transform: translate(-50%, -40%);
          }
        }

        .locked-message-icon {
          font-size: 20px;
          margin-right: 8px;
          display: inline-block;
        }

        .locked-message-text {
          font-size: 14px;
          color: rgba(255, 255, 255, 0.9);
          display: inline-block;
        }

        .milestone-section {
          margin-bottom: 20px;
        }

        .milestone-header {
          font-size: 14px;
          font-weight: 600;
          color: rgba(255, 255, 255, 0.8);
          margin-bottom: 12px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }

        .milestone-progress {
          background: rgba(255, 255, 255, 0.08);
          border-radius: 16px;
          padding: 16px;
          border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .milestone-info {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 10px;
        }

        .milestone-current {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .milestone-emoji {
          font-size: 24px;
        }

        .milestone-text {
          font-size: 14px;
          font-weight: 600;
        }

        .milestone-target {
          font-size: 12px;
          color: rgba(255, 255, 255, 0.6);
        }

        .progress-bar-container {
          width: 100%;
          height: 10px;
          background: rgba(0, 0, 0, 0.3);
          border-radius: 100px;
          overflow: hidden;
        }

        .progress-bar-fill {
          height: 100%;
          background: linear-gradient(90deg, #FFD93D, #FF6B6B);
          border-radius: 100px;
          transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
          box-shadow: 0 2px 8px rgba(255, 217, 61, 0.3);
        }

        .play-button {
          width: 100%;
          padding: 16px;
          background: linear-gradient(135deg, #10B981, #059669);
          color: white;
          border: none;
          border-radius: 16px;
          font-size: 16px;
          font-weight: 700;
          cursor: pointer;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          text-transform: uppercase;
          letter-spacing: 0.5px;
          box-shadow: 0 6px 20px rgba(16, 185, 129, 0.3);
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 8px;
          margin-bottom: 20px;
        }

        .play-button:hover {
          transform: translateY(-2px);
          box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        .motivational-text {
          text-align: center;
          margin: 16px 0;
          padding: 12px;
          background: rgba(255, 255, 255, 0.05);
          border-radius: 12px;
          font-size: 13px;
          color: rgba(255, 255, 255, 0.8);
          font-style: italic;
        }

        .celebration {
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          font-size: 120px;
          z-index: 1000;
          pointer-events: none;
          animation: celebrate 3s ease-out forwards;
        }

        @keyframes celebrate {
          0% {
            transform: translate(-50%, -50%) scale(0) rotate(0deg);
            opacity: 1;
          }
          50% {
            transform: translate(-50%, -50%) scale(1.2) rotate(180deg);
            opacity: 1;
          }
          100% {
            transform: translate(-50%, -50%) scale(0.8) rotate(360deg);
            opacity: 0;
          }
        }
      `}),N&&s.jsx(Ds,{startRect:N.startRect,targetRef:v,count:N.count,onDone:()=>{ye.addCoins(N.amount,`Streak Reward - Day ${N.day||""}`),w(null)}}),s.jsxs("div",{className:"header",children:[s.jsxs("div",{className:"header-top",children:[s.jsx("button",{className:"back-button",onClick:$,children:" Back"}),s.jsxs("div",{className:"coin-pill",ref:v,id:"coin-pill",children:[s.jsx("span",{className:"coin-icon",children:""}),s.jsx("span",{className:"coin-amount",children:ye.getCoins()})]})]}),s.jsxs("div",{className:"title-section",children:[s.jsx("h1",{className:"main-title",children:"STREAKS"}),s.jsx("p",{className:"subtitle",children:"Keep the fire burning!"})]})]}),s.jsxs("div",{className:"streak-hero",children:[s.jsx("div",{className:"fire-animation",children:""}),s.jsx("div",{className:"streak-number",children:n}),s.jsx("div",{className:"streak-label",children:"DAY STREAK"}),s.jsxs("div",{className:"stats-row",children:[s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-value",children:r}),s.jsx("div",{className:"stat-label",children:"Best Streak"})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-value",children:i}),s.jsx("div",{className:"stat-label",children:"Total Days"})]})]})]}),s.jsxs("div",{className:"weekly-progress-card",children:[s.jsxs("div",{className:"weekly-header",children:[s.jsx("div",{className:"weekly-title",children:"This Week's Progress"}),s.jsxs("div",{className:"weekly-counter",children:[s.jsx("span",{className:"weekly-counter-icon",children:""}),s.jsxs("span",{className:"weekly-counter-text",children:[Math.min(n,7),"/7"]})]})]}),s.jsx("div",{className:"weekly-days",children:y.map((O,V)=>{const B=S(O.dayIndex,V),M=O.dayIndex===l;return s.jsxs("div",{className:"day-item",children:[s.jsx("div",{className:`day-circle ${B}`,children:B==="completed"||B==="today-completed"?"":O.short}),s.jsx("div",{className:`day-label ${M?"today":""}`,children:O.label})]},V)})}),s.jsx("div",{className:"milestone-header",children:"Daily Rewards"}),s.jsx("div",{className:"rewards-grid",children:j.map((O,V)=>{const B=A(O.day);return s.jsxs("div",{className:`reward-item ${B.isLocked?"locked":B.canClaim?"can-claim":B.isClaimed?"completed":""}`,onClick:M=>T(O,O.day),children:[s.jsxs("div",{className:"reward-day",children:["Day ",O.day]}),s.jsx("div",{className:"reward-icon",children:O.icon}),s.jsx("div",{className:"reward-text",children:O.label})]},V)})})]}),s.jsxs("div",{className:"milestone-section",children:[s.jsx("div",{className:"milestone-header",children:"Next Milestone"}),s.jsxs("div",{className:"milestone-progress",children:[s.jsxs("div",{className:"milestone-info",children:[s.jsxs("div",{className:"milestone-current",children:[s.jsx("span",{className:"milestone-emoji",children:Z.emoji}),s.jsx("span",{className:"milestone-text",children:Z.label})]}),s.jsxs("span",{className:"milestone-target",children:[n,"/",Z.days," days"]})]}),s.jsx("div",{className:"progress-bar-container",children:s.jsx("div",{className:"progress-bar-fill",style:{width:`${te}%`}})})]})]}),s.jsx("div",{className:"motivational-text",children:n===0?"Start your journey! Claim your Day 0 bonus and complete a quiz!":`Day ${n} strong! Keep going to unlock more rewards!`}),s.jsxs("button",{className:"play-button",onClick:K,children:[s.jsx("span",{children:"Continue Streak"}),s.jsx("span",{children:""})]}),k&&s.jsxs("div",{className:"locked-message",children:[s.jsx("span",{className:"locked-message-icon",children:""}),s.jsx("span",{className:"locked-message-text",children:k.day===1&&k.currentStreak===0?"Complete your first quiz to unlock this reward!":`Reach Day ${k.day} streak to unlock this reward!`})]}),d&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"modal-overlay"}),s.jsx("div",{className:"reward-modal",ref:P,children:s.jsxs("div",{className:"gift-box",children:[s.jsxs("div",{className:"gift-box-body",children:[s.jsx("div",{className:"gift-box-ribbon"}),s.jsx("div",{className:"gift-box-ribbon-horizontal"})]}),s.jsx("div",{className:`gift-box-lid ${g?"opening":""}`,children:s.jsx("div",{className:"gift-box-bow",children:""})}),s.jsxs("div",{className:`gift-content ${g?"show":""}`,children:[s.jsx("div",{className:"gift-content-icon",children:d.icon}),s.jsxs("div",{className:"gift-content-title",children:["Day ",d.day]}),s.jsx("div",{className:"gift-content-desc",children:d.label})]})]})})]}),C&&s.jsx("div",{className:"celebration",children:""})]})}const gA=()=>{const t=new Date;return`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`},yf=()=>{const t=localStorage.getItem("questProgress");return t?JSON.parse(t):{}},sy=(t,e)=>{const n=yf();n[t]=e,n.date=gA(),localStorage.setItem("questProgress",JSON.stringify(n))};function xA(){Wr();const t=Ye(),e=Pt(),n=yf(),[r,i]=f.useState([{id:1,title:"Play 3 quizzes today",progress:n.dailyQuizzes||0,target:3,reward:60,claimed:n.dailyQuizzesClaimed||!1,icon:"",color:"#FF6B6B",difficulty:"Easy",questType:"dailyQuizzes",route:"/quiz/play",routeParams:"?category=random&difficulty=random&from=quest"},{id:3,title:"Practice 15 questions",progress:n.practiceQuestions||0,target:15,reward:100,claimed:n.practiceQuestionsClaimed||!1,icon:"",color:"#FFD93D",difficulty:"Easy",questType:"practiceQuestions",route:"/practice/start",routeParams:"?questions=15&difficulty=easy&category=random&from=quest"},{id:4,title:"Win 5 in a row",progress:n.winStreak||0,target:5,reward:150,claimed:n.winStreakClaimed||!1,icon:"",color:"#A8E6CF",difficulty:"Hard",questType:"winStreak",route:"/play",routeParams:"?mode=survival&from=quest"},{id:5,title:"Complete a speed run",progress:n.speedRun||0,target:1,reward:120,claimed:n.speedRunClaimed||!1,icon:"",color:"#C7B8FF",difficulty:"Medium",questType:"speedRun",route:"/swipe/random-mix",routeParams:"?from=quest"}]),[a,o]=f.useState(ye.getCoins()),[l,u]=f.useState(null),[d,h]=f.useState(0),g=f.useRef(null),[x,N]=f.useState(null);f.useEffect(()=>{const v=()=>{const D=yf();i(L=>L.map(E=>{const m=E.questType;return D[m]!==void 0?{...E,progress:D[m]}:E}))};window.addEventListener("storage",v);const P=()=>v();return window.addEventListener("focus",P),()=>{window.removeEventListener("storage",v),window.removeEventListener("focus",P)}},[]),f.useEffect(()=>{const v=D=>{console.log("Quest progress update received:",D.detail),i(L=>L.map(E=>E.questType==="practiceQuestions"&&D.detail.practiceQuestions?{...E,progress:D.detail.practiceQuestions}:E))};window.addEventListener("questProgressUpdate",v);const P=setInterval(()=>{try{const D=localStorage.getItem("questProgress");if(D){const L=JSON.parse(D);i(E=>E.map(m=>m.questType==="practiceQuestions"&&L.practiceQuestions&&m.progress!==L.practiceQuestions?{...m,progress:L.practiceQuestions}:m))}}catch(D){console.error("Error checking progress:",D)}},1e3);return()=>{window.removeEventListener("questProgressUpdate",v),clearInterval(P)}},[]),f.useEffect(()=>{var v;if((v=e.state)!=null&&v.questCompleted){const{questType:P,increment:D}=e.state;i(L=>L.map(E=>{if(E.questType===P){const m=Math.min(E.progress+(D||1),E.target);return sy(P,m),{...E,progress:m}}return E})),window.history.replaceState({},document.title)}},[e]),f.useEffect(()=>{const v=r.filter(P=>P.progress>=P.target).length;h(Math.round(v/r.length*100))},[r]),f.useEffect(()=>{const v=()=>{o(ye.getCoins())};v(),window.addEventListener("coinsUpdated",v);const P=setInterval(v,500);return()=>{window.removeEventListener("coinsUpdated",v),clearInterval(P)}},[]);const w=v=>{navigator.vibrate&&navigator.vibrate([20]),sessionStorage.setItem("activeQuest",JSON.stringify({id:v.id,type:v.questType,title:v.title,currentProgress:v.progress,target:v.target})),t(v.route+v.routeParams)},k=()=>{sessionStorage.getItem("questsFromHome")==="true"?(sessionStorage.removeItem("questsFromHome"),t("/")):t("/profile")},I=v=>{navigator.vibrate&&navigator.vibrate([20,10,20]);try{const P=new Audio("/sounds/coin.mp3");P.volume=.75,P.play()}catch{console.log("Sound not available")}u(v.id),N({startRect:{left:window.innerWidth/2-50,top:window.innerHeight/2,width:100,height:100},count:Math.min(v.reward/10,10),amount:v.reward,questTitle:v.title}),setTimeout(()=>{i(P=>P.map(D=>D.id===v.id?(sy(D.questType+"Claimed",!0),{...D,claimed:!0}):D)),u(null)},600)},C=v=>{switch(v){case"Easy":return"#10B981";case"Medium":return"#F59E0B";case"Hard":return"#EF4444";default:return"#6B7280"}},_=()=>{const v=new Date,P=new Date(v);P.setDate(P.getDate()+1),P.setHours(5,0,0,0);const D=P-v,L=Math.floor(D/(1e3*60*60)),E=Math.floor(D%(1e3*60*60)/(1e3*60));return`${L}h ${E}m`};return s.jsxs("div",{className:"quests-screen",children:[x&&s.jsx(Ds,{startRect:x.startRect,targetRef:g,count:x.count,onDone:()=>{ye.addCoins(x.amount,`Quest Reward: ${x.questTitle||"Completed"}`),o(ye.getCoins()),N(null)}}),s.jsx("style",{jsx:!0,children:`
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }

        .quests-screen {
          min-height: 100vh;
          background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
          padding: 20px;
          font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
          color: white;
          position: relative;
          overflow-x: hidden;
        }

        .animated-bg {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          pointer-events: none;
        }

        .floating-icon {
          position: absolute;
          font-size: 40px;
          opacity: 0.03;
          animation: float 20s infinite ease-in-out;
        }

        .floating-icon:nth-child(1) {
          top: 10%;
          left: 10%;
          animation-delay: 0s;
        }

        .floating-icon:nth-child(2) {
          top: 20%;
          right: 10%;
          animation-delay: 5s;
        }

        .floating-icon:nth-child(3) {
          bottom: 30%;
          left: 15%;
          animation-delay: 10s;
        }

        .floating-icon:nth-child(4) {
          bottom: 20%;
          right: 20%;
          animation-delay: 15s;
        }

        @keyframes float {
          0%, 100% { transform: translate(0, 0) rotate(0deg); }
          33% { transform: translate(30px, -30px) rotate(120deg); }
          66% { transform: translate(-20px, 20px) rotate(240deg); }
        }

        .header {
          position: relative;
          z-index: 10;
          margin-bottom: 24px;
          animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .back-button {
          display: inline-flex;
          align-items: center;
          gap: 8px;
          padding: 10px 16px;
          background: rgba(255, 255, 255, 0.1);
          backdrop-filter: blur(20px);
          border: 1px solid rgba(255, 255, 255, 0.15);
          border-radius: 12px;
          color: white;
          font-size: 15px;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s;
          margin-top: 10px;
          margin-bottom: 24px;
        }

        .back-button:hover {
          background: rgba(255, 255, 255, 0.15);
          transform: translateX(-2px);
        }

        .coins-display {
          position: absolute;
          top: 20px;
          right: 20px;
          background: linear-gradient(135deg, #FFD93D, #FFA500);
          padding: 8px 16px;
          border-radius: 20px;
          display: flex;
          align-items: center;
          gap: 6px;
          font-weight: 700;
          font-size: 18px;
          color: #1a1a1a;
          box-shadow: 0 4px 12px rgba(255, 217, 61, 0.3);
        }

        .title-section {
          text-align: center;
          margin-bottom: 24px;
        }

        .main-title {
          font-size: 42px;
          font-weight: 800;
          margin-bottom: 8px;
          background: linear-gradient(135deg, #FFD93D, #FF6B6B, #4ECDC4);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          text-transform: uppercase;
          letter-spacing: 1px;
        }

        .subtitle {
          font-size: 16px;
          color: rgba(255, 255, 255, 0.7);
        }

        .daily-progress-card {
          background: rgba(255, 255, 255, 0.08);
          border-radius: 20px;
          padding: 20px;
          margin-bottom: 24px;
          border: 1px solid rgba(255, 255, 255, 0.1);
          animation: fadeInScale 0.6s ease-out 0.2s both;
        }

        @keyframes fadeInScale {
          from {
            opacity: 0;
            transform: scale(0.95);
          }
          to {
            opacity: 1;
            transform: scale(1);
          }
        }

        .progress-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 12px;
        }

        .progress-label {
          font-size: 14px;
          font-weight: 600;
          color: rgba(255, 255, 255, 0.8);
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }

        .progress-value {
          font-size: 24px;
          font-weight: 700;
          background: linear-gradient(135deg, #10B981, #059669);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
        }

        .progress-bar-container {
          width: 100%;
          height: 12px;
          background: rgba(0, 0, 0, 0.3);
          border-radius: 100px;
          overflow: hidden;
        }

        .progress-bar-fill {
          height: 100%;
          background: linear-gradient(90deg, #10B981, #059669);
          border-radius: 100px;
          transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
          box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
        }

        .quests-list {
          display: flex;
          flex-direction: column;
          gap: 14px;
          margin-bottom: 24px;
        }

        .quest-card {
          background: rgba(255, 255, 255, 0.08);
          border-radius: 20px;
          padding: 18px;
          position: relative;
          overflow: hidden;
          border: 1.5px solid rgba(255, 255, 255, 0.1);
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          animation: slideUp 0.5s ease-out both;
        }

        .quest-card:nth-child(1) { animation-delay: 0.1s; }
        .quest-card:nth-child(2) { animation-delay: 0.2s; }
        .quest-card:nth-child(3) { animation-delay: 0.3s; }
        .quest-card:nth-child(4) { animation-delay: 0.4s; }

        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .quest-card:hover {
          transform: translateY(-2px);
          border-color: var(--quest-color);
          box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
        }

        .quest-card.completed {
          background: rgba(255, 255, 255, 0.1);
          border-color: rgba(255, 217, 61, 0.2);
        }

        .quest-accent {
          position: absolute;
          top: 0;
          left: 0;
          width: 4px;
          height: 100%;
          background: var(--quest-color);
          opacity: 0.8;
        }

        .quest-content {
          display: flex;
          align-items: center;
          gap: 14px;
        }

        .quest-icon-container {
          width: 60px;
          height: 60px;
          background: linear-gradient(135deg, var(--quest-color), var(--quest-color-dark));
          border-radius: 16px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 28px;
          flex-shrink: 0;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
          position: relative;
        }

        .quest-icon-container.animating {
          animation: bounce 0.6s ease;
        }

        @keyframes bounce {
          0%, 100% { transform: scale(1); }
          30% { transform: scale(0.9); }
          60% { transform: scale(1.1); }
        }

        .quest-details {
          flex: 1;
          min-width: 0;
        }

        .quest-header {
          display: flex;
          align-items: center;
          gap: 8px;
          margin-bottom: 4px;
        }

        .quest-title {
          font-size: 15px;
          font-weight: 600;
          color: white;
        }

        .difficulty-badge {
          padding: 2px 8px;
          border-radius: 100px;
          font-size: 10px;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }

        .progress-info {
          margin-top: 8px;
        }

        .mini-progress-bar {
          width: 100%;
          height: 6px;
          background: rgba(0, 0, 0, 0.3);
          border-radius: 100px;
          overflow: hidden;
          margin-bottom: 6px;
        }

        .mini-progress-fill {
          height: 100%;
          background: linear-gradient(90deg, var(--quest-color), var(--quest-color-dark));
          border-radius: 100px;
          transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
          box-shadow: 0 1px 4px var(--quest-color);
        }

        .progress-text {
          display: flex;
          justify-content: space-between;
          align-items: center;
          font-size: 12px;
        }

        .progress-numbers {
          color: rgba(255, 255, 255, 0.7);
        }

        .reward-display {
          display: inline-flex;
          align-items: center;
          gap: 4px;
          padding: 3px 8px;
          background: rgba(255, 217, 61, 0.15);
          border-radius: 100px;
          color: #FFD93D;
          font-weight: 600;
        }

        .action-button {
          padding: 10px 18px;
          border-radius: 14px;
          font-size: 14px;
          font-weight: 700;
          border: none;
          cursor: pointer;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          text-transform: uppercase;
          letter-spacing: 0.5px;
          min-width: 90px;
        }

        .action-button.can-claim {
          background: linear-gradient(135deg, #10B981, #059669);
          color: white;
          box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .action-button.can-claim:hover {
          transform: scale(1.05);
          box-shadow: 0 6px 16px rgba(16, 185, 129, 0.4);
        }

        .action-button.claimed {
          background: rgba(255, 255, 255, 0.1);
          color: rgba(255, 255, 255, 0.4);
          cursor: not-allowed;
        }

        .action-button.in-progress {
          background: linear-gradient(135deg, var(--quest-color), var(--quest-color-dark));
          color: white;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .action-button.in-progress:hover {
          transform: scale(1.02);
        }

        .timer-card {
          background: rgba(255, 255, 255, 0.05);
          border-radius: 16px;
          padding: 16px;
          text-align: center;
          border: 1px solid rgba(255, 255, 255, 0.08);
          animation: slideUp 0.5s ease-out 0.6s both;
        }

        .timer-icon {
          font-size: 32px;
          margin-bottom: 8px;
        }

        .timer-label {
          font-size: 12px;
          color: rgba(255, 255, 255, 0.6);
          text-transform: uppercase;
          letter-spacing: 0.5px;
          margin-bottom: 4px;
        }

        .timer-value {
          font-size: 20px;
          font-weight: 700;
          color: #FFD93D;
        }

        .reward-animation {
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          font-size: 80px;
          z-index: 1000;
          pointer-events: none;
          animation: coinCollect 1s ease-out forwards;
        }

        @keyframes coinCollect {
          0% {
            transform: translate(-50%, -50%) scale(0) rotate(0deg);
            opacity: 1;
          }
          50% {
            transform: translate(-50%, -50%) scale(1.5) rotate(180deg);
            opacity: 1;
          }
          100% {
            transform: translate(50vw, -50vh) scale(0.5) rotate(360deg);
            opacity: 0;
          }
        }

        .completed-checkmark {
          position: absolute;
          top: 12px;
          right: 12px;
          width: 24px;
          height: 24px;
          background: linear-gradient(135deg, #10B981, #059669);
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 14px;
          color: white;
          font-weight: bold;
          box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
        }
      `}),s.jsxs("div",{className:"animated-bg",children:[s.jsx("div",{className:"floating-icon",children:""}),s.jsx("div",{className:"floating-icon",children:""}),s.jsx("div",{className:"floating-icon",children:""}),s.jsx("div",{className:"floating-icon",children:""})]}),s.jsxs("div",{className:"header",children:[s.jsx("button",{className:"back-button",onClick:k,children:" Back"}),s.jsxs("div",{className:"coins-display",ref:g,children:[" ",a]}),s.jsxs("div",{className:"title-section",children:[s.jsx("h1",{className:"main-title",children:"Daily Quests"}),s.jsx("p",{className:"subtitle",children:"Complete challenges, earn rewards!"})]})]}),s.jsxs("div",{className:"daily-progress-card",children:[s.jsxs("div",{className:"progress-header",children:[s.jsx("span",{className:"progress-label",children:"Today's Progress"}),s.jsxs("span",{className:"progress-value",children:[d,"%"]})]}),s.jsx("div",{className:"progress-bar-container",children:s.jsx("div",{className:"progress-bar-fill",style:{width:`${d}%`}})})]}),s.jsx("div",{className:"quests-list",children:r.map(v=>{const P=Math.min(100,Math.round(v.progress/v.target*100)),D=P===100,L=v.color+"CC";return s.jsxs("div",{className:`quest-card ${D?"completed":""}`,style:{"--quest-color":v.color,"--quest-color-dark":L},children:[s.jsx("div",{className:"quest-accent"}),D&&v.claimed&&s.jsx("div",{className:"completed-checkmark",children:""}),s.jsxs("div",{className:"quest-content",children:[s.jsx("div",{className:`quest-icon-container ${l===v.id?"animating":""}`,children:v.icon}),s.jsxs("div",{className:"quest-details",children:[s.jsxs("div",{className:"quest-header",children:[s.jsx("span",{className:"quest-title",children:v.title}),s.jsx("span",{className:"difficulty-badge",style:{background:`${C(v.difficulty)}20`,color:C(v.difficulty)},children:v.difficulty})]}),s.jsxs("div",{className:"progress-info",children:[s.jsx("div",{className:"mini-progress-bar",children:s.jsx("div",{className:"mini-progress-fill",style:{width:`${P}%`}})}),s.jsxs("div",{className:"progress-text",children:[s.jsxs("span",{className:"progress-numbers",children:[v.progress,"/",v.target]}),s.jsxs("span",{className:"reward-display",children:[" ",v.reward]})]})]})]}),s.jsx("button",{onClick:()=>{D&&!v.claimed?I(v):D||w(v)},disabled:v.claimed,className:`action-button ${v.claimed?"claimed":D?"can-claim":"in-progress"}`,style:!D&&!v.claimed?{"--quest-color":v.color,"--quest-color-dark":L}:{},children:v.claimed?"":D?"Claim":"Do it"})]})]},v.id)})}),s.jsxs("div",{className:"timer-card",children:[s.jsx("div",{className:"timer-icon",children:""}),s.jsx("div",{className:"timer-label",children:"New Quests In"}),s.jsx("div",{className:"timer-value",children:_()})]}),l&&s.jsx("div",{className:"reward-animation",children:""})]})}function bp({title:t,subtitle:e,children:n}){const r=Ye();return s.jsxs("div",{className:"min-h-full bg-black text-white px-4 pt-12",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("button",{onClick:()=>r(-1),className:"px-3 py-1.5 rounded-xl border border-white/10 bg-white/5 text-sm",children:" Back"}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-base font-semibold leading-tight",children:t}),e&&s.jsx("div",{className:"text-xs text-white/60 leading-tight",children:e})]}),s.jsx("div",{className:"w-[68px]"})]}),n]})}function yA(){const t=Ye(),[e,n]=f.useState(!0),[r,i]=f.useState(!0),[a,o]=f.useState(!0),[l,u]=f.useState(!1),[d,h]=f.useState("");f.useEffect(()=>{const x=jt.getCurrentUser();x&&x.phone&&h(x.phone)},[]);const g=()=>{const N=JSON.parse(localStorage.getItem("currentUser")||"{}").phone;mt.logout(),localStorage.removeItem("currentUser"),localStorage.removeItem("qp_player"),localStorage.removeItem("rememberCredentials"),sessionStorage.clear(),N?t("/auth/signin",{replace:!0,state:{phone:N}}):t("/auth",{replace:!0})};return s.jsxs(s.Fragment,{children:[s.jsx(bp,{title:"Settings",subtitle:"Make it yours",children:s.jsx("div",{className:"flex flex-col justify-center min-h-[calc(100vh-200px)]",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"rounded-3xl border border-white/10 bg-gradient-to-br from-purple-900/20 to-indigo-900/20 backdrop-blur-sm p-2",children:[s.jsx("div",{className:"px-4 pt-3 pb-1",children:s.jsx("h3",{className:"text-xs font-semibold text-white/50 uppercase tracking-wider",children:"Preferences"})}),s.jsxs("div",{className:"divide-y divide-white/10",children:[s.jsx(Ii,{icon:"",label:"Sound",subtitle:"Game sounds & effects",right:s.jsx(Xd,{on:e,set:n})}),s.jsx(Ii,{icon:"",label:"Haptics",subtitle:"Vibration feedback",right:s.jsx(Xd,{on:r,set:i})}),s.jsx(Ii,{icon:"",label:"Notifications",subtitle:"Daily reminders",right:s.jsx(Xd,{on:a,set:o})})]})]}),s.jsxs("div",{className:"rounded-3xl border border-white/10 bg-gradient-to-br from-blue-900/20 to-purple-900/20 backdrop-blur-sm p-2",children:[s.jsx("div",{className:"px-4 pt-3 pb-1",children:s.jsx("h3",{className:"text-xs font-semibold text-white/50 uppercase tracking-wider",children:"Account"})}),s.jsxs("div",{className:"divide-y divide-white/10",children:[s.jsx(Ii,{icon:"",label:"Phone Number",subtitle:d||"Not available",right:s.jsx("span",{className:"text-white/40 text-sm",children:""})}),s.jsx(Ii,{icon:"",label:"Edit Profile",subtitle:"Update your details",right:s.jsx("span",{className:"text-white/40 text-lg",children:""}),onClick:()=>t("/profile/edit")}),s.jsx(Ii,{icon:"",label:"Privacy Policy",subtitle:"Your data is safe",right:s.jsx("span",{className:"text-white/40 text-lg",children:""}),onClick:()=>t("/profile/privacy")})]})]}),s.jsxs("button",{className:`w-full rounded-3xl border border-red-500/30 bg-gradient-to-r from-red-900/30 to-pink-900/30 
                       py-4 text-red-300 font-semibold backdrop-blur-sm
                       transition-all duration-200 hover:from-red-900/40 hover:to-pink-900/40 
                       active:scale-[0.98] flex items-center justify-center gap-2`,onClick:()=>u(!0),children:[s.jsx("span",{children:""}),s.jsx("span",{children:"Sign Out"})]})]})})}),l&&s.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-6 z-50",children:s.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-purple-900 rounded-3xl p-6 w-full max-w-sm border border-white/20 shadow-2xl",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"text-5xl mb-4 animate-bounce",children:""}),s.jsx("h3",{className:"text-xl font-bold mb-2 text-white",children:"Leaving Already?"}),s.jsx("p",{className:"text-white/60 text-sm",children:"You'll need to sign in again to continue your quiz journey"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>u(!1),className:`flex-1 py-3 rounded-2xl bg-white/10 hover:bg-white/20 
                         transition-all duration-200 font-semibold text-white`,children:"Stay"}),s.jsx("button",{onClick:g,className:`flex-1 py-3 rounded-2xl bg-gradient-to-r from-red-500 to-pink-500 
                         hover:from-red-600 hover:to-pink-600 transition-all duration-200 
                         font-semibold text-white shadow-lg`,children:"Sign Out"})]})]})})]})}function Ii({icon:t,label:e,subtitle:n,right:r,onClick:i}){return s.jsxs("button",{type:"button",onClick:i,className:`w-full flex items-center justify-between px-4 py-4 text-left
                 hover:bg-white/5 first:rounded-t-2xl last:rounded-b-2xl transition-all duration-200`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[t&&s.jsx("span",{className:"text-xl",children:t}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-white",children:e}),n&&s.jsx("div",{className:"text-xs text-white/50 mt-0.5",children:n})]})]}),r]})}function Xd({on:t,set:e}){return s.jsx("span",{onClick:n=>{n.stopPropagation(),e(r=>!r),navigator.vibrate&&navigator.vibrate(10)},className:["inline-flex w-12 h-7 items-center rounded-full transition-all duration-300 px-1 shadow-inner",t?"bg-gradient-to-r from-green-400 to-emerald-500 justify-end":"bg-gray-600 justify-start"].join(" "),role:"switch","aria-checked":t,children:s.jsx("span",{className:["w-5 h-5 rounded-full bg-white shadow-md transition-transform duration-300",t?"scale-110":"scale-100"].join(" ")})})}function vA(){const t=Ye(),[e,n]=f.useState(!1),[r,i]=f.useState(!1),[a,o]=f.useState(!1),[l,u]=f.useState({name:"",phone:"",gender:"",ageGroup:"",city:"",email:"",state:"",country:""}),[d,h]=f.useState({name:"",phone:"",gender:"",ageGroup:"",city:"",email:"",state:"",country:""});f.useEffect(()=>{const k=JSON.parse(localStorage.getItem("currentUser")||"{}");if(!k.phone){const P=JSON.parse(localStorage.getItem("users")||"{}"),D=Object.keys(P).find(L=>P[L].username===k.username);if(D)k.phone=D,localStorage.setItem("currentUser",JSON.stringify(k));else{t("/profile");return}}const I=jt.getUserData(k.phone);I.password;const C=JSON.parse(localStorage.getItem(`user_profile_${k.phone}`)||"{}"),_=P=>P?P.charAt(0).toUpperCase()+P.slice(1).toLowerCase():"",v={name:C.name||k.username||I.username||"",phone:k.phone||"",gender:_(C.gender||k.gender||I.gender||""),ageGroup:C.ageGroup||k.ageGroup||I.ageGroup||"",city:C.city||"",email:C.email||"",state:C.state||"",country:C.country||""};u(v),h(v)},[t]),f.useEffect(()=>{if(e){const k=JSON.stringify(l)!==JSON.stringify(d);o(k)}},[d,l,e]);const g=()=>{n(!0),h({...l}),o(!1)},x=()=>{n(!1),h({...l}),o(!1)},N=()=>{const k=JSON.parse(localStorage.getItem("currentUser")||"{}");if(!k.phone)return;jt.updateUserProfile(k.phone,d)&&(u({...d}),n(!1),o(!1),i(!0),setTimeout(()=>i(!1),3e3))},w=(k,I)=>{h(C=>({...C,[k]:I}))};return s.jsxs(bp,{title:"Edit Profile",subtitle:"Update your information",children:[r&&s.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none",children:s.jsx("div",{className:"bg-green-500/20 border border-green-500/50 rounded-2xl px-8 py-4 backdrop-blur-sm animate-bounce",children:s.jsxs("div",{className:"flex items-center gap-2 text-green-400 font-semibold text-lg",children:[s.jsx("span",{children:"Profile updated"}),s.jsx("span",{className:"text-2xl",children:""})]})})}),s.jsx("div",{className:"flex flex-col justify-center min-h-[calc(100vh-200px)]",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"rounded-3xl border border-white/10 bg-gradient-to-br from-purple-900/20 to-indigo-900/20 backdrop-blur-sm p-4",children:[s.jsx("h3",{className:"text-xs font-semibold text-white/50 uppercase tracking-wider mb-4",children:"Basic Information"}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(es,{label:"Name",value:e?d.name:l.name,onChange:k=>w("name",k),placeholder:"Your full name",disabled:!e}),s.jsx(es,{label:"Phone",value:l.phone,disabled:!0,icon:"",helperText:"Cannot be changed"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e?s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Gender"}),s.jsxs("select",{value:d.gender||"",onChange:k=>w("gender",k.target.value),className:`w-full px-4 py-3 rounded-xl bg-white/5 border border-white/10 
                                text-white transition-all duration-200 hover:bg-white/10 
                                focus:bg-white/10 focus:border-white/30 focus:outline-none`,children:[s.jsx("option",{value:"",children:"Not set"}),s.jsx("option",{value:"Male",children:"Male"}),s.jsx("option",{value:"Female",children:"Female"}),s.jsx("option",{value:"Other",children:"Other"})]})]}):s.jsx(es,{label:"Gender",value:l.gender||"Not set",disabled:!0}),e?s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Age Group"}),s.jsxs("select",{value:d.ageGroup||"",onChange:k=>w("ageGroup",k.target.value),className:`w-full px-4 py-3 rounded-xl bg-white/5 border border-white/10 
                                text-white transition-all duration-200 hover:bg-white/10 
                                focus:bg-white/10 focus:border-white/30 focus:outline-none`,children:[s.jsx("option",{value:"",children:"Not set"}),s.jsx("option",{value:"under-5",children:"Under 5 yrs"}),s.jsx("option",{value:"5-10",children:"5-10 yrs"}),s.jsx("option",{value:"11-15",children:"11-15 yrs"}),s.jsx("option",{value:"16-20",children:"16-20 yrs"}),s.jsx("option",{value:"20+",children:"20+ yrs"})]})]}):s.jsx(es,{label:"Age Group",value:l.ageGroup||"Not set",disabled:!0})]})]})]}),s.jsxs("div",{className:"rounded-3xl border border-white/10 bg-gradient-to-br from-blue-900/20 to-purple-900/20 backdrop-blur-sm p-4",children:[s.jsx("h3",{className:"text-xs font-semibold text-white/50 uppercase tracking-wider mb-4",children:"Contact & Location"}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(es,{label:"Email",value:e?d.email:l.email,onChange:k=>w("email",k),placeholder:"yourname@example.com",type:"email",helperText:e?"Optional":l.email?"":"Not provided",disabled:!e}),s.jsx(es,{label:"City",value:e?d.city:l.city,onChange:k=>w("city",k),placeholder:"Add your city name",disabled:!e}),s.jsx(es,{label:"State",value:e?d.state:l.state,onChange:k=>w("state",k),placeholder:"Your state/province",disabled:!e}),s.jsx(es,{label:"Country",value:e?d.country:l.country,onChange:k=>w("country",k),placeholder:"Your country",disabled:!e})]})]}),e?s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:x,className:`flex-1 py-3 rounded-2xl bg-white/10 hover:bg-white/20 
                         transition-all duration-200 font-semibold text-white`,children:"Cancel"}),s.jsx("button",{onClick:N,disabled:!a,className:`flex-1 py-3 rounded-2xl font-semibold text-white shadow-lg
                         transition-all duration-200 ${a?"bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 cursor-pointer":"bg-gray-600 cursor-not-allowed opacity-50"}`,children:"Save Changes"})]}):s.jsx("button",{onClick:g,className:`w-full py-3 rounded-2xl bg-gradient-to-r from-purple-500 to-pink-500 
                       hover:from-purple-600 hover:to-pink-600 transition-all duration-200 
                       font-semibold text-white shadow-lg`,children:"Edit"})]})})]})}function es({label:t,value:e,onChange:n,disabled:r,placeholder:i,type:a="text",icon:o,helperText:l}){return s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:t}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:a,value:e||"",onChange:u=>n&&n(u.target.value),disabled:r,placeholder:i,className:`w-full px-4 py-3 rounded-xl bg-white/5 border border-white/10 
                   text-white placeholder-white/30 transition-all duration-200
                   ${r?"opacity-50 cursor-not-allowed":"hover:bg-white/10 focus:bg-white/10 focus:border-white/30 focus:outline-none"}`}),o&&s.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-white/50",children:o})]}),l&&s.jsx("p",{className:"text-xs text-white/40 mt-1",children:l})]})}function bA(){const t=Ye();return s.jsx(bp,{title:"Privacy Policy",subtitle:"Your data, your control",children:s.jsx("div",{className:"flex flex-col justify-center min-h-[calc(100vh-200px)]",children:s.jsx("div",{className:"rounded-3xl border border-white/10 bg-gradient-to-br from-purple-900/20 to-indigo-900/20 backdrop-blur-sm p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-6xl mb-4",children:""}),s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Privacy Policy"}),s.jsx("p",{className:"text-white/60 text-lg mb-6",children:"Will be updated soon"}),s.jsxs("div",{className:"space-y-3 text-left text-white/50 text-sm",children:[s.jsx("p",{children:" Your data is encrypted and secure"}),s.jsx("p",{children:" We never share your personal information"}),s.jsx("p",{children:" You can delete your account anytime"}),s.jsx("p",{children:" Minimal data collection for best experience"})]}),s.jsx("button",{onClick:()=>t(-1),className:`mt-8 px-8 py-3 rounded-2xl bg-gradient-to-r from-purple-500 to-pink-500 
                       hover:from-purple-600 hover:to-pink-600 transition-all duration-200 
                       font-semibold text-white shadow-lg`,children:"Got it"})]})})})})}function wA({children:t}){const e=jt.getCurrentUser();return["+919701019117"].includes(e==null?void 0:e.phone)?t:s.jsx(E1,{to:"/",replace:!0})}function NA(){const t=Ye(),[e,n]=f.useState(!0),[r,i]=f.useState("overview"),[a,o]=f.useState("7d"),[l,u]=f.useState({totalUsers:0,activeToday:0,totalSessions:0,avgSessionDuration:0,totalQuizzes:0,quizzesPerSession:0,dauMau:0,bounceRate:0,dailyGrowth:0,quizzesPerUser:0,topButtons:[]}),[d,h]=f.useState([]),[g,x]=f.useState([]),[N,w]=f.useState([]),[k,I]=f.useState([]),[C,_]=f.useState(null),[v,P]=f.useState([]);f.useEffect(()=>(document.body.classList.add("hide-bottom-nav"),()=>{document.body.classList.remove("hide-bottom-nav")}),[]),f.useEffect(()=>{D();const S=E();return()=>S&&S()},[a]);const D=async()=>{try{n(!0);const[S,G,Z,te]=await Promise.all([Ga(ki(ln,"user_stats")),Ga(ki(ln,"sessions")),Ga(ki(ln,"events")),Ga(ki(ln,"quiz_attempts"))]),K=await Ga(ki(ln,"users")),$={};K.docs.forEach(ge=>{$[ge.id]=ge.data()});const O=S.docs.map(ge=>{var Te,Ie,Me,Oe,yt;return{id:ge.id,...ge.data(),name:((Te=$[ge.id])==null?void 0:Te.username)||"Unknown",joinedDate:((Me=(Ie=ge.data().joinedDate)==null?void 0:Ie.toDate)==null?void 0:Me.call(Ie))||null,lastActiveDate:((yt=(Oe=ge.data().lastActive)==null?void 0:Oe.toDate)==null?void 0:yt.call(Oe))||null}});h(O);const V=G.docs.map(ge=>({id:ge.id,...ge.data()}));x(V);const B=Z.docs.map(ge=>({id:ge.id,...ge.data()}));w(B);const M={};B.forEach(ge=>{ge.buttonName&&(M[ge.buttonName]=(M[ge.buttonName]||0)+1)});const z=Object.entries(M).sort(([,ge],[,Te])=>Te-ge).slice(0,5).map(([ge,Te])=>({name:ge,count:Te})),H=te.docs.map(ge=>ge.data()),ne=V.length>0?(H.length/V.length).toFixed(1):0,q={};B.forEach(ge=>{q[ge.userId]=(q[ge.userId]||0)+1});const ee=Object.values(q).filter(ge=>ge===1).length,X=Object.keys(q).length>0?Math.round(ee/Object.keys(q).length*100):0,Q=new Date,oe=new Date(Q);oe.setDate(oe.getDate()-1);const ue=O.filter(ge=>ge.joinedDate&&ge.joinedDate.toDateString()===Q.toDateString()).length,ae=O.filter(ge=>ge.joinedDate&&ge.joinedDate.toDateString()===oe.toDateString()).length,ce=ae>0?Math.round((ue-ae)/ae*100):ue*100,J=new Date().toISOString().split("T")[0],W=V.filter(ge=>ge.date===J),F=new Set(W.map(ge=>ge.userId)).size,re=new Date().getMonth(),le=new Date().getFullYear(),pe=new Set(V.filter(ge=>{const Te=new Date(ge.date);return Te.getMonth()===re&&Te.getFullYear()===le}).map(ge=>ge.userId)).size,Ne=pe>0?Math.round(F/pe*100):0,Pe=V.filter(ge=>ge.duration),De=Pe.length>0?Math.round(Pe.reduce((ge,Te)=>ge+Te.duration,0)/Pe.length):0,xt=O.length>0?(H.length/O.length).toFixed(1):0,Be=L(O,V);I(Be),u({totalUsers:O.length,activeToday:F,totalSessions:V.length,avgSessionDuration:De,totalQuizzes:H.length,quizzesPerSession:ne,dauMau:Ne,bounceRate:X,dailyGrowth:ce,quizzesPerUser:xt,topButtons:z})}catch(S){console.error("Error fetching dashboard data:",S)}finally{n(!1)}},L=(S,G)=>{const Z=[1,2,3,4,5,6,7],te=[];return Z.forEach(K=>{let $=0,O=0;S.forEach(V=>{if(!V.joinedDate)return;const B=new Date(V.joinedDate),M=new Date(B);M.setDate(M.getDate()+K);const z=G.some(H=>H.userId!==V.id?!1:new Date(H.date).toDateString()===M.toDateString());new Date-B>=K*24*60*60*1e3&&(O++,z&&$++)}),te.push({day:`D${K}`,rate:O>0?Math.round($/O*100):0,retained:$,total:O})}),te},E=()=>{const S=vT(ki(ln,"sessions"),bT("active","==",!0),wT(10));return _T(S,Z=>{console.log(`${Z.size} active sessions`)})},m=async S=>{try{const G=N.filter(Z=>Z.userId===S).sort((Z,te)=>{var O,V,B,M;const K=((V=(O=Z.timestamp)==null?void 0:O.toDate)==null?void 0:V.call(O))||new Date(Z.timestamp);return(((M=(B=te.timestamp)==null?void 0:B.toDate)==null?void 0:M.call(B))||new Date(te.timestamp))-K}).slice(0,50);P(G),_(d.find(Z=>Z.id===S))}catch(G){console.error("Error loading user journey:",G)}},y=S=>{if(!S)return"0s";if(S<60)return`${S}s`;const G=Math.floor(S/60),Z=S%60;return`${G}m ${Z}s`},j=S=>{if(!S)return"Never";const G=S.toDate?S.toDate():new Date(S),te=new Date-G,K=Math.floor(te/(1e3*60*60*24));return K===0?"Today":K===1?"Yesterday":K<7?`${K}d ago`:G.toLocaleDateString("en-IN",{month:"short",day:"numeric"})},A=S=>S?(S.toDate?S.toDate():new Date(S)).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",dateStyle:"short",timeStyle:"short"}):"N/A",T=({data:S,dataKey:G,color:Z="#3B82F6",showValue:te=!0})=>{const K=Math.max(...S.map($=>$[G]));return s.jsx("div",{className:"space-y-2",children:S.map(($,O)=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"text-xs text-gray-400 w-12",children:$.day||$.name}),s.jsxs("div",{className:"flex-1 bg-gray-800 rounded-full h-6 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full transition-all duration-500",style:{width:`${$[G]/K*100}%`,background:`linear-gradient(90deg, ${Z}, ${Z}dd)`}}),te&&s.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-medium",children:[$[G],"%"]})]})]},O))})};return e?s.jsx("div",{className:"min-h-screen bg-[#000000] flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white/20 mx-auto mb-4"}),s.jsx("div",{className:"text-white/60 text-sm",children:"Loading analytics..."})]})}):s.jsxs("div",{className:"min-h-screen bg-[#000000] text-white",style:{paddingTop:"env(safe-area-inset-top)"},children:[s.jsx("div",{className:"bg-[#0a0a0a] border-b border-white/10 px-4 py-2",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:()=>t("/profile"),className:"h-11 w-11 rounded-full bg-white/5 backdrop-blur border border-white/10 grid place-items-center hover:bg-white/10 transition-all",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("h1",{className:"text-xl font-semibold tracking-tight",children:"Analytics"})]}),s.jsx("div",{className:"flex gap-1.5",children:[{id:"today",label:"Today"},{id:"yesterday",label:"YTD"},{id:"7d",label:"7D"},{id:"all",label:"All"}].map(S=>s.jsx("button",{onClick:()=>o(S.id),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-all ${a===S.id?"bg-white/15 text-white":"text-white/60 hover:text-white/80"}`,children:S.label},S.id))})]})}),s.jsx("div",{className:"border-b border-white/10 px-4",children:s.jsx("div",{className:"flex gap-6",children:[{id:"overview",label:"Overview"},{id:"users",label:"Users"},{id:"engagement",label:"Engagement"}].map(S=>s.jsx("button",{onClick:()=>i(S.id),className:`py-3 px-1 border-b-2 transition-colors text-sm font-medium ${r===S.id?"border-white text-white":"border-transparent text-white/40 hover:text-white/60"}`,children:S.label},S.id))})}),s.jsx("div",{className:"px-4 py-3 bg-[#0a0a0a] border-b border-white/10",children:s.jsxs("div",{className:"flex gap-3 overflow-x-auto pb-1",children:[s.jsxs("div",{className:"flex-shrink-0 px-3 py-2 bg-white/5 rounded-lg min-w-[80px]",children:[s.jsx("div",{className:"text-[10px] text-white/40 uppercase tracking-wider",children:"Sessions"}),s.jsx("div",{className:"text-base font-semibold",children:l.totalSessions})]}),s.jsxs("div",{className:"flex-shrink-0 px-3 py-2 bg-white/5 rounded-lg min-w-[80px]",children:[s.jsx("div",{className:"text-[10px] text-white/40 uppercase tracking-wider",children:"Avg Time"}),s.jsx("div",{className:"text-base font-semibold",children:y(l.avgSessionDuration)})]}),s.jsxs("div",{className:"flex-shrink-0 px-3 py-2 bg-white/5 rounded-lg min-w-[80px]",children:[s.jsx("div",{className:"text-[10px] text-white/40 uppercase tracking-wider",children:"Quizzes"}),s.jsx("div",{className:"text-base font-semibold",children:l.totalQuizzes})]}),s.jsxs("div",{className:"flex-shrink-0 px-3 py-2 bg-white/5 rounded-lg min-w-[80px]",children:[s.jsx("div",{className:"text-[10px] text-white/40 uppercase tracking-wider",children:"Q/User"}),s.jsx("div",{className:"text-base font-semibold",children:l.quizzesPerUser})]}),s.jsxs("div",{className:"flex-shrink-0 px-3 py-2 bg-white/5 rounded-lg min-w-[80px]",children:[s.jsx("div",{className:"text-[10px] text-white/40 uppercase tracking-wider",children:"Bounce"}),s.jsxs("div",{className:"text-base font-semibold",children:[l.bounceRate,"%"]})]}),s.jsxs("div",{className:"flex-shrink-0 px-3 py-2 bg-white/5 rounded-lg min-w-[80px]",children:[s.jsx("div",{className:"text-[10px] text-white/40 uppercase tracking-wider",children:"Growth"}),s.jsxs("div",{className:`text-base font-semibold ${l.dailyGrowth>=0?"text-green-400":"text-red-400"}`,children:[l.dailyGrowth>0?"+":"",l.dailyGrowth,"%"]})]})]})}),s.jsxs("div",{className:"p-4",children:[r==="overview"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"bg-[#0a0a0a] rounded-2xl p-5 border border-white/10",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"text-xs text-white/40 uppercase tracking-wider",children:"Total Users"}),s.jsx("span",{className:"text-lg",children:""})]}),s.jsx("div",{className:"text-3xl font-bold",children:l.totalUsers}),s.jsx("div",{className:"text-xs text-white/40 mt-1",children:"All time"})]}),s.jsxs("div",{className:"bg-[#0a0a0a] rounded-2xl p-5 border border-white/10",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"text-xs text-white/40 uppercase tracking-wider",children:"Active Today"}),s.jsx("span",{className:"text-lg",children:""})]}),s.jsx("div",{className:"text-3xl font-bold",children:l.activeToday}),s.jsx("div",{className:"text-xs text-white/40 mt-1",children:"Unique users"})]}),s.jsxs("div",{className:"bg-[#0a0a0a] rounded-2xl p-5 border border-white/10",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"text-xs text-white/40 uppercase tracking-wider",children:"Quiz/Session"}),s.jsx("span",{className:"text-lg",children:""})]}),s.jsx("div",{className:"text-3xl font-bold",children:l.quizzesPerSession}),s.jsx("div",{className:"text-xs text-white/40 mt-1",children:"Average"})]}),s.jsxs("div",{className:"bg-[#0a0a0a] rounded-2xl p-5 border border-white/10",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"text-xs text-white/40 uppercase tracking-wider",children:"DAU/MAU"}),s.jsx("span",{className:"text-lg",children:""})]}),s.jsxs("div",{className:"text-3xl font-bold",children:[l.dauMau,"%"]}),s.jsx("div",{className:"text-xs text-white/40 mt-1",children:"Stickiness"})]})]}),s.jsxs("div",{className:"bg-[#0a0a0a] rounded-2xl p-5 border border-white/10",children:[s.jsx("h3",{className:"text-sm font-semibold mb-4 text-white/80",children:"Top Features Used"}),s.jsx("div",{className:"space-y-3",children:l.topButtons.map((S,G)=>s.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-white/5 last:border-0",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-lg",children:G===0?"":G===1?"":G===2?"":""}),s.jsx("span",{className:"text-sm text-white/80",children:S.name})]}),s.jsxs("span",{className:"text-sm text-white/40",children:[S.count," clicks"]})]},G))})]})]}),r==="users"&&s.jsxs("div",{className:"bg-[#0a0a0a] rounded-2xl border border-white/10 overflow-hidden",children:[s.jsx("div",{className:"px-5 py-4 border-b border-white/10",children:s.jsxs("h2",{className:"text-sm font-semibold text-white/80",children:["All Users (",d.length,")"]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-black/50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-white/40 uppercase tracking-wider",children:"Phone"}),s.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-white/40 uppercase tracking-wider",children:"Name"}),s.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-white/40 uppercase tracking-wider",children:"Sessions"}),s.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-white/40 uppercase tracking-wider",children:"Quizzes"}),s.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-white/40 uppercase tracking-wider",children:"Score"}),s.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-white/40 uppercase tracking-wider",children:"Joined"}),s.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-white/40 uppercase tracking-wider",children:"Active"}),s.jsx("th",{className:"text-center py-3 px-4 text-xs font-medium text-white/40 uppercase tracking-wider",children:"View"})]})}),s.jsx("tbody",{className:"divide-y divide-white/5",children:d.map(S=>s.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[s.jsx("td",{className:"py-3 px-4 text-sm text-white/80",children:S.userId||S.id}),s.jsx("td",{className:"py-3 px-4 text-sm text-white/60",children:S.name}),s.jsx("td",{className:"py-3 px-4 text-sm text-white/60",children:S.totalSessions||0}),s.jsx("td",{className:"py-3 px-4 text-sm text-white/60",children:S.totalQuizzes||0}),s.jsx("td",{className:"py-3 px-4 text-sm text-white/60",children:S.totalScore||0}),s.jsx("td",{className:"py-3 px-4 text-sm text-white/60",children:j(S.joinedDate)}),s.jsx("td",{className:"py-3 px-4 text-sm text-white/60",children:j(S.lastActiveDate)}),s.jsx("td",{className:"py-3 px-4 text-center",children:s.jsx("button",{onClick:()=>m(S.id),className:"px-3 py-1 bg-white/10 hover:bg-white/20 rounded-full text-xs transition-colors",children:"View"})})]},S.id))})]})})]}),r==="engagement"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-[#0a0a0a] rounded-2xl p-5 border border-white/10",children:[s.jsx("h3",{className:"text-sm font-semibold mb-4 text-white/80",children:"User Retention"}),s.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[s.jsxs("div",{className:"text-center p-3 bg-white/5 rounded-xl",children:[s.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[Math.round(d.filter(S=>{const G=S.lastActiveDate;return G&&new Date-G<864e5}).length/Math.max(d.length,1)*100),"%"]}),s.jsx("div",{className:"text-xs text-white/40 mt-1",children:"Daily Active"})]}),s.jsxs("div",{className:"text-center p-3 bg-white/5 rounded-xl",children:[s.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:[Math.round(d.filter(S=>{const G=S.lastActiveDate;return G&&new Date-G<6048e5}).length/Math.max(d.length,1)*100),"%"]}),s.jsx("div",{className:"text-xs text-white/40 mt-1",children:"Weekly Active"})]}),s.jsxs("div",{className:"text-center p-3 bg-white/5 rounded-xl",children:[s.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:[Math.round(d.filter(S=>{const G=S.lastActiveDate;return G&&new Date-G<2592e6}).length/Math.max(d.length,1)*100),"%"]}),s.jsx("div",{className:"text-xs text-white/40 mt-1",children:"Monthly Active"})]})]}),s.jsx("h4",{className:"text-xs font-medium text-white/60 mb-3 uppercase tracking-wider",children:"Retention by Day"}),s.jsx(T,{data:k,dataKey:"rate",color:"#10B981"})]}),s.jsxs("div",{className:"bg-[#0a0a0a] rounded-2xl p-5 border border-white/10",children:[s.jsx("h3",{className:"text-sm font-semibold mb-4 text-white/80",children:"Session Duration"}),s.jsx("div",{className:"space-y-3",children:[{label:"< 1 min",count:g.filter(S=>S.duration<60).length},{label:"1-5 min",count:g.filter(S=>S.duration>=60&&S.duration<300).length},{label:"5-10 min",count:g.filter(S=>S.duration>=300&&S.duration<600).length},{label:"> 10 min",count:g.filter(S=>S.duration>=600).length}].map(S=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-white/60",children:S.label}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-32 bg-white/10 rounded-full h-1.5",children:s.jsx("div",{className:"h-full bg-white/40 rounded-full",style:{width:`${S.count/Math.max(g.length,1)*100}%`}})}),s.jsx("span",{className:"text-sm text-white/40 w-10 text-right",children:S.count})]})]},S.label))})]})]})]}),C&&s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:()=>{_(null),P([])},children:s.jsxs("div",{className:"bg-[#0a0a0a] rounded-2xl p-5 max-w-2xl w-full max-h-[80vh] overflow-hidden flex flex-col border border-white/10",onClick:S=>S.stopPropagation(),children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"User Journey"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm mb-4",children:[s.jsxs("div",{className:"text-white/40",children:["User: ",s.jsx("span",{className:"text-white/80",children:C.name})]}),s.jsxs("div",{className:"text-white/40",children:["Phone: ",s.jsx("span",{className:"text-white/80",children:C.userId||C.id})]}),s.jsxs("div",{className:"text-white/40",children:["Sessions: ",s.jsx("span",{className:"text-white/80",children:C.totalSessions||0})]}),s.jsxs("div",{className:"text-white/40",children:["Quizzes: ",s.jsx("span",{className:"text-white/80",children:C.totalQuizzes||0})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto",children:[s.jsx("h4",{className:"text-xs font-medium text-white/40 mb-3 uppercase tracking-wider",children:"Recent Activity"}),s.jsx("div",{className:"space-y-2",children:v.map((S,G)=>s.jsxs("div",{className:"flex items-center gap-3 py-2 px-3 bg-white/5 rounded-lg",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"text-sm text-white/80",children:S.buttonName}),s.jsx("span",{className:"text-xs text-white/40 ml-2",children:S.context})]}),s.jsx("div",{className:"text-xs text-white/40",children:A(S.timestamp)})]},G))})]}),s.jsx("button",{onClick:()=>{_(null),P([])},className:"mt-4 px-4 py-2 bg-white/10 hover:bg-white/20 rounded-xl transition-colors w-full",children:"Close"})]})})]})}const jA=t=>JSON.parse(localStorage.getItem("users")||"{}")[t],SA=()=>!!localStorage.getItem("currentUser");function _A(){const t=Ye(),e=Pt(),[n,r]=f.useState(()=>{var g;return sessionStorage.getItem("tempPhone")||((g=e.state)==null?void 0:g.phone)||""}),[i,a]=f.useState(()=>sessionStorage.getItem("tempCountryCode")||"+91"),[o,l]=f.useState(!1),[u,d]=f.useState("");f.useEffect(()=>{sessionStorage.setItem("tempPhone",n),sessionStorage.setItem("tempCountryCode",i)},[n,i]);const h=async()=>{l(!0),d("");const g=n.replace(/\D/g,""),x=i+g;if(g.length!==10){d("Please enter a valid 10-digit phone number"),l(!1);return}sessionStorage.setItem("fullPhone",x);const N=JSON.parse(localStorage.getItem("users")||"{}"),w=N[x]!==void 0;console.log("Users in database:",N),console.log("Phone checking:",x),console.log("User exists?:",w),w?t("/auth/signin",{state:{phone:x}}):t("/auth/avatar",{state:{phone:x}}),l(!1)};return f.useEffect(()=>{var g,x;if(!((g=e.state)!=null&&g.preventAutoSubmit)&&!((x=e.state)!=null&&x.fromAvatar)&&n&&n.length===10){const N=setTimeout(()=>{h()},500);return()=>clearTimeout(N)}},[]),s.jsxs("div",{className:"auth-screen",style:{background:"linear-gradient(135deg, #aa529bff 0%, #6d4397ff 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:[s.jsxs("div",{className:"decorative-icons",children:[s.jsx("div",{className:"floating-icon",style:{top:"5%",left:"10%",animationDelay:"0s"},children:""}),s.jsx("div",{className:"floating-icon",style:{top:"15%",right:"10%",animationDelay:"5s"},children:""}),s.jsx("div",{className:"floating-icon",style:{top:"20%",left:"15%",animationDelay:"10s"},children:""}),s.jsx("div",{className:"floating-icon",style:{top:"75%",right:"20%",animationDelay:"15s"},children:""}),s.jsx("div",{className:"floating-icon",style:{top:"85%",left:"25%",animationDelay:"20s"},children:""})]}),s.jsx("div",{className:"mascot",style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"24px"},children:s.jsx("div",{style:{fontSize:"100px"},children:""})}),s.jsxs("div",{className:"content-card",children:[s.jsx("h1",{className:"title",children:"Ready to Play?"}),s.jsx("p",{className:"subtitle",children:"Enter your phone to start!"}),s.jsxs("div",{className:"phone-input-group",style:{display:"flex",gap:"8px",marginBottom:"24px",alignItems:"center",justifyContent:"center"},children:[s.jsxs("select",{className:"country-select",value:i,onChange:g=>a(g.target.value),style:{width:"auto",minWidth:"95px",padding:"16px 8px",border:"2px solid #e2e8f0",borderRadius:"16px",fontSize:"16px",fontWeight:"600",background:"white",transition:"all 0.3s",color:"#333",textAlign:"center"},children:[s.jsx("option",{value:"+91",children:" +91"}),s.jsx("option",{value:"+1",children:" +1"}),s.jsx("option",{value:"+44",children:" +44"}),s.jsx("option",{value:"+86",children:" +86"}),s.jsx("option",{value:"+81",children:" +81"})]}),s.jsx("input",{type:"tel",className:"phone-input",placeholder:"Phone number",value:n,onChange:g=>{const x=g.target.value.replace(/\D/g,"");x.length<=10&&(r(x),u&&d(""))},maxLength:"10",inputMode:"numeric",pattern:"[0-9]*",style:{flex:1,padding:"16px",paddingLeft:"12px",border:"2px solid #e2e8f0",borderRadius:"16px",fontSize:"18px",fontWeight:"600",transition:"all 0.3s",background:"white",color:"#333",WebkitTextFillColor:"#333"}})]}),n.length>0&&n.length<10&&s.jsxs("p",{style:{color:"#f59e0b",fontSize:"14px",textAlign:"center",marginTop:"-16px",marginBottom:"16px"},children:["Enter ",10-n.length," more digit",10-n.length>1?"s":""]}),s.jsxs("button",{className:"submit-button",onClick:h,disabled:o||n.length!==10,style:{width:"100%",padding:"18px",background:n.length===10?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"linear-gradient(135deg, #94a3b8 0%, #cbd5e1 100%)",color:"white",border:"none",borderRadius:"16px",fontSize:"18px",fontWeight:"700",cursor:n.length===10&&!o?"pointer":"not-allowed",transition:"all 0.3s",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[o?"Loading...":"Continue",s.jsx("span",{children:""})]}),u&&s.jsx("p",{className:"error-message",style:{color:"#ef4444",fontSize:"14px",textAlign:"center",marginTop:"12px",fontWeight:"600"},children:u})]})]})}function kA(){const t=Pt(),e=Ye(),{phone:n,firebaseUser:r}=t.state||{},[i,a]=f.useState(""),[o,l]=f.useState(!1),[u,d]=f.useState(""),[h,g]=f.useState(!1),[x,N]=f.useState(!1),[w,k]=f.useState(""),I=jA(n),[C,_]=f.useState(!1),[v,P]=f.useState(""),[D,L]=f.useState(!1);f.useEffect(()=>{if(localStorage.getItem("rememberCredentials")==="true"&&N(!0),n){const S=JSON.parse(localStorage.getItem(`user_profile_${n}`)||"{}"),Z=JSON.parse(localStorage.getItem("users")||"{}")[n]||{},te=S.name||Z.username||(I==null?void 0:I.username)||"";k(te)}},[n,I]);const E=async()=>{if(!i){d("Please enter your password");return}g(!0),d(""),await new Promise(T=>setTimeout(T,500)),I&&I.password===i?(jt.setCurrentUser(n),mt.startSession(n),r&&localStorage.setItem("firebaseUser",JSON.stringify({uid:r.uid,phoneNumber:r.phoneNumber})),x&&localStorage.setItem("rememberCredentials","true"),e("/",{replace:!0})):(d("Wrong password"),g(!1),setTimeout(()=>d(""),3e3))},m=()=>{alert("OTP feature coming soon!")},y=()=>{sessionStorage.removeItem("tempPhone"),sessionStorage.removeItem("tempCountryCode");const T=(n==null?void 0:n.slice(-10))||"";e("/auth",{replace:!0,state:{phone:T,preventAutoSubmit:!0}})},j=()=>{sessionStorage.removeItem("tempPhone"),sessionStorage.removeItem("tempCountryCode"),e("/auth",{replace:!0,state:{isNewAccount:!0}})},A=T=>{T.key==="Enter"&&E()};return s.jsxs("div",{className:"auth-screen",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[s.jsx("button",{className:"back-button",onClick:y,style:{position:"absolute",top:"40px",left:"20px",background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"50%",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:10,backdropFilter:"blur(10px)",transition:"all 0.3s ease"},onMouseEnter:T=>T.target.style.background="rgba(255,255,255,0.3)",onMouseLeave:T=>T.target.style.background="rgba(255,255,255,0.2)",children:s.jsx("span",{style:{fontSize:"24px",color:"white"},children:""})}),s.jsxs("div",{className:"decorative-icons",children:[s.jsx("div",{className:"floating-icon",style:{top:"10%",left:"5%",animationDelay:"0s"},children:""}),s.jsx("div",{className:"floating-icon",style:{top:"20%",right:"10%",animationDelay:"2s"},children:""}),s.jsx("div",{className:"floating-icon",style:{top:"70%",left:"8%",animationDelay:"4s"},children:""}),s.jsx("div",{className:"floating-icon",style:{top:"80%",right:"5%",animationDelay:"6s"},children:""})]}),s.jsxs("div",{className:"content-card",style:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",borderRadius:"32px",padding:"32px",width:"90%",maxWidth:"400px",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",margin:"0 auto"},children:[(I==null?void 0:I.avatar)&&s.jsx("div",{style:{fontSize:"60px",textAlign:"center",marginBottom:"16px",animation:"bounce 2s infinite"},children:I.avatar.emoji}),s.jsxs("div",{className:"welcome-back",children:[s.jsx("h1",{className:"title",style:{fontSize:"28px",fontWeight:"800",textAlign:"center",marginBottom:"8px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Welcome Back! "}),s.jsx("p",{className:"subtitle",style:{fontSize:"16px",color:"#64748b",textAlign:"center",marginBottom:"24px"},children:w?`Hey ${w}!`:"Good to see you again!"})]}),s.jsx("div",{className:"phone-display",style:{fontSize:"18px",fontWeight:"600",color:"#667eea",marginBottom:"24px",textAlign:"center",padding:"12px",background:"rgba(102, 126, 234, 0.1)",borderRadius:"12px"},children:n}),s.jsxs("div",{style:{position:"relative",marginBottom:"16px"},children:[s.jsx("input",{type:o?"text":"password",className:"phone-input",placeholder:"Enter your password",value:i,onChange:T=>{a(T.target.value),u&&d("")},onKeyPress:A,style:{width:"100%",paddingRight:"45px",border:u?"2px solid #ef4444":"2px solid #e2e8f0",color:"#333",fontSize:"16px",WebkitTextFillColor:"#333",backgroundColor:"white"},autoFocus:!0}),s.jsx("button",{type:"button",onClick:()=>l(!o),style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",padding:"5px",fontSize:"20px",color:"#667eea"},"aria-label":o?"Hide password":"Show password",children:o?"":""})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"20px"},children:[s.jsx("input",{type:"checkbox",id:"rememberMe",checked:x,onChange:T=>N(T.target.checked),style:{width:"18px",height:"18px",cursor:"pointer",accentColor:"#667eea"}}),s.jsx("label",{htmlFor:"rememberMe",style:{fontSize:"14px",color:"#64748b",cursor:"pointer",userSelect:"none"},children:"Remember me"})]}),u&&s.jsxs("div",{style:{color:"#f59e0b",fontSize:"13px",textAlign:"center",marginTop:"-12px",marginBottom:"16px",fontWeight:"500"},children:[" ",u]}),s.jsx("button",{className:"submit-button",onClick:E,disabled:h,style:{width:"100%",padding:"18px",background:h?"linear-gradient(135deg, #94a3b8 0%, #cbd5e1 100%)":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"16px",fontSize:"18px",fontWeight:"700",cursor:h?"not-allowed":"pointer",transition:"all 0.3s",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"20px"},children:h?s.jsxs(s.Fragment,{children:[s.jsx("span",{children:"Signing in..."}),s.jsx("span",{className:"animate-spin",children:""})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{children:"Sign In"}),s.jsx("span",{children:""})]})}),s.jsx("div",{className:"divider",style:{textAlign:"center",margin:"20px 0",position:"relative"},children:s.jsx("span",{className:"divider-text",style:{background:"rgba(255, 255, 255, 0.95)",padding:"0 16px",position:"relative",color:"#94a3b8",fontSize:"14px"},children:"OR"})}),s.jsx("button",{className:"otp-button",onClick:m,style:{width:"100%",padding:"16px",background:"white",border:"2px solid #e2e8f0",borderRadius:"16px",fontSize:"16px",fontWeight:"600",color:"#667eea",cursor:"pointer",transition:"all 0.3s",marginBottom:"12px"},onMouseEnter:T=>{T.currentTarget.style.background="rgba(102, 126, 234, 0.05)",T.currentTarget.style.borderColor="#667eea"},onMouseLeave:T=>{T.currentTarget.style.background="white",T.currentTarget.style.borderColor="#e2e8f0"},children:"Send OTP Instead"}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"20px",paddingTop:"20px",borderTop:"1px solid #e2e8f0"},children:[s.jsx("a",{href:"#",onClick:T=>{T.preventDefault(),_(!0)},style:{color:"#7c3aed",fontSize:"14px",textDecoration:"none",fontWeight:"600"},children:"Forgot password?"}),s.jsx("a",{href:"#",onClick:T=>{T.preventDefault(),j()},style:{color:"#7c3aed",fontSize:"14px",textDecoration:"none",fontWeight:"600"},children:"Create new account"})]})]}),C&&s.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-6 z-50",children:s.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-purple-900 rounded-3xl p-6 w-full max-w-sm border border-white/20 shadow-2xl",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"text-5xl mb-4",children:""}),s.jsx("h3",{className:"text-xl font-bold mb-2 text-white",children:"Reset Password"}),s.jsx("p",{className:"text-white/60 text-sm",children:"Enter your new password"})]}),s.jsxs("div",{className:"relative mb-4",children:[s.jsx("input",{type:o?"text":"password",value:v,onChange:T=>P(T.target.value),placeholder:"New password (min 6 characters)",className:`w-full px-4 py-3 pr-12 rounded-xl bg-white/10 border border-white/20 
                        text-white placeholder-white/50`,autoFocus:!0}),s.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute right-3 top-1/2 -translate-y-1/2 text-white/70 hover:text-white",style:{background:"none",border:"none",cursor:"pointer",padding:"5px",fontSize:"20px"},children:o?"":""})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>{_(!1),P("")},className:`flex-1 py-3 rounded-2xl bg-white/10 hover:bg-white/20 
                         transition-all duration-200 font-semibold text-white`,children:"Cancel"}),s.jsx("button",{onClick:()=>{if(v.length>=6){const T=JSON.parse(localStorage.getItem("users")||"{}");T[n]&&(T[n].password=v,localStorage.setItem("users",JSON.stringify(T)),_(!1),P(""),a(v),L(!0),setTimeout(()=>L(!1),2e3))}else alert("Password must be at least 6 characters")},className:`flex-1 py-3 rounded-2xl bg-gradient-to-r from-green-500 to-emerald-500 
                         hover:from-green-600 hover:to-emerald-600 transition-all duration-200 
                         font-semibold text-white shadow-lg`,children:"Reset"})]})]})}),D&&s.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none",children:s.jsx("div",{className:"bg-green-500 rounded-2xl px-8 py-6 animate-bounce-in",children:s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("div",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center mb-3 animate-scale-in",children:s.jsx("span",{className:"text-green-500 text-3xl",children:""})}),s.jsx("p",{className:"text-white font-semibold text-lg",children:"Password reset successfully!"})]})})}),s.jsx("style",{jsx:!0,children:`
        @keyframes bounce-in {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); opacity: 1; }
        }
        @keyframes scale-in {
            0% { transform: scale(0); }
            100% { transform: scale(1); }
        }
        .animate-bounce-in {
            animation: bounce-in 0.5s ease-out;
        }
        .animate-scale-in {
            animation: scale-in 0.3s ease-out 0.2s both;
        }
        @keyframes shake {
          0%, 100% { transform: translateX(0); }
          25% { transform: translateX(-5px); }
          75% { transform: translateX(5px); }
        }
        
        @keyframes bounce {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-20px); }
        }
        
        .animate-spin {
          display: inline-block;
          animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})}function EA(){const t=Pt(),e=Ye(),{phone:n,firebaseUser:r}=t.state||{},[i,a]=f.useState(()=>{var d;if((d=t.state)!=null&&d.avatar)return t.state.avatar;const u=sessionStorage.getItem("tempAvatar");return u?JSON.parse(u):null}),o=[{id:1,emoji:"",name:"Robot",color:"#667eea"},{id:2,emoji:"",name:"Unicorn",color:"#ec4899"},{id:3,emoji:"",name:"Dragon",color:"#10b981"},{id:4,emoji:"",name:"Wizard",color:"#8b5cf6"},{id:5,emoji:"",name:"Astronaut",color:"#3b82f6"},{id:6,emoji:"",name:"Ninja",color:"#1f2937"}];f.useEffect(()=>{i&&sessionStorage.setItem("tempAvatar",JSON.stringify(i))},[i]);const l=()=>{i&&e("/auth/username",{state:{phone:n,avatar:i,firebaseUser:r}})};return s.jsxs("div",{className:"auth-screen",style:{background:"linear-gradient(135deg, #1e3a8a 0%, #3730a3 35%, #6d28d9 70%, #a78bfa 100%)"},children:[s.jsx("button",{className:"back-button",onClick:()=>e("/auth",{state:{phone:n==null?void 0:n.replace(/^\+\d{1,3}/,""),fromAvatar:!0}}),style:{position:"absolute",top:"40px",left:"20px",background:"rgba(255,255,255,0.15)",border:"none",borderRadius:"50%",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:10,backdropFilter:"blur(10px)",transition:"all 0.3s ease"},onMouseEnter:u=>u.target.style.background="rgba(255,255,255,0.25)",onMouseLeave:u=>u.target.style.background="rgba(255,255,255,0.15)",children:s.jsx("span",{style:{fontSize:"24px",color:"rgba(194, 128, 190, 0.9)"},children:""})}),s.jsxs("div",{className:"content-card",style:{background:"rgba(248, 250, 252, 0.95)",backdropFilter:"blur(20px)",borderRadius:"32px",padding:"24px 20px",width:"95%",maxWidth:"100%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)"},children:[s.jsxs("div",{className:"progress-dots",children:[s.jsx("div",{className:"dot active",style:{background:"#3730a3"}}),s.jsx("div",{className:"dot",style:{background:"#bf89ceff"}})]}),s.jsx("h1",{className:"title",style:{fontSize:"28px",fontWeight:"800",textAlign:"center",marginBottom:"8px",background:"linear-gradient(135deg, #1e3a8a 0%, #6d28d9 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Pick Your Hero!"}),s.jsx("p",{className:"subtitle",style:{fontSize:"16px",color:"#64748b",textAlign:"center",marginBottom:"32px"},children:"Choose your quiz champion"}),s.jsx("div",{className:"avatar-grid",style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px",marginBottom:"32px",padding:"0",maxWidth:"500px",margin:"0 auto 32px auto"},children:o.map(u=>s.jsxs("div",{className:`avatar-card ${(i==null?void 0:i.id)===u.id?"selected":""}`,onClick:()=>a(u),style:{aspectRatio:"1",borderRadius:"20px",background:(i==null?void 0:i.id)===u.id?"linear-gradient(135deg, rgba(55, 48, 163, 0.1), rgba(109, 40, 217, 0.1))":"white",border:(i==null?void 0:i.id)===u.id?"3px solid #3730a3":"3px solid transparent",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s",boxShadow:(i==null?void 0:i.id)===u.id?"0 4px 20px rgba(55, 48, 163, 0.2)":"0 2px 10px rgba(0, 0, 0, 0.05)",transform:(i==null?void 0:i.id)===u.id?"scale(1.05)":"scale(1)"},onMouseEnter:d=>{(i==null?void 0:i.id)!==u.id&&(d.currentTarget.style.transform="scale(1.05)",d.currentTarget.style.boxShadow="0 4px 20px rgba(55, 48, 163, 0.15)")},onMouseLeave:d=>{(i==null?void 0:i.id)!==u.id&&(d.currentTarget.style.transform="scale(1)",d.currentTarget.style.boxShadow="0 2px 10px rgba(0, 0, 0, 0.05)")},children:[s.jsx("div",{className:"avatar-emoji",style:{fontSize:"40px",marginBottom:"8px"},children:u.emoji}),s.jsx("div",{className:"avatar-name",style:{fontSize:"14px",fontWeight:"600",color:(i==null?void 0:i.id)===u.id?"#3730a3":"#64748b"},children:u.name})]},u.id))}),s.jsxs("button",{className:"submit-button",disabled:!i,onClick:l,style:{width:"100%",padding:"18px",background:i?"linear-gradient(135deg, #3730a3 0%, #6d28d9 100%)":"linear-gradient(135deg, #94a3b8 0%, #cbd5e1 100%)",color:"white",border:"none",borderRadius:"16px",fontSize:"18px",fontWeight:"700",cursor:i?"pointer":"not-allowed",transition:"all 0.3s",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",boxShadow:i?"0 4px 20px rgba(55, 48, 163, 0.3)":"none"},onMouseEnter:u=>{i&&(u.currentTarget.style.transform="translateY(-2px)",u.currentTarget.style.boxShadow="0 6px 30px rgba(55, 48, 163, 0.4)")},onMouseLeave:u=>{i&&(u.currentTarget.style.transform="translateY(0)",u.currentTarget.style.boxShadow="0 4px 20px rgba(55, 48, 163, 0.3)")},children:["Continue",s.jsx("span",{children:""})]})]})]})}const CA=async(t,e)=>{console.log("Starting Firestore save for:",t),console.log("User data:",JSON.stringify(e));try{return await Mi(mr(ln,"users",t),e),console.log("Firestore save successful"),!0}catch(n){return console.error("Firestore save error:",n),console.error("Error details:",JSON.stringify(n)),!1}};function TA(){const t=Pt(),e=Ye(),{phone:n,avatar:r,firebaseUser:i}=t.state||{},[a,o]=f.useState(""),[l,u]=f.useState(""),[d,h]=f.useState(""),[g,x]=f.useState(""),[N,w]=f.useState(""),k=[{value:"under-5",label:"Under 5 yrs"},{value:"5-10",label:"5-10 yrs"},{value:"11-15",label:"11-15 yrs"},{value:"16-20",label:"16-20 yrs"},{value:"20+",label:"20+ yrs"}],I=()=>{if(w(""),!a){w("Please enter your name");return}if(!l||l.length<6){w("Password must be at least 6 characters");return}if(!d){w("Please select your gender");return}if(!g){w("Please select your age group");return}const _=l||"123456",v=JSON.parse(localStorage.getItem("users")||"{}");v[n]={username:a,gender:d,ageGroup:g,avatar:r,password:_,phone:n,createdAt:new Date().toISOString()},localStorage.setItem("users",JSON.stringify(v)),CA(n,{username:a,gender:d,ageGroup:g,avatar:r,password:_,createdAt:new Date().toISOString()}).then(()=>{console.log("User saved to Firestore")}).catch(D=>{console.log("Firestore save failed:",D)}),i&&localStorage.setItem("firebaseUser",JSON.stringify({uid:i.uid,phoneNumber:i.phoneNumber})),localStorage.setItem("currentUser",JSON.stringify({phone:n,username:a,gender:d,ageGroup:g,avatar:r})),mt.startSession(n);const P={name:a,level:1,coins:0,currentStreak:0,xp:0};localStorage.setItem("qp_player",JSON.stringify(P)),localStorage.setItem("userName",a),e("/welcome",{state:{username:a},replace:!0})},C=()=>{e("/auth/avatar",{state:{phone:n,avatar:r,firebaseUser:i}})};return s.jsxs("div",{className:"auth-screen",style:{background:"linear-gradient(135deg, #6b46c1 0%, #9333ea 50%, #ec4899 100%)"},children:[s.jsx("button",{className:"back-button",onClick:C,style:{position:"absolute",top:"40px",left:"20px",background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"50%",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:10,backdropFilter:"blur(10px)",transition:"all 0.3s ease"},onMouseEnter:_=>_.target.style.background="rgba(255,255,255,0.3)",onMouseLeave:_=>_.target.style.background="rgba(255,255,255,0.2)",children:s.jsx("span",{style:{fontSize:"24px",color:"white"},children:""})}),s.jsxs("div",{className:"content-card",children:[s.jsxs("div",{className:"progress-dots",children:[s.jsx("div",{className:"dot"}),s.jsx("div",{className:"dot active",style:{background:"#9333ea"}})]}),s.jsx("div",{style:{fontSize:"60px",textAlign:"center",marginBottom:"16px"},children:r==null?void 0:r.emoji}),s.jsx("h1",{className:"title",style:{background:"linear-gradient(135deg, #6b46c1 0%, #ec4899 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Almost Done!"}),s.jsx("p",{className:"subtitle",children:"Tell us about yourself"}),s.jsxs("div",{style:{marginBottom:"24px"},children:[s.jsx("input",{type:"text",className:"phone-input",placeholder:"Enter your name...",value:a,onChange:_=>o(_.target.value),style:{width:"100%",marginBottom:"20px",color:"#333",fontSize:"16px",WebkitTextFillColor:"#333",backgroundColor:"white"}}),s.jsx("input",{type:"password",className:"phone-input",placeholder:"Create a password...",value:l,onChange:_=>u(_.target.value),style:{width:"100%",marginBottom:"20px",marginTop:"10px"}}),s.jsxs("div",{style:{marginBottom:"20px"},children:[s.jsx("label",{style:{fontSize:"14px",color:"#64748b",marginBottom:"8px",display:"block"},children:"Gender"}),s.jsxs("div",{style:{display:"flex",gap:"8px"},children:[s.jsx("button",{onClick:()=>h("male"),style:{flex:1,padding:"12px",border:"2px solid",borderColor:d==="male"?"#9333ea":"#e9d5ff",borderRadius:"12px",background:d==="male"?"rgba(147, 51, 234, 0.1)":"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",color:d==="male"?"#9333ea":"#64748b",transition:"all 0.3s"},children:" Male"}),s.jsx("button",{onClick:()=>h("female"),style:{flex:1,padding:"12px",border:"2px solid",borderColor:d==="female"?"#9333ea":"#e9d5ff",borderRadius:"12px",background:d==="female"?"rgba(147, 51, 234, 0.1)":"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",color:d==="female"?"#9333ea":"#64748b",transition:"all 0.3s"},children:" Female"}),s.jsx("button",{onClick:()=>h("other"),style:{flex:1,padding:"12px",border:"2px solid",borderColor:d==="other"?"#9333ea":"#e9d5ff",borderRadius:"12px",background:d==="other"?"rgba(147, 51, 234, 0.1)":"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",color:d==="other"?"#9333ea":"#64748b",transition:"all 0.3s"},children:" Other"})]})]}),s.jsxs("div",{style:{marginBottom:"20px"},children:[s.jsx("label",{style:{fontSize:"14px",color:"#64748b",marginBottom:"8px",display:"block"},children:"Age Group"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:k.map(_=>s.jsx("button",{onClick:()=>x(_.value),style:{padding:"10px 4px",border:"2px solid",borderColor:g===_.value?"#9333ea":"#e9d5ff",borderRadius:"12px",background:g===_.value?"rgba(147, 51, 234, 0.1)":"white",cursor:"pointer",fontSize:"12px",fontWeight:"600",color:g===_.value?"#9333ea":"#64748b",transition:"all 0.3s"},children:_.label},_.value))})]}),N&&s.jsx("div",{style:{color:"#ef4444",fontSize:"14px",textAlign:"center",marginBottom:"16px"},children:N})]}),s.jsx("button",{className:"submit-button",onClick:I,disabled:!a||!d||!g,style:{width:"100%",padding:"18px",background:a&&d&&g?"linear-gradient(135deg, #6b46c1 0%, #ec4899 100%)":"linear-gradient(135deg, #94a3b8 0%, #cbd5e1 100%)",color:"white",border:"none",borderRadius:"16px",fontSize:"18px",fontWeight:"700",cursor:a&&d&&g?"pointer":"not-allowed",transition:"all 0.3s",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:"Let's Start! "})]})]})}function IA(){var g;const t=Ye(),e=Pt(),[n,r]=f.useState(!1),[i,a]=f.useState(!1),[o,l]=f.useState(!1),u=((g=e.state)==null?void 0:g.username)||localStorage.getItem("userName")||"Champion",d=u.length>12;f.useEffect(()=>{sessionStorage.setItem("justSignedUp","true"),setTimeout(()=>r(!0),100),setTimeout(()=>a(!0),2e3)},[]);const h=()=>{l(!0),setTimeout(()=>{t("/",{replace:!0})},350)};return s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center overflow-hidden transition-opacity",style:{background:"radial-gradient(circle at center, #1a1a2e 0%, #0f0f0f 100%)",opacity:o?.3:1,transitionDuration:"400ms"},children:[s.jsxs("div",{className:"absolute inset-0 flex items-center justify-center",children:[s.jsx("div",{className:"absolute",style:{width:"100px",height:"100px",borderRadius:"50%",background:"radial-gradient(circle, rgba(147, 51, 234, 0.8), transparent)",animation:"pulseExpand 2.5s ease-out infinite"}}),s.jsx("div",{className:"absolute",style:{width:"100px",height:"100px",borderRadius:"50%",background:"radial-gradient(circle, rgba(236, 72, 153, 0.8), transparent)",animation:"pulseExpand 2.5s ease-out 0.5s infinite"}}),s.jsx("div",{className:"absolute",style:{width:"100px",height:"100px",borderRadius:"50%",background:"radial-gradient(circle, rgba(59, 130, 246, 0.8), transparent)",animation:"pulseExpand 2.5s ease-out 1s infinite"}}),s.jsx("div",{className:"absolute",style:{width:"80px",height:"80px",borderRadius:"50%",background:"radial-gradient(circle, rgba(255, 255, 255, 0.9), rgba(147, 51, 234, 0.4))",boxShadow:"0 0 60px 20px rgba(147, 51, 234, 0.6)",animation:"glow 2s ease-in-out infinite"}})]}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:[...Array(12)].map((x,N)=>s.jsx("div",{className:"absolute",style:{width:"2px",height:"100%",background:"linear-gradient(to bottom, transparent, rgba(147, 51, 234, 0.3), transparent)",transform:`rotate(${N*30}deg)`,animation:`fadeInOut 2.5s ease-in-out ${N*.1}s infinite`}},N))}),s.jsx("div",{className:`absolute z-10 transition-all duration-1000
        ${n?"opacity-100":"opacity-0"}`,style:{top:"calc(50% - 200px)",left:"50%",transform:"translateX(-50%)",textAlign:"center",width:"90%",maxWidth:"500px"},children:s.jsxs("h1",{style:{color:"#fff",fontFamily:"system-ui, -apple-system, sans-serif",letterSpacing:"1px",textShadow:"0 0 30px rgba(147, 51, 234, 0.5)",animation:"fadeInUp 1s ease-out forwards",margin:0},children:[s.jsx("div",{style:{fontSize:"48px",fontWeight:"bold",marginBottom:d?"-5px":"-10px"},children:"Welcome"}),s.jsx("div",{style:{fontSize:"48px",fontWeight:"bold",wordWrap:"break-word",overflowWrap:"break-word",lineHeight:d?"1.2":"1.1",padding:"0 20px",marginTop:d?"5px":"0"},children:u})]})}),i&&s.jsx("div",{className:"absolute z-10",style:{bottom:"250px",left:"50%",transform:"translateX(-50%)"},children:s.jsxs("button",{onClick:h,className:"welcome-start-button",style:{background:"linear-gradient(135deg, #9333ea 0%, #ec4899 100%)",color:"white",padding:"18px 40px",borderRadius:"50px",fontSize:"20px",fontWeight:"bold",border:"none",cursor:"pointer",transform:"scale(1)",transition:"all 0.3s ease",display:"inline-flex",alignItems:"center",gap:"12px",boxShadow:"0 4px 30px rgba(147, 51, 234, 0.4)",animation:"slideUp 0.5s ease-out forwards",whiteSpace:"nowrap"},onMouseEnter:x=>{x.currentTarget.style.transform="scale(1.05)",x.currentTarget.style.boxShadow="0 6px 40px rgba(147, 51, 234, 0.6)"},onMouseLeave:x=>{x.currentTarget.style.transform="scale(1)",x.currentTarget.style.boxShadow="0 4px 30px rgba(147, 51, 234, 0.4)"},children:["Let's Learn ",s.jsx("span",{style:{fontSize:"24px"},children:""})]})}),s.jsx("style",{jsx:!0,children:`
        @keyframes pulseExpand {
          0% {
            width: 100px;
            height: 100px;
            opacity: 0.8;
          }
          100% {
            width: 800px;
            height: 800px;
            opacity: 0;
          }
        }
        
        @keyframes glow {
          0%, 100% {
            transform: scale(1);
            opacity: 0.9;
          }
          50% {
            transform: scale(1.1);
            opacity: 1;
          }
        }
        
        @keyframes fadeInOut {
          0%, 100% {
            opacity: 0;
          }
          50% {
            opacity: 0.6;
          }
        }
        
        @keyframes fadeInUp {
          0% {
            opacity: 0;
            transform: translateY(20px);
          }
          100% {
            opacity: 1;
            transform: translateY(0);
          }
        }
        
        @keyframes slideUp {
          0% {
            opacity: 0;
            transform: translateY(30px);
          }
          100% {
            opacity: 1;
            transform: translateY(0);
          }
        }
      `})]})}function AA(){return f.useState(!1),null}const RA={name:(()=>{const t=JSON.parse(localStorage.getItem("currentUser")||"{}");return t.username?t.username.split(" ")[0]:"Player"})(),avatar:"wizard",level:1,totalXP:0,energy:un.MAX_ENERGY,energyRegenAt:null,comboStreak:0,bestCombo:0,currentStreak:0,bestStreak:0,totalDays:0,lastPlayedDate:null,totalQuizzes:0,totalCorrect:0,achievements:[],unlockedAvatars:["wizard","knight"],createdAt:Date.now()};function PA(){const[t,e]=f.useState(()=>{const d=localStorage.getItem(un.STORAGE_KEYS.PLAYER),h=JSON.parse(localStorage.getItem("currentUser")||"{}");if(d){const g=JSON.parse(d);return h.username&&(g.name=h.username.split(" ")[0]),g.unlockedAvatars||(g.unlockedAvatars=["wizard","knight"]),g}return RA});f.useEffect(()=>{localStorage.setItem(un.STORAGE_KEYS.PLAYER,JSON.stringify(t))},[t]),f.useEffect(()=>{if(t.energy<un.MAX_ENERGY&&t.energyRegenAt){const d=setInterval(()=>{const h=Date.now();h>=t.energyRegenAt&&e(g=>({...g,energy:Math.min(g.energy+1,un.MAX_ENERGY),energyRegenAt:g.energy+1<un.MAX_ENERGY?h+un.ENERGY_REGEN_TIME:null}))},6e4);return()=>clearInterval(d)}},[t.energy,t.energyRegenAt]);const n=f.useCallback(d=>{e(h=>{const g=h.totalXP+d,x=Bx(h.totalXP),N=Bx(g);let w=[...h.unlockedAvatars];return N>x&&un.AVATARS.forEach(k=>{k.unlockLevel<=N&&!w.includes(k.id)&&w.push(k.id)}),{...h,totalXP:g,level:N,unlockedAvatars:w}})},[]),r=f.useCallback(d=>{console.log("[DEPRECATED] addCoins called with:",d)},[]),i=f.useCallback((d=1)=>t.energy<d?!1:(e(h=>({...h,energy:h.energy-d,energyRegenAt:h.energyRegenAt||Date.now()+un.ENERGY_REGEN_TIME})),!0),[t.energy]),a=f.useCallback(d=>{e(h=>{const g=d?h.comboStreak+1:0;return{...h,comboStreak:g,bestCombo:Math.max(h.bestCombo,g)}})},[]),o=f.useCallback(()=>{e(d=>({...d,comboStreak:0}))},[]),l=f.useCallback(d=>{t.unlockedAvatars.includes(d)&&e(h=>({...h,avatar:d}))},[t.unlockedAvatars]),u=f.useCallback(()=>{const d=new Date().toDateString();e(h=>{if(h.lastPlayedDate===d)return h;const g=new Date;g.setDate(g.getDate()-1);const x=g.toDateString();let N=h.currentStreak;return h.lastPlayedDate===x?N=h.currentStreak+1:(h.lastPlayedDate,N=1),{...h,currentStreak:N,bestStreak:Math.max(h.bestStreak,N),totalDays:h.totalDays+1,lastPlayedDate:d}})},[]);return{player:t,addXP:n,addCoins:r,useEnergy:i,updateCombo:a,resetCombo:o,changeAvatar:l,updateDailyStreak:u,levelProgress:s4(t.totalXP)}}let vf={addListener:()=>({remove:()=>{}}),minimizeApp:()=>{},exitApp:()=>{}};typeof window<"u"&&window.Capacitor&&mm(()=>import("@capacitor/app"),[]).then(({App:t})=>{vf=t}).catch(t=>{console.error("Failed to load Capacitor App plugin:",t)});window.history.replaceState({path:window.location.pathname,preventBack:!0},"",window.location.pathname);window.history.pushState({path:window.location.pathname,preventBack:!0},"",window.location.pathname);window.userService=jt;const i2=f.createContext(null),Wr=()=>{const t=f.useContext(i2);if(!t)throw new Error("useGame must be used within GameProvider");return t};function DA({children:t}){const e=PA(),n=Wu(),r=typeof n.xp=="number"?n.xp:0,i=typeof n.level=="number"?n.level:1,a={current:Math.floor(r%100)||0,required:100};console.log("[XP Debug]",{xp:r,level:i,progress:a});const o={...e,coins:n.coins,xp:n.xp,level:n.level,levelProgress:a,recordQuizComplete:n.recordQuizComplete,recordPracticeComplete:n.recordPracticeComplete,getTodaySummary:n.getTodaySummary};return s.jsx(i2.Provider,{value:o,children:t})}function MA(){const[t,e]=f.useState(!1),[n,r]=f.useState(!1);return f.useEffect(()=>{(()=>{const a=SA();if(r(a),e(!0),a){const o=JSON.parse(localStorage.getItem("currentUser")||"{}");o.phone&&mt.startSession(o.phone)}})()},[]),f.useEffect(()=>{let i=0,a=null,o=null;return(async()=>{try{o=await vf.addListener("backButton",()=>{const u=window.location.pathname;u==="/"||u==="/home"?(i++,i===1?(console.log("Press back again to exit"),a=setTimeout(()=>{i=0},2e3)):i===2&&(clearTimeout(a),vf.minimizeApp(),mt.endSession())):window.history.back()})}catch(u){console.error("Error setting up back button handler:",u)}})(),()=>{o&&typeof o.remove=="function"&&o.remove(),a&&clearTimeout(a)}},[]),t?!n&&!window.location.pathname.startsWith("/auth")?(window.location.href="/auth",null):s.jsxs(DA,{children:[s.jsxs(Hj,{children:[s.jsx(et,{path:"/auth",element:s.jsx(_A,{})}),s.jsx(et,{path:"/auth/signin",element:s.jsx(kA,{})}),s.jsx(et,{path:"/auth/avatar",element:s.jsx(EA,{})}),s.jsx(et,{path:"/auth/username",element:s.jsx(TA,{})}),s.jsx(et,{path:"/welcome",element:s.jsx(IA,{})}),s.jsxs(et,{element:s.jsx(XI,{}),children:[s.jsx(et,{path:"/",element:s.jsx(Ux,{})}),s.jsx(et,{path:"/play",element:s.jsx(K4,{})}),s.jsx(et,{path:"/play/classic",element:s.jsx(R4,{})}),s.jsx(et,{path:"/play/party",element:s.jsx(v3,{})}),s.jsx(et,{path:"/profile",element:s.jsx(U3,{})}),s.jsx(et,{path:"/profile/leaderboard",element:s.jsx(q3,{})}),s.jsx(et,{path:"/profile/history",element:s.jsx(K3,{})}),s.jsx(et,{path:"/profile/rewards",element:s.jsx(dA,{})}),s.jsx(et,{path:"/profile/badges",element:s.jsx(hA,{})}),s.jsx(et,{path:"/profile/achievements",element:s.jsx(mA,{})}),s.jsx(et,{path:"/profile/streaks",element:s.jsx(pA,{})}),s.jsx(et,{path:"/profile/quests",element:s.jsx(xA,{})}),s.jsx(et,{path:"/profile/settings",element:s.jsx(yA,{})}),s.jsx(et,{path:"/profile/edit",element:s.jsx(vA,{})}),s.jsx(et,{path:"/profile/privacy",element:s.jsx(bA,{})}),s.jsx(et,{path:"/swipe",element:s.jsx(w3,{})}),s.jsx(et,{path:"/leaders",element:s.jsx(E1,{to:"/profile/leaderboard",replace:!0})}),s.jsx(et,{path:"/quiz/:category",element:s.jsx(d3,{})}),s.jsx(et,{path:"/quiz/play",element:s.jsx(j3,{})}),s.jsx(et,{path:"/practice/start",element:s.jsx(S3,{})}),s.jsx(et,{path:"/surprise",element:s.jsx(B3,{})}),s.jsx(et,{path:"/admin",element:s.jsx(wA,{children:s.jsx(NA,{})})}),s.jsx(et,{path:"*",element:s.jsx(Ux,{})})]})]}),s.jsx(AA,{})]}):s.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",backgroundColor:"#000"},children:s.jsx("div",{style:{color:"#fff"},children:"Loading..."})})}Jd.createRoot(document.getElementById("root")).render(s.jsx(pn.StrictMode,{children:s.jsx(yS,{children:s.jsx(MA,{})})}));export{_2 as c,iy as g};
